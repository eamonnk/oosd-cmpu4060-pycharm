/*! For license information please see oneuplightspeedwebpack.js.LICENSE.txt */
var __webpack_result__;(()=>{var e=[,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("appPageContext")}
,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i.a,b:()=>i.d,c:()=>o});var a=n(5),i=n(20),r=n(43),o=(0,n("odsp.util_118").c7)("ItemUrlHelper",r.a,{pageContext:a.a})}
,,,(e,t,n)=>{"use strict";n.d(t,{$:()=>B,A:()=>w,B:()=>O,C:()=>g,D:()=>X,Db:()=>Le,E:()=>U,F:()=>p,G:()=>s,H:()=>j,I:()=>K,Ib:()=>q,J:()=>F,K:()=>P,L:()=>o,M:()=>z,N:()=>G,O:()=>we,P:()=>Z,Q:()=>Ee,R:()=>Oe,S:()=>ke,Sb:()=>pe,T:()=>de,U:()=>Se,V:()=>ne,W:()=>ge,X:()=>ie,Y:()=>De,Z:()=>r,_:()=>re,_b:()=>ce,a:()=>_,ab:()=>ye,b:()=>h,bb:()=>ee,c:()=>b,cb:()=>xe,d:()=>v,db:()=>fe,e:()=>d,eb:()=>le,f:()=>Y,fb:()=>be,g:()=>J,gb:()=>Q,h:()=>u,hb:()=>se,i:()=>I,ib:()=>te,j:()=>x,k:()=>y,l:()=>S,lb:()=>_e,m:()=>l,mb:()=>me,n:()=>m,nb:()=>Ie,o:()=>f,ob:()=>$,p:()=>R,pb:()=>he,q:()=>c,r:()=>T,rb:()=>ve,s:()=>H,sb:()=>ue,t:()=>E,tb:()=>ae,u:()=>A,ub:()=>oe,v:()=>L,vb:()=>Ce,w:()=>k,x:()=>M,xb:()=>W,y:()=>C,yb:()=>Ae,z:()=>D});var a=n("odsp.util_118"),i=n(358),r=a.Tb.isFeatureEnabled,o={ODB:817,ODC:!0,OneDrive:!0},s={ODB:60124,ODC:!0,Fallback:!1},c={ODB:60358},d={ODB:1655,ODC:!1,Fallback:!1},l={ODB:61828,ODC:!1,Fallback:!1},u={ODB:61978,ODC:!1,Fallback:!1},f={ODB:62087,ODC:!1,Fallback:!1},p={ECS:1071224},m={ECS:1161382},_={ECS:1082725},h={ECS:1111474},b={ECS:1266897},g={ODB:!0,Fallback:!0},v={ODB:1614,ODC:!1,Fallback:!1},y={ODB:1063,ODC:!1,Fallback:!1},S={ODB:61719,ODC:!1,Fallback:!1},D={ODB:1513,ODC:!1,Fallback:!1},I={ODB:62071,ODC:"PdfCacheDisplayInfo",Fallback:!1},x={ODB:61561,ODC:!1,Fallback:!1},C={ODB:61332,ODC:!1,Fallback:!1},O={ODB:61881,ODC:"PdfDeprecateTempAuth",Fallback:!1},w={ODB:61973,ODC:!1,Fallback:!1},E={ODB:60165},A={ODB:60192},L={ODB:61066},k={ODB:1711},M={ODB:61403},P={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},T={ODB:61890,ODC:!1,OneDrive:!1,Fallback:!1},U={ODB:61709,ODC:!0,OneDrive:!0,Fallback:!0},F={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},H={ODB:61495},R={ODB:61649},N={ODB:61953,ODC:!1,OneDrive:!1,Fallback:!1};function B(e){return a.HW.isActivated("5d22fad5-86b3-40a8-9fee-2e13934de07d","08/21/2024","kifraint - consolidate custom copilot flights")?r(N):(0,i.b)({pageContextForEAPCheck:e})}var j={ODB:!a.HW.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},V={ODB:1698};function z(){return!a.HW.isActivated("d9c17c13-cdd6-4c12-aec1-e636d97e7a9c","09/25/2023","Scoping context work for copilot pane in oneup")}function G(){return!a.HW.isActivated("ae9f64ca-76b3-4a80-acc7-17d05476cd05","04/09/2024","Let copilot chat work with shared files as well")}var K={ODB:!0,OneDrive:!0},W={ODB:61113},q={ODB:61686};function Q(){return!a.HW.isActivated("8829b122-25f1-497b-889d-18046e90cdb4","05/23/2024","Update oneupitem processing to exclude unsupported files from officebundle generation, to prevent unsupported wac viewer usage")}var Y={ODB:61210},J={ODB:61338},X={ODB:61220},Z={ODB:61356};function $(){return r(V)}function ee(){return!a.HW.isActivated("6b3d3f79-542e-416d-a2d5-df4c81a10a67","04/19/2024","Update 3d viewer to support gltf csl")}function te(){return!a.HW.isActivated("5904d91a-f2d9-492f-809a-0628008a7395","01/18/2024","Refactor UA and Esign for PDF perf improvement")}function ne(){return!a.HW.isActivated("a57daca8-0ab6-44bc-85da-ad7ef0256836","02/01/2024","Default OneNote file to other viewer no matter if it contains thumbnail url")}function ae(){return!a.HW.isActivated("ca112383-8d78-4a73-8406-2825ad372646","02/06/2024","useMemo in oneupSlide to avoid unnecessary re-rendering")}function ie(){return!a.HW.isActivated("5DB864CD-C8C0-412B-BDCF-7B1D19DC6408","02/07/2024","Refactor eSignature for perf improvement")}function re(){return!a.HW.isActivated("2786c500-79af-45d2-a8bc-9e24bba711dc","02/14/2024","set accessToken to undefined for file handler")}function oe(){return!a.HW.isActivated("878753ca-7dc4-4e78-9149-0385365eb96e","02/28/2024","update the file type check for thumbnail")}function se(){return!a.HW.isActivated("a647a6fc-3e82-4662-9c1c-7fe30dc1c1ed","03/05/2024","update the file picker to use webDavUrl")}function ce(){return!a.HW.isActivated("83825E35-490E-43D8-941D-0B315F472C7F","03/20/2024","use previewer for large files for new oneup by default")}function de(){return!a.HW.isActivated("d64008af-a8a9-4552-b0b4-b1ea01c39f05","03/19/2024","update fast oneup render logic to check parent first")}function le(){return!a.HW.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","04/05/2024","log experiment data for oneup")}function ue(){return!a.HW.isActivated("ba334243-6ae7-47f8-b998-b7d40e2b1a5f","04/22/2024","display right pane with error message")}function fe(){return!a.HW.isActivated("59dd68f8-625d-4d16-b841-b507c7cae5ba","04/24/2024","enable show presence for current single client")}function pe(){return a.HW.isActivated("59599a46-3c86-46b4-b44e-8e9836b0c8cc","05/13/2024","refactor command bar styles")}function me(){return!a.HW.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","05/07/2024","enable preserve CurrentItemKey for search and filter result in new Oneup")}function _e(){return!a.HW.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","05/15/2024","use onedrive/sharepoint for filehandler client name")}function he(){return!a.HW.isActivated("27ee7a45-8265-4d6e-a9c8-5c375f656b8b","05/14/2024","enable od3 style for info pane iframe")}function be(){return!a.HW.isActivated("dfafd001-d599-49cf-b756-f64d5614b6c7","05/23/2024","use first focusable target")}function ge(){return!a.HW.isActivated("6884f3e1-f7e7-429c-829d-de15202d7086","05/29/2024","disable FRE for WAC and Video")}function ve(){return!a.HW.isActivated("6884f3e1-f7e7-429c-829d-de15202d7086","05/30/2024","remove list url if parentView !== 0")}function ye(){return!a.HW.isActivated("83b9c996-3090-4417-ad53-fc565729550b","06/14/2024","Enable override to other viewer for specific extensions")}function Se(){return!a.HW.isActivated("bddb1b44-54d7-4d9e-8c35-6e6f1eae7f08","06/18/2024","validate item info correctness disregard casing")}function De(){return!a.HW.isActivated("2fc93384-9c5a-45c4-a1d7-5938985af39e","07/18/2024","fast one up error handling for no access scenarios")}function Ie(){return!a.HW.isActivated("21df4421-5b42-4f02-b214-c13002058ff0","07/11/2024","suppress web keyboard shortcuts while oneup is open")}function xe(){return!a.HW.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/03/2024","send oauth token over in crosslist scenario for info pane")}function Ce(){return!a.HW.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/10/2024","load wac viewer when offset is 0")}var Oe={ODB:62047};function we(){return!a.HW.isActivated("02071577-5f64-4528-af85-232e917aecb5","08/27/2024","aterentiev - enable builder for copilot viewer")}function Ee(){return!a.HW.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")}function Ae(){return!a.HW.isActivated("438f44e6-9109-48e0-ad63-1422c7a65475","09/04/2024","aterentiev - pass token provider to copilot data source")}var Le={ODB:62044};function ke(){return!a.HW.isActivated("cfbff67e-09b8-486e-a4b8-ed7c9434ae22","09/13/2024","allow commandbar set updates when file handler api returns")}}
,,,,,,,,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>k,resourceKey:()=>M});var a,i,r=n("tslib_826"),o=n(426),s=n(5),c=n(6),d=n("odsp.util_118"),l=n(9);!function(e){e[e.STI=1]="STI",e[e.Default=2]="Default"}(a||(a={})),function(e){e[e.Default=1]="Default",e[e.Search=2]="Search"}(i||(i={}));var u=n(695),f=n(65),p="SpHttpDataSource.async.key",m=(d.HW.isActivated("723526D9-B1A5-4ADC-81B1-B7D1B4934EBB","9/23/2020","Workaround for loading sp-http in AMD builds"),new d.hK({name:p,loader:new d.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(53)]).then(n.bind(n,618)).then(function(e){return e.resourceKey})})})),_=(new d.hK({name:p,loader:new d.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(53)]).then(n.bind(n,618)).then(function(e){return e.typeResourceKey})})}),n(4)),h=n(100),b=n(50).a.local,g=new d.hK({name:"".concat("CachingType.key",".cachingType"),factory:new d.t_(b)}),v=new Map,y=new d.hK({name:"".concat("PrefetchPromiseCache.key",".prefetchPromiseCache"),factory:new d.t_(v)}),S=n(374),D=n(223),I=n(224),x=n(376),C=new d.hK({name:"IdentityCache.key",factory:{dependencies:{pageContext:s.a,identityDataStoreCachingType:g},create:function(e){var t=e.pageContext,n=e.identityDataStoreCachingType;return{instance:new x.a({userId:t.systemUserKey,cachingType:n})}}}}),O=n(91),w=!d.HW.isActivated("646D58EC-51E4-4C3E-9B03-EC9E3174625D"),E="https://substrate.office.com",A=["https://esign.svc.cloud.dev.microsoft","https://esign.svc.cloud.microsoft","9471276c-aa67-4dd2-bde2-291a033f3c3c","396ef0b6-ae1c-4404-86ce-0a869d4d2987","https://portal.office.com/"],L=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._dataRequestor=new u.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:a._pageContext}),a._cache=n.identityCache,a._promiseCache=new Map,a._prefetchPromiseCache=n.prefetchPromiseCache,a._apiUrlHelper=new f.a({webAbsoluteUrl:a._pageContext.webAbsoluteUrl}),a._tokenFetcher=n.tokenFetcher,a._offlineDetection=n.offlineDetection,a}return(0,r.XJ)(t,e),t.prototype.getIdentity=function(){return t=(e={pageContext:this._pageContext}).pageContext,n=function(e){var t=e.pageContext,n=null==t?void 0:t.systemUserKey;return n&&n.substring(n.lastIndexOf("|")+1).replace("@live.com","")||""}(e),a=!0===t.isAnonymousGuestUser||!0===t.isEmailAuthenticationGuestUser?D.a.anonymous:D.a.aad,i=t.userLoginName,r=t.webPermMasks,{email:t.userEmail,id:n,loginName:i,type:a,sessionState:"",webPermMasks:r};var e,t,n,a,i,r},t.prototype.getSignInUrl=function(){throw new Error("Not Implemented")},t.prototype.getGraphToken=function(e){var t=e.resource,n=e.scopes,a=e.claimsChallenge;return t&&!this._isGraphEndpoint(t)?this.getSharePointToken(t,!!a||void 0,a?{claims:a.claims,access_token:a.access_token,error:a.error}:void 0):n&&(n.indexOf("InformationProtection.Read.All")>-1||n.indexOf("InformationProtectionPolicy.Read")>-1||n.indexOf("Calendars.Read")>-1)?c.c.resolve(this.resources.consumeAsync(m.bypass)).then(function(e){return e.fetchToken({resource:t,claims:null==a?void 0:a.claims})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("ms-graph",{resource:t&&new l.a(t).authority||"https://graph.microsoft.com",claimsChallenge:a})},t.prototype.getLokiToken=function(){return this._getTokenForResource("ms-loki",{resource:"https://loki.delve.office.com"})},t.prototype.getPushChannelToken=function(){return this._getTokenForResource("pushchannel",{resource:"https://pushchannel.1drv.ms",useSpHttpDataSource:!0})},t.prototype.getTeamsCMDToken=function(){return this._getTokenForResource("teams-cmd",{resource:"6bc3b958-689b-49f5-9006-36d165f30e00",useSpHttpDataSource:!0})},t.prototype.getMeetingCatchupToken=function(){return this._getTokenForResource("ms-mcu",{resource:"https://MeetingCatchup.substrate.office.com",useSpHttpDataSource:!0})},t.prototype.getFormsToken=function(){return this._getTokenForResource("ms-forms",{resource:"https://forms.office.com",useSpHttpDataSource:!0})},t.prototype.getOCPSToken=function(){return this._getTokenForResource("ocps",{resource:"https://clients.config.office.net",useSpHttpDataSource:!0})},t.prototype.getSPHomeToken=function(e){return this._getTokenForResource("SPHome",{resource:e.resource})},t.prototype.getOfficeToken=function(){return this._getTokenForResource("ms-officeapps",{resource:"https://officeapps.live.com"})},t.prototype.getSubstrateToken=function(e){var t,n,r;void 0===e&&(e={tokenType:a.Default,resourceType:i.Default});var o=e.tokenType,s=e.skipCache,c=e.resourceType;if(o===a.STI)return this._getTokenForResource("ms-substrate-sti",{resource:E,tokenType:"STI",skipCache:s});var d=(0,I.i)(null===(t=this._pageContext)||void 0===t?void 0:t.env2),l=(null===(n=this._pageContext)||void 0===n?void 0:n.substrateEndpointUrl)||E,u="ms-substrate";return c===i.Search&&d&&(l="".concat((null===(r=this._pageContext)||void 0===r?void 0:r.substrateEndpointUrl)||"https://partner.outlook.cn","/search"),u="ms-substrate-search"),this._getTokenForResource(u,{resource:l,skipCache:s})},t.prototype.getSubstrateTenantFeedbackToken=function(){return this._getTokenForResource("ms-substrate-tenant-feedback",{resource:"https://substrate.office.com/tenantfeedback",useSpHttpDataSource:!0})},t.prototype.getMediaTAToken=function(e){return this._getTokenForResource("SharePoint-media",{resource:e})},t.prototype.getMediaTAGptToken=function(e,t){return c.c.resolve(this.resources.consumeAsync(m)).then(function(n){return n.fetchToken({resource:e,claims:null==t?void 0:t.claims})}).then(function(e){return{accessToken:e}})},t.prototype.getAugloopToken=function(e){return void 0===e&&(e="https://augloop.office.com/v2"),this._getTokenForResource("ms-augloop",{resource:e,useSpHttpDataSource:!0})},t.prototype.getSharePointToken=function(e,t,n){var a=/https:\/\/(.*).svc.ms/.test(e);if(this._isGraphEndpoint(e))return this._getTokenForResource("ms-graph",{resource:new l.a(e).authority,forceRefresh:t,claimsChallenge:n});if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||a){if(this._isGraphEndpoint(e)||a){var i=this._isGraphEndpoint(e)?"SharePoint-graph":a?"SharePoint-media":"SharePoint";return this._getTokenForResource(i,{resource:new l.a(e).authority,forceRefresh:t,claimsChallenge:n})}return c.c.resolve(this.resources.consumeAsync(m.bypass)).then(function(t){return t.fetchToken({resource:new l.a(e).authority,claims:null==n?void 0:n.claims})}).then(function(e){return{accessToken:e}})}return this._getTokenForResource("SharePoint_SelfIssued",{resource:new l.a(e).authority,forceRefresh:t,tokenType:"SPO",claimsChallenge:n})},t.prototype.getSharepointAppBarToken=function(e){return this._getTokenForResource("SharePoint",(0,r.W_)((0,r.W_)({},e),{useSpHttpDataSource:!0}))},t.prototype.getPowerBIToken=function(e){return this._getTokenForResource("power-bi",{resource:e})},t.prototype.getPowerPlatformToken=function(e){return this._getTokenForResource("power-platform",{resource:e,useSpHttpDataSource:!0})},t.prototype.getPhoneLinkToken=function(e){return c.c.resolve(this.resources.consumeAsync(m.bypass)).then(function(t){return t.fetchToken({resource:e,tokenName:"PhoneLink"})}).then(function(e){return{accessToken:e}})},t.prototype.getYammerToken=function(e){return this._getTokenForResource("yammer",{resource:e})},t.prototype.getAzNBToken=function(){return c.c.resolve(this.resources.consumeAsync(m.bypass)).then(function(e){return e.fetchToken({resource:"api://63c9fecc-99c2-4c4c-878f-84685641aa94"})}).then(function(e){return{accessToken:e}})},t.prototype.getOfficeHomeToken=function(e){return c.c.resolve(this.resources.consumeAsync(m.bypass)).then(function(t){return t.fetchToken({resource:e,tokenName:"OfficeHome"})}).then(function(e){return{accessToken:e}})},t.prototype.getAzRMSToken=function(){return this._getTokenForResource("az-rms",{resource:"https://aadrm.com",useSpHttpDataSource:!0})},t.prototype.getOAuthSessionToken=function(e,t){var n=A.indexOf(e)>=0;return this._getTokenForResource("oAuth",{resource:e,claimsChallenge:t,useSpHttpDataSource:n})},t.prototype.getFormDigest=function(e){var t;return t=e?e.split("/_api")[0]+"/_api/contextInfo":this._getContextInfoUrl(),this._dataRequestor.getData({url:t,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},t.prototype._getTokenForResource=function(e,t){var n,a;return(0,r.Zd)(this,void 0,c.c,function(){var i,o,s,d,l,u,f,p,b,g,v,y,S,D,I,x,C=this;return(0,r.qr)(this,function(O){switch(O.label){case 0:return i=t.resource,o=t.tokenType,s=t.claimsChallenge,d=t.forceRefresh,l=function(e){var t=e.resource,n=e.tokenType;return"".concat(e.tokenName,"|").concat(t,"|").concat(n||"")}({tokenName:e,resource:i,tokenType:o}),u=this._promiseCache.get(l),f=null===(n=this._prefetchPromiseCache)||void 0===n?void 0:n.get(l),p=function(e){var n=e.access_token,a=e.expires_on,i=e.correlationId,r=1e3*(Number(a||(0,h.b)(n).exp)-300);return t.skipCache||C._cache.setValue(l,{value:n,expiration:r,correlationId:i}),{accessToken:n,tokenExpiry:r,correlationId:i}},s||d?[4,Promise.all((0,r.AE)((0,r.AE)([],u?[u.catch(function(e){})]:[],!0),f?[f.catch(function(e){})]:[],!0))]:[3,2];case 1:return O.sent(),this._cache.setValue(l,void 0),[3,6];case 2:return(b=this._cache.getValue(l,Date.now()))?[2,{accessToken:b.value,tokenExpiry:b.expiration,correlationId:b.correlationId}]:u?[4,u]:[3,4];case 3:if(g=O.sent())return[2,g];O.label=4;case 4:return f?(null===(a=this._prefetchPromiseCache)||void 0===a||a.delete(l),v=function(){return(0,r.Zd)(C,void 0,c.c,function(){var e,t,n;return(0,r.qr)(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),[4,f];case 1:return e=a.sent(),new _.a(e.qos.start).end((0,r.W_)((0,r.W_)({},e.qos.end),{resultType:e.qos.success?_.b.Success:_.b.Failure})),t=void 0,e.response?e.response.ok?[4,e.response.json()]:[2,void 0]:[3,3];case 2:n=a.sent(),t=p((0,r.W_)((0,r.W_)({},n),{correlationId:e.response.headers.get("SPRequestGuid")||""})),a.label=3;case 3:return[2,t];case 4:return a.sent(),[2,void 0];case 5:return[2]}})})},y=v(),this._promiseCache.set(l,y),[4,y]):[3,6];case 5:if(S=O.sent(),this._promiseCache.delete(l),S)return[2,S];O.label=6;case 6:return w&&this._offlineDetection.offline?[2,c.c.resolve({accessToken:"nucleusOfflineToken",tokenExpiry:Date.now()+36e5})]:(D=function(){return(0,r.Zd)(C,void 0,c.c,function(){var e,t,n,a;return(0,r.qr)(this,function(r){switch(r.label){case 0:return[4,this.resources.consumeAsync(m.bypass)];case 1:return[4,r.sent().fetchTokenData({resource:i,claims:null==s?void 0:s.claims})];case 2:return e=r.sent(),t=void 0,(n=null===(a=e.expiresOn)||void 0===a?void 0:a.getTime())&&(t=(n/1e3).toString()),[2,{access_token:e.accessToken,expires_on:t}]}})})},I=function(){return(0,r.Zd)(C,void 0,c.c,function(){return(0,r.qr)(this,function(n){switch(n.label){case 0:return t.useSpHttpDataSource?[4,D()]:[3,2];case 1:case 3:return[2,n.sent()];case 2:return[4,this._tokenFetcher.getToken({name:e,resource:i,tokenType:o,claimsChallenge:s})]}})})},x=I().then(function(e){var t=p(e);return C._promiseCache.delete(l),t},function(e){return C._promiseCache.delete(l),c.c.reject(e)}),this._promiseCache.set(l,x),[4,x]);case 7:return[2,O.sent()]}})})},t.prototype._getContextInfoUrl=function(){return this._apiUrlHelper.build().segment("contextInfo").toString()},t.prototype._isGraphEndpoint=function(e){var t="".concat(this._pageContext.msGraphEndpointUrl,"/");return"".concat(e,"/").slice(0,t.length)===t},t.dependencies=(0,r.W_)((0,r.W_)({},o.a.dependencies),{pageContext:s.a,identityDataStoreCachingType:g.optional,tokenFetcher:S.a,prefetchPromiseCache:y.optional,identityCache:C,offlineDetection:O.a}),t}(o.a);const k=L;var M=(0,d.c7)("IdentityDataSource",L)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>c});var a=n("odsp.util_118"),i=a.HW.isActivated("EF060DDF-A910-4B46-8F6F-C4574FF67B88"),r=window._spPageContextInfo,o=function(e){if(r&&r.farmSettings)return r.farmSettings[e]},s=function(e){return 1===Number(o(e))||"true"===o(e)},c=function(e){var t=o(e);return!!t&&(1===Number(t)||"true"===t.toLowerCase())},d=function(e){return e.serviceSetting?(i?s:c)(e.serviceSetting):a.Tb.isFeatureEnabled(e)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>r,c:()=>i});var a={idParamKey:"id",parentIdParamKey:"parent",driveIdParamKey:"driveId",driveEndpointParamKey:"endpoint",queryTypeParamKey:"view",pageParamKey:"p",parentQueryTypeParamKey:"parentview",windowNameJsonKey:"ODBParams",queryParamKey:"q",conversationIdParamKey:"cvid",metadataSearchIdKey:"searchid",uniqueParamKey:"u",navParamKey:"nav",localeKey:"locale",dateFilterKey:"dateFilter",typeFiltersKey:"typeFilters",userFiltersKey:"userFilters",viewIdKey:"viewid",viewPathKey:"viewpath",isPowerAppView:"isPowerAppView",listIdKey:"listId",listUrlKey:"listurl",sortFieldKey:"sortField",isAscendingKey:"isAscending",policyTipKey:"policyTipForListItemId",sharingKey:"sharingDialogForListItemId",openShare:"openShare",managePermissionsKey:"managePermissionsForListItemId",pseudoPolicyTipKey:"showpolicytips",groupByKey:"groupBy",errorTypeKey:"type",correlationIdKey:"correlation",approvalItemVersion:"approvalItemVersion",commentIdKey:"commentId",emailCTRParamKey:"e",useFiltersInViewXmlKey:"useFiltersInViewXml",itemId:"itemId",playlistLayout:"playlistLayout",needsAttentionViewKey:"needsAttentionView",requiredColumnsKey:"required",pickerLinkTypeKey:"link_type",pickerAADClientIdKey:"aad_client_id",pickerMSAClientIdKey:"msa_client_id",pickerSelectionModeKey:"selection_mode",pickerViewTypeKey:"view_type",pickerAccessLevelKey:"access",pickerReturnUrlKey:"ru",remoteItem:n(215).a,stateParamKey:"state",callerId:"CallerId",callerScenarioId:"CallerScenarioId",listItemIdKey:"ID",rootFolderParamKey:"RootFolder",sourceKey:"Source",isDialogKey:"IsDlg",contentTypeId:"ContentTypeId",newTargetListUrlKey:"newTargetListUrl",shareLinkId:"slrid",settingKey:"setting",userExpirationPanelKey:"userExpiration",sharedLibraryCreated:"sharedLibraryCreated",expandPageRowLimitKey:"rowLimit",fileBrowserOptionsKey:"fileBrowser",groupIdKey:"groupId",odSkipAutoFocus:"odSkipAutoFocus",teamIdKey:"teamId",channelIdKey:"channelId",entityIdKey:"entityId",subEntityIdKey:"subEntityId",ringIdKey:"ringId",asidKey:"asid",sidKey:"sid",hostName:"hostName",returnUrl:"returnUrl",disableQueryAlterationKey:"dqa",searchScopeKey:"searchScope",action:"action",videoDriveId:"videoDriveId",videoItemId:"videoItemId",videoParentId:"videoParentId",referrer:"referrer",referrerScenario:"referrerScenario",viewerKey:"viewer",personIdKey:"personId",emailIdKey:"emailId",meetingIdKey:"meetingId",templateId:"templateId",sourceDoc:"sourcedoc",entryPoint:"entry",noAuthRedirect:"noAuthRedirect",appParamKey:"app",scenarioParamKey:"scenario",loadFormWithNucleus:"loadFormWithNucleus",referringClientKey:"referringClient",localKey:"local"},i=/^Filter(Field|Value|Type|Op|LookupId|Display)(s?)([1-9]|10)$/;const r=a}
,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a.a});var a=n(369)}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>o,c:()=>r,d:()=>i,e:()=>_,f:()=>h});var a,i,r,o,s=n("tslib_826"),c=n(125),d=n("odsp.util_118"),l=n(390),u=n(85),f=n("react-lib"),p=n(28);!function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(a||(a={})),function(e){e[e.none=0]="none",e[e.detailPane=1]="detailPane",e[e.versionHistory=2]="versionHistory",e[e.copilotPane=3]="copilotPane",e[e.commentsPane=4]="commentsPane"}(i||(i={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(r||(r={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(o||(o={}));var m=function(e){function t(){return e.call(this,{currentState:{publisher:"init",rightPane:{type:i.none},modal:{showModal:!1},eSignData:{isCreateSidePanelActive:!1},annotationViewerState:{viewerVisiblity:t._defaultAnnotationVisibility,isActive:!1},isFocusItemFavorited:void 0,isPerfButtonOpen:(0,p.Z)(p.xb),isOneUpFreOpen:!1,isPrecenseFacepileVisible:!1}})||this}return(0,s.XJ)(t,e),t.prototype.getViewerState=function(e){var t=this.state.currentState.viewerStates;return null==t?void 0:t.get(e)},t.prototype.getAnnotationViewerState=function(){return this.state.currentState.annotationViewerState},t.prototype.getESignData=function(){return this.state.currentState.eSignData},t.prototype.getFileHandlerOptions=function(){return this.state.currentState.fileHandlerOptions},t.prototype.updateViewerState=function(e,t){var n=this.state.currentState.viewerStates||new Map,a=null==n?void 0:n.get(t.key);t.options=(0,s.W_)((0,s.W_)((0,s.W_)({},a),t.options),{pdfViewerStates:(0,s.W_)((0,s.W_)({},null==a?void 0:a.pdfViewerStates),t.options.pdfViewerStates)}),n.set(t.key,t.options),this.update("currentState",{publisher:e,viewerStates:new Map(n)})},t.prototype.updateRightPaneError=function(e,t){(0,p.sb)()&&this.update("currentState",{publisher:e,rightPane:(0,s.W_)((0,s.W_)({},t),{hasError:!0})})},t.prototype.updateRightPaneState=function(e,t){t.type!==i.none&&this.updateESignDataState(e,{isCreateSidePanelActive:!1}),this.update("currentState",{publisher:e,rightPane:(0,s.W_)((0,s.W_)({},t),{hasError:void 0,error:void 0})})},Object.defineProperty(t.prototype,"rightPaneType",{get:function(){return this.currentAppState.rightPane.type},enumerable:!1,configurable:!0}),t.prototype.updateModalState=function(e,t){this.update("currentState",{publisher:e,modal:t})},t.prototype.updateParentPermissionValidity=function(e,t){this.update("currentState",{publisher:e,hasValidPermissionToParent:t})},t.prototype.updateFileHandlerOptions=function(e,t){this.update("currentState",{publisher:e,fileHandlerOptions:t})},t.prototype.updatePerfButtonState=function(e,t){this.update("currentState",{publisher:e,perfDataReported:t})},t.prototype.updatePerfButtonIsVisible=function(e,t){this.update("currentState",{publisher:e,isPerfButtonOpen:t})},t.prototype.updateIsPresenceFacepileVisible=function(e,t){this.state.currentState.isPrecenseFacepileVisible!==t&&this.update("currentState",{publisher:e,isPrecenseFacepileVisible:t})},t.prototype.updateOneUpShellFreIsOpen=function(e,t){this.update("currentState",{publisher:e,isOneUpFreOpen:t})},t.prototype.updateImageState=function(e,t){this.update("currentState",{publisher:e,imageMode:t})},t.prototype.updatePdfState=function(e,t){this.update("currentState",{publisher:e,pdfAppMode:t})},t.prototype.updateToastState=function(e,t){var n=this.state.currentState.toast;t.timeStamp=Date.now();var a=t.toastKey?t.toastKey:"defaultKeyToDisplayOnlyOneToast";if(n?n.set(a,t):(n=new Map).set(a,t),!1===t.visible&&n.delete(a),n.size>2){var i="",r=1/0;n.forEach(function(e,t){e.timeStamp&&e.timeStamp<r&&(i=t,r=e.timeStamp)}),n.delete(i)}var o=new Map(n);this.update("currentState",{publisher:e,toast:o})},t.prototype.updateErrorState=function(e,t){this.update("currentState",{publisher:e,errorState:t})},t.prototype.setIsFocusItemFavorited=function(e,t){this.update("currentState",{publisher:e,isFocusItemFavorited:t})},t.prototype.toggleAnnotationViewerVisiblity=function(e){var t=this.state.currentState.annotationViewerState,n=t.viewerVisiblity,i=n===a.Off||void 0===n?a.On:a.Off,r=(0,s.W_)((0,s.W_)({},t),{viewerVisiblity:i,isActive:!t.isActive});this.update("currentState",{publisher:e,annotationViewerState:r}),(0,p.Z)(p.r)&&this.hideUACommentsPane(i,e)},t.prototype.hideUACommentsPane=function(e,t){e===a.Off&&this.state.currentState.rightPane.type===i.commentsPane&&this.updateRightPaneState(t,{type:i.none})},t.prototype.setAnnotationViewerPreloadSucceeded=function(e,t){var n=this.state.currentState.annotationViewerState;this.update("currentState",{publisher:e,annotationViewerState:(0,s.W_)((0,s.W_)({},n),{hasPreloadSucceeded:t})})},t.prototype.updateDeletedKeysState=function(e,t){this.update("currentState",{publisher:e,deletedKeys:t})},t.prototype.updateIsUniversalPrintLicenseValidState=function(e,t){this.update("currentState",{publisher:e,isUniversalPrintLicenseValid:t})},t.prototype.updateIsNoAccessScenarioState=function(e,t){this.update("currentState",{publisher:e,isNoAccessScenario:t})},t.prototype.updateESignDataState=function(e,t){t.isCreateSidePanelActive&&this.updateRightPaneState(e,{type:i.none}),this.update("currentState",{publisher:e,eSignData:t})},Object.defineProperty(t.prototype,"currentAppState",{get:function(){return this.state.currentState},enumerable:!1,configurable:!0}),t.prototype.clean=function(){this.update("currentState",{publisher:"close",rightPane:{type:i.none},errorState:void 0,viewerStates:void 0,imageMode:r.view,annotationViewerState:{viewerVisiblity:t._defaultAnnotationVisibility,hasPreloadSucceeded:!1,isActive:!1},pdfAppMode:c.a.View,toast:void 0,modal:{showModal:!1,content:void 0},eSignData:{isCreateSidePanelActive:!1},perfDataReported:void 0,isFocusItemFavorited:void 0})},t.prototype.navClean=function(){this.update("currentState",{publisher:"nav",eSignData:{isCreateSidePanelActive:!1}})},t._defaultAnnotationVisibility=a.Off,t}(l.a),_=new d.hK({name:"OneUpStateStore",factory:new d.wo(m)});function h(e,t){return function(e,t,n){var a=(0,f.useState)(),i=a[0],r=a[1],o=(0,f.useState)(function(){var a=e.state[t],i=n?n(a):a;if(!(0,d.C)(i))return i;i.then(function(e){return c(e)}).catch(function(e){return r(e)})}),s=o[0],c=o[1];return(0,f.useLayoutEffect)(function(){return e.onUpdate(t,function(e){var t=n?n(e.detail):e.detail;(0,d.C)(t)?t.then(function(e){return c(e)}).catch(function(e){return r(e)}):c(t)})},[]),[s,i]}((0,u.c)().consume(_),e,t)}}
,,,,,,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>i,b:()=>a}),function(e){e.Start="start",e.Succeed="succeed",e.Fail="fail"}(a||(a={})),function(e){e.DocumentPreviewDone="DocumentPreviewDone",e.DocumentLoad="DocumentLoad",e.DocumentSave="DocumentSave",e.DocumentExtract="DocumentExtract",e.DocumentMerge="DocumentMerge"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>a,c:()=>d,d:()=>i,e:()=>u});var a,i,r=n("tslib_826");!function(e){e.EventHandleFailed="EventHandleFailed",e.FileDownloadFailed="FileDownloadFailed",e.RangeDownloadSizeMismatch="RangeDownloadSizeMismatch",e.FontLoadFailed="FontLoadFailed",e.PrintFailed="PrintFailed",e.ShowThumbnailFailed="ShowThumbnailFailed",e.Unknown="Unknown",e.WasmModuleInitFailed="WasmModuleInitFailed",e.WasmModuleNotFound="WasmModuleNotFound",e.WasmRuntimeError="WasmRuntimeError",e.WasmCacheFailed="WasmCacheFailed",e.AnnotationAddFailed="AnnotationAddFailed",e.PdfJsPreviewFailed="PdfJsPreviewFailed",e.InvalidPDF="InvalidPDF",e.PDFWorkerMismatch="PDFWorkerMismatch",e.PreviewerFailToLoadTask="PreviewerFailToLoadTask",e.PreviewerFailToLoadPage="PreviewerFailToLoadPage",e.PreviewerFailToFetchFile="PreviewerFailToFetchFile",e.PreviewerUnmounted="PreviewerUnmounted",e.MipInitializationFailed="MipInitializationFailed",e.PdfLoadCanceled="PdfLoadCanceled",e.ViewContextNotInitialized="ViewContextNotInitialized",e.MipFileSizeExceeded="MipFileSizeExceeded",e.GetPdfStreamFailed="GetPdfStreamFailed",e.UploadFileDataFailed="UploadFileDataFailed"}(a||(a={})),function(e){e.PDFError="PDFError",e.PdfOpenError="PdfOpenError",e.PdfWorkerMismatchError="PdfWorkerMismatchError",e.NetworkError="NetworkError"}(i||(i={}));var o,s="MsPdfViewer",c=function(e,t,n,a){return{error:{name:e,message:t,stack:n},extraData:{location:s,code:a}}},d=(o=Error,(0,r.XJ)(function e(t,n){var a=o.call(this,n)||this;return a.toCaughtError=function(){return c(a.name,a.message,a.stack)},Object.setPrototypeOf(a,e.prototype),a.name=t,a},o),function(e){function t(n,a,r){void 0===r&&(r=!1);var o=e.call(this,a)||this;return o.toString=function(){return"[".concat(o.name,"] code: ").concat(o.code,", message: ").concat(o.message,", stack: ").concat(o.stack)},o.toCaughtError=function(){return c(o.name,o.message,o.stack,o.code)},Object.setPrototypeOf(o,t.prototype),o.name=i.PDFError,o.code=n,o.isExpected=r,o}return(0,r.XJ)(t,e),t.prototype.toQosError=function(){return{isExpected:this.isExpected,code:this.code||this.name,error:{name:this.name,message:this.message,stack:this.stack},extraData:{location:s}}},t}(Error)),l=function(e){function t(n,a,o,c,d,l){var u=e.call(this,"".concat(n||a,".").concat(o||"GetFile"),c,l)||this;return u.toQosError=function(){return(0,r.W_)((0,r.W_)({},e.prototype.toQosError.call(u)),{extraData:{location:s,status:u.status,responseHeaders:u.responseHeaders}})},Object.setPrototypeOf(u,t.prototype),u.name=i.NetworkError,u.status=n,u.statusText=a,u.where=o,u.responseHeaders=d,u}return(0,r.XJ)(t,e),t}(d),u=(function(e){(0,r.XJ)(function t(n){var r=e.call(this,a.InvalidPDF,n,!0)||this;return Object.setPrototypeOf(r,t.prototype),r.name=i.PdfOpenError,r},e)}(d),function(e){function t(n){var r=e.call(this,a.PDFWorkerMismatch,n,!1)||this;return Object.setPrototypeOf(r,t.prototype),r.name=i.PdfWorkerMismatchError,r}return(0,r.XJ)(t,e),t}(d))}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>c});var a,i,r=n(127),o=n("odsp.util_118");!function(e){e.updateOneUpStatus="updateOneUpStatus"}(a||(a={})),function(e){e.oneUpItemCacheUpdate="oneUpItemCacheUpdate",e.initialStoreDataWhenSubscribing="initialStoreDataWhenSubscribing"}(i||(i={}));var s=function(){function e(){this._eventMC=new r.a}return e.prototype.subscribe=function(e,t,n){var a=this._eventMC.subscribe(e,t),r=this.getOneUpProperties();return t(new CustomEvent("updateOneUpStatus",{detail:{publisher:i.initialStoreDataWhenSubscribing,update:r}})),a},e.prototype.update=function(e,t){this._focusItem=e.focusItem||this._focusItem,this._focusItemSet=e.focusItemSet||this._focusItemSet,this._parentItem=e.parentItem||this._parentItem,this._currentIndex=void 0!==e.currentIndex?e.currentIndex:this._currentIndex,this._focusItemKey=e.focusItemKey||this._focusItemKey,this._childItemKeys=e.childItemKeys||this._childItemKeys,this._currentItemSetKey=e.currentItemSetKey||this._currentItemSetKey,this._list=e.list||this._list,this._pageContexts=e.pageContexts||this._pageContexts,this._parentStoreKey=e.parentStoreKey||this._parentStoreKey;var n={publisher:t,update:e};this._eventMC.publish(a.updateOneUpStatus,n)},e.prototype.getOneUpProperties=function(){return this._focusItem?{focusItem:this._focusItem,focusItemSet:this._focusItemSet,parentItem:this._parentItem,currentIndex:this._currentIndex,focusItemKey:this._focusItemKey,childItemKeys:this._childItemKeys,currentItemSetKey:this._currentItemSetKey,list:this._list,pageContexts:this._pageContexts,parentStoreKey:this._parentStoreKey}:void 0},e.prototype.clean=function(){this._focusItem=void 0,this._focusItemSet=void 0,this._parentItem=void 0,this._currentIndex=void 0,this._focusItemKey=void 0,this._childItemKeys=void 0,this._currentItemSetKey=void 0,this._list=void 0,this._pageContexts=void 0,this._parentStoreKey=void 0},Object.defineProperty(e.prototype,"focusItem",{get:function(){return this._focusItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusItemSet",{get:function(){return this._focusItemSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentItem",{get:function(){return this._parentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this._currentIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusItemKey",{get:function(){return this._focusItemKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childItemKeys",{get:function(){return this._childItemKeys},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentItemSetKey",{get:function(){return this._currentItemSetKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this._list},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageContexts",{get:function(){return this._pageContexts},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentStoreKey",{get:function(){return this._parentStoreKey},enumerable:!1,configurable:!0}),e}(),c=new o.hK({name:"OneUpStore",factory:{dependencies:{},create:function(){return{instance:new s}}}})}
,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l});var a=n("tslib_826"),i=n(60),r=n(308),o=function(){function e(e,t,n){var a=new r.d(e);t(a),this._id=a.payload.id,this._name=e.name,this._active=!0,this._logQosEnd=n}return e.prototype.stop=function(e){this._active&&this._logEnd(i.b.Succeed,e||{})},e.prototype.fail=function(e){this._active&&this._logEnd(i.b.Fail,(0,a.W_)({isExpected:!1},e))},e.prototype._logEnd=function(e,t){var n=new r.c(this._id,this._name,e,t);this._logQosEnd(n),this._active=!1},e}(),s="PDF:Telemetry",c=function(){function e(){}return e.prototype.logQosStart=function(e){var t=e.payload;console.log("[".concat(s,"] [").concat(e.type,"]: ").concat(t.id," | ").concat(t.name,": ").concat(t.status,", ").concat(t.startTime))},e.prototype.logQosEnd=function(e){var t=e.payload,n="[".concat(s,"] [").concat(e.type,"]: ").concat(t.id," | ").concat(t.name,": ").concat(t.status,", ").concat(t.endTime,", ");switch(t.status){case i.b.Succeed:var a=t;n+="extraData: ".concat(JSON.stringify(a.extraData));break;case i.b.Fail:var r=t;n+="isExpected: ".concat(r.isExpected,", code: ").concat(r.code," error: ").concat(JSON.stringify(r.error),", extraData: ").concat(JSON.stringify(r.extraData))}console.log(n)},e.prototype.logEngagement=function(e){this._log(e)},e.prototype.logError=function(e){this._log(e)},e.prototype._log=function(e){console.log("[".concat(s,"] [").concat(e.type,"]: ").concat(JSON.stringify(e.payload)))},e}(),d=function(){function e(){}return e.initialize=function(t){e._handler=t},e.createScenario=function(t){var n=e._handler,a=n.logQosStart,i=n.logQosEnd;return new o(t,a,i)},e.logEngagement=function(t){var n=new r.b(t);e._handler.logEngagement(n)},e.logError=function(t){var n=new r.a(t);e._handler.logError(n)},e._handler=new c,e}(),l=d.initialize}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a,i,r=n("tslib_826");!function(e){e.MSPDF_LOG_VERBOSE="VERBOSE",e.MSPDF_LOG_INFO="INFO",e.MSPDF_LOG_WARNING="WARNING",e.MSPDF_LOG_ERROR="ERROR"}(a||(a={})),function(e){e.GREEN="green",e.CYAN="cyan"}(i||(i={}));var o=function(){function e(){}return e._format=function(e,t,n){return"[".concat("MSPDFKit-Web","] ").concat(e," | ").concat(t,": ").concat(n)},e._tint=function(e,t){return["%c".concat(e),"color:".concat(t)]},e.prototype.verbose=function(t,n){console.log(e._format(a.MSPDF_LOG_VERBOSE,t,n))},e.prototype.info=function(t,n){console.info.apply(console,(0,r.AE)([],(0,r.MS)(e._tint(e._format(a.MSPDF_LOG_INFO,t,n),i.GREEN)),!1))},e.prototype.warn=function(t,n){console.warn(e._format(a.MSPDF_LOG_WARNING,t,n))},e.prototype.error=function(t,n){console.error(e._format(a.MSPDF_LOG_ERROR,t,n.toString()))},e.prototype.time=function(e){console.time(e)},e.prototype.timeEnd=function(e){console.timeEnd(e)},e}(),s=function(){function e(){}return Object.defineProperty(e,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!1,configurable:!0}),e.initialize=function(t){e._logHandler=t},e.verbose=function(t,n){e.enabled&&e._logHandler.verbose(t,n)},e.info=function(t,n){e.enabled&&e._logHandler.info(t,n)},e.warn=function(t,n){e.enabled&&e._logHandler.warn(t,n)},e.error=function(t,n){e.enabled&&e._logHandler.error(t,n)},e.time=function(t){e.enabled&&e._logHandler.time&&e._logHandler.time(t)},e.timeEnd=function(t){e.enabled&&e._logHandler.timeEnd&&e._logHandler.timeEnd(t)},e._enabled=!1,e._logHandler=new o,e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});var a=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},e.prototype.midPointTo=function(t){return new e((this.x+t.x)/2,(this.y+t.y)/2)},e.prototype.symmetricMap=function(){return new e(-this.x,-this.y)},e.prototype.plus=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.prototype.round=function(){return Math.round(this.x),Math.round(this.y),this},e}(),i=function(){function e(e,t,n,i){this.origin=new a(e,t),this.size={width:n,height:i}}return e.create=function(t){return new e(t.origin.x,t.origin.y,t.size.width,t.size.height)},e.prototype.scale=function(e){return this.origin.scale(e),this.width*=e,this.height*=e,this},e.prototype.intersect=function(t){if(t){var n=Math.max(this.x,t.x),a=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return n<a&&i<r?new e(n,i,a-n,r-i):void 0}},e.prototype.area=function(){return this.width*this.height},e.prototype.ceil=function(){var e=this.right,t=this.bottom;return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.ceil(e)-this.x,this.height=Math.ceil(t)-this.y,this},e.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},e.prototype.toString=function(){return"(".concat(this.x,", ").concat(this.y,"), ").concat(this.width," * ").concat(this.height)},Object.defineProperty(e.prototype,"x",{get:function(){return this.origin.x},set:function(e){this.origin.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.origin.y},set:function(e){this.origin.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.size.width},set:function(e){this.size.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.size.height},set:function(e){this.size.height=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),e}()}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_118"),i=new a.hK({name:"platformDetection",factory:new a.wo(a.QC)})}
,(e,t,n)=>{"use strict";var a,i,r,o,s,c,d,l;n.d(t,{a:()=>d,b:()=>r,c:()=>c,d:()=>o,e:()=>a,f:()=>s,g:()=>i}),function(e){e.HighlightLink="HighlightLink",e.ClearHighlightLink="ClearHighlightLink",e.InkStrokesAdded="InkStrokesAdded",e.InkAdded="InkAdded",e.InkUpdated="InkUpdated",e.DocumentDirty="DocumentDirty",e.DocumentSaved="DocumentSaved",e.InvalidateRect="InvalidateRect",e.InvalidateRectForAnnot="InvalidateRectForAnnot",e.ShowFreeText="ShowFreeText",e.ScaleChanged="ScaleChanged",e.ResponsiveResize="ResponsiveResize",e.RotationChanged="RotationChanged",e.AnnotationChanged="AnnotationChanged",e.Scrolling="Scrolling",e.ZoomStart="ZoomStart",e.ZoomEnd="ZoomEnd",e.InitialDisplayInfoApplied="InitialDisplayInfoApplied",e.VisiblePagesLoaded="VisiblePagesLoaded",e.ShowEditableInk="ShowEditableInk",e.ShowErasableInk="ShowErasableInk"}(a||(a={})),function(e){e.FitSize="FitPageWithWindowSize",e.FitWidth="FitPageWithWindowWidth"}(i||(i={})),function(e){e.Default="default",e.Text="text",e.Link="pointer"}(r||(r={})),function(e){e.Space=" ",e.Tab="Tab",e.Home="Home",e.Enter="Enter",e.End="End",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight"}(o||(o={})),function(e){e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270"}(s||(s={})),function(e){e[e.Success=0]="Success",e[e.InvalidContentType=1]="InvalidContentType",e[e.InvalidContentDisposition=2]="InvalidContentDisposition",e[e.DocumentCancelled=4]="DocumentCancelled",e[e.PdfiumUnknown=5]="PdfiumUnknown",e[e.PdfiumFile=6]="PdfiumFile",e[e.PdfiumFormat=7]="PdfiumFormat",e[e.PdfiumUnsupportedSecurity=8]="PdfiumUnsupportedSecurity",e[e.PdfiumPage=9]="PdfiumPage",e[e.PdfiumXfaLoad=10]="PdfiumXfaLoad",e[e.PdfiumXfaLayout=11]="PdfiumXfaLayout",e[e.IncorrectPassword=12]="IncorrectPassword",e[e.IncorrectResponseStatus=13]="IncorrectResponseStatus",e[e.UnexpectedError=14]="UnexpectedError",e[e.IncorrectMIPAuth=15]="IncorrectMIPAuth"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Ink=1]="Ink",e[e.Erase=2]="Erase",e[e.Highlight=3]="Highlight",e[e.FreeText=4]="FreeText",e[e.PointErase=5]="PointErase"}(d||(d={})),function(e){e.Form="Form"}(l||(l={}))}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("urlLite")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>S});var a=n("odsp.util_118"),i=n(89),r=n(223),o=n(122),s=n(6),c=n(123),d=n(35),l=n(40),u=new a.hK({name:"alwaysUseTokenFetcherForVroom",factory:new a.t_(!1)}),f=a.HW.isActivated("8FBE5803-0F7D-47D4-9BBB-2BF40847050D","09/06/2022","Always use IdentityDataSource for tokens"),p=(0,l.a)({ODB:-671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource,this._alwaysUseTokenFetcherForVroom=t.alwaysUseTokenFetcherForVroom}return e.prototype.getToken=function(e,t){var n,i,o=this._identityDataSource.getIdentity().type;if(o===r.a.aad){if(t&&(p||this._alwaysUseTokenFetcherForVroom)){var c=new d.a(t).authority;return null===(i=(n=this._identityDataSource).getSharePointToken)||void 0===i?void 0:i.call(n,c)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return s.c.resolve()})}else if(!f||o===r.a.msa)return this._identityDataSource.getSessionToken();return s.c.reject(new a.EI({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){var t,n;return null===(n=(t=this._identityDataSource).getFormDigest)||void 0===n?void 0:n.call(t,e)},e.dependencies={identityDataSource:c.a,microServiceDataSource:o.a.optional,alwaysUseTokenFetcherForVroom:u},e}(),_=(0,a.c7)("SessionManagementProvider",m),h=n(195),b=n(377),g=n(380),v="VroomDataRequestor",y=new a.hK({name:"".concat(v,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:b.a},create:function(e){return{instance:function(){return s.c.resolve(e.isOfflineStateObservable.get())}}}}}),S=(0,a.c7)(v,h.a,{sessionManagementProvider:_.optional,urlDataSource:i.a.optional,cookieOrigin:g.a,isOffline:y})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var a=n("tslib_826"),i=n("odsp.util_118"),r=n(219),o=n(40),s=function(){function e(){}return e.prototype.onChange=function(){return function(){}},Object.defineProperty(e.prototype,"offline",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),c=function(e){function t(){return e.call(this,!0)||this}return(0,a.XJ)(t,e),t}(r.a),d=new i.hK({name:"offlineDetection",factory:(0,o.a)({ODB:60362})?new i.wo(c):new i.wo(s)})}
,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.FileRequest=26]="FileRequest",e[e.CreateList=27]="CreateList",e[e.ManageVault=28]="ManageVault",e[e.RequestAccess=29]="RequestAccess",e[e.TraceMe=30]="TraceMe",e[e.FileBrowser=31]="FileBrowser",e[e.TagPreferences=32]="TagPreferences",e[e.PhotoStream=33]="PhotoStream",e[e.Convergence=34]="Convergence",e[e.DocumentOptions=35]="DocumentOptions",e[e.DeviceBackups=37]="DeviceBackups",e[e.Search=38]="Search",e[e.NotificationOptions=39]="NotificationOptions",e[e.ContentAssembly=40]="ContentAssembly",e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup",e[e.CloudImport=42]="CloudImport",e[e.SharingSettings=301]="SharingSettings",e[e.SyncSettings=302]="SyncSettings",e[e.StorageSettings=303]="StorageSettings",e[e.AccessPolicySettings=304]="AccessPolicySettings",e[e.ComplianceSettings=305]="ComplianceSettings",e[e.NotificationSettings=306]="NotificationSettings",e[e.GeoLocations=307]="GeoLocations"}(a||(a={}));const i=a}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("tslib_826"),i=n(82),r=function(){function e(){}return e.setAll=function(e){var t=e.workerSrc,n=e.pdfJsWorkerSrc,a=e.wasmModuleInit,i=e.fontUrls,r=e.pdfJsCMapUrl,o=e.enableLogging,s=e.disableExternalWasmCache,c=e.globalVarNameForWorkerVer;this.workerSrc=t,this.pdfJsWorkerSrc=n,this.wasmModuleInit=a,this.fontUrls=i,this.pdfJsCmapUrl=r,this.enableLogging=o,this.disableExternalWasmCache=s,this.globalVarNameForWorkerVer=c},Object.defineProperty(e,"workerSrc",{get:function(){return this.value.workerSrc},set:function(e){this.value.workerSrc=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pdfJsWorkerSrc",{get:function(){return this.value.pdfJsWorkerSrc},set:function(e){this.value.pdfJsWorkerSrc=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pdfJsCmapUrl",{get:function(){return this.value.pdfJsCMapUrl},set:function(e){this.value.pdfJsCMapUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"wasmModuleInit",{get:function(){return this.value.wasmModuleInit},set:function(e){this.value.wasmModuleInit=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"fontUrls",{get:function(){return this.value.fontUrls},set:function(e){this.value.fontUrls=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableLogging",{get:function(){return this.value.enableLogging},set:function(e){i.a.enabled=this.value.enableLogging=!!e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"disableExternalWasmCache",{get:function(){return this.value.disableExternalWasmCache},set:function(e){this.value.disableExternalWasmCache=!!e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalVarNameForWorkerVer",{get:function(){return this.value.globalVarNameForWorkerVer},set:function(e){this.value.globalVarNameForWorkerVer=e},enumerable:!1,configurable:!0}),e.setMessengerOptions=function(e){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return e?[4,n.e(25).then(n.bind(n,385))]:[2];case 1:return t.sent().setMessengerOptions(e),this.value.messengerOptions=e,[2]}})})},Object.defineProperty(e,"messengerOptions",{get:function(){return this.value.messengerOptions},enumerable:!1,configurable:!0}),e.value={workerSrc:"index.worker.js",wasmModuleInit:[]},e}()}
,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s,c:()=>o,d:()=>i,e:()=>u,f:()=>Ue,g:()=>Be,h:()=>Fe,i:()=>Re,j:()=>He,k:()=>Ne,l:()=>te});var a=n("fui.core_421");const i="data-tabster",r=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]","details > summary","audio[controls]","video[controls]"].join(", "),o={Source:0,Target:1},s={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4},c={Unlimited:0,Limited:1,LimitedTrapFocus:2};function d(e,t){var n;return null===(n=e.storageEntry(t))||void 0===n?void 0:n.tabster}function l(e,t,n){var a,r;const o=n||e._noop?void 0:t.getAttribute(i);let s,c=e.storageEntry(t);if(o){if(o===(null===(a=null==c?void 0:c.attr)||void 0===a?void 0:a.string))return;try{const e=JSON.parse(o);if("object"!=typeof e)throw new Error(`Value is not a JSON object, got '${o}'.`);s={string:o,object:e}}catch(e){}}else if(!c)return;c||(c=e.storageEntry(t,!0)),c.tabster||(c.tabster={});const d=c.tabster||{},l=(null===(r=c.attr)||void 0===r?void 0:r.object)||{},u=(null==s?void 0:s.object)||{};for(const n of Object.keys(l))if(!u[n]){if("root"===n){const t=d[n];t&&e.root.onRoot(t,!0)}switch(n){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":const a=d[n];a&&(a.dispose(),delete d[n]);break;case"observed":delete d[n],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete d[n]}}for(const n of Object.keys(u)){const a=u.sys;switch(n){case"deloser":d.deloser?d.deloser.setProps(u.deloser):e.deloser&&(d.deloser=e.deloser.createDeloser(t,u.deloser));break;case"root":d.root?d.root.setProps(u.root):d.root=e.root.createRoot(t,u.root,a),e.root.onRoot(d.root);break;case"modalizer":d.modalizer?d.modalizer.setProps(u.modalizer):e.modalizer&&(d.modalizer=e.modalizer.createModalizer(t,u.modalizer,a));break;case"restorer":d.restorer?d.restorer.setProps(u.restorer):e.restorer&&u.restorer&&(d.restorer=e.restorer.createRestorer(t,u.restorer));break;case"focusable":d.focusable=u.focusable;break;case"groupper":d.groupper?d.groupper.setProps(u.groupper):e.groupper&&(d.groupper=e.groupper.createGroupper(t,u.groupper,a));break;case"mover":d.mover?d.mover.setProps(u.mover):e.mover&&(d.mover=e.mover.createMover(t,u.mover,a));break;case"observed":e.observedElement&&(d.observed=u.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":d.uncontrolled=u.uncontrolled;break;case"outline":e.outline&&(d.outline=u.outline);break;case"sys":d.sys=u.sys;break;default:console.error(`Unknown key '${n}' in data-tabster attribute value.`)}}s?c.attr=s:(0===Object.keys(d).length&&(delete c.tabster,delete c.attr),e.storageEntry(t,!1))}const u="tabster:movefocus",f="tabster:mover:movefocus",p="tabster:mover:memorized-element",m="tabster:groupper:movefocus",_="tabster:restorer:restore-focus",h="undefined"!=typeof CustomEvent?CustomEvent:function(){};class b extends h{constructor(e,t){super(e,{bubbles:!0,cancelable:!0,composed:!0,detail:t}),this.details=t}}class g extends b{constructor(e){super("tabster:focusin",e)}}class v extends b{constructor(e){super("tabster:focusout",e)}}class y extends b{constructor(e){super(u,e)}}class S extends b{constructor(e){super("tabster:mover:state",e)}}class D extends b{constructor(e){super("tabster:modalizer:active",e)}}class I extends b{constructor(e){super("tabster:modalizer:inactive",e)}}class x extends b{constructor(){super(_)}}class C extends b{constructor(e){super("tabster:root:focus",e)}}class O extends b{constructor(e){super("tabster:root:blur",e)}}const w={createMutationObserver:e=>new MutationObserver(e),createTreeWalker:(e,t,n,a)=>e.createTreeWalker(t,n,a),getParentNode:e=>e?e.parentNode:null,getParentElement:e=>e?e.parentElement:null,nodeContains:(e,t)=>!(!t||!(null==e?void 0:e.contains(t))),getActiveElement:e=>e.activeElement,querySelector:(e,t)=>e.querySelector(t),querySelectorAll:(e,t)=>Array.prototype.slice.call(e.querySelectorAll(t),0),getElementById:(e,t)=>e.getElementById(t),getFirstChild:e=>(null==e?void 0:e.firstChild)||null,getLastChild:e=>(null==e?void 0:e.lastChild)||null,getNextSibling:e=>(null==e?void 0:e.nextSibling)||null,getPreviousSibling:e=>(null==e?void 0:e.previousSibling)||null,getFirstElementChild:e=>(null==e?void 0:e.firstElementChild)||null,getLastElementChild:e=>(null==e?void 0:e.lastElementChild)||null,getNextElementSibling:e=>(null==e?void 0:e.nextElementSibling)||null,getPreviousElementSibling:e=>(null==e?void 0:e.previousElementSibling)||null,appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,n)=>e.insertBefore(t,n),getSelection:e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.getSelection())||null},getElementsByName:(e,t)=>e.ownerDocument.getElementsByName(t)};let E;const A="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,n,a){this.left=e||0,this.top=t||0,this.right=(e||0)+(n||0),this.bottom=(t||0)+(a||0)}};let L=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),E=!1}catch(e){E=!0}function k(e){const t=e();let n=t.__tabsterInstanceContext;return n||(n={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=n),n}class M{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&z(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class P{constructor(e,t,n){const a=k(e);let i;a.WeakRef?i=new a.WeakRef(t):(i=new M(t),a.fakeWeakRefs.push(i)),this._ref=i,this._data=n}get(){const e=this._ref;let t;return e&&(t=e.deref(),t||delete this._ref),t}getData(){return this._data}}function T(e,t){const n=k(e);n.fakeWeakRefs=n.fakeWeakRefs.filter(e=>!M.cleanup(e,t))}function U(e){const t=k(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=function(e){return e.basics.WeakRef}(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout(()=>{t.fakeWeakRefsTimer=void 0,T(e),U(e)},12e4))}function F(e,t,n){if(t.nodeType!==Node.ELEMENT_NODE)return;const a=E?n:{acceptNode:n};return w.createTreeWalker(e,t,NodeFilter.SHOW_ELEMENT,a,!1)}function H(e,t){let n=t.__tabsterCacheId;const a=k(e),i=n?a.containerBoundingRectCache[n]:void 0;if(i)return i.rect;const r=t.ownerDocument&&t.ownerDocument.documentElement;if(!r)return new A;let o=0,s=0,c=r.clientWidth,d=r.clientHeight;if(t!==r){const e=t.getBoundingClientRect();o=Math.max(o,e.left),s=Math.max(s,e.top),c=Math.min(c,e.right),d=Math.min(d,e.bottom)}const l=new A(o<c?o:-1,s<d?s:-1,o<c?c-o:0,s<d?d-s:0);return n||(n="r-"+ ++a.lastContainerBoundingRectCacheId,t.__tabsterCacheId=n),a.containerBoundingRectCache[n]={rect:l,element:t},a.containerBoundingRectCacheTimer||(a.containerBoundingRectCacheTimer=window.setTimeout(()=>{a.containerBoundingRectCacheTimer=void 0;for(const e of Object.keys(a.containerBoundingRectCache))delete a.containerBoundingRectCache[e].element.__tabsterCacheId;a.containerBoundingRectCache={}},50)),l}function R(e,t,n){const a=N(t);if(!a)return!1;const i=H(e,a),r=t.getBoundingClientRect(),o=r.height*(1-n),s=Math.max(0,i.top-r.top)+Math.max(0,r.bottom-i.bottom);return 0===s||s<=o}function N(e){const t=e.ownerDocument;if(t){for(let t=w.getParentElement(e);t;t=w.getParentElement(t))if(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)return t;return t.documentElement}return null}function B(e){return!!e.__shouldIgnoreFocus}function j(e,t){const n=k(e);let a=t.__tabsterElementUID;return a||(a=t.__tabsterElementUID=function(e){const t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=4294967295*Math.random();const n=[];for(let e=0;e<t.length;e++)n.push(t[e].toString(36));return n.push("|"),n.push((++L).toString(36)),n.push("|"),n.push(Date.now().toString(36)),n.join("")}(e())),!n.elementByUId[a]&&z(t.ownerDocument,t)&&(n.elementByUId[a]=new P(e,t)),a}function V(e,t){const n=k(e);for(const e of Object.keys(n.elementByUId)){const a=n.elementByUId[e],i=a&&a.get();i&&t&&!w.nodeContains(t,i)||delete n.elementByUId[e]}}function z(e,t){return w.nodeContains(null==e?void 0:e.body,t)}function G(e,t){const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return n&&n.call(e,t)}let K=0;class W{constructor(e,t,n){const a=e.getWindow;this._tabster=e,this._element=new P(a,t),this._props={...n},this.id="i"+ ++K}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class q{constructor(e,t,n,i,r){var o;this._focusIn=e=>{if(this._fixedTarget){const e=this._fixedTarget.get();return void(e&&(0,a.V5G)(e))}const t=this.input;if(this.onFocusIn&&t){const n=e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,n),n)}},this._focusOut=e=>{if(this._fixedTarget)return;this.useDefaultAction=!1;const t=this.input;if(this.onFocusOut&&t){const n=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,n),n)}};const s=e(),c=s.document.createElement("i");c.tabIndex=0,c.setAttribute("role","none"),c.setAttribute("data-tabster-dummy",""),c.setAttribute("aria-hidden","true");const d=c.style;d.position="fixed",d.width=d.height="1px",d.opacity="0.001",d.zIndex="-1",d.setProperty("content-visibility","hidden"),function(e){e.__shouldIgnoreFocus=!0}(c),this.input=c,this.isFirst=n.isFirst,this.isOutside=t,this._isPhantom=null!==(o=n.isPhantom)&&void 0!==o&&o,this._fixedTarget=r,c.addEventListener("focusin",this._focusIn),c.addEventListener("focusout",this._focusOut),c.__tabsterDummyContainer=i,this._isPhantom&&(this._disposeTimer=s.setTimeout(()=>{delete this._disposeTimer,this.dispose()},0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(s.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();const t=this.input;t&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null===(e=w.getParentNode(t))||void 0===e||e.removeChild(t))}setTopLeft(e,t){var n;const a=null===(n=this.input)||void 0===n?void 0:n.style;a&&(a.top=`${e}px`,a.left=`${t}px`)}_isBackward(e,t,n){return e&&!n?!this.isFirst:!!(n&&t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING)}}class Q{constructor(e,t,n,a,i,r){this._element=t,this._instance=new J(e,t,this,n,a,i,r)}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}moveOut(e){var t;null===(t=this._instance)||void 0===t||t.moveOut(e)}moveOutWithDefaultAction(e,t){var n;null===(n=this._instance)||void 0===n||n.moveOutWithDefaultAction(e,t)}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null===(t=this._instance)||void 0===t||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(e,t,n,i,r){const o=new q(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(o){let s,c;if("BODY"===t.tagName)s=t,c=n&&i||!n&&!i?w.getFirstElementChild(t):null;else{let a,r;n&&(!i||i&&!e.focusable.isFocusable(t,!1,!0,!0))?(s=t,c=i?t.firstElementChild:null):(s=w.getParentElement(t),c=n&&i||!n&&!i?t:w.getNextElementSibling(t));do{a=n&&i||!n&&!i?w.getPreviousElementSibling(c):c,r=ee(a),r===t?c=n&&i||!n&&!i?a:w.getNextElementSibling(a):r=null}while(r)}(null==s?void 0:s.dispatchEvent(new y({by:"root",owner:s,next:null,relatedEvent:r})))&&(w.insertBefore(s,o,c),(0,a.V5G)(o))}}static addPhantomDummyWithTarget(e,t,n,a){const i=new q(e.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new P(e.getWindow,a)).input;if(i){let e,a;t.querySelector(r)&&!n?(e=t,a=w.getFirstElementChild(t)):(e=w.getParentElement(t),a=n?t:w.getNextElementSibling(t)),e&&w.insertBefore(e,i,a)}}}class Y{constructor(e){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=e=>{var t;this._changedParents.has(e)||(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout(()=>{delete this._updateDummyInputsTimer;for(const e of this._dummyElements){const t=e.get();if(t){const e=this._dummyCallbacks.get(t);if(e){const n=w.getParentNode(t);n&&!this._changedParents.has(n)||e()}}}this._changedParents=new WeakSet},100)))},this._win=e}add(e,t){!this._dummyCallbacks.has(e)&&this._win&&(this._dummyElements.push(new P(this._win,e)),this._dummyCallbacks.set(e,t),this.domChanged=this._domChanged)}remove(e){this._dummyElements=this._dummyElements.filter(t=>{const n=t.get();return n&&n!==e}),this._dummyCallbacks.delete(e),0===this._dummyElements.length&&delete this.domChanged}dispose(){var e;const t=null===(e=this._win)||void 0===e?void 0:e.call(this);this._updateTimer&&(null==t||t.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(e){this._win&&(this._updateQueue.add(e),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var e;this._updateTimer||(this._updateTimer=null===(e=this._win)||void 0===e?void 0:e.call(this).setTimeout(()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){const e=new Map,t=[];for(const n of this._updateQueue)t.push(n(e));this._updateQueue.clear();for(const e of t)e();e.clear()}else this._scheduledUpdatePositions()},100))}}class J{constructor(e,t,n,i,r,o,s){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(e,t,n)=>{this._onFocus(!0,e,t,n)},this._onFocusOut=(e,t,n)=>{this._onFocus(!1,e,t,n)},this.moveOut=e=>{var t;const n=this._firstDummy,i=this._lastDummy;if(n&&i){this._ensurePosition();const r=n.input,o=i.input,s=null===(t=this._element)||void 0===t?void 0:t.get();if(r&&o&&s){let t;e?(r.tabIndex=0,t=r):(o.tabIndex=0,t=o),t&&(0,a.V5G)(t)}}},this.moveOutWithDefaultAction=(e,t)=>{var n;const i=this._firstDummy,r=this._lastDummy;if(i&&r){this._ensurePosition();const o=i.input,s=r.input,c=null===(n=this._element)||void 0===n?void 0:n.get();if(o&&s&&c){let n;e?!i.isOutside&&this._tabster.focusable.isFocusable(c,!0,!0,!0)?n=c:(i.useDefaultAction=!0,o.tabIndex=0,n=o):(r.useDefaultAction=!0,s.tabIndex=0,n=s),n&&c.dispatchEvent(new y({by:"root",owner:c,next:null,relatedEvent:t}))&&(0,a.V5G)(n)}}},this.setTabbable=(e,t)=>{var n,a;for(const n of this._wrappers)if(n.manager===e){n.tabbable=t;break}const i=this._getCurrent();if(i){const e=i.tabbable?0:-1;let t=null===(n=this._firstDummy)||void 0===n?void 0:n.input;t&&(t.tabIndex=e),t=null===(a=this._lastDummy)||void 0===a?void 0:a.input,t&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout(()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()},0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=e=>{var t,n;const a=(null===(t=this._firstDummy)||void 0===t?void 0:t.input)||(null===(n=this._lastDummy)||void 0===n?void 0:n.input),i=this._transformElements,r=new Set;let o=0,s=0;const c=this._getWindow();for(let t=a;t&&t.nodeType===Node.ELEMENT_NODE;t=w.getParentElement(t)){let n=e.get(t);if(void 0===n){const a=c.getComputedStyle(t).transform;a&&"none"!==a&&(n={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),e.set(t,n||null)}n&&(r.add(t),i.has(t)||t.addEventListener("scroll",this._addTransformOffsets),o+=n.scrollTop,s+=n.scrollLeft)}for(const e of i)r.has(e)||e.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=r,()=>{var e,t;null===(e=this._firstDummy)||void 0===e||e.setTopLeft(o,s),null===(t=this._lastDummy)||void 0===t||t.setTopLeft(o,s)}};const c=t.get();if(!c)throw new Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=s;const d=c.__tabsterDummy;if((d||this)._wrappers.push({manager:n,priority:i,tabbable:!0}),d)return d;c.__tabsterDummy=this;const l=null==r?void 0:r.dummyInputsPosition,u=c.tagName;this._isOutside=l?2===l:(o||"UL"===u||"OL"===u||"TABLE"===u)&&!("LI"===u||"TD"===u||"TH"===u),this._firstDummy=new q(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new q(this._getWindow,this._isOutside,{isFirst:!1},t);const f=this._firstDummy.input;f&&e._dummyObserver.add(f,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var n,a,i,r;if(0===(this._wrappers=this._wrappers.filter(n=>n.manager!==e&&!t)).length){delete(null===(n=this._element)||void 0===n?void 0:n.get()).__tabsterDummy;for(const e of this._transformElements)e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();const e=this._getWindow();this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);const t=null===(a=this._firstDummy)||void 0===a?void 0:a.input;t&&this._tabster._dummyObserver.remove(t),null===(i=this._firstDummy)||void 0===i||i.dispose(),null===(r=this._lastDummy)||void 0===r||r.dispose()}}_onFocus(e,t,n,a){var i;const r=this._getCurrent();!r||t.useDefaultAction&&!this._callForDefaultAction||null===(i=r.manager.getHandler(e))||void 0===i||i(t,n,a)}_getCurrent(){return this._wrappers.sort((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority),this._wrappers[0]}_ensurePosition(){var e,t,n;const a=null===(e=this._element)||void 0===e?void 0:e.get(),i=null===(t=this._firstDummy)||void 0===t?void 0:t.input,r=null===(n=this._lastDummy)||void 0===n?void 0:n.input;if(a&&i&&r)if(this._isOutside){const e=w.getParentNode(a);if(e){const t=w.getNextSibling(a);t!==r&&w.insertBefore(e,r,t),w.getPreviousElementSibling(a)!==i&&w.insertBefore(e,i,a)}}else{w.getLastElementChild(a)!==r&&w.appendChild(a,r);const e=w.getFirstElementChild(a);e&&e!==i&&e.parentNode&&w.insertBefore(e.parentNode,i,e)}}}function X(e){let t=null;for(let n=w.getLastElementChild(e);n;n=w.getLastElementChild(n))t=n;return t||void 0}function Z(e,t,n,a){const i=e.storageEntry(t,!0);let r=!1;if(!i.aug){if(void 0===a)return r;i.aug={}}if(void 0===a){if(n in i.aug){const e=i.aug[n];delete i.aug[n],null===e?t.removeAttribute(n):t.setAttribute(n,e),r=!0}}else{let e;n in i.aug||(e=t.getAttribute(n)),void 0!==e&&e!==a&&(i.aug[n]=e,null===a?t.removeAttribute(n):t.setAttribute(n,a),r=!0)}return void 0===a&&0===Object.keys(i.aug).length&&(delete i.aug,e.storageEntry(t,!1)),r}function $(e){return"INPUT"===e.tagName&&!!e.name&&"radio"===e.type}function ee(e){var t;return(null===(t=null==e?void 0:e.__tabsterDummyContainer)||void 0===t?void 0:t.get())||null}function te(e,t){const n=JSON.stringify(e);return!0===t?n:{[i]:n}}class ne extends Q{constructor(e,t,n,i){super(e,t,1,i,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);const n=this._element.get();if(n){this._setFocused(!0);const t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:n,ignoreAccessibility:!0});if(t)return void(0,a.V5G)(t)}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=n}}class ae extends W{constructor(e,t,n,i,r){super(e,t,i),this._isFocused=!1,this._setFocused=e=>{var t;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;const n=this._element.get();n&&(e?(this._isFocused=!0,null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1),n.dispatchEvent(new C({element:n}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout(()=>{var e;delete this._setFocusedTimer,this._isFocused=!1,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0),n.dispatchEvent(new O({element:n}))},0))},this._onFocusIn=e=>{const t=this._tabster.getParent,n=this._element.get();let a=e.composedPath()[0];do{if(a===n)return void this._setFocused(!0);a=a&&t(a)}while(a)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=n;const o=e.getWindow;this.uid=j(o,t),this._sys=r,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs();const s=o().document;s.addEventListener(a.ttl,this._onFocusIn),s.addEventListener(a.CaY,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new ne(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);const t=this._tabster.getWindow(),n=t.document;n.removeEventListener(a.ttl,this._onFocusIn),n.removeEventListener(a.CaY,this._onFocusOut),this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null===(e=this._dummyManager)||void 0===e||e.dispose(),this._remove()}moveOutWithDefaultAction(e,t){const n=this._dummyManager;if(n)n.moveOutWithDefaultAction(e,t);else{const n=this.getElement();n&&ne.moveWithPhantomDummy(this._tabster,n,!0,e,t)}}_add(){}_remove(){}}class ie{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var e;const t=this._win().document,n=t.body;if(n){this._autoRootUnwait(t);const a=this._autoRoot;if(a)return function(e,t,n){let a;{const t=e.getAttribute(i);if(t)try{a=JSON.parse(t)}catch(e){}}a||(a={}),function(e,t){for(const n of Object.keys(t)){const a=t[n];a?e[n]=a:delete e[n]}}(a,t),Object.keys(a).length>0?e.setAttribute(i,te(a,!0)):e.removeAttribute(i)}(n,{root:a}),l(this._tabster,n),null===(e=d(this._tabster,n))||void 0===e?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._autoRoot=t,e.queueInit(()=>{this._autoRoot&&this._autoRootCreate()})}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){const e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,Object.keys(this._roots).forEach(e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])}),this.rootById={}}createRoot(e,t,n){const a=new ae(this._tabster,e,this._onRootDispose,t,n);return this._roots[a.id]=a,this._forceDummy&&a.addDummyInputs(),a}addDummyInputs(){this._forceDummy=!0;const e=this._roots;for(const t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){const n=e().__tabsterInstance;return n&&n.root.rootById[t]}static getTabsterContext(e,t,n){var a,i,r,o;if(void 0===n&&(n={}),!t.ownerDocument)return;const{checkRtl:s,referenceElement:c}=n,l=e.getParent;let u,f,p,m;e.drainInitQueue();let _,h,b,g,v=!1,y=c||t;const S={};for(;y&&(!u||s);){const n=d(e,y);if(s&&void 0===b){const e=y.dir;e&&(b="rtl"===e.toLowerCase())}if(!n){y=l(y);continue}const o=y.tagName;(n.uncontrolled||"IFRAME"===o||"WEBVIEW"===o)&&(g=y),m||!(null===(a=n.focusable)||void 0===a?void 0:a.excludeFromMover)||p||(v=!0);const c=n.modalizer,D=n.groupper,I=n.mover;!f&&c&&(f=c),p||!D||f&&!c||(f?(!D.isActive()&&D.getProps().tabbability&&f.userId!==(null===(i=e.modalizer)||void 0===i?void 0:i.activeId)&&(f=void 0,p=D),h=D):p=D),m||!I||f&&!c||D&&y===t||!y.contains(t)||(m=I,_=!!p&&p!==D),n.root&&(u=n.root),(null===(r=n.focusable)||void 0===r?void 0:r.ignoreKeydown)&&Object.assign(S,n.focusable.ignoreKeydown),y=l(y)}if(!u){const n=e.root;n._autoRoot&&(null===(o=t.ownerDocument)||void 0===o?void 0:o.body)&&(u=n._autoRootCreate())}return p&&!m&&(_=!0),u?{root:u,modalizer:f,groupper:p,mover:m,groupperBeforeMover:_,modalizerInGroupper:h,rtl:s?!!b:void 0,uncontrolled:g,excludedFromMover:v,ignoreKeydown:e=>!!S[e.key]}:void 0}static getRoot(e,t){var n;const a=e.getParent;for(let i=t;i;i=a(i)){const t=null===(n=d(e,i))||void 0===n?void 0:n.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class re{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){const t=this._callbacks;t.indexOf(e)<0&&t.push(e)}subscribeFirst(e){const t=this._callbacks,n=t.indexOf(e);n>=0&&t.splice(n,1),t.unshift(e)}unsubscribe(e){const t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach(n=>n(e,t))}}class oe{constructor(e){this._tabster=e}dispose(){}getProps(e){const t=d(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,n,a){return!(!G(e,r)||!t&&-1===e.tabIndex)&&(n||this.isVisible(e))&&(a||this.isAccessible(e))}isVisible(e){if(!e.ownerDocument||e.nodeType!==Node.ELEMENT_NODE)return!1;if(function(e){var t,n;const a=e.ownerDocument,i=null===(t=a.defaultView)||void 0===t?void 0:t.getComputedStyle(e);if(null===e.offsetParent&&a.body!==e&&"fixed"!==(null==i?void 0:i.position))return!0;if("hidden"===(null==i?void 0:i.visibility))return!0;if("fixed"===(null==i?void 0:i.position)){if("none"===i.display)return!0;if(null===(null===(n=e.parentElement)||void 0===n?void 0:n.offsetParent)&&a.body!==e.parentElement)return!0}return!1}(e))return!1;const t=e.ownerDocument.body.getBoundingClientRect();return 0!==t.width||0!==t.height}isAccessible(e){var t;for(let n=e;n;n=w.getParentElement(n)){const e=d(this._tabster,n);if(this._isHidden(n))return!1;if(!(null===(t=null==e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(n))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;const n=e.getAttribute("aria-hidden");return!(!n||"true"!==n.toLowerCase()||(null===(t=this._tabster.modalizer)||void 0===t?void 0:t.isAugmented(e)))}findFirst(e,t){return this.findElement({...e},t)}findLast(e,t){return this.findElement({isBackward:!0,...e},t)}findNext(e,t){return this.findElement({...e},t)}findPrev(e,t){return this.findElement({...e,isBackward:!0},t)}findDefault(e,t){return this.findElement({...e,acceptCondition:t=>this.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault},t)||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e,t){const n=this._findElements(!1,e,t);return n?n[0]:n}_findElements(e,t,n){var a,i,r;const{container:o,currentElement:s=null,includeProgrammaticallyFocusable:c,useActiveModalizer:d,ignoreAccessibility:l,modalizerId:u,isBackward:f,onElement:p}=t;n||(n={});const m=[];let{acceptCondition:_}=t;const h=!!_;if(!o)return null;_||(_=e=>this.isFocusable(e,c,!1,l));const b={container:o,modalizerUserId:void 0===u&&d?null===(a=this._tabster.modalizer)||void 0===a?void 0:a.activeId:u||(null===(r=null===(i=ie.getTabsterContext(this._tabster,o))||void 0===i?void 0:i.modalizer)||void 0===r?void 0:r.userId),from:s||o,isBackward:f,isFindAll:e,acceptCondition:_,hasCustomCondition:h,includeProgrammaticallyFocusable:c,ignoreAccessibility:l,cachedGrouppers:{},cachedRadioGroups:{}},g=F(o.ownerDocument,o,e=>this._acceptElement(e,b));if(!g)return null;const v=t=>{var a,i;const r=null!==(a=b.foundElement)&&void 0!==a?a:b.foundBackward;return r&&m.push(r),e?!(r&&(b.found=!1,delete b.foundElement,delete b.foundBackward,delete b.fromCtx,b.from=r,p&&!p(r))||!r&&!t):(r&&n&&(n.uncontrolled=null===(i=ie.getTabsterContext(this._tabster,r))||void 0===i?void 0:i.uncontrolled),!(!t||r))};if(s||(n.outOfDOMOrder=!0),s&&w.nodeContains(o,s))g.currentNode=s;else if(f){const e=X(o);if(!e)return null;if(this._acceptElement(e,b)===NodeFilter.FILTER_ACCEPT&&!v(!0))return b.skippedFocusable&&(n.outOfDOMOrder=!0),m;g.currentNode=e}do{f?g.previousNode():g.nextNode()}while(v());return b.skippedFocusable&&(n.outOfDOMOrder=!0),m.length?m:null}_acceptElement(e,t){var n,a,i;if(t.found)return NodeFilter.FILTER_ACCEPT;const r=t.foundBackward;if(r&&(e===r||!w.nodeContains(r,e)))return t.found=!0,t.foundElement=r,NodeFilter.FILTER_ACCEPT;const o=t.container;if(e===o)return NodeFilter.FILTER_SKIP;if(!w.nodeContains(o,e))return NodeFilter.FILTER_REJECT;if(ee(e))return NodeFilter.FILTER_REJECT;if(w.nodeContains(t.rejectElementsFrom,e))return NodeFilter.FILTER_REJECT;const s=t.currentCtx=ie.getTabsterContext(this._tabster,e);if(!s)return NodeFilter.FILTER_SKIP;if(B(e))return this.isFocusable(e,void 0,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!t.hasCustomCondition&&("IFRAME"===e.tagName||"WEBVIEW"===e.tagName))return(null===(n=s.modalizer)||void 0===n?void 0:n.userId)===(null===(a=this._tabster.modalizer)||void 0===a?void 0:a.activeId)?(t.found=!0,t.rejectElementsFrom=t.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let c,d=t.fromCtx;d||(d=t.fromCtx=ie.getTabsterContext(this._tabster,t.from));const l=null==d?void 0:d.mover;let u=s.groupper,f=s.mover;if(c=null===(i=this._tabster.modalizer)||void 0===i?void 0:i.acceptElement(e,t),void 0!==c&&(t.skippedFocusable=!0),void 0===c&&(u||f||l)){const n=null==u?void 0:u.getElement(),a=null==l?void 0:l.getElement();let i=null==f?void 0:f.getElement();i&&w.nodeContains(a,i)&&w.nodeContains(o,a)&&(!n||!f||w.nodeContains(a,n))&&(f=l,i=a),!n||n!==o&&w.nodeContains(o,n)||(u=void 0),i&&!w.nodeContains(o,i)&&(f=void 0),u&&f&&(i&&n&&!w.nodeContains(n,i)?f=void 0:u=void 0),u&&(c=u.acceptElement(e,t)),f&&(c=f.acceptElement(e,t))}if(void 0===c&&(c=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,c===NodeFilter.FILTER_SKIP&&this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0)),c===NodeFilter.FILTER_ACCEPT&&!t.found){if(!t.isFindAll&&$(e)&&!e.checked){const n=e.name;let a=t.cachedRadioGroups[n];if(a||(a=function(e){if(!$(e))return;const t=e.name;let n,a=Array.from(w.getElementsByName(e,t));return a=a.filter(e=>!!$(e)&&(e.checked&&(n=e),!0)),{name:t,buttons:new Set(a),checked:n}}(e),a&&(t.cachedRadioGroups[n]=a)),(null==a?void 0:a.checked)&&a.checked!==e)return NodeFilter.FILTER_SKIP}t.isBackward?(t.foundBackward=e,c=NodeFilter.FILTER_SKIP):(t.found=!0,t.foundElement=e)}return c}}const se="Enter",ce="Escape",de="Home",le="ArrowLeft",ue="ArrowUp",fe="ArrowRight",pe="ArrowDown",me={2:0,3:1,1:2};class _e extends re{constructor(e,t){super(),this._init=()=>{const e=this._win(),t=e.document;t.addEventListener(a.ttl,this._onFocusIn,!0),t.addEventListener(a.CaY,this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);const n=w.getActiveElement(t);n&&n!==t.body&&this._setFocusedElement(n),this.subscribe(this._onChanged)},this._onFocusIn=e=>{const t=e.composedPath()[0];t&&this._setFocusedElement(t,e.detail.relatedTarget,e.detail.isFocusedProgrammatically)},this._onFocusOut=e=>{var t;this._setFocusedElement(void 0,null===(t=e.detail)||void 0===t?void 0:t.originalEvent.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{if("Tab"!==e.key||e.ctrlKey)return;const t=this.getVal();if(!t||!t.ownerDocument||"true"===t.contentEditable)return;const n=this._tabster,i=n.controlTab,r=ie.getTabsterContext(n,t);if(!r||r.ignoreKeydown(e))return;const o=e.shiftKey,s=_e.findNextTabbable(n,r,void 0,t,void 0,o,!0),c=r.root.getElement();if(!c)return;const l=null==s?void 0:s.element,u=function(e,t){var n;const a=e.getParent;let i=t;do{const t=null===(n=d(e,i))||void 0===n?void 0:n.uncontrolled;if(t&&e.uncontrolled.isUncontrolledCompletely(i,!!t.completely))return i;i=a(i)}while(i)}(n,t);if(l){const d=s.uncontrolled;if(r.uncontrolled||w.nodeContains(d,t)){if(!s.outOfDOMOrder&&d===r.uncontrolled||u&&!w.nodeContains(u,l))return;return void Q.addPhantomDummyWithTarget(n,t,o,l)}if(d||"IFRAME"===l.tagName)return void(c.dispatchEvent(new y({by:"root",owner:c,next:l,relatedEvent:e}))&&Q.moveWithPhantomDummy(this._tabster,null!=d?d:l,!1,o,e));(i||(null==s?void 0:s.outOfDOMOrder))&&c.dispatchEvent(new y({by:"root",owner:c,next:l,relatedEvent:e}))&&(e.preventDefault(),e.stopImmediatePropagation(),(0,a.V5G)(l))}else!u&&c.dispatchEvent(new y({by:"root",owner:c,next:null,relatedEvent:e}))&&r.root.moveOutWithDefaultAction(o,e)},this._onChanged=(e,t)=>{var n,a;if(e)e.dispatchEvent(new g(t));else{const e=null===(n=this._lastVal)||void 0===n?void 0:n.get();if(e){const n={...t},i=ie.getTabsterContext(this._tabster,e),r=null===(a=null==i?void 0:i.modalizer)||void 0===a?void 0:a.userId;r&&(n.modalizerId=r),e.dispatchEvent(new v(n))}}},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){super.dispose();const e=this._win(),t=e.document;t.removeEventListener(a.ttl,this._onFocusIn,!0),t.removeEventListener(a.CaY,this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);const n=this._asyncFocus;n&&(e.clearTimeout(n.timeout),delete this._asyncFocus),delete _e._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var n,a;let i=_e._lastResetElement,r=i&&i.get();r&&w.nodeContains(t,r)&&delete _e._lastResetElement,r=null===(a=null===(n=e._nextVal)||void 0===n?void 0:n.element)||void 0===a?void 0:a.get(),r&&w.nodeContains(t,r)&&delete e._nextVal,i=e._lastVal,r=i&&i.get(),r&&w.nodeContains(t,r)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!z(t.ownerDocument,t))&&(this._lastVal=t=void 0),t}focus(e,t,n){return!!this._tabster.focusable.isFocusable(e,t,!1,n)&&(e.focus(),!0)}focusDefault(e){const t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){var n;const{container:a,ignoreAccessibility:i}=t;let r;if(a){const t=ie.getTabsterContext(this._tabster,a);t&&(r=null===(n=_e.findNextTabbable(this._tabster,t,a,void 0,void 0,!e,i))||void 0===n?void 0:n.element)}return r&&!w.nodeContains(a,r)&&(r=void 0),r||void 0}_focusFirstOrLast(e,t){const n=this.getFirstOrLastTabbable(e,t);return!!n&&(this.focus(n,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{const t=e.getAttribute("tabindex"),n=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),_e._lastResetElement=new P(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",n)}return!0}requestAsyncFocus(e,t,n){const a=this._tabster.getWindow(),i=this._asyncFocus;if(i){if(me[e]>me[i.source])return;a.clearTimeout(i.timeout)}this._asyncFocus={source:e,callback:t,timeout:a.setTimeout(()=>{this._asyncFocus=void 0,t()},n)}}cancelAsyncFocus(e){const t=this._asyncFocus;(null==t?void 0:t.source)===e&&(this._tabster.getWindow().clearTimeout(t.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(e,t,n){null===n?e.removeAttribute(t):e.setAttribute(t,n)}_setFocusedElement(e,t,n){var a,i;if(this._tabster._noop)return;const r={relatedTarget:t};if(e){const t=null===(a=_e._lastResetElement)||void 0===a?void 0:a.get();if(_e._lastResetElement=void 0,t===e||B(e))return;r.isFocusedProgrammatically=n;const o=ie.getTabsterContext(this._tabster,e),s=null===(i=null==o?void 0:o.modalizer)||void 0===i?void 0:i.userId;s&&(r.modalizerId=s)}const o=this._nextVal={element:e?new P(this._win,e):void 0,detail:r};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===o&&this.setVal(e,r),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new P(this._win,e))}static findNextTabbable(e,t,n,a,i,r,o){const s=n||t.root.getElement();if(!s)return null;let c=null;const d=_e._isTabbingTimer,l=e.getWindow();d&&l.clearTimeout(d),_e.isTabbing=!0,_e._isTabbingTimer=l.setTimeout(()=>{delete _e._isTabbingTimer,_e.isTabbing=!1},0);const u=t.modalizer,f=t.groupper,p=t.mover,m=t=>{if(c=t.findNextTabbable(a,i,r,o),a&&!(null==c?void 0:c.element)){const i=t!==u&&w.getParentElement(t.getElement());if(i){const s=ie.getTabsterContext(e,a,{referenceElement:i});if(s){const a=t.getElement(),d=r?a:a&&X(a)||a;d&&(c=_e.findNextTabbable(e,s,n,d,i,r,o),c&&(c.outOfDOMOrder=!0))}}}};if(f&&p)m(t.groupperBeforeMover?f:p);else if(f)m(f);else if(p)m(p);else if(u)m(u);else{const t={container:s,currentElement:a,referenceElement:i,ignoreAccessibility:o,useActiveModalizer:!0},n={},d=e.focusable[r?"findPrev":"findNext"](t,n);c={element:d,outOfDOMOrder:n.outOfDOMOrder,uncontrolled:n.uncontrolled}}return c}}_e.isTabbing=!1;class he extends Q{constructor(e,t,n,i){super(n,e,4,i,!0),this._setHandlers((i,r,o)=>{var s,c;const d=e.get(),l=i.input;if(d&&l){const e=ie.getTabsterContext(n,l);if(e){let u;u=null===(s=t.findNextTabbable(o||void 0,void 0,r,!0))||void 0===s?void 0:s.element,u||(u=null===(c=_e.findNextTabbable(n,e,void 0,i.isOutside?l:function(e,t){let n=e,a=null;for(;n&&!a;)a=t?w.getPreviousElementSibling(n):w.getNextElementSibling(n),n=w.getParentElement(n);return a||void 0}(d,!r),void 0,r,!0))||void 0===c?void 0:c.element),u&&(0,a.V5G)(u)}}})}}class be extends W{constructor(e,t,n,a,i){super(e,t,a),this._shouldTabInside=!1,this.makeTabbable(!1),this._onDispose=n,e.controlTab||(this.dummyManager=new he(this._element,this,e,i))}dispose(){var e;this._onDispose(this),this._element.get(),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,delete this._first}findNextTabbable(e,t,n,a){const i=this.getElement();if(!i)return null;const r=ee(e)===i;if(!this._shouldTabInside&&e&&w.nodeContains(i,e)&&!r)return{element:void 0,outOfDOMOrder:!0};const o=this.getFirst(!0);if(!e||!w.nodeContains(i,e)||r)return{element:o,outOfDOMOrder:!0};const s=this._tabster;let d,l=null,u=!1;if(this._shouldTabInside&&o){const r={container:i,currentElement:e,referenceElement:t,ignoreAccessibility:a,useActiveModalizer:!0},o={};l=s.focusable[n?"findPrev":"findNext"](r,o),u=!!o.outOfDOMOrder,l||this._props.tabbability!==c.LimitedTrapFocus||(l=s.focusable[n?"findLast":"findFirst"]({container:i,ignoreAccessibility:a,useActiveModalizer:!0},o),u=!0),d=o.uncontrolled}return{element:l,uncontrolled:d,outOfDOMOrder:u}}makeTabbable(e){this._shouldTabInside=e||!this._props.tabbability}isActive(e){var t;const n=this.getElement()||null;let a=!0;for(let e=w.getParentElement(n);e;e=w.getParentElement(e)){const n=null===(t=d(this._tabster,e))||void 0===t?void 0:t.groupper;n&&(n._shouldTabInside||(a=!1))}let i=a?!!this._props.tabbability&&this._shouldTabInside:void 0;if(i&&e){const e=this._tabster.focusedElement.getFocusedElement();e&&(i=e!==this.getFirst(!0))}return i}getFirst(e){var t;const n=this.getElement();let a;if(n){if(e&&this._tabster.focusable.isFocusable(n))return n;a=null===(t=this._first)||void 0===t?void 0:t.get(),a||(a=this._tabster.focusable.findFirst({container:n,useActiveModalizer:!0})||void 0,a&&this.setFirst(a))}return a}setFirst(e){e?this._first=new P(this._tabster.getWindow,e):delete this._first}acceptElement(e,t){const n=t.cachedGrouppers,a=w.getParentElement(this.getElement()),i=a&&ie.getTabsterContext(this._tabster,a),r=null==i?void 0:i.groupper,o=(null==i?void 0:i.groupperBeforeMover)?r:void 0;let s;const c=e=>{let t,a=n[e.id];return a?t=a.isActive:(t=this.isActive(!0),a=n[e.id]={isActive:t}),t};if(o&&(s=o.getElement(),!c(o)&&s&&t.container!==s&&w.nodeContains(t.container,s)))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const d=c(this),l=this.getElement();if(l&&!0!==d){if(l===e&&r&&(s||(s=r.getElement()),s&&!c(r)&&w.nodeContains(t.container,s)&&s!==t.container))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;if(l!==e&&w.nodeContains(l,e))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const a=n[this.id];let i;if(i="first"in a?a.first:a.first=this.getFirst(!0),i&&t.acceptCondition(i))return t.rejectElementsFrom=l,t.skippedFocusable=!0,i!==t.from?(t.found=!0,t.foundElement=i,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}}}class ge{constructor(e,t){this._current={},this._grouppers={},this._init=()=>{const e=this._win();this._tabster.focusedElement.subscribeFirst(this._onFocus);const t=e.document,n=w.getActiveElement(t);n&&this._onFocus(n),t.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(m,this._onMoveFocus)},this._onGroupperDispose=e=>{delete this._grouppers[e.id]},this._onFocus=e=>{e&&this._updateCurrent(e,!0,!0)},this._onMouseDown=e=>{e.target&&this._updateCurrent(e.target,!0)},this._onKeyDown=e=>{if(e.key!==se&&e.key!==ce)return;if(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const t=this._tabster.focusedElement.getFocusedElement();t&&this.handleKeyPress(t,e)},this._onMoveFocus=e=>{var t;const n=e.composedPath()[0],a=null===(t=e.detail)||void 0===t?void 0:t.action;n&&void 0!==a&&!e.defaultPrevented&&(1===a?this._enterGroupper(n):this._escapeGroupper(n),e.stopImmediatePropagation())},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){const e=this._win();this._tabster.focusedElement.cancelAsyncFocus(1),this._current={},this._updateTimer&&(e.clearTimeout(this._updateTimer),delete this._updateTimer),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),e.removeEventListener(m,this._onMoveFocus),Object.keys(this._grouppers).forEach(e=>{this._grouppers[e]&&(this._grouppers[e].dispose(),delete this._grouppers[e])})}createGroupper(e,t,n){const a=new be(this._tabster,e,this._onGroupperDispose,t,n);this._grouppers[a.id]=a;const i=this._tabster.focusedElement.getFocusedElement();return i&&w.nodeContains(e,i)&&!this._updateTimer&&(this._updateTimer=this._win().setTimeout(()=>{delete this._updateTimer,i===this._tabster.focusedElement.getFocusedElement()&&this._updateCurrent(i,!0,!0)},0)),a}forgetCurrentGrouppers(){this._current={}}_updateCurrent(e,t,n){var a;this._updateTimer&&(this._win().clearTimeout(this._updateTimer),delete this._updateTimer);const i={};let r=!0;for(let o=e;o;o=w.getParentElement(o)){const s=null===(a=d(this._tabster,o))||void 0===a?void 0:a.groupper;if(s){if(i[s.id]=!0,r&&n&&o!==e&&(r=!1),t||!r){this._current[s.id]=s;const t=s.isActive()||e!==o&&(!s.getProps().delegated||s.getFirst(!1)!==e);s.makeTabbable(t)}r=!1}}for(const e of Object.keys(this._current)){const t=this._current[e];t.id in i||(t.makeTabbable(!1),t.setFirst(void 0),delete this._current[e])}}_enterGroupper(e,t){const n=this._tabster,a=ie.getTabsterContext(n,e),i=(null==a?void 0:a.groupper)||(null==a?void 0:a.modalizerInGroupper),r=null==i?void 0:i.getElement();if(i&&r&&(e===r||i.getProps().delegated&&e===i.getFirst(!1))){const a=n.focusable.findNext({container:r,currentElement:e,useActiveModalizer:!0});if(a&&(!t||t&&r.dispatchEvent(new y({by:"groupper",owner:r,next:a,relatedEvent:t}))))return t&&(t.preventDefault(),t.stopImmediatePropagation()),a.focus(),a}return null}_escapeGroupper(e,t,n){var a;const i=this._tabster,r=ie.getTabsterContext(i,e),o=null==r?void 0:r.modalizerInGroupper;let s=(null==r?void 0:r.groupper)||o;const c=null==s?void 0:s.getElement();if(s&&c&&w.nodeContains(c,e)){let r;if(e!==c||n)r=s.getFirst(!0);else{const e=w.getParentElement(c),t=e?ie.getTabsterContext(i,e):void 0;s=null==t?void 0:t.groupper,r=null==s?void 0:s.getFirst(!0)}if(r&&(!t||t&&c.dispatchEvent(new y({by:"groupper",owner:c,next:r,relatedEvent:t}))))return s&&(s.makeTabbable(!1),o&&(null===(a=i.modalizer)||void 0===a||a.setActive(void 0))),r.focus(),r}return null}moveFocus(e,t){return 1===t?this._enterGroupper(e):this._escapeGroupper(e)}handleKeyPress(e,t,n){const a=this._tabster,i=ie.getTabsterContext(a,e);if(i&&((null==i?void 0:i.groupper)||(null==i?void 0:i.modalizerInGroupper))){if(a.focusedElement.cancelAsyncFocus(1),i.ignoreKeydown(t))return;if(t.key===se)this._enterGroupper(e,t);else if(t.key===ce){const i=a.focusedElement.getFocusedElement();a.focusedElement.requestAsyncFocus(1,()=>{(i===a.focusedElement.getFocusedElement()||(!n||i)&&n)&&this._escapeGroupper(e,t,n)},0)}}}}class ve extends re{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,a.hs7)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,a.xrM)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null===(t=this._keyborg)||void 0===t||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())}}let ye=0;const Se="aria-hidden";class De extends Q{constructor(e,t,n){super(t,e,2,n),this._setHandlers((n,i)=>{var r,o;const s=e.get(),c=s&&(null===(r=ie.getRoot(t,s))||void 0===r?void 0:r.getElement()),d=n.input;let l;if(c&&d){const e=ee(d),n=ie.getTabsterContext(t,e||d);n&&(l=null===(o=_e.findNextTabbable(t,n,c,d,void 0,i,!0))||void 0===o?void 0:o.element),l&&(0,a.V5G)(l)}})}}class Ie extends W{constructor(e,t,n,a,i,r){super(e,t,a),this._wasFocused=0,this.userId=a.id,this._onDispose=n,this._activeElements=r,e.controlTab||(this.dummyManager=new De(this._element,e,i))}makeActive(e){if(this._isActive!==e){this._isActive=e;const t=this.getElement();if(t){const n=this._activeElements,a=n.map(e=>e.get()).indexOf(t);e?a<0&&n.push(new P(this._tabster.getWindow,t)):a>=0&&n.splice(a,1)}this._dispatchEvent(e)}}focused(e){return e||(this._wasFocused=++ye),this._wasFocused}setProps(e){e.id&&(this.userId=e.id),this._props={...e}}dispose(){var e;this.makeActive(!1),this._onDispose(this),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(e){return w.nodeContains(this.getElement(),e)}findNextTabbable(e,t,n,a){var i,r;if(!this.getElement())return null;const o=this._tabster;let s,c=null,d=!1;const l=e&&(null===(i=ie.getRoot(o,e))||void 0===i?void 0:i.getElement());if(l){const i={container:l,currentElement:e,referenceElement:t,ignoreAccessibility:a,useActiveModalizer:!0},u={};c=o.focusable[n?"findPrev":"findNext"](i,u),!c&&this._props.isTrapped&&(null===(r=o.modalizer)||void 0===r?void 0:r.activeId)?(c=o.focusable[n?"findLast":"findFirst"]({container:l,ignoreAccessibility:a,useActiveModalizer:!0},u),d=!0):d=!!u.outOfDOMOrder,s=u.uncontrolled}return{element:c,uncontrolled:s,outOfDOMOrder:d}}_dispatchEvent(e,t){const n=this.getElement();let a=!1;if(n){const i=t?this._activeElements.map(e=>e.get()):[n];for(const t of i)if(t){const i={id:this.userId,element:n},r=e?new D(i):new I(i);t.dispatchEvent(r),r.defaultPrevented&&(a=!0)}}return a}_remove(){}}class xe{constructor(e,t,n){this._onModalizerDispose=e=>{const t=e.id,n=e.userId,a=this._parts[n];delete this._modalizers[t],a&&(delete a[t],0===Object.keys(a).length&&(delete this._parts[n],this.activeId===n&&this.setActive(void 0)))},this._onKeyDown=e=>{var t;if(e.key!==ce)return;const n=this._tabster,a=n.focusedElement.getFocusedElement();if(a){const i=ie.getTabsterContext(n,a),r=null==i?void 0:i.modalizer;if(i&&!i.groupper&&(null==r?void 0:r.isActive())&&!i.ignoreKeydown(e)){const a=r.userId;if(a){const i=this._parts[a];if(i){const a=Object.keys(i).map(e=>{var t;const n=i[e],a=n.getElement();let r;return a&&(r=null===(t=d(this._tabster,a))||void 0===t?void 0:t.groupper),n&&a&&r?{el:a,focusedSince:n.focused(!0)}:{focusedSince:0}}).filter(e=>e.focusedSince>0).sort((e,t)=>e.focusedSince>t.focusedSince?-1:e.focusedSince<t.focusedSince?1:0);if(a.length){const i=a[0].el;i&&(null===(t=n.groupper)||void 0===t||t.handleKeyPress(i,e,!0))}}}}}},this._onFocus=(e,t)=>{var n,a;const i=e&&ie.getTabsterContext(this._tabster,e);if(!i||!e)return;const r=this._augMap;for(let t=e;t;t=w.getParentElement(t))r.has(t)&&(r.delete(t),Z(this._tabster,t,Se));const o=i.modalizer;if(null===(a=o||(null===(n=d(this._tabster,e))||void 0===n?void 0:n.modalizer))||void 0===a||a.focused(),(null==o?void 0:o.userId)!==this.activeId)if(t.isFocusedProgrammatically||this.currentIsOthersAccessible||(null==o?void 0:o.getProps().isAlwaysAccessible))this.setActive(o);else{const t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout(()=>this._restoreModalizerFocus(e),100)}else this.currentIsOthersAccessible=null==o?void 0:o.getProps().isOthersAccessible},this._tabster=e,this._win=e.getWindow,this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this._alwaysAccessibleSelector=t,this._accessibleCheck=n,this.activeElements=[],e.controlTab||e.root.addDummyInputs(),this._win().addEventListener("keydown",this._onKeyDown,!0),e.queueInit(()=>{this._tabster.focusedElement.subscribe(this._onFocus)})}dispose(){const e=this._win();e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach(e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])}),e.clearTimeout(this._restoreModalizerFocusTimer),e.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(e,t,n){var a;const i=new Ie(this._tabster,e,this._onModalizerDispose,t,n,this.activeElements),r=i.id,o=t.id;this._modalizers[r]=i;let s=this._parts[o];return s||(s=this._parts[o]={}),s[r]=i,w.nodeContains(e,null!==(a=this._tabster.focusedElement.getFocusedElement())&&void 0!==a?a:null)&&(o!==this.activeId?this.setActive(i):i.makeActive(!0)),i}isAugmented(e){return this._augMap.has(e)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout(()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()},250))}setActive(e){const t=null==e?void 0:e.userId,n=this.activeId;if(n!==t){if(this.activeId=t,n){const e=this._parts[n];if(e)for(const t of Object.keys(e))e[t].makeActive(!1)}if(t){const e=this._parts[t];if(e)for(const t of Object.keys(e))e[t].makeActive(!0)}this.currentIsOthersAccessible=null==e?void 0:e.getProps().isOthersAccessible,this.hiddenUpdate()}}focus(e,t,n){const a=ie.getTabsterContext(this._tabster,e),i=null==a?void 0:a.modalizer;if(i){this.setActive(i);const e=i.getProps(),a=i.getElement();if(a){if(void 0===t&&(t=e.isNoFocusFirst),!t&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:a}))return!0;if(void 0===n&&(n=e.isNoFocusDefault),!n&&this._tabster.focusedElement.focusDefault(a))return!0;this._tabster.focusedElement.resetFocus(a)}}return!1}acceptElement(e,t){var n;const a=t.modalizerUserId,i=null===(n=t.currentCtx)||void 0===n?void 0:n.modalizer;if(a)for(const t of this.activeElements){const n=t.get();if(n&&(w.nodeContains(e,n)||n===e))return NodeFilter.FILTER_SKIP}const r=a===(null==i?void 0:i.userId)||!a&&(null==i?void 0:i.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP;return void 0!==r&&(t.skippedFocusable=!0),r}_hiddenUpdate(){var e;const t=this._tabster,n=t.getWindow().document.body,a=this.activeId,i=this._parts,r=[],o=[],s=this._alwaysAccessibleSelector,c=s?Array.from(w.querySelectorAll(n,s)):[],d=[];for(const e of Object.keys(i)){const t=i[e];for(const n of Object.keys(t)){const i=t[n],s=i.getElement(),l=i.getProps().isAlwaysAccessible;s&&(e===a?(d.push(s),this.currentIsOthersAccessible||r.push(s)):l?c.push(s):o.push(s))}}const l=this._augMap,u=r.length>0?[...r,...c]:void 0,f=[],p=new WeakMap,m=(e,n)=>{var a;const i=e.tagName;if("SCRIPT"===i||"STYLE"===i)return;let r=!1;l.has(e)?n?r=!0:(l.delete(e),Z(t,e,Se)):n&&!(null===(a=this._accessibleCheck)||void 0===a?void 0:a.call(this,e,d))&&Z(t,e,Se,"true")&&(l.set(e,!0),r=!0),r&&(f.push(new P(t.getWindow,e)),p.set(e,!0))},_=e=>{var n;for(let a=w.getFirstElementChild(e);a;a=w.getNextElementSibling(a)){let e=!1,i=!1,r=!1;if(u){const o=t.getParent(a);for(const t of u){if(a===t){e=!0;break}if(w.nodeContains(a,t)){i=!0;break}w.nodeContains(t,o)&&(r=!0)}i||(null===(n=a.__tabsterElementFlags)||void 0===n?void 0:n.noDirectAriaHidden)?_(a):e||r||m(a,!0)}else m(a,!1)}};u||c.forEach(e=>m(e,!1)),o.forEach(e=>m(e,!0)),n&&_(n),null===(e=this._aug)||void 0===e||e.map(e=>e.get()).forEach(e=>{e&&!p.get(e)&&m(e,!1)}),this._aug=f,this._augMap=p}_restoreModalizerFocus(e){const t=null==e?void 0:e.ownerDocument;if(!e||!t)return;const n=ie.getTabsterContext(this._tabster,e),a=null==n?void 0:n.modalizer,i=this.activeId;if(!a&&!i||a&&i===a.userId)return;const r=null==n?void 0:n.root.getElement();if(r){let t=this._tabster.focusable.findFirst({container:r,useActiveModalizer:!0});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&(t=this._tabster.focusable.findLast({container:r,useActiveModalizer:!0}),!t))throw new Error("Something went wrong.");return void this._tabster.focusedElement.focus(t)}}e.blur()}}const Ce=["input","textarea","*[contenteditable]"].join(", ");class Oe extends Q{constructor(e,t,n,i){super(t,e,3,i),this._onFocusDummyInput=e=>{var t,n;const i=this._element.get(),r=e.input;if(i&&r){const o=ie.getTabsterContext(this._tabster,i);let s;o&&(s=null===(t=_e.findNextTabbable(this._tabster,o,void 0,r,void 0,!e.isFirst,!0))||void 0===t?void 0:t.element);const c=null===(n=this._getMemorized())||void 0===n?void 0:n.get();c&&this._tabster.focusable.isFocusable(c)&&(s=c),s&&(0,a.V5G)(s)}},this._tabster=t,this._getMemorized=n,this._setHandlers(this._onFocusDummyInput)}}class we extends W{constructor(e,t,n,a,i){var r;super(e,t,a),this._visible={},this._onIntersection=e=>{for(const t of e){const e=t.target,n=j(this._win,e);let a,i=this._fullyVisible;if(t.intersectionRatio>=.25?(a=t.intersectionRatio>=.75?2:1,2===a&&(i=n)):a=0,this._visible[n]!==a){void 0===a?(delete this._visible[n],i===n&&delete this._fullyVisible):(this._visible[n]=a,this._fullyVisible=i);const t=this.getState(e);t&&e.dispatchEvent(new S(t))}}},this._win=e.getWindow,this.visibilityTolerance=null!==(r=a.visibilityTolerance)&&void 0!==r?r:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=n,e.controlTab||(this.dummyManager=new Oe(this._element,e,()=>a.memorizeCurrent?this._current:void 0,i))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);const t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager}setCurrent(e){this._current=e?new P(this._win,e):void 0,!this._props.trackState&&!this._props.visibilityAware||this._setCurrentTimer||(this._setCurrentTimer=this._win().setTimeout(()=>{var e;delete this._setCurrentTimer;const t=[];this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current);for(const n of t){const t=null==n?void 0:n.get();if(t&&(null===(e=this._allElements)||void 0===e?void 0:e.get(t))===this){const e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){const e=this.getState(t);e&&t.dispatchEvent(new S(e))}}}}))}getCurrent(){var e;return(null===(e=this._current)||void 0===e?void 0:e.get())||null}findNextTabbable(e,t,n,a){const i=this.getElement(),r=i&&ee(e)===i;if(!i)return null;let o,s=null,c=!1;if(this._props.tabbable||r||e&&!w.nodeContains(i,e)){const r={currentElement:e,referenceElement:t,container:i,ignoreAccessibility:a,useActiveModalizer:!0},d={};s=this._tabster.focusable[n?"findPrev":"findNext"](r,d),c=!!d.outOfDOMOrder,o=d.uncontrolled}return{element:s,uncontrolled:o,outOfDOMOrder:c}}acceptElement(e,t){var n,a;if(!_e.isTabbing)return(null===(n=t.currentCtx)||void 0===n?void 0:n.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;const{memorizeCurrent:i,visibilityAware:r,hasDefault:o=!0}=this._props,s=this.getElement();if(s&&(i||r||o)&&(!w.nodeContains(s,t.from)||ee(t.from)===s)){let e;if(i){const n=null===(a=this._current)||void 0===a?void 0:a.get();n&&t.acceptCondition(n)&&(e=n)}if(!e&&o&&(e=this._tabster.focusable.findDefault({container:s,useActiveModalizer:!0})),!e&&r&&(e=this._tabster.focusable.findElement({container:s,useActiveModalizer:!0,isBackward:t.isBackward,acceptCondition:e=>{var n;const a=j(this._win,e),i=this._visible[a];return s!==e&&!!(null===(n=this._allElements)||void 0===n?void 0:n.get(e))&&t.acceptCondition(e)&&(2===i||1===i&&(1===r||!this._fullyVisible))}})),e)return t.found=!0,t.foundElement=e,t.rejectElementsFrom=s,t.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){const e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;const t=this._win(),n=this._allElements=new WeakMap,a=this._tabster.focusable;let i=this._updateQueue=[];const r=w.createMutationObserver(e=>{for(const t of e){const e=t.target,n=t.removedNodes,a=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&i.push({element:e,type:2});else{for(let e=0;e<n.length;e++)i.push({element:n[e],type:3});for(let e=0;e<a.length;e++)i.push({element:a[e],type:1})}}u()}),o=(e,t)=>{var a,i;const r=n.get(e);r&&t&&(null===(a=this._intersectionObserver)||void 0===a||a.unobserve(e),n.delete(e)),r||t||(n.set(e,this),null===(i=this._intersectionObserver)||void 0===i||i.observe(e))},s=e=>{const t=a.isFocusable(e);n.get(e)?t||o(e,!0):t&&o(e)},c=e=>{const{mover:n}=f(e);if(n&&n!==this){if(n.getElement()!==e||!a.isFocusable(e))return;o(e)}const i=F(t.document,e,e=>{const{mover:t,groupper:n}=f(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;const i=null==n?void 0:n.getFirst(!0);return n&&n.getElement()!==e&&i&&i!==e?NodeFilter.FILTER_REJECT:(a.isFocusable(e)&&o(e),NodeFilter.FILTER_SKIP)});if(i)for(i.currentNode=e;i.nextNode(););},l=e=>{n.get(e)&&o(e,!0);for(let t=w.getFirstElementChild(e);t;t=w.getNextElementSibling(t))l(t)},u=()=>{!this._updateTimer&&i.length&&(this._updateTimer=t.setTimeout(()=>{delete this._updateTimer;for(const{element:e,type:t}of i)switch(t){case 2:s(e);break;case 1:c(e);break;case 3:l(e)}i=this._updateQueue=[]},0))},f=e=>{const t={};for(let n=e;n;n=w.getParentElement(n)){const e=d(this._tabster,n);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};i.push({element:e,type:1}),u(),r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{r.disconnect()}}getState(e){const t=j(this._win,e);if(t in this._visible){const n=this._visible[t]||0;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:n}}}}class Ee{constructor(e,t){this._init=()=>{const e=this._win();e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(f,this._onMoveFocus),e.addEventListener(p,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;let n=e,a=e;for(let i=w.getParentElement(e);i;i=w.getParentElement(i)){const e=null===(t=d(this._tabster,i))||void 0===t?void 0:t.mover;e&&(e.setCurrent(a),n=void 0),!n&&this._tabster.focusable.isFocusable(i)&&(n=a=i)}},this._onKeyDown=async e=>{var t;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1),e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const n=e.key;let a;if(n===pe?a=2:n===fe?a=4:n===ue?a=1:n===le?a=3:"PageDown"===n?a=6:"PageUp"===n?a=5:n===de?a=7:"End"===n&&(a=8),!a)return;const i=this._tabster.focusedElement.getFocusedElement();i&&!await this._isIgnoredInput(i,n)&&this._moveFocus(i,a,e)},this._onMoveFocus=e=>{var t;const n=e.composedPath()[0],a=null===(t=e.detail)||void 0===t?void 0:t.key;n&&void 0!==a&&!e.defaultPrevented&&(this._moveFocus(n,a),e.stopImmediatePropagation())},this._onMemorizedElement=e=>{var t;const n=e.composedPath()[0];let a=null===(t=e.detail)||void 0===t?void 0:t.memorizedElement;if(n){const t=ie.getTabsterContext(this._tabster,n),i=null==t?void 0:t.mover;i&&(a&&!w.nodeContains(i.getElement(),a)&&(a=void 0),i.setCurrent(a),e.stopImmediatePropagation())}},this._tabster=e,this._win=t,this._movers={},e.queueInit(this._init)}dispose(){var e;const t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null===(e=this._ignoredInputResolve)||void 0===e||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener(f,this._onMoveFocus),t.removeEventListener(p,this._onMemorizedElement),Object.keys(this._movers).forEach(e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])})}createMover(e,t,n){const a=new we(this._tabster,e,this._onMoverDispose,t,n);return this._movers[a.id]=a,a}moveFocus(e,t){return this._moveFocus(e,t)}_moveFocus(e,t,n){var i,r;const o=this._tabster,c=ie.getTabsterContext(o,e,{checkRtl:!0});if(!c||!c.mover||c.excludedFromMover||n&&c.ignoreKeydown(n))return null;const l=c.mover,u=l.getElement();if(c.groupperBeforeMover){const e=c.groupper;if(!e||e.isActive(!0))return null;for(let t=w.getParentElement(e.getElement());t&&t!==u;t=w.getParentElement(t))if(null===(r=null===(i=d(o,t))||void 0===i?void 0:i.groupper)||void 0===r?void 0:r.isActive(!0))return null}if(!u)return null;const f=o.focusable,p=l.getProps(),m=p.direction||s.Both,_=m===s.Both,h=_||m===s.Vertical,b=_||m===s.Horizontal,g=m===s.GridLinear,v=g||m===s.Grid,S=p.cyclic;let D,I,x,C=0,O=0;if(v&&(x=e.getBoundingClientRect(),C=Math.ceil(x.left),O=Math.floor(x.right)),c.rtl&&(4===t?t=3:3===t&&(t=4)),2===t&&h||4===t&&(b||v))if(D=f.findNext({currentElement:e,container:u,useActiveModalizer:!0}),D&&v){const e=Math.ceil(D.getBoundingClientRect().left);!g&&O>e&&(D=void 0)}else!D&&S&&(D=f.findFirst({container:u,useActiveModalizer:!0}));else if(1===t&&h||3===t&&(b||v))if(D=f.findPrev({currentElement:e,container:u,useActiveModalizer:!0}),D&&v){const e=Math.floor(D.getBoundingClientRect().right);!g&&e>C&&(D=void 0)}else!D&&S&&(D=f.findLast({container:u,useActiveModalizer:!0}));else if(7===t)v?f.findElement({container:u,currentElement:e,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{var n;if(!f.isFocusable(t))return!1;const a=Math.ceil(null!==(n=t.getBoundingClientRect().left)&&void 0!==n?n:0);return t!==e&&C<=a||(D=t,!1)}}):D=f.findFirst({container:u,useActiveModalizer:!0});else if(8===t)v?f.findElement({container:u,currentElement:e,useActiveModalizer:!0,acceptCondition:t=>{var n;if(!f.isFocusable(t))return!1;const a=Math.ceil(null!==(n=t.getBoundingClientRect().left)&&void 0!==n?n:0);return t!==e&&C>=a||(D=t,!1)}}):D=f.findLast({container:u,useActiveModalizer:!0});else if(5===t){if(f.findElement({currentElement:e,container:u,useActiveModalizer:!0,isBackward:!0,acceptCondition:e=>!(!f.isFocusable(e)||R(this._win,e,l.visibilityTolerance)&&(D=e,1))}),v&&D){const e=Math.ceil(D.getBoundingClientRect().left);f.findElement({currentElement:D,container:u,useActiveModalizer:!0,acceptCondition:t=>{if(!f.isFocusable(t))return!1;const n=Math.ceil(t.getBoundingClientRect().left);return C<n||e>=n||(D=t,!1)}})}I=!1}else if(6===t){if(f.findElement({currentElement:e,container:u,useActiveModalizer:!0,acceptCondition:e=>!(!f.isFocusable(e)||R(this._win,e,l.visibilityTolerance)&&(D=e,1))}),v&&D){const e=Math.ceil(D.getBoundingClientRect().left);f.findElement({currentElement:D,container:u,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{if(!f.isFocusable(t))return!1;const n=Math.ceil(t.getBoundingClientRect().left);return C>n||e<=n||(D=t,!1)}})}I=!0}else if(v){const n=1===t,a=C,i=Math.ceil(x.top),r=O,o=Math.floor(x.bottom);let s,c,d=0;f.findAll({container:u,currentElement:e,isBackward:n,onElement:e=>{const t=e.getBoundingClientRect(),l=Math.ceil(t.left),u=Math.ceil(t.top),f=Math.floor(t.right),p=Math.floor(t.bottom);if(n&&i<p||!n&&o>u)return!0;const m=Math.ceil(Math.min(r,f))-Math.floor(Math.max(a,l)),_=Math.ceil(Math.min(r-a,f-l));if(m>0&&_>=m){const t=m/_;t>d&&(s=e,d=t)}else if(0===d){const t=function(e,t,n,a,i,r,o,s){const c=n<i?i-n:o<e?e-o:0,d=a<r?r-a:s<t?t-s:0;return 0===c?d:0===d?c:Math.sqrt(c*c+d*d)}(a,i,r,o,l,u,f,p);(void 0===c||t<c)&&(c=t,s=e)}else if(d>0)return!1;return!0}}),D=s}return D&&(!n||n&&u.dispatchEvent(new y({by:"mover",owner:u,next:D,relatedEvent:n})))?(void 0!==I&&function(e,t,n){const a=N(t);if(a){const i=H(e,a),r=t.getBoundingClientRect();a.scrollTop+=n?r.top-i.top:r.bottom-i.bottom}}(this._win,D,I),n&&(n.preventDefault(),n.stopImmediatePropagation()),(0,a.V5G)(D),D):null}async _isIgnoredInput(e,t){if("true"===e.getAttribute("aria-expanded")&&e.hasAttribute("aria-activedescendant"))return!0;if(G(e,Ce)){let n,a=0,i=0,r=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){const n=e.type,o=e.value;if(r=(o||"").length,"email"===n||"number"===n){if(r){const n=w.getSelection(e);if(n){const e=n.toString().length,a=t===le||t===ue;if(n.modify("extend",a?"backward":"forward","character"),e!==n.toString().length)return n.modify("extend",a?"forward":"backward","character"),!0;r=0}}}else{const t=e.selectionStart;if(null===t)return"hidden"===n;a=t||0,i=e.selectionEnd||0}}else"true"===e.contentEditable&&(n=new(function(e){const t=k(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}(this._win))(t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};const n=this._win();this._ignoredInputTimer&&n.clearTimeout(this._ignoredInputTimer);const{anchorNode:o,focusNode:s,anchorOffset:c,focusOffset:d}=w.getSelection(e)||{};this._ignoredInputTimer=n.setTimeout(()=>{var t,n,l;delete this._ignoredInputTimer;const{anchorNode:u,focusNode:f,anchorOffset:p,focusOffset:m}=w.getSelection(e)||{};if(u===o&&f===s&&p===c&&m===d){if(a=p||0,i=m||0,r=(null===(n=e.textContent)||void 0===n?void 0:n.length)||0,u&&f&&w.nodeContains(e,u)&&w.nodeContains(e,f)&&u!==e){let t=!1;const n=e=>{if(e===u)t=!0;else if(e===f)return!0;const r=e.textContent;if(r&&!w.getFirstChild(e)){const e=r.length;t?f!==u&&(i+=e):(a+=e,i+=e)}let o=!1;for(let t=w.getFirstChild(e);t&&!o;t=t.nextSibling)o=n(t);return o};n(e)}null===(l=this._ignoredInputResolve)||void 0===l||l.call(this,!0)}else null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1)},0)}));if(n&&!await n)return!0;if(a!==i)return!0;if(a>0&&(t===le||t===ue||t===de))return!0;if(a<r&&(t===fe||t===pe||"End"===t))return!0}return!1}}class Ae{constructor(e){this._isUncontrolledCompletely=e}isUncontrolledCompletely(e,t){var n;const a=null===(n=this._isUncontrolledCompletely)||void 0===n?void 0:n.call(this,e,t);return void 0===a?t:a}}class Le extends W{constructor(e,t,n){var a;if(super(e,t,n),this._hasFocus=!1,this._onFocusOut=e=>{var t;const n=null===(t=this._element)||void 0===t?void 0:t.get();n&&null===e.relatedTarget&&n.dispatchEvent(new x),n&&!w.nodeContains(n,e.relatedTarget)&&(this._hasFocus=!1)},this._onFocusIn=()=>{this._hasFocus=!0},this._props.type===o.Source){const e=null===(a=this._element)||void 0===a?void 0:a.get();null==e||e.addEventListener("focusout",this._onFocusOut),null==e||e.addEventListener("focusin",this._onFocusIn),this._hasFocus=w.nodeContains(e,e&&w.getActiveElement(e.ownerDocument))}}dispose(){var e;if(this._props.type===o.Source){const t=null===(e=this._element)||void 0===e?void 0:e.get();null==t||t.removeEventListener("focusout",this._onFocusOut),null==t||t.removeEventListener("focusin",this._onFocusIn),this._hasFocus&&this._tabster.getWindow().document.body.dispatchEvent(new x)}}}class ke{constructor(e){this._history=[],this._onRestoreFocus=e=>{this._focusedElementState.cancelAsyncFocus(2);const t=e.composedPath()[0];t&&this._focusedElementState.requestAsyncFocus(2,()=>this._restoreFocus(t),0)},this._onFocusIn=e=>{var t;if(!e)return;const n=d(this._tabster,e);(null===(t=null==n?void 0:n.restorer)||void 0===t?void 0:t.getProps().type)===o.Target&&this._addToHistory(e)},this._restoreFocus=e=>{var t;const n=this._getWindow().document;if(w.getActiveElement(n)!==n.body)return;if(!this._keyboardNavState.isNavigatingWithKeyboard()&&w.nodeContains(n.body,e))return;let a=this._history.pop();for(;a&&!w.nodeContains(n.body,w.getParentElement(a.get()));)a=this._history.pop();null===(t=null==a?void 0:a.get())||void 0===t||t.focus()},this._tabster=e,this._getWindow=e.getWindow,this._getWindow().addEventListener(_,this._onRestoreFocus),this._keyboardNavState=e.keyboardNavigation,this._focusedElementState=e.focusedElement,this._focusedElementState.subscribe(this._onFocusIn)}dispose(){const e=this._getWindow();this._focusedElementState.unsubscribe(this._onFocusIn),this._focusedElementState.cancelAsyncFocus(2),e.removeEventListener(_,this._onRestoreFocus)}_addToHistory(e){var t;(null===(t=this._history[this._history.length-1])||void 0===t?void 0:t.get())!==e&&(this._history.length>10&&this._history.shift(),this._history.push(new P(this._getWindow,e)))}createRestorer(e,t){const n=new Le(this._tabster,e,t);return t.type===o.Target&&w.getActiveElement(e.ownerDocument)===e&&this._addToHistory(e),n}}class Me{static _overrideAttachShadow(e){const t=e.Element.prototype.attachShadow;t.__origAttachShadow||(Element.prototype.attachShadow=function(e){const n=t.call(this,e);for(const e of Me._shadowObservers)e._addSubObserver(n);return n},Element.prototype.attachShadow.__origAttachShadow=t)}constructor(e){this._isObserving=!1,this._callbackWrapper=(e,t)=>{for(const t of e)if("childList"===t.type){const e=t.removedNodes,n=t.addedNodes;for(let t=0;t<e.length;t++)this._walkShadows(e[t],!0);for(let e=0;e<n.length;e++)this._walkShadows(n[e])}this._callback(e,t)},this._callback=e,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(e){if(this._options&&this._callback&&!this._subObservers.has(e)&&this._options.subtree&&function(e,t){var n,a;if(!e||!t)return!1;let i=t;for(;i;){if(i===e)return!0;i="function"!=typeof i.assignedElements&&(null===(n=i.assignedSlot)||void 0===n?void 0:n.parentNode)?null===(a=i.assignedSlot)||void 0===a?void 0:a.parentNode:i.nodeType===document.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode}return!1}(this._root,e)){const t=new MutationObserver(this._callbackWrapper);this._subObservers.set(e,t),this._isObserving&&t.observe(e,this._options),this._walkShadows(e)}}disconnect(){this._isObserving=!1,delete this._options,Me._shadowObservers.delete(this);for(const e of this._subObservers.values())e.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(e,t){const n=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument,a=null==n?void 0:n.defaultView;n&&a&&(Me._overrideAttachShadow(a),Me._shadowObservers.add(this),this._root=e,this._options=t,this._isObserving=!0,this._observer.observe(e,t),this._walkShadows(e))}_walkShadows(e,t){const n=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;if(n){if(e===n)e=n.body;else{const t=e.shadowRoot;if(t)return void this._addSubObserver(t)}n.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{if(e.nodeType===Node.ELEMENT_NODE)if(t){const t=this._subObservers.get(e);t&&(t.disconnect(),this._subObservers.delete(e))}else{const t=e.shadowRoot;t&&this._addSubObserver(t)}return NodeFilter.FILTER_SKIP}}).nextNode()}}takeRecords(){const e=this._observer.takeRecords();for(const t of this._subObservers.values())e.push(...t.takeRecords());return e}}Me._shadowObservers=new Set;class Pe{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class Te{constructor(e,t){var n,a;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="8.0.1",this._noop=!1,this.getWindow=()=>{if(!this._win)throw new Error("Using disposed Tabster.");return this._win},this._storage=function(e){const t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;const r=this.getWindow;(null==t?void 0:t.DOMAPI)&&function(e){for(const t of Object.keys(e))w[t]=e[t]}({...t.DOMAPI}),this.keyboardNavigation=new ve(r),this.focusedElement=new _e(this,r),this.focusable=new oe(this),this.root=new ie(this,null==t?void 0:t.autoRoot),this.uncontrolled=new Ae((null==t?void 0:t.checkUncontrolledCompletely)||(null==t?void 0:t.checkUncontrolledTrappingFocus)),this.controlTab=null===(n=null==t?void 0:t.controlTab)||void 0===n||n,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this._dummyObserver=new Y(r),this.getParent=null!==(a=null==t?void 0:t.getParent)&&void 0!==a?a:w.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){const t=r().document;this._unobserve=function(e,t,n,a){if("undefined"==typeof MutationObserver)return()=>{};const r=t.getWindow;let o;function s(t,n){o||(o=k(r).elementByUId),c(t,n);const a=F(e,t,e=>c(e,n));if(a)for(;a.nextNode(););}function c(e,a){var s;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;const c=e.__tabsterElementUID;return c&&o&&(a?delete o[c]:null!==(s=o[c])&&void 0!==s||(o[c]=new P(r,e))),(d(t,e)||e.hasAttribute(i))&&n(t,e,a),NodeFilter.FILTER_SKIP}const l=w.createMutationObserver(e=>{var a,r,o,c,d;const l=new Set;for(const d of e){const e=d.target,u=d.removedNodes,f=d.addedNodes;if("attributes"===d.type)d.attributeName===i&&(l.has(e)||n(t,e));else{for(let n=0;n<u.length;n++){const i=u[n];l.add(i),s(i,!0),null===(r=(a=t._dummyObserver).domChanged)||void 0===r||r.call(a,e)}for(let n=0;n<f.length;n++)s(f[n]),null===(c=(o=t._dummyObserver).domChanged)||void 0===c||c.call(o,e)}}l.clear(),null===(d=t.modalizer)||void 0===d||d.hiddenUpdate()});return a&&s(r().document.body),l.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[i]}),()=>{l.disconnect()}}(t,this,l,e)}}},U(r),this.queueInit(()=>{this.internal.resumeObserver(!0)})}_mergeProps(e){var t;e&&(this.getParent=null!==(t=e.getParent)&&void 0!==t?t:this.getParent)}createTabster(e,t){const n=new Pe(this);return e||this._wrappers.add(n),this._mergeProps(t),n}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){var e,t,n,a,i,r,o,s;this.internal.stopObserver();const c=this._win;null==c||c.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],c&&this._forgetMemorizedTimer&&(c.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(n=this.deloser)||void 0===n||n.dispose(),null===(a=this.groupper)||void 0===a||a.dispose(),null===(i=this.mover)||void 0===i||i.dispose(),null===(r=this.modalizer)||void 0===r||r.dispose(),null===(o=this.observedElement)||void 0===o||o.dispose(),null===(s=this.restorer)||void 0===s||s.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),function(e){const t=k(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}(this.getWindow),V(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),c&&(function(e){const t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}(c),delete c.__tabsterInstance,delete this._win)}storageEntry(e,t){const n=this._storage;let a=n.get(e);return a?!1===t&&0===Object.keys(a).length&&n.delete(e):!0===t&&(a={},n.set(e,a)),a}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout(()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())V(this.getWindow,e),_e.forgetMemorized(this.focusedElement,e)},0),T(this.getWindow,!0)))}queueInit(e){var t;this._win&&(this._initQueue.push(e),this._initTimer||(this._initTimer=null===(t=this._win)||void 0===t?void 0:t.setTimeout(()=>{delete this._initTimer,this.drainInitQueue()},0)))}drainInitQueue(){if(!this._win)return;const e=this._initQueue;this._initQueue=[],e.forEach(e=>e())}}function Ue(e,t){let n=function(e){return e.__tabsterInstance}(e);return n?n.createTabster(!1,t):(n=new Te(e,t),e.__tabsterInstance=n,n.createTabster())}function Fe(e){const t=e.core;return t.groupper||(t.groupper=new ge(t,t.getWindow)),t.groupper}function He(e){const t=e.core;return t.mover||(t.mover=new Ee(t,t.getWindow)),t.mover}function Re(e,t,n){const a=e.core;return a.modalizer||(a.modalizer=new xe(a,t,n)),a.modalizer}function Ne(e){const t=e.core;return t.restorer||(t.restorer=new ke(t)),t.restorer}function Be(e,t){e.core.disposeTabster(e,t)}}
,,,,,,,,,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane",e[e.Channels=24]="Channels",e[e.PhotoStream=25]="PhotoStream",e[e.PhoneLink=26]="PhoneLink",e[e.DefaultDocLib=27]="DefaultDocLib",e[e.ListSyncIssues=28]="ListSyncIssues",e[e.OneDriveHome=29]="OneDriveHome",e[e.TeamsDownloads=30]="TeamsDownloads",e[e.MyLists=31]="MyLists",e[e.Selection=32]="Selection",e[e.People=33]="People",e[e.Meetings=34]="Meetings",e[e.RecentLists=35]="RecentLists",e[e.MyOrganizationAssets=36]="MyOrganizationAssets",e[e.LargestFiles=37]="LargestFiles",e[e.StockImages=38]="StockImages",e[e.Bing=39]="Bing",e[e.Local=40]="Local",e[e.ChannelSharedList=41]="ChannelSharedList"}(a||(a={}));const i=a}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("".concat("MicroServiceDataSource.key",".microServiceDataSource"))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("identity")}
,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>a,b:()=>i}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={})),function(e){e.ExitEditMode="ExitEditMode"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s,c:()=>d});var a=n(98),i="text/plain",r={abap:i,ada:i,adp:i,ahk:i,as:i,as3:i,asc:i,ascx:"text/xml",asm:i,asp:i,awk:i,bash:i,bash_login:i,bash_logout:i,bash_profile:i,bashrc:i,bat:"text/x-bat",bib:i,bsh:"text/x-java",build:i,builder:i,c:"text/x-cpp","c++":"text/x-c++src",capfile:i,cc:"text/x-c++src",cfc:i,cfm:i,cfml:i,cl:i,clj:i,cls:i,cmake:i,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:i,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:i,db:i,ddl:i,di:i,dif:i,diff:i,disco:"text/xml",dml:i,dtd:"text/xml",dtml:"text/xml",el:i,emakefile:i,erb:i,erl:i,f:i,f90:i,f95:i,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:i,gemspec:"text/ruby",gitconfig:"text/x-ini",go:i,groovy:i,gvy:i,h:"text/x-cpp","h++":"text/x-c++hdr",haml:i,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:i,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:i,hs:i,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:i,inc:"text/html",inf:i,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:i,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:i,jsx:"text/javascript",l:i,less:"text/x-less",lhs:i,lisp:i,log:i,lst:i,ltx:i,lua:"text/x-lua",m:i,mak:i,make:i,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:i,mli:i,mll:i,mly:i,mm:i,mud:i,nfo:i,opml:"text/xml",osascript:i,osts:"text/javascript",out:i,p:i,pas:i,patch:i,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:i,plist:i,pm:i,pod:i,pp:i,profile:i,properties:i,ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:i,r:i,rake:i,rb:"text/ruby",rbx:i,rc:i,re:i,reg:i,rest:i,resw:"text/xml",resx:"text/xml",rhtml:i,rjs:i,rprofile:i,rpy:i,rss:"text/xml",rst:i,rxml:i,s:i,sass:"text/scss",scala:i,scm:i,sconscript:i,sconstruct:i,script:i,scss:"text/scss",sgml:"text/xml",sh:i,shtml:"text/html",sml:"text/xml",sql:i,sty:i,t:i,tcl:i,tex:i,text:i,textile:i,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:i,vb:"text/x-vb",vi:i,vim:i,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:i,xslt:i,yaml:i,yaws:i,yml:i,zsh:i};function o(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}function s(e,t){return!!e&&c(e,t)}function c(e,t){return function(e){return e=o(e),r.hasOwnProperty(e)}(e)&&(t===a.a.File||t===a.a.Media||t===a.a.Unknown)}function d(e){var t=o(e);return r.hasOwnProperty(t)?r[t]:void 0}}
,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>le,b:()=>ue});var a=n("odsp.util_118"),i=n(49),r=n("tslib_826"),o=n(415),s=n(20),c=n(26),d=n(42),l=n(27),u=n(136),f=n(99),p=n(351),m=new a.hK({name:"isOneDriveHomeEnabled.key",factory:new a.t_(function(){return!1})}),_=new a.hK({name:"isPeopleEnabled.key",factory:new a.t_(function(){return!1})}),h=n(64),b=n(214),g=n(5),v=n(40),y=n(135),S={ODB:61527},D={pageContext:g.a},I=function(e){var t=e.pageContext,n=!(0,y.b)()&&((0,v.a)(S)||!(0,b.a)()&&function(e,t){return!(!e||1!==(0,h.c)(90244,e))}(t));return I=function(){return n},n},x=new a.hK({name:"isInlineOneDriveSharedFolderEnabled",factory:{dependencies:D,create:function(e){return{instance:function(){return I(e)}}}}}),C=new a.hK({name:"isOpenSharedFolderInPeopleEnabled.key",factory:new a.t_(function(){return!1})}),O={ODB:61770},w=a.HW.isActivated("79CFF990-D05C-499D-A210-9CAA1C965AC7"),E={pageContext:g.a},A=function(e){var t=e.pageContext,n=!(0,y.b)()&&((0,v.a)(O)||!(0,b.a)()&&!!(null==t?void 0:t.isMySiteOwner)&&(w||!(0,h.a)(90293,t))&&function(e,t){return!(1!==(0,h.c)(90316,e))}(t));return A=function(){return n},n};new a.hK({name:"isOpenSharedFolderInPeopleEnabled",factory:{dependencies:E,create:function(e){return{instance:function(){return A(e)}}}}});var L=n(356),k=n(120),M=n(41),P=n(93),T=[".aspx",".ascx",".master",".xsf",".xap",".swf",".jar",".asmx",".htc",".ashx",".json",".soap",".svc",".xamlx"];const U=function(){function e(){}return e.isAllowed=function(e){return!(T.indexOf(e.toLocaleLowerCase())>=0)},e}();var F=n(126),H=n(129),R=n(180),N=n(417),B=n(86),j=!a.HW.isActivated("CDDAA141-CBD4-42B5-B007-A9A9340B8D9F"),V=new a.hK({name:"addDefaultParentViewOnViewerOpenUrls.key",factory:new a.t_(!1)}),z=!a.HW.isActivated("960440C4-4144-497B-83AA-14E753E48334"),G="wopiframe.aspx",K="doc.aspx",W={ODB:!p.b},q={ODB:!p.b||1413},Q={ODB:1080},Y={ODB:1064},J={platformDetection:B.a,isOneDriveHomeEnabled:m,isPeopleEnabled:_,isInlineOneDriveSharedFolderEnabled:x.optional,isOpenSharedFolderInPeopleEnabled:C.optional,addDefaultParentViewOnViewerOpenUrls:V.optional},X=new a.hK({name:"GetDefaultClickUrl",factory:{dependencies:J,create:function(e){var t=e.isPeopleEnabled,n=e.isInlineOneDriveSharedFolderEnabled,i=e.isOpenSharedFolderInPeopleEnabled,o=e.addDefaultParentViewOnViewerOpenUrls;return{instance:function(m){var _=m.defaultRootItemId,b=m.pageContext,g=m.isDocSet,y=m.listId,S=m.listItemId,D=m.itemKey,I=m.itemType,x=m.itemList,C=m.itemOpenUrl,O=m.itemOpenInOfficeOnlineUrl,E=m.itemPreviewIFrameUrl,A=m.itemQueryType,T=m.itemOfficeBundle,B=m.itemContentTypeId,V=m.itemUrls,z=m.itemUrlHelper,J=m.itemSubsite,X=m.itemExtension,ee=m.itemFSObjType,te=m.itemTranslationLanguages,ne=m.isUnifiedAppSupportedFile,ae=m.welcomePageCustomized,ie=m.viewParams,re=m.parentItemKey,oe=m.parentItemLink,se=m.supportsOneUp,ce=m.urlType,de=void 0===ce?"default":ce,le=m.additionalViewParams,ue=m.driveType,fe=m.isRootFolder,pe=m.isItemInOtherUsersOneDrive,me=m.mySiteOwner,_e=m.page,he=void 0===_e?(0,R.f)(ie):_e,be=(0,R.e)(D),ge=(0,R.c)({key:D,viewParams:ie,defaultRootItemId:_});le&&(0,H.a)(ge,le);var ve,ye=(0,r.W_)({},ge),Se=m.getMediaUrl||function(){return Z({itemKey:D,parentItemKey:re,params:ye,supportsOneUp:se,itemUrlHelper:z,page:he,addDefaultParentViewOnViewerOpenUrls:o})},De=!!p.c&&(0,v.a)(W),Ie=!p.c||(0,v.a)(q),xe=(0,p.e)(),Ce=ue===N.a.business,Oe=he===P.a.FilePicker||he===P.a.FileBrowser;Oe&&(ge[M.b.pageParamKey]=he);var we=be[M.b.queryTypeParamKey];if((!we||Number(we)===k.a.Files)&&e.isOneDriveHomeEnabled()&&(ge[M.b.queryTypeParamKey]=k.a.Files),he===P.a.FilePicker&&I!==L.a.Folder)return"";if(A&&(0,R.i)(A)&&!(0,R.i)((0,R.g)(be)))return"";var Ee=z.getItemUrlParts(D),Ae="focus"===de&&!(T&&Ee.isCrossDomain)||(0,v.a)(Q)&&A===k.a.SharedWithMe&&T&&p.b,Le=Ee.fullItemUrl,ke="current"===de?L.a.Folder:"external"===de?L.a.Unknown:I;if(delete ge[M.b.noAuthRedirect],(0,R.b)(ie)&&"existing"===de||Ae)ve=Se();else if(ne)ve=O||"";else if(T&&T.enableDefaultClick)ve=Se();else switch(ke){case L.a.Media:ve=Se();break;case L.a.Folder:var Me=De,Pe=Ee.geoRelation!==s.a.sameGeo;if(delete ge[M.b.navParamKey],delete ge[M.b.viewerKey],p.b&&!xe&&Ee.isCrossList)return"";if(!Oe&&J&&(Pe||J.isExternal)&&!Me)return J.serverRelativeUrl;if(!Oe&&x&&(Pe||x.isExternal)&&!Me)return Ee.fullItemUrl||"";if(g&&(!Ie||ae))return C||"";if(Oe||!Ee.isCrossList&&Ee.siteRelation===s.d.sameSite||Number(b.webTemplate)===d.b.mySite&&b.isNoScriptEnabled&&Ee.isCrossDomain&&!Ce&&(!Pe||Me))fe&&me&&pe&&t()&&(null==n?void 0:n())&&(ge[M.b.emailIdKey]=me,ge[M.b.queryTypeParamKey]=k.a.People),ve="#".concat((0,c.a)(ge,void 0,!1));else if(pe&&(!w&&(0,h.a)(90293,b)||(null==i?void 0:i())))fe&&me&&t()&&(null==n?void 0:n())&&(ge[M.b.emailIdKey]=me,ge[M.b.queryTypeParamKey]=k.a.People),ve="#".concat((0,c.a)(ge,void 0,!1));else if(ge[M.b.remoteItem])ve="#".concat((0,c.a)(ge));else{if(C&&(Te=new l.a(C)).getScheme()){ve=C;break}ve=f.a(Ee.fullItemUrl||"")}break;case L.a.Shortcut:ve=V&&V[u.b.shortcutTarget]||C||"";break;case L.a.File:if(X&&(0,F.a)(X,ke))ve=he===P.a.TextFileEditor&&U.isAllowed(X||"")?function(e){var t=e.itemKey,n=e.parentItemKey,i=e.parentItemLink,r=e.viewParams,o=e.supportsOneUp,s=e.defaultRootItemId,d=e.addDefaultParentViewOnViewerOpenUrls,l=(0,R.c)({key:t,viewParams:r,defaultRootItemId:s}),u=(0,a.k1)(n||""),f=u[M.b.idParamKey];if("root"===f){var p=(0,a.k1)(t)[M.b.listUrlKey];p&&(f=p)}if(l[M.b.parentIdParamKey]=f,j){var m=d?k.a.Files:void 0,_=u[M.b.queryTypeParamKey]||m;void 0!==_&&(l[M.b.parentQueryTypeParamKey]=_)}else l[M.b.parentQueryTypeParamKey]=u[M.b.queryTypeParamKey];l[M.b.pageParamKey]=P.a.TextFileEditor,delete l[M.b.queryTypeParamKey];var h="";return!o&&i?(delete l[M.b.parentQueryTypeParamKey],h=i,"".concat(i,"?").concat((0,c.a)(l,void 0,!0))):(Number(r[M.b.pageParamKey])!==P.a.TextFileEditor&&(h=(0,R.a)()+window.location.pathname),"".concat(h,"#").concat((0,c.a)(l,void 0,!0)))}({itemKey:D,parentItemKey:re,parentItemLink:oe,viewParams:ie,supportsOneUp:se,defaultRootItemId:_,addDefaultParentViewOnViewerOpenUrls:o}):Se();else if(te&&te.length>0||function(e){return!!e&&e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B")>-1}(B)){var Te;C?((Te=new l.a(C)).setQueryParameter("stay","true"),ve=Te.toString()):ve=""}else if((0,v.a)(Y)&&$(C,Le)){if(".aspx"==="".concat(X).toLowerCase()&&C)return C;ve=Se()}else ve=C||D&&"#"+D;break;default:ve=(0,v.a)(Y)&&$(C,Le)&&X?Se():C||D&&"#"+D}if(y&&(ke===L.a.File&&E&&(-1!==E.toLowerCase().indexOf(G)||-1!==E.toLowerCase().indexOf(K))||ke===L.a.OneNote)){var Ue=new l.a(ve);Ue.getLastPathSegment().toLowerCase()!==G&&Ue.getLastPathSegment().toLowerCase()!==K||(Ue.setQueryParameter("1"===ee?"IsFolder":"IsList","1"),Ue.setQueryParameter("ListId",y),Ue.setQueryParameter("ListItemId",S||""),ve=Ue.toString())}return function(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e}(ve)}}}}});function Z(e){var t,n=e.itemKey,i=e.params,r=void 0===i?{}:i,o=e.parentItemKey,s=e.supportsOneUp,d=e.itemUrlHelper,l=e.page,u=e.addDefaultParentViewOnViewerOpenUrls;if(!s){var f=d.getItemUrlParts(n),p=f.serverRelativeItemUrl||"",m=((t={})[M.b.idParamKey]=p,t[M.b.parentIdParamKey]=p.substring(0,p.lastIndexOf("/")),t);return"".concat(f.fullListUrl,"?").concat((0,c.a)(m,void 0))}var _=(0,a.k1)(o||"");r[M.b.parentIdParamKey]=_[M.b.idParamKey];var h=(0,R.h)(r);if(h){var b=h.mountPoint,g=h.remoteSpItem;if(g){var v={mountPoint:b,remoteSpItem:{listFullUrl:g.listFullUrl,rootFolder:_[M.b.idParamKey],webAbsoluteUrl:g.webAbsoluteUrl}};(0,H.a)(r,(0,R.j)(v))}}if(j){var y=u?k.a.Files:void 0,S=_[M.b.queryTypeParamKey]||y;void 0!==S&&(r[M.b.parentQueryTypeParamKey]=S)}else r[M.b.parentQueryTypeParamKey]=_[M.b.queryTypeParamKey];for(var D in delete _[M.b.idParamKey],delete _[M.b.queryTypeParamKey],delete _[M.b.uniqueParamKey],r){var I=r[D];(null==I||""===I&&D.indexOf("FilterValue")<0)&&delete r[D]}return l&&l!==P.a.Files&&(r[M.b.pageParamKey]="".concat(l)),"#"+(0,c.a)(r,_,!1)}function $(e,t){return z?function(e,t){if(z){if(!e||!t)return!1;try{if((0,o.a)(e)===t)return!0}catch(e){}try{if(e===t||e===(0,o.a)(t))return!0}catch(e){}return!1}return e===(t&&f.a(t))}(e,t):!(!e||!t||(0,o.a)(e)!==(0,o.a)(t))}function ee(e){var t=function(e,t){var n=e.appMap?e.appMap.toLowerCase():void 0;return"ms-powerpoint"===n||"ms-word"===n||"ms-visio"===n||"ms-excel"===n||!1}(e);return t&&function(e){return!!(e&&e.openUrl&&e.appMap)}(e)&&!a.Tb.isFeatureEnabled({ODB:826,OneDrive:!0})}new Set(["WacFailed.DocumentIsIRMProtected","WacFailed.5243086","WacFailed.5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]);var te=n(25),ne=n(52),ae=n(218),ie=n(418),re=ie.b.protocolCommand,oe=n(419),se=n(138),ce=n(137),de=function(){function e(e,t){this._pageContext=t.pageContext,this._navigation=t.navigation,this._itemUrlHelper=t.itemUrlHelper,this._getDefaultClickUrl=t.getDefaultClickUrl,this._platform=t.platform,this._isFastOneUp=t.isFastOneUp,this._addDefaultParentViewOnViewerOpenUrls=t.addDefaultParentViewOnViewerOpenUrls}return e.prototype.getDefaultClickUrlForOneUp=function(e,t){var n,a,i,r=this;if(!e||!e.key)return"";var o=this._navigation.viewParams,s=null==t?void 0:t.parentItem,c=(0,R.f)(o),d=this._itemUrlHelper.getItemUrlParts("").serverRelativeItemUrl||"",l=(0,R.c)({key:e.key,viewParams:o,defaultRootItemId:d}),u={itemKey:e.key,viewParams:o,itemUrlHelper:this._itemUrlHelper,pageContext:this._pageContext,isDocSet:e.isDocSet,listId:this._pageContext.listId,listItemId:e.properties&&e.properties.ID,itemType:e.type,itemList:e.list,itemOpenUrl:e.openUrl,itemPreviewIFrameUrl:e.previewIFrameUrl,itemQueryType:e.queryType,itemOfficeBundle:e.officeBundle,itemContentTypeId:e.contentTypeId,itemUrls:e.urls,itemSubsite:void 0,itemExtension:e.extension,itemFSObjType:null===(n=e.properties)||void 0===n?void 0:n.FSObjType,itemTranslationLanguages:null===(a=e.properties)||void 0===a?void 0:a._SPTranslatedLanguages,isUnifiedAppSupportedFile:ee(e),welcomePageCustomized:null===(i=e.properties)||void 0===i?void 0:i.WelcomePageCustomized,getMediaUrl:function(){return Z({itemKey:e.key,parentItemKey:null==s?void 0:s.key,params:l,supportsOneUp:!0,itemUrlHelper:r._itemUrlHelper,page:c,addDefaultParentViewOnViewerOpenUrls:r._addDefaultParentViewOnViewerOpenUrls})},parentItemKey:s&&s.key,supportsOneUp:!0,urlType:null==t?void 0:t.urlType,defaultRootItemId:d,page:c},f=this._getDefaultClickUrl(u);return this._isFastOneUp&&(f=f.replace("#","?")),f},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,i,r,o,s,c,d,l,u=e.appMap,f=e.properties&&e.properties.path||this.getItemUrl(e.key),p=e.extension||"",m=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf(p.toLowerCase()),_=e.queryType===k.a.SharedWithMe&&("ms-word"===e.appMap||"ms-powerpoint"===e.appMap);return r=u,o=f,s=ne.a.hasItemPermission(e,ne.a.editListItems)&&!m&&(!ae.c(e)||ae.b(e,this._pageContext.userId))||_?re.Edit:re.View,c=(null===(a=this._platform)||void 0===a?void 0:a.isChrome)&&(null===(i=this._platform)||void 0===i?void 0:i.isMac),d=this._pageContext.isSPO,l=ie.a.none,c&&(l=ie.a.encodeCommand),ie.b.createProtocolHandlerUrl(r,o,s,"",l,d)},e.prototype.getKey=function(e){return(0,R.d)(e)},e.prototype.getItemUrl=function(e){void 0===e&&(e="");var t=this._itemUrlHelper.getItemUrlParts(e);return f.a((null==t?void 0:t.fullItemUrl)||"")},e.prototype.getOpenInOfficeOnlineUrl=function(e,t){var n,a=e;return n=ee(e)?oe.a.GetWopiDocEditUrl(a,t||"",this._pageContext.env):oe.a.GetWopiFrameEditUrl(a),this._ensureLayouts15(n||e.openUrl||"")},e.prototype.getApiBaseUrl=function(e){var t="v2.1"===(null==e?void 0:e.apiVersion)?e.apiVersion:"v2.0";return"".concat((0,ce.b)(this._pageContext),"/_api/").concat(t)},e.prototype.getKeyParams=function(e){return(0,R.e)(e)},e.prototype.getPageType=function(e){return(0,R.f)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),(0,R.g)(e)},e.prototype._ensureLayouts15=function(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e},e.dependencies={navigation:i.a,pageContext:g.a,resources:a.Ci,itemUrlHelper:te.c,getDefaultClickUrl:X,platform:B.a,isFastOneUp:se.c.optional,addDefaultParentViewOnViewerOpenUrls:V.optional},e}();const le=de;var ue=(0,a.c7)("OneUpUrlDataSource",de)}
,(e,t,n)=>{"use strict";var a;function i(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){return!1}}function r(){return void 0===a&&(a=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||i()),a}n.d(t,{a:()=>i,b:()=>r})}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s,c:()=>i,d:()=>o,e:()=>r});var a=n("odsp.util_118"),i=(n(5),new a.hK("ResourceKeys")),r=new a.hK("ResourceKeys"),o=new a.hK("ResourceKeys"),s=new a.hK("ResourceKeys"),c=new a.hK("ResourceKeys")}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p,b:()=>m,c:()=>f,d:()=>a,e:()=>i,f:()=>c,g:()=>h,h:()=>r,i:()=>_,j:()=>u,k:()=>l,l:()=>o,m:()=>s,n:()=>d});var a,i,r="OneUpLightSpeed.fastOneUp.boot",o="OneUpLightSpeed.fastOneUp.getSingleItem",s="OneUpLightSpeed.getSingleItem.preloadRLDSData",c="OneUpLightSpeed.getSingleItem.callRLDS_gListDataInvalid",d="OneUpLightSpeed.getSingleItem.race.callRLDS",l="OneUpLightSpeed.fastOneUp.getSingleItemFavoriteStatus",u="OneUpLightSpeed.getSingleItem.ensureParentItem",f=3e5,p=12e4,m=12e4;function _(e,t){var n=new Error(e);return n.name=t||e,n}function h(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return"".concat(1<<t%10,"-").concat(1<<t%10+1).concat(t<10?" B":" ".concat("KMGTPEZY"[t/10-1|0],"iB"))}!function(e){e.rldsApiError="rldsApiError",e.viewerInitLoadingError="viewerInitLoadingError",e.genericViewerLoadingError="genericViewerLoadingError",e.actionError="actionError",e.reactRenderError="reactRenderError",e.processOneUpItemError="processOneUpItemError",e.rldsApiErrorNoAccess="rldsApiErrorNoAccess"}(a||(a={})),function(e){e.inlineOneUpFirstPage="inlineOneUpFirstPage",e.inlineOneUpSlide="inlineOneUpSlide",e.fastOneUp="fastOneUp"}(i||(i={}))}
,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("tslib_826"),i=n(246),r=function(){var e=i.b,t=e.palette,n=e.semanticColors,r="".concat(n.buttonBackground," !important"),o="".concat(n.buttonBackgroundHovered," !important"),s="".concat(n.buttonBackgroundPressed," !important"),c="".concat(n.buttonBorder," !important"),d={background:r,paddingLeft:"8px",paddingRight:"8px",margin:"auto 6px auto 6px",color:t.black,height:"32px",width:"auto",border:"1px solid ".concat(c),".ms-Button-menuIcon":{marginTop:"2px",color:t.black},".ms-Button-flexContainer":{backgroundColor:"transparent !important"}};return{root:(0,a.W_)({},d),rootHovered:(0,a.W_)((0,a.W_)({cursor:"pointer"},d),{background:o}),rootPressed:{background:s},rootExpanded:(0,a.W_)({backgroundColor:r},d),rootCheckedHovered:(0,a.W_)((0,a.W_)({cursor:"pointer"},d),{background:o}),rootCheckedPressed:(0,a.W_)((0,a.W_)({},d),{background:s}),rootExpandedHovered:{background:o,cursor:"pointer"},flexContainer:{color:t.black,width:"auto"},icon:{color:t.black}}}}
,(e,t,n)=>{"use strict";var a,i;function r(){a=self._pdfSessionPerfMarks=[]}function o(){return void 0===i&&(i=void 0!==typeof performance&&!!performance&&"function"==typeof performance.mark&&"function"==typeof performance.clearMarks&&"function"==typeof performance.now),i}function s(){return"undefined"!=typeof MSPDF_PERF_LAB&&MSPDF_PERF_LAB}n.d(t,{a:()=>c});var c=function(){function e(){}return e.initialize=function(t){var n=t.markNamePrefix;e._markNamePrefix=n||"",r()},e.mark=function(t){e._mark(t)},e.debugMark=function(t){s()&&e._mark(t)},e.getMarkerTime=function(t,n){if(void 0===n&&(n=!0),!o())return NaN;var a=n?e.addPrefix(t):t,i=performance.getEntriesByName(a,"mark");return(null==i?void 0:i.length)>0?Math.round(i[0].startTime):NaN},e.getDurationBetweenMarks=function(t,n){return e.getMarkerTime(n)-e.getMarkerTime(t)},e.enterPerfTestSession=function(e){s()&&(this._curSessionName=e,this._sessionId+=1)},e.sessionMark=function(t,n){if(s()){var i={stage:t,startTime:o()?performance.now():Date.now(),extraData:n},r=e.sessionMarkName,c=a,d=c.find(function(e){return e.name===r});d?d.data.push(i):c.push({name:r,data:[i]})}},e.getSessionMarkerData=function(){var t=e.sessionMarkName,n=a.find(function(e){return e.name===t});return null==n?void 0:n.data},e.clearMarks=function(t){if(o()){var n=[];t&&(n=t.map(e.addPrefix)),performance.getEntriesByType("mark").filter(function(t){return n.length>0?n.indexOf(t.name)>=0:0===t.name.lastIndexOf(e.namePrefix,0)}).forEach(function(e){performance.clearMarks(e.name)}),r()}},e.addPrefix=function(t){var n=e.namePrefix;return 0===t.lastIndexOf(n,0)?t:n+t},e._mark=function(t){if(o()){var n=e.addPrefix(t);performance.mark(n)}},Object.defineProperty(e,"namePrefix",{get:function(){return e._markNamePrefix+"MsPdf."},enumerable:!1,configurable:!0}),Object.defineProperty(e,"sessionMarkName",{get:function(){return e.addPrefix("".concat(e._curSessionName,"_").concat(this._sessionId))},enumerable:!1,configurable:!0}),e._markNamePrefix="",e._curSessionName="Unknown",e._sessionId=-1,e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n("tslib_826"),i={UseGlobalToast:"b5c77de1-1f64-4e72-9234-00da9aea2ae5",UseBlobForStringLength:"510d7ace-c669-4a2c-b87c-17de82da37b3",StoreDisplayInfoInLocalStorage:"5cf5258d-9b8f-4adb-b082-780ea098f985",UseGripperSelectText:"87777701-6913-40b9-bb10-4b86c005fbdf",CheckWorkerVersion:"4d99680d-88bd-4dff-99a1-7e3eebd51734",UseSizeObserver:"66c17183-e7b2-4755-a82e-a9a2c20f5d16",FixExtraWhitePage:"d7f8d50e-be04-4553-b457-04fac12fe1a8",UseExternalCidFont:"dc778e1c-946e-42b2-a4f8-5fd70cde9539",ExposePdfPermission:"80de8c7c-3044-47fc-8f25-f7e557672b3e",DeprecateOldFileHandler:"5f020187-e12b-401d-9c8a-efdc86e27790",StoreFreeTextAttributeInLocalStorage:"24019b2e-df14-4d7f-9fb4-04dbe0ce8933"},r=function(){function e(){}return e.initialize=function(t){var n,r;e.activatedKillSwitches=[];try{for(var o=(0,a.OY)(Object.keys(i)),s=o.next();!s.done;s=o.next()){var c=s.value,d=i[c];t(d)&&e.activatedKillSwitches.push(d)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.isActivated=function(t){var n=i[t];return e.activatedKillSwitches.includes(n)},Object.defineProperty(e,"activatedKillSwitches",{get:function(){return e._activatedKillSwitches},set:function(t){e._activatedKillSwitches=t},enumerable:!1,configurable:!0}),e._activatedKillSwitches=[],e}(),o=r.initialize}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p,b:()=>_,c:()=>m,d:()=>g,e:()=>b,f:()=>x,g:()=>c,h:()=>s,i:()=>o,j:()=>d,k:()=>l,l:()=>u,m:()=>C,n:()=>D,o:()=>S,p:()=>v,q:()=>I,r:()=>y,s:()=>f,t:()=>h,u:()=>i,v:()=>a,w:()=>r});var a=.5,i=5,r=90,o=14,s=3,c=7,d=5,l=5,u=150,f=96,p=100,m=1,_=255,h=1e8,b=255,g="MsPdfViewer.CACHED_DISPLAY_INFO_ARRAY_STORE_KEY",v={r:0,g:81,b:186,a:1},y=1.12,S=-1,D=0,I="freeTextInitialAttributes",x=5242880,C=5242880}
,(e,t)=>{"use strict";var n,a,i,r;if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var d=null,l=null,u=function(){if(null!==d)try{var e=t.unstable_now();d(!0,e),d=null}catch(e){throw setTimeout(u,0),e}};n=function(e){null!==d?setTimeout(n,0,e):(d=e,setTimeout(u,0))},a=function(e,t){l=setTimeout(e,t)},i=function(){clearTimeout(l)},t.unstable_shouldYield=function(){return!1},r=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var m=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var _=!1,h=null,b=-1,g=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},r=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):g=0<e?Math.floor(1e3/e):5};var y=new MessageChannel,S=y.port2;y.port1.onmessage=function(){if(null!==h){var e=t.unstable_now();v=e+g;try{h(!0,e)?S.postMessage(null):(_=!1,h=null)}catch(e){throw S.postMessage(null),e}}else _=!1},n=function(e){h=e,_||(_=!0,S.postMessage(null))},a=function(e,n){b=f(function(){e(t.unstable_now())},n)},i=function(){p(b),b=-1}}function D(e,t){var n=e.length;e.push(t);e:for(;;){var a=n-1>>>1,i=e[a];if(!(void 0!==i&&0<C(i,t)))break e;e[a]=t,e[n]=i,n=a}}function I(e){return void 0===(e=e[0])?null:e}function x(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,i=e.length;a<i;){var r=2*(a+1)-1,o=e[r],s=r+1,c=e[s];if(void 0!==o&&0>C(o,n))void 0!==c&&0>C(c,o)?(e[a]=c,e[s]=n,a=s):(e[a]=o,e[r]=n,a=r);else{if(!(void 0!==c&&0>C(c,n)))break e;e[a]=c,e[s]=n,a=s}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var O=[],w=[],E=1,A=null,L=3,k=!1,M=!1,P=!1;function T(e){for(var t=I(w);null!==t;){if(null===t.callback)x(w);else{if(!(t.startTime<=e))break;x(w),t.sortIndex=t.expirationTime,D(O,t)}t=I(w)}}function U(e){if(P=!1,T(e),!M)if(null!==I(O))M=!0,n(F);else{var t=I(w);null!==t&&a(U,t.startTime-e)}}function F(e,n){M=!1,P&&(P=!1,i()),k=!0;var r=L;try{for(T(n),A=I(O);null!==A&&(!(A.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=A.callback;if("function"==typeof o){A.callback=null,L=A.priorityLevel;var s=o(A.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?A.callback=s:A===I(O)&&x(O),T(n)}else x(O);A=I(O)}if(null!==A)var c=!0;else{var d=I(w);null!==d&&a(U,d.startTime-n),c=!1}return c}finally{A=null,L=r,k=!1}}var H=r;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){M||k||(M=!0,n(F))},t.unstable_getCurrentPriorityLevel=function(){return L},t.unstable_getFirstCallbackNode=function(){return I(O)},t.unstable_next=function(e){switch(L){case 1:case 2:case 3:var t=3;break;default:t=L}var n=L;L=t;try{return e()}finally{L=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=H,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=L;L=e;try{return t()}finally{L=n}},t.unstable_scheduleCallback=function(e,r,o){var s=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:E++,callback:r,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>s?(e.sortIndex=o,D(w,e),null===I(O)&&e===I(w)&&(P?i():P=!0,a(U,o-s))):(e.sortIndex=c,D(O,e),M||k||(M=!0,n(F))),e},t.unstable_wrapCallback=function(e){var t=L;return function(){var n=L;L=t;try{return e.apply(this,arguments)}finally{L=n}}}}
,(e,t,n)=>{var a=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,l=c||d||Function("return this")(),u=Object.prototype.toString,f=Math.max,p=Math.min,m=function(){return l.Date.now()};function _(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function h(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(_(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=_(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=r.test(e);return n||o.test(e)?s(e.slice(2),n?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var a,i,r,o,s,c,d=0,l=!1,u=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var n=a,r=i;return a=i=void 0,d=t,o=e.apply(r,n)}function v(e){return d=e,s=setTimeout(S,t),l?g(e):o}function y(e){var n=e-c;return void 0===c||n>=t||n<0||u&&e-d>=r}function S(){var e=m();if(y(e))return D(e);s=setTimeout(S,function(e){var n=t-(e-c);return u?p(n,r-(e-d)):n}(e))}function D(e){return s=void 0,b&&a?g(e):(a=i=void 0,o)}function I(){var e=m(),n=y(e);if(a=arguments,i=this,c=e,n){if(void 0===s)return v(c);if(u)return s=setTimeout(S,t),g(c)}return void 0===s&&(s=setTimeout(S,t)),o}return t=h(t)||0,_(n)&&(l=!!n.leading,r=(u="maxWait"in n)?f(h(n.maxWait)||0,t):r,b="trailing"in n?!!n.trailing:b),I.cancel=function(){void 0!==s&&clearTimeout(s),d=0,a=c=i=s=void 0},I.flush=function(){return void 0===s?o:D(m())},I}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>a,c:()=>l,d:()=>u});var a,i=n("tslib_826"),r=n("react-lib");!function(e){e.Hidden="hidden",e.Running="running",e.Success="success",e.Error="error",e.Info="info"}(a||(a={}));var o=function(e,t){switch(t.type){case a.Hidden:return{type:t.type,text:"",link:"",linkText:"",percentComplete:0};case a.Success:return{type:t.type,text:t.text,link:t.link,linkText:t.linkText,percentComplete:1,onClickButton:t.onClickClose};case a.Error:return{type:t.type,text:t.text,link:"",linkText:"",percentComplete:0,onClickButton:t.onClickClose};case a.Info:return{type:t.type,text:t.text,infoIconName:t.infoIconName,shouldAutoFocus:t.shouldAutoFocus,onClickButton:t.onClickClose};default:case a.Running:return{type:t.type,text:t.text,link:"",linkText:"",percentComplete:t.percentComplete,onClickButton:t.onClickExpand}}},s={type:a.Hidden,text:"",link:"",linkText:"",percentComplete:0,onClickButton:function(){}},c=r.createContext(s),d=r.createContext(function(){}),l=function(){return r.useContext(c)},u=function(){return r.useContext(d)},f=function(e){var t=e.children,n=(0,i.MS)(r.useReducer(o,s),2),a=n[0],l=n[1];return r.createElement(c.Provider,{value:a},r.createElement(d.Provider,{value:l},t))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>I,b:()=>y,c:()=>g,d:()=>v,e:()=>i.k1,f:()=>S,g:()=>u.b,h:()=>p,i:()=>D,j:()=>m});var a=n("tslib_826"),i=n("odsp.util_118"),r=n(26),o=n(129),s=n(93),c=n(120),d=n(41),l=n(40),u=n(183),f=n(215);function p(e){var t=e[f.a];if(t){var n=JSON.parse("".concat(t||""));return{mountPoint:n.mp,remoteSpFolderById:n.rsf,remoteSpItem:n.rsi}}}function m(e){var t;if(!e)return{};var n={mp:e.mountPoint,rsf:e.remoteSpFolderById,rsi:e.remoteSpItem};return(t={})[f.a]=JSON.stringify(n),t}var _={ODB:60210},h={ODB:!i.HW.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event.")},b=(0,l.a)(h);function g(e){var t=e.defaultRootItemId,n=e.viewParams,r=e.listUrl,s=e.viewId,l=e.key,f=(0,i.k1)(l),p=(0,a.W_)({},n);delete p[d.b.idParamKey],delete p[d.b.rootFolderParamKey],delete p[d.b.queryTypeParamKey],delete p[d.b.queryParamKey],delete p[d.b.listUrlKey],i.HW.isActivated("0405907e-3935-4959-bd2c-b5a5b89f8acb","09/09/2022","preserve search filters in oneUp and exiting oneUp in odb, return to search when exiting oneUp in odb/spo")||(delete p[d.b.dateFilterKey],delete p[d.b.userFiltersKey]),delete p[d.b.typeFiltersKey],delete p[d.b.remoteItem],delete p[d.b.sortFieldKey],delete p[d.b.groupByKey],delete p[d.b.viewIdKey],delete p[d.b.personIdKey],delete p[d.b.meetingIdKey],delete p[d.b.emailIdKey];for(var m=0,_=Object.keys(n);m<_.length;m++){var h=_[m];d.c.test(h)&&delete p[h]}return delete p[d.b.searchScopeKey],delete p[d.b.disableQueryAlterationKey],delete p[d.b.itemId],delete p[d.b.playlistLayout],(0,o.a)(p,f),delete p[d.b.parentIdParamKey],delete p[d.b.parentQueryTypeParamKey],delete p[d.b.pageParamKey],delete p[d.b.sharedLibraryCreated],f[d.b.idParamKey]===t&&(delete p[d.b.idParamKey],delete p[d.b.rootFolderParamKey]),i.HW.isActivated("81A798A6-1C14-40C3-BD52-2A60351DCF87","11/8/2021","Only preserve view id when navigating within same list")&&(p[d.b.listUrlKey]===n[d.b.listUrlKey]&&(0,u.b)(f)===c.a.Files&&(s||"").replace("{","").replace("}","")!==p[d.b.viewIdKey]||delete p[d.b.viewIdKey],p[d.b.newTargetListUrlKey]===r&&(delete p[d.b.newTargetListUrlKey],delete p[d.b.viewPathKey])),delete p[d.b.uniqueParamKey],b&&(delete p[d.b.callerId],delete p[d.b.callerScenarioId]),p}function v(e,t){var n,a=Number(e[d.b.queryTypeParamKey])||c.a.Files,i=((n={})[d.b.idParamKey]=e[d.b.idParamKey]||t||"",n[d.b.driveIdParamKey]=e[d.b.driveIdParamKey]||"",n[d.b.driveEndpointParamKey]=e[d.b.driveEndpointParamKey]||"",n[d.b.listUrlKey]=e[d.b.listUrlKey]||"",n[d.b.queryTypeParamKey]="".concat(a||""),n[d.b.queryParamKey]=e[d.b.queryParamKey]||"",n[d.b.typeFiltersKey]=e[d.b.typeFiltersKey]||"",n[d.b.userFiltersKey]=e[d.b.userFiltersKey]||"",n[d.b.dateFilterKey]=e[d.b.dateFilterKey]||"",n[d.b.uniqueParamKey]=e[d.b.uniqueParamKey]||"",n[d.b.disableQueryAlterationKey]=(0,l.a)(_)&&e[d.b.disableQueryAlterationKey]||"",n[d.b.metadataSearchIdKey]=e[d.b.metadataSearchIdKey]||"",n);return e[d.b.searchScopeKey]&&(i[d.b.searchScopeKey]=e[d.b.searchScopeKey]||""),(0,r.a)(i,void 0,!0)}function y(e){var t,n=e[d.b.parentIdParamKey],a=e[d.b.parentQueryTypeParamKey];return(n||a)&&((t={})[d.b.idParamKey]=e[d.b.idParamKey],t[d.b.listUrlKey]=e[d.b.listUrlKey],a&&(t[d.b.queryTypeParamKey]=e[d.b.queryTypeParamKey])),t?(0,r.a)(t,void 0,!0):""}function S(e,t){var n=Number(e[d.b.pageParamKey]);switch(n){case s.a.FilePicker:case s.a.FileBrowser:case s.a.TextFileEditor:case s.a.Error:case s.a.Share:case s.a.Embed:case s.a.Restore:case s.a.Settings:case s.a.MobileAppUpsell:case s.a.FileRequest:return n}return y(e)&&t?s.a.OneUp:s.a.Files}function D(e){return e===c.a.RecycleBin||e===c.a.SecondStageRecycleBin}function I(){return window.location.protocol+"//"+window.location.host}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("itemComment")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n(184),i=n(41);function r(e){var t=e[i.b.queryTypeParamKey];return t||(t=e[i.b.parentQueryTypeParamKey]),t?Number(t):a.a.Files}const o=r}
,,,,e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,r){for(var o,s,c=i(e),d=1;d<arguments.length;d++){for(var l in o=Object(arguments[d]))n.call(o,l)&&(c[l]=o[l]);if(t){s=t(o);for(var u=0;u<s.length;u++)a.call(o,s[u])&&(c[s[u]]=o[s[u]])}}return c}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>g,b:()=>v});var a=n("tslib_826"),i=n(61),r=n(82),o=n(81),s=n(94),c=n(700),d=n(309);function l(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var n,i,r,o,s,c,d;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=e.dbName,i=e.dbVersion,r=e.storeName,[4,f(n,i,r)];case 1:return o=a.sent(),s=o.transaction([r],"readonly"),c=s.objectStore(r),d=c.get(t),[2,new Promise(function(e,n){d.onerror=function(){o.close(),n("Fail to retreive store by ".concat(t))},d.onsuccess=function(t){o.close(),e(t.target.result)}})]}})})}function u(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var n,i,r,o,s,c,d,l;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=e.dbName,i=e.dbVersion,r=e.storeName,[4,f(n,i,r)];case 1:return o=a.sent(),s=o.transaction([r],"readwrite"),c=s.objectStore(r),d=c.clear(),l=c.put(t.value,t.key),[2,new Promise(function(e,n){d.onerror=function(){o.close(),n("Fail to clear store")},l.onerror=function(){o.close(),n("Fail to update store by ".concat(t.key))},l.onsuccess=function(){o.close(),e()}})]}})})}function f(e,t,n){return(0,a.Zd)(this,void 0,void 0,function(){var i;return(0,a.qr)(this,function(a){if(!self.indexedDB)throw new Error("This browser doesn't support IndexedDB");return i=indexedDB.open(e,t),[2,new Promise(function(t,a){i.onupgradeneeded=function(){var e=i.result;e.objectStoreNames.contains(n)&&e.deleteObjectStore(n),e.createObjectStore(n)},i.onerror=function(){a("Fail to open indexeddb ".concat(e))},i.onsuccess=function(){t(i.result)}})]})})}var p=function(){function e(){}return e.dispose=function(){},e.retreive=function(e,t){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(n){return[2,l(e,t)]})})},e.update=function(e,t){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,u(e,t)];case 1:return n.sent(),[2]}})})},e}(),m={dbName:"ODSPPDF",dbVersion:1,storeName:"WASM_CACHE"},_="WasmDataProvider",h="GetWasmAsset",b="The wasmDataCache is not defined",g=function(){function e(){var e=this;this.wasmModuleInnerInitPromise={},this.initialize=function(t){if(void 0===t&&(t="Main"),!e.wasmModuleInnerInitPromise[t]){var n=s.a.wasmModuleInit.find(function(e){return e.type||"Main"===t});n&&(e.wasmModuleInnerInitPromise[t]=e.convertModuleInit(n))}},this.convertModuleInit=function(t){return(0,a.Zd)(e,void 0,void 0,function(){var e,n,s,c,l,u,f,p;return(0,a.qr)(this,function(a){switch(a.label){case 0:if(e=t.wasmUrl,n=t.noCache,s=t.wasmJsUrlOrBlob,c=t.dataUrl,l=t.type,n)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getWasmBinaryFromCache(e,l)];case 2:return u=a.sent(),[3,4];case 3:return(f=a.sent())===b?r.a.verbose(_,f):(p=new i.c(i.b.WasmCacheFailed,"Fail to work on wasm cache, reason: ".concat(f)),o.a.logError(p.toCaughtError())),[3,4];case 4:return u?[3,6]:[4,(0,d.c)(e,{credentials:"same-origin"},h)];case 5:u=a.sent(),a.label=6;case 6:return 0===u.byteLength&&o.a.logError(new i.c(i.b.WasmModuleInitFailed,"The wasm binary is empty and the module instantiation will fail, wasmUrl=".concat(encodeURIComponent(e))).toCaughtError()),[2,{wasmBinary:u,wasmJsUrlOrBlob:s,dataUrl:c,type:l}]}})})}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getModuleInnerInit=function(e){return void 0===e&&(e="Main"),this.initialize(e),this.wasmModuleInnerInitPromise[e]},e.prototype.dispose=function(){var e;this.wasmModuleInnerInitPromise={},null===(e=this.wasmDataCache)||void 0===e||e.dispose()},e.prototype.getWasmBinaryFromCache=function(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var n,l,u;return(0,a.qr)(this,function(a){switch(a.label){case 0:return s.a.disableExternalWasmCache||!(0,c.a)()&&!(0,c.b)()?[3,2]:[4,this.setExternalWasmCache()];case 1:return a.sent(),[3,3];case 2:this.wasmDataCache=p,a.label=3;case 3:if(!this.wasmDataCache)throw b;return l="".concat(t||"Main","-").concat("0.14.1"),[4,this.wasmDataCache.retreive(m,l)];case 4:return(u=a.sent())&&0!==u.byteLength?(r.a.verbose(_,"Succeed to retreive wasm cache"),n=u,[3,7]):[3,5];case 5:return r.a.verbose(_,"No up-to-date wasm cache. Try to fetch the binary at ".concat(Date.now())),[4,(0,d.c)(e,{credentials:"same-origin"},h)];case 6:n=a.sent(),r.a.verbose(_,"Succeed to fetch the binary at ".concat(Date.now(),", size: ").concat(n.byteLength,"B")),this.wasmDataCache.update(m,{key:l,value:n}).catch(function(e){var t=new i.c(i.b.WasmCacheFailed,"Fail to update wasm cache, error: ".concat(e));o.a.logError(t.toCaughtError())}),a.label=7;case 7:return[2,n]}})})},e.prototype.setExternalWasmCache=function(){return(0,a.Zd)(this,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,n.e(25).then(n.bind(n,385))];case 1:return e=t.sent(),this.wasmDataCache=e.ExternalWasmCache,[2]}})})},e}(),v=g.getInstance().initialize}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>a}),function(e){e.Reset="Reset",e.Add="Add",e.Delete="Delete",e.Unknown="Unknown"}(a||(a={}))}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)({name:"".concat("dataRequestNoRedirect.key",".dataRequestNoRedirect"),factory:{dependencies:{},create:function(){return{instance:void 0}}}})}
,,,,,,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{legacyGraphDataSourceKey:()=>_});var a=n("tslib_826"),i=n(6),r=n("odsp.util_118"),o=n(35),s=n(25),c=n(39),d=n(90),l=n(5),u=n(134),f={ODB:620},p=27e5,m=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._itemUrlHelper=t.itemUrlHelper,this._pageContext=t.pageContext,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._identityDataSource=t.identityDataSource}return e.prototype.getItemCurrentVersion=function(e,t){return(0,a.Zd)(this,void 0,i.c,function(){var n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=this.getItemUrl(e,t),i="".concat(n,"/versions?$select=id"),[4,this._sendVroomRequest(n,i,e,t||{},"versions",{})];case 1:return[2,(r=a.sent().value).length>0?r[0].id:""]}})})},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t={});var n=this._urlCache;if(!t.forceRefresh){var a=n.get(e.key)||{},o=a.url,s=a.time;if(!r.HW.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&o&&s>Date.now()-p)return i.c.wrap(o)}if(t.excludeTempAuth&&e.downloadUrlNoAuth)return i.c.resolve(e.downloadUrlNoAuth);if(e.downloadUrl&&""!==e.downloadUrl&&e.itemGeneratedTimeStamp&&Date.now()-e.itemGeneratedTimeStamp<p)return i.c.resolve(e.downloadUrl);var c=t.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,d=this.getItemUrl(e,t),l="".concat(d,"?select=id,@content.downloadUrl");return this._sendVroomRequest(d,l,e,t,"itemDownloadUrl",c).then(function(t){var a=t["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");return n.set(e.key,{url:a,time:Date.now()}),a})},e.prototype.getDownloadToken=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return t.isCrossDomain?this._identityDataSource.getSharePointToken(new o.a(t.fullItemUrl).authority).then(function(e){var t=e.accessToken,n=e.isBadger;return"".concat(n?"badger":"bearer"," ").concat(t)}):i.c.resolve(void 0)},e.prototype.getAuthenticationParams=function(e,t){var n=this,i=(t||{}).apiVersion,o=void 0===i?r.Tb.isFeatureEnabled(f)?"v2.1":"v2.0":i;return this.refreshAccessToken(e,(0,a.W_)((0,a.W_)({},t),{apiVersion:o})).then(function(){return n._getAuthenticationParamsSync(e,t)})},e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,a=void 0===n?!this._pageContext.isSPO:n,i=t.isPath,r=void 0!==i&&i,o=t.apiVersion,s=void 0===o?"v2.0":o,c=t.allowCookies,d=void 0!==c&&c,l=this._getGraphBaseUrl(e,{useDirectEndpoint:a,apiVersion:s,allowCookies:d}),u=e.graph;if(u&&u.driveId&&"root"!==u.itemId){var f=u.driveId,p=void 0===f?"me":f,m=u.itemId,_=void 0===m?"root":m;return"".concat(l,"/drives/").concat(encodeURIComponent(p)).concat("root"===_?"/root":"/items/".concat(encodeURIComponent(_))).concat(r?":":"")}var h=e.graph,b=void 0;if((p=h&&h.driveId)&&(b="".concat(l,"/drives/").concat(encodeURIComponent(p))),!b)return"";var g=this._itemUrlHelper.getItemUrlParts(e.key),v=this._itemUrlHelper.getUrlParts({path:g.serverRelativeItemUrl,listUrl:g.serverRelativeListUrl}).listRelativeItemUrl;return"".concat(b,"/root").concat(v?":/".concat(encodeURI(v)).concat(r?"":":"):"".concat(r?":":""))},e.prototype.getAccessToken=function(e,t){void 0===t&&(t={});var n=e;return"v2.1"===t.apiVersion?n&&n.graph.sessionTokenV21:n&&n.graph.sessionToken},e.prototype.refreshAccessToken=function(e,t){return void 0===t&&(t={}),i.c.resolve(this.getAccessToken(e,t))},e.prototype.getMetaPac=function(e,t){return void 0===t&&(t={}),i.c.resolve(this.getAccessToken(e,t))},e.prototype.getDownloadUrlSync=function(e,t){},e.prototype.getDriveUrl=function(e,t){return""},e.prototype._getAuthenticationParamsSync=function(e,t){var n=this.getAccessToken(e,t);if(n){var a=n.accessToken,i=n.proofToken,r={};return a&&(r.access_token=a),i&&(r.prooftoken=i),r}return{}},e.prototype._getGraphBaseUrl=function(e,t){var n=t.useDirectEndpoint,a=t.apiVersion,i=this._itemUrlHelper.getItemUrlParts(e.key),r=i.fullListUrl;if(n){if(r)return"".concat(new o.a(r).authority,"/_api/").concat(a);if(i.isCrossDomain||i.isCrossList){var s=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return"".concat(new o.a(s).authority,"/_api/").concat(a)}return this._urlDataSource.getApiBaseUrl({apiVersion:a})}return"https://graph.microsoft.com/v1.0"},e.prototype._sendVroomRequest=function(e,t,n,a,r,s){var c=this;void 0===a&&(a={});var d=this._itemUrlHelper.getItemUrlParts(n.key).isCrossDomain;a.apiName&&(r="".concat(a.apiName,".").concat(r));var l=!d;return(l?i.c.resolve(void 0):this._identityDataSource.getSharePointToken(new o.a(e).authority)).then(function(e){var n=l?void 0:e;return c._vroomDataRequestor.send({apiName:r,path:"".concat(t),accessToken:n,qosExtraData:a.qosExtraData,allowCookies:l,headers:s})})},e.dependencies={urlDataSource:u.b,itemUrlHelper:s.c,pageContext:l.a,vroomDataRequestor:d.a,identityDataSource:c.resourceKey},e}(),_=(0,r.c7)("LegacyGraphDataSource",m)}
,,(e,t,n)=>{var a="Expected a function",i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,u=d||l||Function("return this")(),f=Object.prototype.toString,p=Math.max,m=Math.min,_=function(){return u.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=o.test(e);return n||s.test(e)?c(e.slice(2),n?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(a);return h(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),function(e,t,n){var i,r,o,s,c,d,l=0,u=!1,f=!1,g=!0;if("function"!=typeof e)throw new TypeError(a);function v(t){var n=i,a=r;return i=r=void 0,l=t,s=e.apply(a,n)}function y(e){return l=e,c=setTimeout(D,t),u?v(e):s}function S(e){var n=e-d;return void 0===d||n>=t||n<0||f&&e-l>=o}function D(){var e=_();if(S(e))return I(e);c=setTimeout(D,function(e){var n=t-(e-d);return f?m(n,o-(e-l)):n}(e))}function I(e){return c=void 0,g&&i?v(e):(i=r=void 0,s)}function x(){var e=_(),n=S(e);if(i=arguments,r=this,d=e,n){if(void 0===c)return y(d);if(f)return c=setTimeout(D,t),v(d)}return void 0===c&&(c=setTimeout(D,t)),s}return t=b(t)||0,h(n)&&(u=!!n.leading,o=(f="maxWait"in n)?p(b(n.maxWait)||0,t):o,g="trailing"in n?!!n.trailing:g),x.cancel=function(){void 0!==c&&clearTimeout(c),l=0,i=d=r=c=void 0},x.flush=function(){return void 0===c?s:I(_())},x}(e,t,{leading:i,maxWait:t,trailing:r})}}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("odsp.util_118"),i=n(134),r=new a.hK({name:"oneUpUrlDataSource",factory:new a.bx(i.a)})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a="remoteItem"}
,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(19);function i(){var e=window.ONEUPTELEMETRY_MANAGER=window.ONEUPTELEMETRY_MANAGER||(0,a.c)({sourceName:"OneUp"});return(0,a.d)(e)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_118");function i(){return!a.HW.isActivated("64BB7792-D4C7-4D09-9465-0C4838EA4CEA")&&a.Tb.isFeatureEnabled({ODB:61359})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>O});var a,i=n("tslib_826"),r=n(141),o=n("odsp.util_118"),s=n(86),c=n(100),d=new o.hK("pdfViewerEmbedOptions"),l=n(93),u=n(28),f=n(229),p=n(49),m=n(5),_=n(89),h=n(52),b=function(e){function t(t,n){var a=e.call(this)||this;return a._pageContext=n.pageContext,a}return(0,i.XJ)(t,e),t.prototype.canSaveAsOriginal=function(e){var t,n,a=e.item;return!!a&&h.a.hasItemPermission(a,h.a.insertListItems)&&h.a.hasItemPermission(a,h.a.editListItems)&&!(null===(t=this._pageContext)||void 0===t?void 0:t.isAnonymousGuestUser)&&!(null===(n=this._pageContext)||void 0===n?void 0:n.isEmailAuthenticationGuestUser)},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}()),g=(0,o.c7)("PdfDataSource",b,{pageContext:m.a.optional}),v=n(230),y=function(e){var t,n,a,i;if(!e)return!1;var r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},S=function(e){return y(e)},D=n(175);!function(e){e.GetDownloadUrl="GetDownloadUrl",e.GetDownloadToken="GetDownloadToken"}(a||(a={}));var I=".pdf",x=["ODBLightSpeedWebPack","TeamsODBFileBrowserWebPack","ODBUWP"],C=function(){function e(e,t){this.isWorkerVersionMismatch=function(e){var t,n=null===(t=window._spModuleLink)||void 0===t?void 0:t.buildNumber;return"dev"!==n&&!(!e||!n)&&e!==n},this._enablePdf=(0,u.Z)(u.L),this._enableMsPdfviewer=(0,u.Z)(u.G),this._enableEmbedMsPdfviewer=(0,u.Z)(u.e),this._enableEditPdf=(0,u.Z)(u.d),this._enableExtractPdf=(0,u.Z)(u.z),this._enablePreviewTif=(0,u.Z)(u.H),this._enableDeprecateTempAuth=(0,u.Z)(u.B),this._enableDeprecateTempAuthForPrefetch=(0,u.Z)(u.A),this._enableHTML=(0,u.Z)(u.I)&&((0,f.a)()||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._platformDetection=t.platformDetection,this._pageContext=t.pageContext,this._embedOptions=t.embedOptions}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==l.a.Embed},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===I||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isProgressiveLoadingEnabled=function(e){return!(!(0,u.Z)(u.o)||!e.size)&&e.size>104857600},e.prototype.isPreviewerEnabled=function(e,t){if(void 0===t&&(t=!0),this.isProgressiveLoadingEnabled(e))return!1;if(!((0,u.Z)(u.y)||(0,u._b)()&&t||!this.isNotEmbed()&&!(0,v.h)()&&!S(u.c.ECS)||y(u.n.ECS))||!e.size)return!1;var n=this._platformDetection.isMobile?20971520:209715200;return e.size>n&&!e.pdfConversion},e.prototype.isMsPdfViewerSupported=function(e){var t;if(!e)return!1;var n=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),a=this._isHostAppTeams()&&y(u.F.ECS),i=!(0,v.g)()&&!S(u.a.ECS)&&!this.isNotEmbed()&&((null===(t=this._embedOptions)||void 0===t?void 0:t.useMsPdf)||!1);return(n||a||i)&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){var t=!!e.size&&e.size<=D.t;return this.isMsPdfViewerAvailable(e)&&(this._enableEditPdf||!this.isNotEmbed()&&!(0,v.f)()&&!S(u.b.ECS))&&this._extension(e)===I&&t},e.prototype.isPdfExtractAvailable=function(e){return this.hasSyntexLicense()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfExtractable=function(){return this.hasSyntexLicense()&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.itemStatus!==r.b.ConditionalAccessViewOnly&&e.itemStatus!==r.b.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype.getWorkerManifestName=function(){var e,t=(null===(e=window._spModuleLink)||void 0===e?void 0:e.manifestName)||"";return(0,u.Z)(u.q)&&-1!==x.indexOf(t)?"odbmspdfwebworker":"mspdfwebworker"},e.prototype.getEmbedOptions=function(){return this._embedOptions},e.prototype.hasSyntexLicense=function(){var e,t;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||(0,v.s)()&&(null===(t=this._pageContext)||void 0===t?void 0:t.isUserSyntexV2Licensed)||!1},e.prototype.isTempAuthDeprecated=function(e){return!!this.isNotEmbed()&&((null==e?void 0:e.downloadUrl)?!(0,v.o)()&&this._enableDeprecateTempAuthForPrefetch:!(0,v.p)()&&this._enableDeprecateTempAuth)},e.prototype.getTempAuthLogData=function(e){if(!(0,v.q)()&&e.url)return{isPdfNoTempAuth:!e.url.toLowerCase().includes("tempauth"),isPdfUseToken:!!e.token}},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return!!e&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){if(!t)return!1;var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4&&((0,v.l)()||t<536870912);return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=(0,c.b)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=(0,o.k1)((t.location.search||"").slice(1)),a=(0,o.k1)((t.location.hash||"").slice(1)),r=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return(0,i.W_)((0,i.W_)((0,i.W_)({},n),a),r).client_id},e.dependencies={},e}(),O=(0,o.c7)("PdfViewerHelper",C,{platformDetection:s.a,urlDataSource:_.a,navigation:p.a,pdfDataSource:g,pageContext:m.a.optional,embedOptions:d.optional})}
,(e,t,n)=>{"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,{a:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>I,b:()=>l,c:()=>b,d:()=>p,e:()=>d,f:()=>s,g:()=>i,h:()=>o,i:()=>c,j:()=>_,k:()=>h,l:()=>u,m:()=>f,n:()=>D,o:()=>v,p:()=>g,q:()=>y,r:()=>S,s:()=>r,t:()=>m});var a=n("odsp.util_118"),i=function(){return a.HW.isActivated("c3dc126d-70db-4dc6-9ad6-3ce6d59dfaca")},r=function(){return!a.HW.isActivated("acc3d562-8099-40b9-ad90-f199e8fcec91","6/15/2023","Syntex V2 License check")},o=function(){return a.HW.isActivated("8abd1628-3d93-4f7f-812c-632b31cc516f","06/19/2023","Enable previewer for embedded scenarios")},s=function(){return a.HW.isActivated("f644d6f3-bfb2-4b67-9ea4-f2bbd98431b0","07/17/2023","Enable editing for mspdf in embed scenarios")},c=function(){return a.HW.isActivated("facbf24e-8794-4b51-9003-45d3abd49d9b","09/28/2023","Fix sharee can not save pdf change")},d=function(){return a.HW.isActivated("0e5640e9-b84f-4cd2-abf5-46e9e6177353","12/02/2023","Do not send version request for view only PDF")},l=function(){return a.HW.isActivated("5b9870f7-f2fd-4892-baf4-5cdf182ff84f","29/02/2024","Do not activate esign new design")},u=function(){return a.HW.isActivated("20302a2a-5087-41af-b2a7-57f1d3a7bb82","01/26/2024","Use MsPdf fallback theshold")},f=function(){return a.HW.isActivated("068F8934-7C5F-4B80-A3C6-6CB83E3E7188","02/27/2024","Send PDF full page load perf data")},p=function(){return a.HW.isActivated("8bebc9ff-21dd-4f04-ac18-fba44f4a162e","02/26/2024","Disable print and annotate command for PDF MIP")},m=function(){return a.HW.isActivated("24B0D3BD-C2CA-4EAF-AC93-BD08C1D10CD0","05/17/2024","Use external arial font")},_=function(){return a.HW.isActivated("35f1dedc-ac8b-4b34-9e2f-b9fef10763fc","06/27/2024","load jp font on settings")},h=function(){return a.HW.isActivated("5ffdba9e-c361-4a60-9633-fad755e4eae2","06/27/2024","load korean font")},b=function(){return a.HW.isActivated("EE02F3C9-6475-4A21-92FD-34501A13F529","07/11/2024","disable open in app on mobile")},g=function(){return a.HW.isActivated("F8DA2D1F-DFA4-4517-9725-12E716766315","08/07/2024","Disable temp auth deprecation for legacy OneUp PDF viewer and new inline OneUp PDF viewer")},v=function(){return a.HW.isActivated("74E95D32-2C34-478C-812F-C3D8516E7845","08/07/2024","Disable temp auth deprecation for new fast OneUp PDF viewer where prefetches the download url")},y=function(){return a.HW.isActivated("e66ba878-0389-4296-9158-6f0fce24ae33","09/10/2024","Add RUMOne log for temp auth deprecation")},S=function(){return a.HW.isActivated("ec9f89cd-e773-4158-ae47-68d5097f6e54","08/13/2024","Refactor the implmentation for versions API")},D=function(){return a.HW.isActivated("f65d78e0-eb8a-4de0-a500-a48ec644f91d","08/14/2024","Pdf copy the file content by chunks to reduce memory usage")},I=function(){return a.HW.isActivated("c798f4e6-7216-47a4-a5c6-0c00fa6233ff","09/06/2024","Close UA when entering PDF edit mode")}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>_});var a=n("tslib_826"),i=n("odsp.util_118"),r=n(53),o=n(25),s=n(232),c=n(5),d=n(432),l=n(90),u=(0,i.c7)("PreAuthServiceKey",d.a,{dataRequestor:l.a}),f=n(39),p=n(28),m={oneUpStateStore:r.e,graphDataSource:s.a,itemUrlHelper:o.c,preAuthService:u,identityDataSource:f.resourceKey,pageContext:c.a},_=new i.hK({name:"FileHandlerHelper",factory:{dependencies:m,create:function(e){return{instance:{hasFileHandler:function(t){var n=e.oneUpStateStore.getFileHandlerOptions();if(n)for(var a=null==n?void 0:n.data.actions.preview,i=t.extension,r=0;r<a.length;r++){var o=a[r].availableOn.file,s=o&&o.extensions||void 0;if(o&&i){var c="."!==i.charAt(0)?"."+i:i;return!s||-1!==s.indexOf(c.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*")}}return!1},getCorrespondingPreviewFileHandlerPostData:function(t){return(0,a.Zd)(this,void 0,void 0,function(){var n,i,r,o,s,c,d,l,u;return(0,a.qr)(this,function(f){switch(f.label){case 0:if(!(n=e.oneUpStateStore.getFileHandlerOptions()))return[3,6];i=null==n?void 0:n.data.actions.preview,r=t.extension,o=0,f.label=1;case 1:if(!(o<i.length))return[3,6];if(s=i[o].availableOn.file,c=s&&s.extensions||void 0,!s||!r)return[3,5];if(d="."!==r.charAt(0)?"."+r:r,c&&-1===c.indexOf(d.toLowerCase())&&-1===c.indexOf("*")&&-1===c.indexOf(".*"))return[3,5];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,this.getFileHandlerItemUrl(t,i[o],!!i[o].handler.isPromoted)];case 3:if((l=f.sent())&&l.length>0)return[2,(0,a.W_)((0,a.W_)({},i[o]),{itemUrls:l})];throw new Error("failed to get fileHandler item url");case 4:throw u=f.sent(),new Error(u);case 5:return o++,[3,1];case 6:return[2,Promise.resolve(void 0)]}})})},getFileHandlerItemUrl:function(t,n,i){var r,o;return(0,a.Zd)(this,void 0,void 0,function(){var s,c,d;return(0,a.qr)(this,function(a){switch(a.label){case 0:return i?[2,Promise.resolve([e.graphDataSource.getItemUrl(t,{useDirectEndpoint:!1})])]:[3,1];case 1:return s=e.itemUrlHelper.getItemUrlParts(t.key).fullItemUrl,c=e.itemUrlHelper.getItemUrlParts(t.key).fullWebUrl,s&&c?[4,e.identityDataSource.getSharePointToken(c)]:[3,4];case 2:return d=a.sent(),[4,e.preAuthService.getPreAuthUrls({driveUrl:(0,p._)()?null===(o=null===(r=t.graph)||void 0===r?void 0:r.sessionToken)||void 0===o?void 0:o.tokenUrl:void 0,appId:n.handler.appId,items:[s],accessToken:d})];case 3:return[2,a.sent()];case 4:throw new Error("no item full url / item webAbsolute Url")}})})}}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>v});var a=n("tslib_826"),i=n("odsp.util_118"),r=n(35),o=n(25),s=n(39),c=n(90),d=n(5),l=n(134),u=n(142),f=n(196),p=n(234),m=n(202),_={ODB:620},h=27e5,b=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._itemUrlHelper=t.itemUrlHelper,this._pageContext=t.pageContext,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._identityDataSource=t.identityDataSource}return e.prototype.getItemCurrentVersion=function(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=this.getItemUrl(e,t),i="".concat(n,"/versions?$select=id"),[4,this._sendVroomRequest(n,i,e,t||{},"versions",{})];case 1:return[2,(r=a.sent().value).length>0?r[0].id:""]}})})},e.prototype.getDownloadUrl=function(e,t){return void 0===t&&(t={}),(0,a.Zd)(this,void 0,void 0,function(){var n,r,o,s,c,d,l,u;return(0,a.qr)(this,function(a){return n=this._urlCache,!t.forceRefresh&&(r=n.get(e.key),s=(o=r||{}).url,c=o.time,!i.HW.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&s&&c>Date.now()-h)?[2,s]:t.excludeTempAuth&&e.downloadUrlNoAuth?[2,e.downloadUrlNoAuth]:e.downloadUrl&&""!==e.downloadUrl&&e.itemGeneratedTimeStamp&&Date.now()-e.itemGeneratedTimeStamp<h?[2,e.downloadUrl]:(d=t.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,l=this.getItemUrl(e,t),u="".concat(l,"?select=id,@content.downloadUrl"),[2,this._sendVroomRequest(l,u,e,t,"itemDownloadUrl",d).then(function(t){var a=t["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");return n.set(e.key,{url:a,time:Date.now()}),a})])})})},e.prototype.getDownloadToken=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){return(t=this._itemUrlHelper.getItemUrlParts(e.key)).isCrossDomain?[2,this._identityDataSource.getSharePointToken(new r.a(t.fullItemUrl).authority).then(function(e){var t=e.accessToken,n=e.isBadger;return"".concat(n?"badger":"bearer"," ").concat(t)})]:[2,void 0]})})},e.prototype.getAuthenticationParams=function(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var n,r,o;return(0,a.qr)(this,function(s){switch(s.label){case 0:return n=(t||{}).apiVersion,r=void 0===n?i.Tb.isFeatureEnabled(_)?"v2.1":"v2.0":n,[4,this.getAccessToken(e,(0,a.W_)((0,a.W_)({},t),{apiVersion:r}))];case 1:return o=s.sent(),[2,this._getAuthenticationParamsSync(o)]}})})},e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,a=void 0===n?!this._pageContext.isSPO:n,i=t.isPath,r=void 0!==i&&i,o=t.apiVersion,s=void 0===o?"v2.0":o,c=t.allowCookies,d=void 0!==c&&c,l=this._getGraphBaseUrl(e,{useDirectEndpoint:a,apiVersion:s,allowCookies:d}),u=e.graph;if(u&&u.driveId&&"root"!==u.itemId){var f=u.driveId,p=void 0===f?"me":f,m=u.itemId,_=void 0===m?"root":m;return"".concat(l,"/drives/").concat(encodeURIComponent(p)).concat("root"===_?"/root":"/items/".concat(encodeURIComponent(_))).concat(r?":":"")}var h=e.graph,b=void 0;if((p=h&&h.driveId)&&(b="".concat(l,"/drives/").concat(encodeURIComponent(p))),!b)return"";var g=this._itemUrlHelper.getItemUrlParts(e.key),v=this._itemUrlHelper.getUrlParts({path:g.serverRelativeItemUrl,listUrl:g.serverRelativeListUrl}).listRelativeItemUrl;return"".concat(b,"/root").concat(v?":/".concat(encodeURI(v)).concat(r?"":":"):"".concat(r?":":""))},e.prototype.getAccessToken=function(e,t){return void 0===t&&(t={}),(0,a.Zd)(this,void 0,void 0,function(){var n,i,o,s,c,d,l,p;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=t.apiVersion,i=t.forceRefresh,o=void 0!==i&&i,!(s=this._getAccessTokenFromItem(e,{apiVersion:n}))||(c=s.accessToken,d=s.proofToken,l=s.tokenExpiry,o||(0,u.a)((0,f.default)({authToken:c},{proofToken:f.optional(d),expiry:f.optional(l?new Date(l):void 0)}),3e5))?(p=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl,[4,this._identityDataSource.getSharePointToken(new r.a(p).authority,o)]):[2,s];case 1:return[2,a.sent()]}})})},e.prototype._getAccessTokenFromItem=function(e,t){var n,a;return void 0===t&&(t={}),"v2.1"===t.apiVersion?null===(n=e.graph)||void 0===n?void 0:n.sessionTokenV21:null===(a=e.graph)||void 0===a?void 0:a.sessionToken},e.prototype._getAuthenticationParamsSync=function(e){if(e){var t=e.accessToken,n=e.proofToken,a={};return t&&(a.access_token=t),n&&(a.prooftoken=n),a}return{}},e.prototype._getGraphBaseUrl=function(e,t){var n=t.useDirectEndpoint,a=t.apiVersion,i=this._itemUrlHelper.getItemUrlParts(e.key),o=i.fullListUrl;if(n){if(o)return"".concat(new r.a(o).authority,"/_api/").concat(a);if(i.isCrossDomain||i.isCrossList){var s=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return"".concat(new r.a(s).authority,"/_api/").concat(a)}return this._urlDataSource.getApiBaseUrl({apiVersion:a})}return"https://graph.microsoft.com/v1.0"},e.prototype._sendVroomRequest=function(e,t,n,a,i,o){var s=this;void 0===a&&(a={});var c=this._itemUrlHelper.getItemUrlParts(n.key).isCrossDomain;a.apiName&&(i="".concat(a.apiName,".").concat(i));var d=!c;return(d?Promise.resolve(void 0):this._identityDataSource.getSharePointToken(new r.a(e).authority)).then(function(e){var n=d?void 0:e;return s._vroomDataRequestor.send({apiName:i,path:"".concat(t),accessToken:n,qosExtraData:a.qosExtraData,allowCookies:d,headers:o})})},e.dependencies={urlDataSource:l.b,itemUrlHelper:o.c,pageContext:d.a,vroomDataRequestor:c.a,identityDataSource:s.resourceKey},e}(),g=m.legacyGraphDataSourceKey,v=p.a?g:(0,i.c7)("oneup-lightspeed/GraphDataSource",b)}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=n("odsp.util_118").HW.isActivated("fb3bead2-a0ae-4f8b-a7f4-c777ae0a7a93")}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a,i,r=n("odsp.util_118"),o=n(138),s=n(5),c=n(240),d=n(42);!function(e){e.legacy="legacy",e.phase1="react",e.phase2="newDesign"}(a||(a={})),function(e){e.carousel="carousel",e.fast="fast",e.embed="embed"}(i||(i={}));var l={isFastOneUp:o.c.optional,pageContext:s.a},u=new r.hK({name:"OneUpEngagementContextKey",factory:{dependencies:l,create:function(e){var t=e.pageContext,n=e.isFastOneUp,i=t?(0,d.c)(Number(t.webTemplate)):"unknown",r=a.phase2,o=t?(0,c.a)(t):void 0;return{instance:{previewContext:f(n),webTemplate:i,clientId:o,isSyntexEnabled:t?t.isSyntexEnabled:"unknown",oneUpPhase:r}}}}});function f(e){return e?i.fast:i.carousel}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n("tslib_826"),i=n(42),r=n("odsp.util_118"),o=n(100);function s(e){var t,n,s,c,d,l,u=(null==e?void 0:e.authToken)||"",f=(0,o.b)(u);return f&&f.app_displayname?t=f.app_displayname:(s=window,c=(0,r.k1)((s.location.search||"").slice(1)),d=(0,r.k1)((s.location.hash||"").slice(1)),l=(null===(n=s.PageContext)||void 0===n?void 0:n.scenarioContext.embed)||{},t=(0,a.W_)((0,a.W_)((0,a.W_)({},c),d),l).client_id||(Number(e.webTemplate)===i.b.mySite?"ODB":"SPList")),t}}
,,,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>a}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={})),function(e){e[e.None=0]="None",e[e.CommentsDisabled=1]="CommentsDisabled",e[e.CommentsInTable=2]="CommentsInTable",e[e.CommentsMigrating=4]="CommentsMigrating",e[e.LikesMigrating=8]="LikesMigrating"}(i||(i={}))}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>o});var a="rgba(31,31,31,.88)",i="#141414",r={themePrimary:"#0F6CBD",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#ffffff",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",whiteTranslucent40:a},o={semanticColors:{bodyBackground:a,bodyStandoutBackground:r.neutralLight,buttonText:r.black,buttonTextPressed:r.neutralDark,buttonTextHovered:r.neutralPrimary,bodySubtext:r.neutralSecondary,disabledBackground:r.neutralQuaternaryAlt,errorText:r.redDark,inputBackgroundChecked:r.themePrimary,menuBackground:r.neutralLighter,menuItemBackgroundHovered:r.neutralQuaternaryAlt,menuItemBackgroundPressed:r.neutralQuaternary,menuDivider:r.neutralTertiaryAlt,menuIcon:r.themeDarkAlt,menuHeader:r.black,menuItemText:r.neutralPrimary,menuItemTextHovered:r.neutralDark,messageText:r.neutralPrimary,buttonBackground:a,buttonBackgroundHovered:"#424242",buttonBackgroundPressed:"#000000",primaryButtonBackground:r.themeTertiary,primaryButtonBackgroundHovered:r.themeLight,primaryButtonBackgroundPressed:r.themeLighter,primaryButtonText:r.black,primaryButtonTextHovered:r.black,primaryButtonTextPressed:r.black,primaryButtonTextDisabled:"#605e5c",buttonBorder:"#808080",variantBorder:r.neutralQuaternary,infoBackground:r.neutralQuaternaryAlt,infoIcon:r.neutralPrimaryAlt,errorIcon:r.redDark,warningIcon:r.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"},palette:r,isInverted:!0}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>r,c:()=>o,d:()=>c,e:()=>u,f:()=>m,g:()=>f,h:()=>p,i:()=>_});var a=n(496);function i(e,t,n){let{reference:i,floating:r}=e;const o=(0,a.m)(t),s=(0,a.d)(t),c=(0,a.g)(s),d=(0,a.n)(t),l="y"===o,u=i.x+i.width/2-r.width/2,f=i.y+i.height/2-r.height/2,p=i[c]/2-r[c]/2;let m;switch(d){case"top":m={x:u,y:i.y-r.height};break;case"bottom":m={x:u,y:i.y+i.height};break;case"right":m={x:i.x+i.width,y:f};break;case"left":m={x:i.x-r.width,y:f};break;default:m={x:i.x,y:i.y}}switch((0,a.f)(t)){case"start":m[s]-=p*(n&&l?-1:1);break;case"end":m[s]+=p*(n&&l?-1:1)}return m}const r=async(e,t,n)=>{const{placement:a="bottom",strategy:r="absolute",middleware:o=[],platform:s}=n,c=o.filter(Boolean),d=await(null==s.isRTL?void 0:s.isRTL(t));let l=await s.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:f}=i(l,a,d),p=a,m={},_=0;for(let n=0;n<c.length;n++){const{name:o,fn:h}=c[n],{x:b,y:g,data:v,reset:y}=await h({x:u,y:f,initialPlacement:a,placement:p,strategy:r,middlewareData:m,rects:l,platform:s,elements:{reference:e,floating:t}});u=null!=b?b:u,f=null!=g?g:f,m={...m,[o]:{...m[o],...v}},y&&_<=50&&(_++,"object"==typeof y&&(y.placement&&(p=y.placement),y.rects&&(l=!0===y.rects?await s.getElementRects({reference:e,floating:t,strategy:r}):y.rects),({x:u,y:f}=i(l,p,d))),n=-1)}return{x:u,y:f,placement:p,strategy:r,middlewareData:m}};async function o(e,t){var n;void 0===t&&(t={});const{x:i,y:r,platform:o,rects:s,elements:c,strategy:d}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:p=!1,padding:m=0}=(0,a.c)(t,e),_=(0,a.l)(m),h=c[p?"floating"===f?"reference":"floating":f],b=(0,a.q)(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(h)))||n?h:h.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(c.floating)),boundary:l,rootBoundary:u,strategy:d})),g="floating"===f?{...s.floating,x:i,y:r}:s.reference,v=await(null==o.getOffsetParent?void 0:o.getOffsetParent(c.floating)),y=await(null==o.isElement?void 0:o.isElement(v))&&await(null==o.getScale?void 0:o.getScale(v))||{x:1,y:1},S=(0,a.q)(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:g,offsetParent:v,strategy:d}):g);return{top:(b.top-S.top+_.top)/y.y,bottom:(S.bottom-b.bottom+_.bottom)/y.y,left:(b.left-S.left+_.left)/y.x,right:(S.right-b.right+_.right)/y.x}}const s=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:r,rects:o,platform:s,elements:c,middlewareData:d}=t,{element:l,padding:u=0}=(0,a.c)(e,t)||{};if(null==l)return{};const f=(0,a.l)(u),p={x:n,y:i},m=(0,a.d)(r),_=(0,a.g)(m),h=await s.getDimensions(l),b="y"===m,g=b?"top":"left",v=b?"bottom":"right",y=b?"clientHeight":"clientWidth",S=o.reference[_]+o.reference[m]-p[m]-o.floating[_],D=p[m]-o.reference[m],I=await(null==s.getOffsetParent?void 0:s.getOffsetParent(l));let x=I?I[y]:0;x&&await(null==s.isElement?void 0:s.isElement(I))||(x=c.floating[y]||o.floating[_]);const C=S/2-D/2,O=x/2-h[_]/2-1,w=(0,a.p)(f[g],O),E=(0,a.p)(f[v],O),A=w,L=x-h[_]-E,k=x/2-h[_]/2+C,M=(0,a.a)(A,k,L),P=!d.arrow&&null!=(0,a.f)(r)&&k!==M&&o.reference[_]/2-(k<A?w:E)-h[_]/2<0,T=P?k<A?k-A:k-L:0;return{[m]:p[m]+T,data:{[m]:M,centerOffset:k-M-T,...P&&{alignmentOffset:T}},reset:P}}}),c=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:s,rects:c,initialPlacement:d,platform:l,elements:u}=t,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:_="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:b=!0,...g}=(0,a.c)(e,t);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const v=(0,a.n)(r),y=(0,a.n)(d)===d,S=await(null==l.isRTL?void 0:l.isRTL(u.floating)),D=m||(y||!b?[(0,a.k)(d)]:(0,a.h)(d));m||"none"===h||D.push(...(0,a.i)(d,b,h,S));const I=[d,...D],x=await o(t,g),C=[];let O=(null==(i=s.flip)?void 0:i.overflows)||[];if(f&&C.push(x[v]),p){const e=(0,a.e)(r,c,S);C.push(x[e[0]],x[e[1]])}if(O=[...O,{placement:r,overflows:C}],!C.every(e=>e<=0)){var w,E;const e=((null==(w=s.flip)?void 0:w.index)||0)+1,t=I[e];if(t)return{data:{index:e,overflows:O},reset:{placement:t}};let n=null==(E=O.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:E.placement;if(!n)switch(_){case"bestFit":{var A;const e=null==(A=O.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:A[0];e&&(n=e);break}case"initialPlacement":n=d}if(r!==n)return{reset:{placement:n}}}return{}}}};function d(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function l(e){return a.s.some(t=>e[t]>=0)}const u=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...r}=(0,a.c)(e,t);switch(i){case"referenceHidden":{const e=d(await o(t,{...r,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:l(e)}}}case"escaped":{const e=d(await o(t,{...r,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:l(e)}}}default:return{}}}}},f=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:r,y:o,placement:s,middlewareData:c}=t,d=await async function(e,t){const{placement:n,platform:i,elements:r}=e,o=await(null==i.isRTL?void 0:i.isRTL(r.floating)),s=(0,a.n)(n),c=(0,a.f)(n),d="y"===(0,a.m)(n),l=["left","top"].includes(s)?-1:1,u=o&&d?-1:1,f=(0,a.c)(t,e);let{mainAxis:p,crossAxis:m,alignmentAxis:_}="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return c&&"number"==typeof _&&(m="end"===c?-1*_:_),d?{x:m*u,y:p*l}:{x:p*l,y:m*u}}(t,e);return s===(null==(n=c.offset)?void 0:n.placement)&&null!=(i=c.arrow)&&i.alignmentOffset?{}:{x:r+d.x,y:o+d.y,data:{...d,placement:s}}}}},p=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:r}=t,{mainAxis:s=!0,crossAxis:c=!1,limiter:d={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=(0,a.c)(e,t),u={x:n,y:i},f=await o(t,l),p=(0,a.m)((0,a.n)(r)),m=(0,a.j)(p);let _=u[m],h=u[p];if(s){const e="y"===m?"bottom":"right",t=_+f["y"===m?"top":"left"],n=_-f[e];_=(0,a.a)(t,_,n)}if(c){const e="y"===p?"bottom":"right",t=h+f["y"===p?"top":"left"],n=h-f[e];h=(0,a.a)(t,h,n)}const b=d.fn({...t,[m]:_,[p]:h});return{...b,data:{x:b.x-n,y:b.y-i}}}}},m=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:r,rects:o,middlewareData:s}=t,{offset:c=0,mainAxis:d=!0,crossAxis:l=!0}=(0,a.c)(e,t),u={x:n,y:i},f=(0,a.m)(r),p=(0,a.j)(f);let m=u[p],_=u[f];const h=(0,a.c)(c,t),b="number"==typeof h?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(d){const e="y"===p?"height":"width",t=o.reference[p]-o.floating[e]+b.mainAxis,n=o.reference[p]+o.reference[e]-b.mainAxis;m<t?m=t:m>n&&(m=n)}if(l){var g,v;const e="y"===p?"width":"height",t=["top","left"].includes((0,a.n)(r)),n=o.reference[f]-o.floating[e]+(t&&(null==(g=s.offset)?void 0:g[f])||0)+(t?0:b.crossAxis),i=o.reference[f]+o.reference[e]+(t?0:(null==(v=s.offset)?void 0:v[f])||0)-(t?b.crossAxis:0);_<n?_=n:_>i&&(_=i)}return{[p]:m,[f]:_}}}},_=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:i,platform:r,elements:s}=t,{apply:c=(()=>{}),...d}=(0,a.c)(e,t),l=await o(t,d),u=(0,a.n)(n),f=(0,a.f)(n),p="y"===(0,a.m)(n),{width:m,height:_}=i.floating;let h,b;"top"===u||"bottom"===u?(h=u,b=f===(await(null==r.isRTL?void 0:r.isRTL(s.floating))?"start":"end")?"left":"right"):(b=u,h="end"===f?"top":"bottom");const g=_-l[h],v=m-l[b],y=!t.middlewareData.shift;let S=g,D=v;if(p){const e=m-l.left-l.right;D=f||y?(0,a.p)(v,e):e}else{const e=_-l.top-l.bottom;S=f||y?(0,a.p)(g,e):e}if(y&&!f){const e=(0,a.o)(l.left,0),t=(0,a.o)(l.right,0),n=(0,a.o)(l.top,0),i=(0,a.o)(l.bottom,0);p?D=m-2*(0!==e||0!==t?e+t:(0,a.o)(l.left,l.right)):S=_-2*(0!==n||0!==i?n+i:(0,a.o)(l.top,l.bottom))}await c({...t,availableWidth:D,availableHeight:S});const I=await r.getDimensions(s.floating);return m!==I.width||_!==I.height?{reset:{rects:!0}}:{}}}}}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f});var a=n("tslib_826"),i=n("odsp.util_118"),r=n(53),o=n(52),s=n(5),c=n(517),d=n(39),l=!i.HW.isActivated("F7F844A1-C5CA-40D4-A9F1-D446600D3D5F"),u={oneUpStateStore:r.e,pageContext:s.a,getExecutor:c.a.async.lazy,identityDataSource:d.resourceKey},f=new i.hK({name:"SaveAction",factory:{dependencies:u,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n,i,r=!!(null===(i=null===(n=t.oneUpStateStore.getViewerState(e.item.key))||void 0===n?void 0:n.saveData)||void 0===i?void 0:i.fileUpload)&&o.a.hasItemPermission(e.item,o.a.editListItems),s=t.pageContext,c={isAvailable:r,id:"SaveAction",onExecute:function(n){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,t.getExecutor()];case 1:return[2,a.sent().executeSave({item:e.item,parentItem:e.parentItem,fileUpload:n.fileUpload,pageContext:s,oneUpStateStore:t.oneUpStateStore,saveascopy:n.saveascopy||!1,identityDataSource:t.identityDataSource,qosEvent:n.qosEvent})]}})})},customerPromise:l?{startSchema:{pillar:"Edit"},computeVeto:function(){return"Save Failure"}}:void 0};return c})}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>c,c:()=>s,d:()=>o});var a=n("tslib_826"),i=n(520),r=n(60),o=function(e){this.type="Qos",this.payload=(0,a.W_)((0,a.W_)({privacyClassification:"RequiredService"},e),{id:(0,i.a)(),status:r.b.Start,startTime:performance.now()})},s=function(e,t,n,i){this.type="Qos",this.payload=(0,a.W_)((0,a.W_)({privacyClassification:"RequiredService"},i),{id:e,name:t,status:n,endTime:performance.now()})},c=function(e){this.type="Engagement",this.payload=(0,a.W_)({privacyClassification:"OptionalDiagnostic"},e)},d=function(e){this.type="CaughtError",this.payload=(0,a.W_)({privacyClassification:"RequiredService"},e)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>c,d:()=>l});var a=n("tslib_826"),i=n(61),r=n(82),o="Fetch",s=3;function c(e,t,n,r){return(0,a.Zd)(this,void 0,void 0,function(){var o,s,c,d,l,u,f,p;return(0,a.qr)(this,function(a){switch(a.label){case 0:null==r||r("Start fetchDataBuffer  where: ".concat(n)),o="inferredExtension=".concat(function(e){var t;return null===(t=e.split(/[#?]/)[0].split(".").pop())||void 0===t?void 0:t.trim()}(e)),null==r||r("ErrorMsgSuffix: ".concat(o)),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,fetch(e,t)];case 2:if(s=a.sent(),null==r||r("Fetched done"),c=s.ok,d=s.status,l=s.statusText,u=s.headers,null==r||r("ok: ".concat(c,", status: ").concat(d,", statusText: ").concat(l,", headers: ").concat(u)),!c)throw new i.a(d,l,n,"Unexpected HTTP status ".concat(d," from fetch, ").concat(o),u);return null==r||r("Response ok"),[4,s.arrayBuffer()];case 3:return f=a.sent(),null==r||r("Got array buffer. size: ".concat(f.byteLength)),[2,f];case 4:throw p=a.sent(),null==r||r("Error during fetch: ".concat(p," ").concat(p.stack)),"AbortError"===p.name||"NetworkError"===p.name?p:new i.a(void 0,p.name,n,"".concat(p.message,", ").concat(o));case 5:return[2]}})})}function d(e,t,n,c,d){return(0,a.Zd)(this,void 0,void 0,function(){function l(s){return(0,a.Zd)(this,void 0,void 0,function(){var c,l,f,p,_,h,b;return(0,a.qr)(this,function(g){switch(g.label){case 0:return s?(c=(t||{}).headers,l=void 0===c?{}:c,f=(0,a.W_)((0,a.W_)({},t),{headers:(0,a.W_)((0,a.W_)({},l),{Range:"bytes=".concat(s.start,"-").concat(s.end-1)})}),[4,fetch(e,f)]):[2];case 1:if((p=g.sent()).ok)return[3,2];throw _=new i.a(p.status,p.statusText,d,"Fetch request by range failed. fileSize: ".concat(n)),r.a.error(o,_),_;case 2:return[4,p.arrayBuffer()];case 3:h=g.sent(),m+=h.byteLength,b=new Uint8Array(h),u.set(b,s.start),g.label=4;case 4:return[2]}})})}var u,f,p,m,_,h,b,g;return(0,a.qr)(this,function(e){switch(e.label){case 0:for(u=new Uint8Array(n),f=[],p=Math.ceil(n/s),m=0,_=0,h=p;f.length<s;)f.push({start:_,end:h}),_=h,h=Math.min(h+p,n);e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(f.map(l))];case 2:if(e.sent(),r.a.verbose(o,"Download by range completed"),m!==n)throw b=new i.c(i.b.RangeDownloadSizeMismatch,"Download by range failed. Incorrect size. fileSize: ".concat(n,", downloaded length: ").concat(m)),r.a.error(o,b),b;return[2,u.buffer];case 3:throw g=e.sent(),r.a.error(o,new i.c(i.b.FileDownloadFailed,"Download by range failed. e: ".concat(g,", fileSize: ").concat(n))),"AbortError"!==g.name&&c(),g;case 4:return[2]}})})}function l(e,t,n,i){return(0,a.Zd)(this,void 0,void 0,function(){var r,o,s;return(0,a.qr)(this,function(a){switch(a.label){case 0:return r=i.signal,o={credentials:"same-origin",signal:r,headers:{Range:"bytes=".concat(t,"-").concat(n)}},[4,c(e,o)];case 1:return s=a.sent(),[2,new Uint8Array(s)]}})})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_826"),i=/\{(\d+)\}/g;function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(i,function(e,n){var a=t[Number(n)];return null!==a?"".concat(a):""})}var o=function(){function e(e){this._strings=e}return Object.defineProperty(e.prototype,"strings",{get:function(){return this._strings},set:function(e){this._strings=e},enumerable:!1,configurable:!0}),e.prototype.get=function(e,t){if(!this._strings)return"";var n=this._strings[e];return t?r.apply(void 0,(0,a.AE)([n],(0,a.MS)(t),!1)):n},e}()}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_826");(0,n("fui.util_554").Bv)([{rawString:".screenReader_6d70c630{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}"}]);var i=function(){function e(){}return e.read=function(e,t){if(""!==e)for(var n=[e],a=this._getLiveNodes(n.length,t||0),i=function(e){window.setTimeout(function(){a[e].textContent=n[e]},500*(e+1))},r=0;r<n.length;r++)i(r)},e.clear=function(){var e,t;try{for(var n=(0,a.OY)(this._liveNodes),i=n.next();!i.done;i=n.next()){var r=i.value;document.body.removeChild(r)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._liveNodes=[]},e._getLiveNodes=function(e,t){this.clear();for(var n=[],a=0;a<e;a++){var i=document.createElement("div");switch(n.push(i),document.body.appendChild(i),i.classList.add("screenReader_6d70c630"),t){case 0:i.setAttribute("aria-live","polite");break;case 1:i.setAttribute("role","alert"),i.setAttribute("aria-live","assertive")}}return this._liveNodes=n,n},e._liveNodes=[],e}()}
,(e,t,n)=>{"use strict";function a(){if(window.devicePixelRatio)return Math.ceil(window.devicePixelRatio);if(window.matchMedia)for(var e=4;e>1;e=Math.round(10*(e-.1))/10)if(window.matchMedia("(-webkit-min-device-pixel-ratio: ".concat(e,")")).matches||window.matchMedia("(min-resolution: ".concat(e,"dppx)")).matches)return e;return 1}function i(e){return Math.floor(e*a())}n.d(t,{a:()=>a,b:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n(82);function i(e){try{var t=new URL(e).toString().match(/\/([^\/?#]+)[^\/]*$/);return t&&t.length>1?t[1]:""}catch(t){return a.a.warn("UrlHelper",'Given url "'.concat(e,'" is invalid')),""}}function r(e){e.startsWith("www.")&&(e="https://".concat(e));try{switch(new URL(e).protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}catch(e){return!1}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(61),i=n(81),r=function(){function e(){this._eventMap={}}return e.prototype.on=function(e,t){this._eventMap[e]||(this._eventMap[e]=[]),this._eventMap[e].push(t)},e.prototype.off=function(e,t){var n,a=this._eventMap[e];!a||(n=a.indexOf(t))<0||a.splice(n,1)},e.prototype.dispatch=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._eventMap[e]&&this._eventMap[e].forEach(function(n){try{n.apply(null,t)}catch(t){var r=new a.c(a.b.EventHandleFailed,"Fail to handle event ".concat(e,", error: ").concat(t));i.a.logError(r.toCaughtError())}})},e.prototype.dispose=function(){var e=this;Object.keys(this._eventMap).forEach(function(t){for(var n=e._eventMap[t],a=n.length;a>=0;a--)e.off(t,n[a])})},e}()}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>m,b:()=>_,c:()=>b,d:()=>h});var a=n("tslib_826"),i=n(368),r=n(69),o=n(41),s=n(244),c=n(323),d=n("odsp.util_118"),l=n(349),u=n(43),f=n(116),p=function(e){function t(t,n){var a=e.call(this,n)||this;return a.name="NetworkError",a.status=t,a}return(0,a.XJ)(t,e),t}(Error),m=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ManipulationError",n}return(0,a.XJ)(t,e),t}(Error);function _(e,t){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(n){return[2,Promise.all(e.map(function(e){return function(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){switch(a.label){case 0:if(!t)throw new Error("Invalid url");return[4,fetch(t,e)];case 1:if(!(n=a.sent()).ok)throw new p(n.status,"Fail to fetch file, url=".concat(t));return[2,n.arrayBuffer()]}})})}(t,e)}))]})})}function h(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){return e?(n="".concat(t.webUrl,"/").concat(e).concat(".pdf")).length>=400?[2,d.OO(c.n,n.length)]:[2,""]:[2,c.m]})})}function b(e,t,c,d){return(0,a.Zd)(this,void 0,void 0,function(){var p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k;return(0,a.qr)(this,function(M){switch(M.label){case 0:return(null==d?void 0:d.webUrl)?[4,n.e(52).then(n.bind(n,613))]:[2,Promise.reject("")];case 1:return p=M.sent().SharePointUploader,m={name:e.name,size:e.size,slice:function(t,n){return e}},_=decodeURI(new URL(d.webUrl).pathname),h=decodeURI(d["@sharePoint.listUrl"]||""),b=c.getKey(((E={})[o.b.idParamKey]=_,E[o.b.listUrlKey]=h,E)),g=new u.a({},{pageContext:t}),v=new f.a({},{pageContext:t,itemUrlHelper:g}),y=g.getItemUrlParts(b),[4,new p({webApiUrl:v.build().webByItemUrl(y),fileUpload:m,throttler:new i.a({maxParallelUploads:1}),canStream:!0,dataRequestor:new r.b({},{pageContext:t,noRedirect:!0}),destinationUrl:y.serverRelativeItemUrl||"",nameConflictBehavior:l.a.rename,appName:"ODB OneUp viewer",onStart:function(){},onAbort:function(){},onProgress:function(e){}}).upload()];case 2:return S=M.sent(),D=c.getKey(((A={})[o.b.idParamKey]=S.ServerRelativeUrl,A)),I=h&&y.isCrossList,x=c.getKey((0,a.W_)(((L={})[o.b.idParamKey]=_,L),I?((k={})[o.b.listUrlKey]=h,k):{})),C={key:D||"",id:S.ServerRelativeUrl,type:s.a.File},O={key:x||"",id:y.serverRelativeItemUrl,type:s.a.Folder},w=c.getDefaultClickUrlForOneUp(C,{parentItem:O,urlType:"focus"}),[2,Promise.resolve(w)]}})})}}
,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>E,b:()=>O,c:()=>w});var a=n("tslib_826"),i=n("odsp.util_118"),r=n("react-lib"),o=n(575),s=n(133),c=n(54),d=n(43),l=n(39),u=n(35),f=n(333),p=n(44),m=n(584),_=n(577),h=n(576),b=(0,s.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(51)]).then(n.bind(n,672))];case 1:return[2,e.sent().ShareDialog]}})})});function g(e){var t=new i.nM,n=new d.a({},{pageContext:e.pageContext}),s=n.getItemUrlParts(e.item.key).isCrossList,g=n.getItemUrlParts(e.item.key).fullWebUrl,v=(0,i.k1)((0,i.k9)(window.location.href)),y=v.listurl,S=v.id;return e.onRender&&e.onRender(r.createElement(function(e){return r.createElement(b,{getSharingInformation:D,getClientId:function(){return"oneup"},initializeShareFrame:I,mode:o.a.share,resolve:function(){},reject:function(e){t.reject(e)},locale:c.a.language||"en-US",itemName:e.itemName||"",onShareReady:function(){},onShareLoaded:function(e){var n={resultType:e.resultType,extraData:(0,a.l7)(e,["resultType"])};t.resolve(n)},onModalClose:function(){e.onClose&&e.onClose()}})},(0,a.W_)({},e))),t.promise;function D(){if(s)return e.resources.consume(l.resourceKey).getSharePointToken(new u.a(g).authority).then(function(t){var n={authToken:t.accessToken,webAbsoluteUrl:g,isODB:!0,itemName:e.itemName,listUrl:y,serverRelativeItemUrl:S,cookieAuthIframeUrlForCrossDomain:"".concat(e.pageContext.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?crossdomain=true&clickTime=").concat(Date.now())};return Promise.resolve((0,a.W_)({},n))});var t="".concat(e.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?listId=").concat(e.listId,"&clientId=").concat("oneup","&listItemId=").concat(e.listItemId,"&mode=").concat(e.mode,"&fullScreenMode=true");return Promise.resolve({cookieAuthIframeUrl:t})}function I(t){var n,a,i,r=(0,h.a)("OneUpSharingModalContainer"),o=r[0],d=r[1];if(s&&o){o.style.position="relative",o.style.zIndex="10000000000000";var l={authToken:t.sharingInformation.authToken||"",clientId:"OneUp",mode:Number(e.mode),listItemId:e.item.itemId||"",itemName:e.item.name||"",itemAppmap:e.item.appMap,itemType:e.item.type,itemExtension:e.item.extension,correlationId:null!==(a=null===(n=e.pageContext)||void 0===n?void 0:n.CorrelationId)&&void 0!==a?a:p.a.generate(),scenarioId:"OneUp-CrossList",hostOptions:{showCloseButton:!0,hideShareDialogOverflowButton:!0},hostMethod:f.a.sharepoint,serverRelativeItemUrl:S,listUrl:y,webAbsoluteUrl:g||"",locale:c.a.language||"en-US",fullScreenIframe:!0};new _.a({element:o,locale:l.locale,environment:null!==(i=e.pageContext.env2)&&void 0!==i?i:m.a.prod,disableIframeDomainCheck:!0,isConsumer:!1,context:l,styles:{minWidth:"480px"},options:{onError:function(e){},onReady:function(){console.log("sharePrefetch ready")},onTimeout:function(){},onDismiss:function(){d()}}}).initializeUI()}}}var v=new i.hK({name:"ShowShareDialog",factory:{dependencies:{},create:function(e){return{instance:{showShareDialog:g}}}}}),y=n(5),S=n(70),D=n(53),I="ShareAction",x=function(e,t,n){return function(i){var r=function(e){var t;return!(null===(t=e.lifeCycleStatus)||void 0===t?void 0:t.isMalwareDetected)}(i.item);return{isAvailable:r,id:t,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var t,i,r,o;return(0,a.qr)(this,function(a){switch(a.label){case 0:return(t=e.oneUpStore.getOneUpProperties())?(i={listId:e.pageContext.listId,webAbsoluteUrl:e.pageContext.webAbsoluteUrl,listItemId:null===(o=null===(r=t.focusItem)||void 0===r?void 0:r.properties)||void 0===o?void 0:o.ID,mode:n,fullScreenMode:!0,itemName:t.focusItem.name,item:t.focusItem,pageContext:e.pageContext,resources:e.resources,onClose:function(){e.oneUpStateStore.updateModalState("shareCommand",{showModal:!1,content:void 0})},onRender:function(t){e.oneUpStateStore.updateModalState("shareCommand",{showModal:!0,content:t})}},[4,e.getExecutor()]):[3,3];case 1:return[4,a.sent().showShareDialog(i)];case 2:return[2,a.sent()];case 3:return[2]}})})}}}},C={getExecutor:v.async.lazy,pageContext:y.a,oneUpStore:S.b,resources:i.Ci,oneUpStateStore:D.e},O=new i.hK({name:"ShareAction",factory:{dependencies:C,create:function(e){return{instance:{evaluateAction:x(e,I,o.a.manageAccess)}}}}}),w=new i.hK({name:"ShareAction",factory:{dependencies:C,create:function(e){return{instance:{evaluateAction:x(e,I,o.a.share)}}}}}),E=new i.hK({name:"ShareAction",factory:{dependencies:C,create:function(e){return{instance:{evaluateAction:x(e,"CopyAction",o.a.copyLink)}}}}})}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>c});var a=n("tslib_826"),i=n(310),r=n("react-lib"),o=r.createContext(void 0),s=function(e){var t=e.children,n=(0,a.l7)(e,["children"]);return r.createElement(o.Provider,{value:new i.a(n.strings)},t)},c=function(){return r.useContext(o)},d=function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t,n;return(0,a.qr)(this,function(i){switch(i.label){case 0:return[4,Promise.all([Promise.resolve().then(function(){var e=new Error("Cannot find module '../l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e}),Promise.resolve().then(function(){var e=new Error("Cannot find module '@ms/file-annotation-bar/lib/l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e})])];case 1:return e=a.MS.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],[2,(0,a.W_)((0,a.W_)({},t.default),n.default)]}})})}}
,,(e,t,n)=>{"use strict";n.d(t,{A:()=>r,B:()=>h,C:()=>s,D:()=>c,E:()=>i,F:()=>f,G:()=>o,H:()=>m,I:()=>D,J:()=>R,a:()=>I,b:()=>_,c:()=>S,d:()=>y,e:()=>v,f:()=>u,g:()=>l,h:()=>x,i:()=>p,j:()=>d,k:()=>b,l:()=>g,m:()=>k,n:()=>E,o:()=>A,p:()=>L,q:()=>w,r:()=>O,s:()=>a,t:()=>C,u:()=>H,v:()=>U,w:()=>T,x:()=>P,y:()=>F,z:()=>M}),(0,n("fui.util_554").Bv)([{rawString:".OneUpModal_6fa6ba72 .OneUpRoot_6fa6ba72{display:flex;flex-direction:row;position:absolute;top:45px;left:0;right:0;bottom:0}.OneUpModal_6fa6ba72 .OneUpRoot_6fa6ba72 .OneUpRightPane_6fa6ba72{min-width:320px}.OneUpModal_6fa6ba72 .OneUpRoot_6fa6ba72 .OneUpVersionHistoryRightPane_6fa6ba72{min-width:320px;overflow-y:auto!important}.OneUpModal_6fa6ba72 .OneUpRootLightBackground_6fa6ba72{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpModal_6fa6ba72 .OneUpRootDarkBackground_6fa6ba72{background-color:rgba(0,0,0,0)}.OneUpModal_6fa6ba72 [data-automation-id=CopilotPaneCommand]{min-width:32px!important;width:32px!important;margin:4px 2px!important}.OneUpModal_6fa6ba72 .OneUpRootNoCommandBar_6fa6ba72{display:flex;flex-direction:column;position:absolute;top:0;left:0;right:0;bottom:0}.OneUpModal_6fa6ba72 .OneUpDetailsPane_6fa6ba72{position:relative;width:380px;height:100%}.OneUpModal_6fa6ba72 .OneUpCommentsPane_6fa6ba72{padding:10px 10px 10px 20px;width:340px;height:calc(100% - 60px)}.OneUpModal_6fa6ba72 .OneUpCommentsPane_6fa6ba72 .OneUpCommentsPaneTitle_6fa6ba72{font-family:sans-serif;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:"}.OneUpModal_6fa6ba72 .OneUpVersionHistoryPane_6fa6ba72{padding:10px;width:630px}.OneUpModal_6fa6ba72 .OneUpDetailsPaneSpinner_6fa6ba72{height:100%;display:flex;justify-content:center;align-items:center}.OneUpModal_6fa6ba72 .OneUpViewer_6fa6ba72{position:relative;flex:1 1 auto}.OneUpModal_6fa6ba72 .OneUpAccessibleLoadAnnouncement_6fa6ba72{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUpModal_6fa6ba72 .OneUpCommandBar_6fa6ba72{display:flex;justify-content:space-between}.OneUpModal_6fa6ba72 div.OneUpRootAnimation_6fa6ba72{opacity:0;transition:opacity 367ms linear,visibility 367ms linear,transform 367ms linear}.OneUpModal_6fa6ba72 div.OneUpRootAnimation_6fa6ba72.OneUpEntrance_6fa6ba72{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_6fa6ba72 div.OneUpRootAnimation_6fa6ba72.OneUpExit_6fa6ba72{opacity:0;visibility:hidden}.OneUpModal_6fa6ba72 div.OneUpRootAnimation_6fa6ba72.OneUpEntranceV2_6fa6ba72{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_6fa6ba72 div.OneUpRootAnimation_6fa6ba72.OneUpExitV2_6fa6ba72{opacity:0;visibility:hidden}@media (prefers-reduced-motion){.OneUpModal_6fa6ba72 div.OneUpRootAnimation_6fa6ba72{transition:unset;opacity:1;visibility:inherit}}.OneUpCommandButtonPrimary_6fa6ba72{margin-left:5px;margin-right:5px}.OneUpCommandButtonPrimaryWhite_6fa6ba72{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpCommandButtonPrimaryWhiteV2_6fa6ba72{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"!important;border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"!important}.PreviousButton_6fa6ba72{position:absolute;top:50%;left:32px;z-index:9999}.NextButton_6fa6ba72{position:absolute;top:50%;right:32px}.OneUpContextMenuCommandIcon_6fa6ba72{display:flex}.OneUpNewBadge_6fa6ba72{margin-left:10px;align-self:center;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:inline-flex;align-items:center;justify-content:center;position:relative;font-size:.625rem;height:8px;padding:3px 6px;border-radius:20px}.OneUpHelpMenuOption_6fa6ba72{border:transparent;margin:5px}.OneUpHelpButton_6fa6ba72{width:32px;height:32px;position:absolute;bottom:12px;right:24px;z-index:99999;display:flex;flex-direction:column;align-items:center}.OneUpHelpButton_6fa6ba72 i{font-size:16px}.OneUpHelpButtonPerfBtnOpen_6fa6ba72{right:249px}.OneUpHelpButtonRightPaneOpen_6fa6ba72{right:364px}.OneUpHelpButtonVersionHistoryPaneOpen_6fa6ba72{right:694px}.OneUpHelpButtonDetailsPaneOpen_6fa6ba72{right:424px}.OneUpPerfButton_6fa6ba72{position:absolute;bottom:0;right:0;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;box-shadow:0 0 5px "},{theme:"black",defaultValue:"#000"},{rawString:";border-top-left-radius:10px;border-top-right-radius:10px}.OneUpPerfButton_6fa6ba72 .OneUpPerfButtonHeader_6fa6ba72{display:flex;flex-direction:row;justify-content:space-between;width:100%;border-radius:inherit}.OneUpPerfButton_6fa6ba72 .OneUpPerfButtonHeaderText_6fa6ba72{margin-top:5px;margin-left:10px}.OneUpPerfButton_6fa6ba72 .OneUpPerfButtonDivider_6fa6ba72{margin-left:10px;margin-right:10px}.OneUpPerfButton_6fa6ba72 .OneUpPerfButtonLink_6fa6ba72{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OneUpPerfButton_6fa6ba72 .OneUpPerfButtonContent_6fa6ba72{margin:10px;display:flex;flex-direction:row;align-items:flex-end}.versionHistoryNumber_6fa6ba72:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}::-webkit-scrollbar{width:14px;height:14px;scrollbar-width:thin;scrollbar-color:#605e5c transparent}::-webkit-scrollbar-thumb{-webkit-background-clip:content-box;background-clip:content-box;border-radius:8px;border:4px solid transparent;background-color:#605e5c}::-webkit-scrollbar-thumb:hover{background-color:#3b3a39}::-webkit-scrollbar-button{display:none}::-webkit-scrollbar-corner{background:0 0}@media (forced-colors:active){::-webkit-scrollbar{scrollbar-color:CanvasText transparent}::-webkit-scrollbar-thumb{background-color:CanvasText;border:4px solid Window}}"}]);const a="OneUpModal_6fa6ba72",i="OneUpRoot_6fa6ba72",r="OneUpRightPane_6fa6ba72",o="OneUpVersionHistoryRightPane_6fa6ba72",s="OneUpRootDarkBackground_6fa6ba72",c="OneUpRootNoCommandBar_6fa6ba72",d="OneUpDetailsPane_6fa6ba72",l="OneUpCommentsPane_6fa6ba72",u="OneUpCommentsPaneTitle_6fa6ba72",f="OneUpVersionHistoryPane_6fa6ba72",p="OneUpDetailsPaneSpinner_6fa6ba72",m="OneUpViewer_6fa6ba72",_="OneUpAccessibleLoadAnnouncement_6fa6ba72",h="OneUpRootAnimation_6fa6ba72",b="OneUpEntranceV2_6fa6ba72",g="OneUpExitV2_6fa6ba72",v="OneUpCommandButtonPrimary_6fa6ba72",y="OneUpCommandButtonPrimaryWhite_6fa6ba72",S="OneUpCommandButtonPrimaryWhiteV2_6fa6ba72",D="PreviousButton_6fa6ba72",I="NextButton_6fa6ba72",x="OneUpContextMenuCommandIcon_6fa6ba72",C="OneUpNewBadge_6fa6ba72",O="OneUpHelpMenuOption_6fa6ba72",w="OneUpHelpButton_6fa6ba72",E="OneUpHelpButtonPerfBtnOpen_6fa6ba72",A="OneUpHelpButtonRightPaneOpen_6fa6ba72",L="OneUpHelpButtonVersionHistoryPaneOpen_6fa6ba72",k="OneUpHelpButtonDetailsPaneOpen_6fa6ba72",M="OneUpPerfButton_6fa6ba72",P="OneUpPerfButtonHeader_6fa6ba72",T="OneUpPerfButtonHeaderText_6fa6ba72",U="OneUpPerfButtonDivider_6fa6ba72",F="OneUpPerfButtonLink_6fa6ba72",H="OneUpPerfButtonContent_6fa6ba72",R="versionHistoryNumber_6fa6ba72"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_826"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.l7)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>l,c:()=>o,e:()=>s,d:()=>r.a,f:()=>d});var a=n("odsp.util_118"),i=(n(371),n(182),n(123)),r=(new a.hK("list"),new a.hK("oAuthTokenDataSource"),new a.hK("siteScripts"),new a.hK("people"),n(89)),o=(new a.hK("recentList"),new a.hK("prefetchCache"),new a.hK("folder"),new a.hK("appsItem"),new a.hK("externallySharedItem"),new a.hK("popularItem"),new a.hK("subsiteItem"),new a.hK("mostViewsItem"),new a.hK("mostViewersItem"),new a.hK("settings"),new a.hK("getItem"),new a.hK("items"),new a.hK("versionControl"),new a.hK("versionHistory"),new a.hK("vault"),i.a),s=(new a.hK("peopleCardFactory"),new a.hK("peopleCard"),new a.hK("language"),new a.hK("languagePicker"),new a.hK("leftNav"),new a.hK("search"),new a.hK("sharing"),new a.hK("sharingLightSpeed"),new a.hK("sharingData"),new a.hK("groups"),new a.hK("suiteNav"),new a.hK("iosMobileAppPath"),new a.hK("url")),c=(new a.hK("universalAnnotation"),new a.hK("download")),d=(new a.hK("docFormat"),new a.hK("footer"),new a.hK("manifests"),new a.hK("itemActivityFeed"),new a.hK("itemActivityFeedHelper"),new a.hK("itemActivityFeedSharingHelper"),new a.hK("userInfo"),new a.hK("storageInfo"),new a.hK("storageOptions"),new a.hK("album"),new a.hK("tag"),new a.hK("shareByLink"),new a.hK("folderItemCount"),new a.hK("photo"),new a.hK("subscriptions"),new a.hK("analytics"),new a.hK("sendFeedback"),new a.hK("embed"),new a.hK("application"),new a.hK("policyTip"),new a.hK("policyTipLightSpeed"),new a.hK("customAction"),new a.hK("taxonomy"),new a.hK("web"),new a.hK("floodgate"),new a.hK("shortcutsDS"),new a.hK("encoding"),new a.hK("rating"),new a.hK("publish"),new a.hK("videoItem")),l=(new a.hK("sites"),new a.hK("copy"),new a.hK("upsell"),new a.hK("notifications"),new a.hK("command"),new a.hK("processFilters"),new a.hK("quota"),new a.hK("itemColumn"),new a.hK("bundle"),new a.hK("itemPicker"),new a.hK("site"),new a.hK("pushChannel"),new a.hK("itemAutoRefresh"),new a.hK("loginApp"),new a.hK("mruRecent"),new a.hK("pdf"),new a.hK("zip"),new a.hK("url2"),new a.hK("attachments"),new a.hK("spotlight"),new a.hK("error"),new a.hK("promotedPhotos"),new a.hK("fileHandler"),new a.hK("fileHandlerFromCache"),new a.hK("recycleBin"),new a.hK("deleteRestore"),new a.hK("instrumentation"),new a.hK("shadowCall"),new a.hK("graph"));new a.hK("formula"),new a.hK("appUrl"),new a.hK("graphUrl"),new a.hK("batchUploaderType"),new a.hK("vroomItemIdentityProcessor"),new a.hK("preAuth"),new a.hK("peopleService"),new a.hK("schema"),new a.hK("restore"),new a.hK("restore"),new a.hK("restoreActivities"),new a.hK("inAppMessaging"),new a.hK("notificationSettings"),new a.hK("itemInvalidator"),new a.hK("itemUpdator"),new a.hK("wopiFrame"),new a.hK("wrs"),new a.hK("excel"),new a.hK("winAppCommunicator"),new a.hK("wip"),new a.hK("worker"),new a.hK("checkUserAccessDataSource"),new a.hK("userExpiration"),new a.hK("itemMuteNotificationDataSource"),new a.hK("ticketRedeemer"),new a.hK("recommendList"),new a.hK("reportAbuse"),new a.hK("requestReview"),new a.hK("removeFromShareWithMeList")}
,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>i,b:()=>a}),function(e){e.FreeText="FreeText",e.Pen="Pen",e.Highlighter="Highlighter",e.Eraser="Eraser",e.Display="Display"}(a||(a={})),function(e){e.DarkYellow="#FED430",e.LightOrange="#FBAE17",e.Orange="#F36323",e.Red="#E3182D",e.DarkPurple="#5B318D",e.Purple="#914BB8",e.Magenta="#CF1278",e.DarkRed="#C10051",e.LightBlue="#3ECCFD",e.Blue="#0078D7",e.DarkBlue="#0051BA",e.LightGreen="#7EC400",e.Green="#00B44B",e.LightGrey="#EBEBEB",e.Grey="#B6B6B6",e.Black="#1F1F1F"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(e){this.viewHandler=e.viewHandler,this.inputEvtHandler=e.inputEvtHandler,this.metadata=e.metadata}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_826"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.l7)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>c,c:()=>s});var a=n("tslib_826"),i=n("react-lib"),r=i.createContext(void 0),o=i.createContext(function(){}),s=function(){return i.useContext(r)},c=function(){var e=i.useContext(o);return{updateSaveFreeText:i.useCallback(function(t){e(function(e){return(0,a.W_)((0,a.W_)({},e),{saveFreeText:t})})},[e])}},d=function(e){var t=e.children,n=e.enableFreeText,s=e.freeTextHandler,c=e.freeTextContainer,d=e.showEditableFreeTextAt,l=e.setInitialFontAttributes,u=(0,a.MS)(i.useState({saveFreeText:function(){}}),2),f=u[0],p=u[1],m=(0,a.W_)((0,a.W_)({},f),{enableFreeText:n,freeTextHandler:s,freeTextContainer:c,showEditableFreeTextAt:d,setInitialFontAttributes:l});return i.createElement(o.Provider,{value:p},i.createElement(r.Provider,{value:m},t))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>s,c:()=>d,d:()=>c,e:()=>u,f:()=>o});var a=n("odsp.util_118"),i=n(135),r=n(40),o=window._spPageContextInfo,s=function(){var e=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{e=e||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return e}(),c=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,d=!o||"21"===o.webTemplate&&700===o.listBaseTemplate,l=(window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,{Fallback:!a.HW.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")}),u=(a.HW.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly."),a.HW.isActivated("B1DF29B6-8677-490E-9A70-AB171BEF1F47","01/30/2024","Pass oneDs collector url to the photos app"),function(){var e=function(){if((0,i.a)())return{winappMajorVersion:100,winappMinorVersion:0,winappPatchVersion:0};var e=navigator.userAgent,t=e.substring(e.indexOf("OneDriveWinApp")),n=t&&t.split("/"),a=s&&(n.length>1?n[1].split("."):t);return{winappMajorVersion:a?parseInt(a[0],10):"-1",winappMinorVersion:a?parseInt(a[1],10):"-1",winappPatchVersion:a?parseInt(a[2],10):"-1"}}(),t=e.winappMajorVersion,n=e.winappMinorVersion,a=e.winappPatchVersion;return!(t<19||19===t&&(n<23||23===n&&a<7))});(0,r.a)({ODB:60863})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var a=n(5),i=n(25),r=n(116),o=n("odsp.util_118"),s="ApiUrlHelper",c=new o.hK({name:"".concat(s,".encodeWebAbsoluteUrl"),factory:new o.t_(!0)}),d=(0,o.c7)(s,r.a,{itemUrlHelper:i.c,pageContext:a.a,encodeWebAbsoluteUrl:c})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>l,c:()=>d});var a=n("tslib_826"),i=n("react-lib"),r=n.n(i),o={setMode:function(){},resetPageSelection:function(){},subscribe:function(){},unsubscribe:function(){},toggle:function(){}},s=(0,i.createContext)(o),c=(0,i.createContext)(function(){}),d=function(){return r().useContext(s)},l=function(){var e=r().useContext(c);return(0,i.useCallback)(function(t){e(function(e){return(0,a.W_)((0,a.W_)({},e),t)})},[e])},u=function(e){var t=e.children,n=(0,a.MS)((0,i.useState)(o),2),d=n[0],l=n[1];return r().createElement(c.Provider,{value:l},r().createElement(s.Provider,{value:d},t))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>d,c:()=>s,d:()=>o});var a=n("tslib_826"),i=n(83),r=n(87),o=function(e,t,n,o){var s,c,d,l,u,f=(0,a.MS)([e.x,e.y],2),p=f[0],m=f[1],_=(0,a.MS)([e.width,e.height],2),h=_[0],b=_[1];switch(o){case r.f.Degree90:p=(s=(0,a.MS)([t.height-m-b,p],2))[0],m=s[1],h=(c=(0,a.MS)([b,h],2))[0],b=c[1];break;case r.f.Degree180:p=(d=(0,a.MS)([t.width-p-h,t.height-m-b],2))[0],m=d[1];break;case r.f.Degree270:p=(l=(0,a.MS)([m,t.width-p-h],2))[0],m=l[1],h=(u=(0,a.MS)([b,h],2))[0],b=u[1]}return new i.b(p,m,h,b).scale(n||1)},s=function(e,t,n,a,r){var s=e.x,c=e.y,d=void 0===r?{width:0,height:0}:r,l=d.width,u=d.height;return o(new i.b(s,c,l,u),t,n,a)},c=function(e,t,n,o){var s,c,d,l=(0,a.MS)([e.x/n,e.y/n],2),u=l[0],f=l[1];switch(o){case r.f.Degree90:u=(s=(0,a.MS)([f,t.height-u],2))[0],f=s[1];break;case r.f.Degree180:u=(c=(0,a.MS)([t.width-u,t.height-f],2))[0],f=c[1];break;case r.f.Degree270:u=(d=(0,a.MS)([t.width-f,u],2))[0],f=d[1]}return new i.a(u,f)},d=function(e,t,n,a,o){var s=e.left,c=e.top,d=e.bottom,l=e.right,u=function(e,t){return new i.a(e*a+n,t*a)};switch(o){case r.f.Degree0:return u(s,d);case r.f.Degree90:return u(s,c);case r.f.Degree180:return u(t?l:s,c);case r.f.Degree270:return u(l,t?d:c);default:return new i.a(0,0)}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s,c:()=>r});var a=n("react-lib"),i=n(87),r=function(e){var t=a.useRef();return a.useEffect(function(){t.current=e}),t.current};function o(e){var t=a.useRef(e);t.current=e;var n=a.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.current;return a.apply(null,e)})}var s=function(e,t){var n=a.useRef(!1);a.useEffect(function(){if(t){var a=function(){n.current=!0},r=function(){n.current?n.current=!1:t()};return e.on(i.e.ResponsiveResize,a),e.on(i.e.ScaleChanged,r),e.on(i.e.RotationChanged,t),function(){e.off(i.e.ResponsiveResize,a),e.off(i.e.ScaleChanged,r),e.off(i.e.RotationChanged,t)}}},[e,t])}}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={}));const i=a}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("clientName")}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>o,c:()=>l,d:()=>d});var a=n("tslib_826"),i=n(310),r=n("react-lib"),o=function(e){return new i.a(e)},s=r.createContext(void 0),c=function(e){var t=e.children,n=(0,a.l7)(e,["children"]);return r.createElement(s.Provider,{value:o(n.strings)},t)},d=function(){return r.useContext(s)},l=function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){var e=new Error("Cannot find module '../../l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e})];case 1:return[2,e.sent().default]}})})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n("react-lib"),i=a.createContext(!1),r=function(e){var t=e.children,n=e.ariaHidden;return a.createElement(i.Provider,{value:n},t)},o=function(){return a.useContext(i)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_826"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.l7)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("fui.util_554"),i={AcceptMedium:"",Accounts:"",Add:"",AddFriend:"",AlertSolid:"",AlignLeft:"",AlignRight:"",AppIconDefault:"",Ascending:"",Attach:"",AutomateFlow:"",Back:"",BackToWindow:"",Blocked12:"",Blocked2:"",BlockedSite:"",BlockedSiteSolid12:"",BooleanData:"",CalculatorAddition:"",CalculatorMultiply:"",Calendar:"",CalendarDay:"",CalendarWeek:"",CalendarWorkWeek:"",Cancel:"",CC:"",CCSolid:"",Chat:"",CheckboxComposite:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CheckMark:"",ChevronDown:"",ChevronDownSmall:"",ChevronLeft:"",ChevronLeftMed:"",ChevronLeftSmall:"",ChevronRight:"",ChevronRightMed:"",ChevronRightSmall:"",ChevronUp:"",ChoiceColumn:"",ChromeClose:"",CircleAdditionSolid:"",CirclePlus:"",CircleRing:"",Clear:"",ClearFilter:"",ClosePaneMirrored:"",CloudPrinter:"",Color:"",Comment:"",CommentAdd:"",CompassNW:"",Completed:"",CompletedSolid:"",Contact:"",Copy:"",CriticalErrorSolid:"",Currency:"",DateTime2:"",Delete:"",Descending:"",Diamond:"",Document:"",DocumentApproval:"",Down:"",Download:"",DynamicList:"",Edit:"",EditListPencil:"",EditNote:"",Embed:"",EntityExtraction:"",Error:"",ErrorBadge:"",ExcelDocument:"",ExcelLogo:"",FabricFolder:"",FabricFolderLink:"",FabricMovetoFolder:"",FabricOpenFolderHorizontal:"",Favicon:"",FavoriteStar:"",FavoriteStarFill:"",Feedback:"",FileRequest:"",Filter:"",Flag:"",Flow:"",Folder:"",FullScreen:"",FullView:"",Glimmer:"",GlobalNavButton:"",Globe:"",GridViewMedium:"",GripperBarVertical:"",GripperDotsVertical:"",GroupedList:"",GroupList:"",Handwriting:"",Heart:"",HeartFill:"",History:"",Home:"",HomeGroup:"",Info:"",InfoSolid:"",LargeGrid:"",Library:"",Lightbulb:"",Link:"",Link12:"",List:"",Lock:"",Mail:"",MailAttached:"",Market:"",Megaphone:"",MicrosoftTranslatorLogo:"",More:"",MoreVertical:"",Number:"",ODLink:"",OneDriveAdd:"",OpenFile:"",OpenFolderHorizontal:"",OpenPane:"",OpenPaneMirrored:"",OutlookLogo:"",Page:"",PDF:"",People:"",PeopleAdd:"",Photo2:"",Pin:"",Pinned:"",PinnedSolid:"",PinSolid12:"",PinSolidOff12:"",PinToTab:"",Play:"",PlayerSettings:"",PlaylistMusic:"",POI:"",PopExpand:"",PowerApps2Logo:"",PowerAutomateLogo:"",PowerPointDocument:"",ReadingMode:"",ReadOutLoud:"",RecycleBin:"",ReminderPerson:"",RemoveFilter:"",Rename:"",Reply:"",Ringer:"",SavedOffline:"",Search:"",SecurityGroup:"",Send:"",Settings:"",Share:"",ShareiOS:"",Signin:"",SingleBookmark:"",SingleBookmarkSolid:"",SingleColumnEdit:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",Snooze:"",Sort:"",SortDown:"",SortLines:"",SortUp:"",Speech:"",SpeechOff:"",StackIndicator:"",StatusCircleCheckmark:"",Stop:"",Switch:"",SyncStatusSolid:"",SyncToPC:"",Tag:"",TagUnknown12:"",TagUnknown12Mirror:"",Taskboard:"",TeamsLogo:"",TextDocument:"",TextDocumentShared:"",TextField:"",Tiles:"",Trending12:"",UnavailableOffline:"",Undo:"",Uneditable2:"",Unknown:"",Unpin:"",Up:"",Upload:"",View:"",ViewAll:"",ViewList:"",VisioLogo:"",Warning12:"",WarningSolid:"",WordDocument:"",Work:""};function r(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('".concat(e,"odsp-next-icons-6109c629.woff') format('woff')")},icons:i};(0,a.bV)(n,t)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>l});var a=n("tslib_826"),i=n(165),r=n("react-lib"),o=n(94),s=n(318),c=n(383),d=r.lazy(function(){return n.e(27).then(n.bind(n,655)).then(function(e){return{default:e.PdfJsPreviewer}})}),l=r.forwardRef(function(e,t){var n=e.filename,l=e.url,u=e.token,f=e.enablePreview,p=e.onDocumentLoaded,m=e.onDocumentFullyLoaded,_=e.onFirstRenderVisible,h=e.onNeedPassword,b=e.onDocumentPreviewed,g=r.useRef(null),v=r.useRef(null),y=r.useRef(void 0),S=r.useRef(void 0),D=r.useRef(void 0),I=r.useRef(void 0),x=(0,a.MS)(r.useState(!1),2),C=x[0],O=x[1];r.useImperativeHandle(t,function(){return{isMip:function(){var e;return f&&D.current?D.current.mip:!!(null===(e=g.current)||void 0===e?void 0:e.isMip)},getFilename:function(){return void 0===n?(0,s.a)(l):n},getViewer:function(){return g.current},verifyPassword:function(e,t){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return f&&!C&&v.current?(y.current=e,null===(n=v.current)||void 0===n||n.verifyPassword(e,t),[3,3]):[3,1];case 1:return g.current?[4,null===(i=g.current)||void 0===i?void 0:i.verifyPassword(e,t)]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})}}},[f,n,C,l]),r.useEffect(function(){i.a.mark("Start")},[]);var w=r.useCallback(function(e){D.current=e,null==b||b(),e.mip&&(null==p||p(e))},[p,b]),E=r.useCallback(function(e){y.current=void 0,I.current=void 0,null==p||p(e)},[p]),A=r.useCallback(function(){null==_||_()},[_]),L=r.useCallback(function(){f?null==m||m():null==_||_()},[f,m,_]),k=r.useCallback(function(e,t){var n;S.current=t,I.current=e,(null===(n=D.current)||void 0===n?void 0:n.mip)||O(!0)},[]),M=r.useCallback(function(){var e;(null===(e=D.current)||void 0===e?void 0:e.mip)||O(!0)},[]);return f&&o.a.pdfJsWorkerSrc&&!C?r.createElement(r.Suspense,{fallback:r.createElement("div",null)},r.createElement(d,{ref:v,url:l,token:u,workerSrc:o.a.pdfJsWorkerSrc,cMapUrl:o.a.pdfJsCmapUrl,onDocumentLoaded:w,onFirstPageRendered:A,onDocumentFetched:k,onDocumentLoadFailed:M,onNeedPassword:h})):r.createElement(c.a,(0,a.W_)({key:l,componentRef:g},e,{fileData:I.current,defaultPageNumber:S.current||e.defaultPageNumber,defaultScale:e.defaultScale,initialPassword:y.current,onDocumentLoaded:E,onFirstRenderVisible:L}))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r,c:()=>a,d:()=>i}),(0,n("fui.util_554").Bv)([{rawString:".pdfOuter_27b1583c{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%}.pdfViewer_27b1583c{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0;overflow:auto;width:100%;height:100%;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.pdfContent_27b1583c{position:relative;overflow:hidden;min-width:100%;min-height:100%}.fillSize_27b1583c{width:100%;height:100%}.hidden_27b1583c{visibility:hidden}"}]);var a="pdfOuter_27b1583c",i="pdfViewer_27b1583c",r="pdfContent_27b1583c",o="fillSize_27b1583c"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_826"),i=n(71),r=n("react-lib");(0,n("fui.util_554").Bv)([{rawString:'.inputWrapper_e17f0b58{display:inline-block;height:100%}input{height:24px;border:1px solid;border-radius:2px;background-color:"#ffffff";color:"#323130"}input:focus{outline:none}'}]);var o=function(e){var t=e.visible,n=e.autoFocusOnInput,o=e.onEnterWhenFocused,s=e.onShiftEnterWhenFocused,c=e.inputProps,d=e.rootProps,l=e.outerRef,u=e.children,f=(0,a.MS)(r.useState(!1),2),p=f[0],m=f[1],_=r.useRef(null),h=r.useRef(null),b=(0,i.a)();r.useEffect(function(){var e,a;t&&n&&(null===(e=_.current)||void 0===e||e.focus(),m(!0),null===(a=h.current)||void 0===a||a.focus())},[n,t]);var g=r.useCallback(function(e){var t,n;switch(e.key){case"Enter":h.current===document.activeElement?e.shiftKey?null==s||s():null==o||o():(m(!0),null===(t=h.current)||void 0===t||t.focus());break;case"Escape":m(!1),null===(n=_.current)||void 0===n||n.focus(),e.stopPropagation(),e.preventDefault()}},[o,s]),v=r.useCallback(function(e){var t;null===(t=c.onBlur)||void 0===t||t.call(c,e),m(!1)},[c]);return r.createElement("div",{ref:l,className:"inputWrapper_e17f0b58"},r.createElement("div",(0,a.W_)({},d,{ref:_,"data-is-focusable":!0,onKeyDown:g}),r.createElement("input",(0,a.W_)({},c,{ref:h,style:{borderColor:b.semanticColors.inputBorder,backgroundColor:b.semanticColors.inputBackground,color:b.semanticColors.inputText},"data-is-focusable":p,onBlur:v})),r.createElement("style",null,"::placeholder {color: ".concat(b.semanticColors.inputPlaceholderText,"; }")),u))};o.defaultProps={visible:!0,autoFocusOnInput:!1}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("engagementHandlers")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("getOneUpOnePlayerResources")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>a});var a={ODB:61471},i={ODB:61546}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>m});var a=n("odsp.util_118"),i=n("tslib_826"),r=n(65),o=n(69),s=n(32),c=n(20),d=function(){function e(e,t){var n=this,s=t.cookieRefresher,c=t.pageContext,d=t.noRedirect,l=void 0===d?!a.HW.isActivated("22A14184-8C68-4EA3-8CA6-09C8A9009A71")||void 0:d;this._pageContext=c;var u=s?{getFormDigest:function(e){return(0,i.Zd)(n,void 0,void 0,function(){return(0,i.qr)(this,function(t){switch(t.label){case 0:return[4,s.refreshCookies({resource:e.url,expiration:e.expiration,claimsChallenge:e.claimsChallenge})];case 1:return t.sent(),[2,void 0]}})})}}:void 0;this._dataRequestor=new o.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:c,tokenProvider:u,noRedirect:l}),this._apiUrlHelper=new r.a({webAbsoluteUrl:c.webAbsoluteUrl})}return e.prototype.getToken=function(e){var t=e.name,n=e.resource,r=e.tokenType,o={resource:n,tokenType:r};if(!a.HW.isActivated("3985CFAD-51BE-4D3E-A7F9-F1C2ADFD85E4","09/18/2023","Validate that self-signed resource is in tenant")){var d=new c.b({context:this._pageContext}).getUrlParts({webUrl:n});if("SPO"===r&&d.geoRelation===c.a.unknown)throw new a.EI({code:"InvalidTenantForSelfSignedToken"})}var l=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString();return this._dataRequestor.getData({url:l,method:"POST",qosName:"AcquireToken."+t,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},allowOAuth:!1,parseResponse:function(e,t){var n=JSON.parse(e),a=t.getCorrelationId();return(0,i.W_)((0,i.W_)({},n),{correlationId:a})},additionalPostData:JSON.stringify(o),telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var a=t.code;if(a&&(a.indexOf("0x80070005")>-1||a.indexOf("10012")>-1))return{eventData:(0,i.W_)((0,i.W_)({},n),{resultType:s.a.ExpectedFailure})}}return{eventData:n}}})},e}(),l=n(5),u=n(375),f=n(193),p=(0,a.c7)("".concat("AcquireTokenFetcher.key",".tokenFetcher"),d,{pageContext:l.a,cookieRefresher:u.a.optional,noRedirect:f.a}),m=new a.hK({name:"TokenFetcher.key",factory:new a.S7(p)})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("CookieRefresher")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>i});var a=n(66),i=function(){function e(){this._state={}}return e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]},e.prototype.setValue=function(e,t){t?this._state[e]=t:delete this._state[e]},e}(),r=function(){function e(e){var t=e.userId,n=e.cachingType;this._store=new a.a("Identity.OAuth.".concat(t),n)}return e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)},e.prototype.setValue=function(e,t){t?this._store.setValue(e,t):this._store.remove(e)},e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n("odsp.util_118"),i=n(91),r=n(378),o=n(379),s=new a.hK({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.a},create:function(e){var t=new r.a,n=new o.a(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_826");const i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.XJ)(t,e),t.prototype.trackPromise=function(e){var t=!1,n=this.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.trackSignal=function(e){return this.attach({dispose:function(){e.cancel()}}),e},t}(n(131).a)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(){function e(e){this._value=e,this._observers=new Set}return e.prototype.get=function(){return this._value},e.prototype.set=function(e){this._value=e,this._observers.forEach(function(e){e()})},e.prototype.subscribe=function(e){var t=this;return this._observers.add(e),function(){t._observers.delete(e)}},e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_118"),i=new a.hK({name:"cookieOrigin",factory:new a.t_(window.location.origin)})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_826"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.l7)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>It});var a=n("tslib_826"),i=n("fui.util_554");(0,i.Bv)([{rawString:"#printContainer_e193b7f6{display:none}@media print{body{background:rgba(0,0,0,0)}body[data-pdfprinting]>*{display:none}#printContainer_e193b7f6{display:block;height:100%}#printContainer_e193b7f6>div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:100%;page-break-after:always;page-break-inside:avoid}#printContainer_e193b7f6>div img{max-width:100%;max-height:100%}}"}]);var r=n(147),o=n(12),s=n(316),c=n(83),d=n(204),l=n.n(d),u=n(317),f=n(61),p=n(319),m=n(166),_=n(82),h=n(165),b=n(81),g=n(60),v=n(702);const y=Symbol("Comlink.proxy"),S=Symbol("Comlink.endpoint"),D=Symbol("Comlink.releaseProxy"),I=Symbol("Comlink.thrown"),x=e=>"object"==typeof e&&null!==e||"function"==typeof e,C=new Map([["proxy",{canHandle:e=>x(e)&&e[y],serialize(e){const{port1:t,port2:n}=new MessageChannel;return O(e,t),[n,[n]]},deserialize:e=>(e.start(),E(e))}],["throw",{canHandle:e=>x(e)&&I in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function O(e,t=self){t.addEventListener("message",function n(a){if(!a||!a.data)return;const{id:i,type:r,path:o}=Object.assign({path:[]},a.data),s=(a.data.argumentList||[]).map(T);let c;try{const t=o.slice(0,-1).reduce((e,t)=>e[t],e),n=o.reduce((e,t)=>e[t],e);switch(r){case"GET":c=n;break;case"SET":t[o.slice(-1)[0]]=T(a.data.value),c=!0;break;case"APPLY":c=n.apply(t,s);break;case"CONSTRUCT":c=function(e){return Object.assign(e,{[y]:!0})}(new n(...s));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;O(e,n),c=function(e,t){return M.set(e,t),e}(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(e){c={value:e,[I]:0}}Promise.resolve(c).catch(e=>({value:e,[I]:0})).then(e=>{const[a,o]=P(e);t.postMessage(Object.assign(Object.assign({},a),{id:i}),o),"RELEASE"===r&&(t.removeEventListener("message",n),w(t))})}),t.start&&t.start()}function w(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function E(e,t){return L(e,[],t)}function A(e){if(e)throw new Error("Proxy has been released and is not useable")}function L(e,t=[],n=function(){}){let a=!1;const i=new Proxy(n,{get(n,r){if(A(a),r===D)return()=>U(e,{type:"RELEASE",path:t.map(e=>e.toString())}).then(()=>{w(e),a=!0});if("then"===r){if(0===t.length)return{then:()=>i};const n=U(e,{type:"GET",path:t.map(e=>e.toString())}).then(T);return n.then.bind(n)}return L(e,[...t,r])},set(n,i,r){A(a);const[o,s]=P(r);return U(e,{type:"SET",path:[...t,i].map(e=>e.toString()),value:o},s).then(T)},apply(n,i,r){A(a);const o=t[t.length-1];if(o===S)return U(e,{type:"ENDPOINT"}).then(T);if("bind"===o)return L(e,t.slice(0,-1));const[s,c]=k(r);return U(e,{type:"APPLY",path:t.map(e=>e.toString()),argumentList:s},c).then(T)},construct(n,i){A(a);const[r,o]=k(i);return U(e,{type:"CONSTRUCT",path:t.map(e=>e.toString()),argumentList:r},o).then(T)}});return i}function k(e){const t=e.map(P);return[t.map(e=>e[0]),(n=t.map(e=>e[1]),Array.prototype.concat.apply([],n))];var n}const M=new WeakMap;function P(e){for(const[t,n]of C)if(n.canHandle(e)){const[a,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:a},i]}return[{type:"RAW",value:e},M.get(e)||[]]}function T(e){switch(e.type){case"HANDLER":return C.get(e.name).deserialize(e.value);case"RAW":return e.value}}function U(e,t,n){return new Promise(a=>{const i=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),a(n.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)})}var F,H=n("react-lib"),R=n.n(H),N=n(175),B=n(87),j=function(e,t){void 0===t&&(t=1);var n=e.map(function(e){return e.height*t}),i=e.map(function(e){return e.width*t}),r=e.length;return{width:Math.max.apply(Math,(0,a.AE)([],(0,a.MS)(n),!1))+(N.j+N.k)*t,height:(N.h+(r-1)*N.i+N.g)*t+i.reduce(function(e,t){return e+t},0)}},V=function(){function e(e,t,n,a,i,r,o,s,c,d,l,u){void 0===i&&(i=!1),void 0===r&&(r=!0),void 0===o&&(o=!0),void 0===s&&(s=!0),void 0===c&&(c=!0),void 0===d&&(d=!0),void 0===l&&(l=!0),void 0===u&&(u=!0),this._isMipDecrypted=!1,this._isAnnotAllowed=!0,this._isFormFieldAllowed=!0,this._isCopyAllowed=!0,this._isEditAllowed=!0,this._isPrintAllowed=!0,this._isCopyAccessibleAllowed=!0,this._isSignAllowed=!0,this._scale=1,this._rotation=B.f.Degree0,this._originalLayoutSize=e,this._layoutSize=e,this._pageCount=t,this._originalPageSizes=n,this._pageSizes=n,_.a.verbose("PdfMetadata","Page count ".concat(t,", layout size (").concat(e.width,", ").concat(e.height,")")),this._mip=!!a,this._isMipDecrypted=i,this._isAnnotAllowed=r,this._isFormFieldAllowed=o,this._isCopyAllowed=s,this._isEditAllowed=c,this._isPrintAllowed=d,this._isCopyAccessibleAllowed=l,this._isSignAllowed=u}return e.prototype.updateOriginalLayoutForProgressiveLoading=function(e,t){var n=this,a=this.inverted?t.map(function(e){var t=e.width;return{width:e.height,height:t}}):t,i=a.length!==this.originalPageSizes.length||a.some(function(e,t){var a=e.width,i=e.height;return a!==n._originalPageSizes[t].width||i!==n._originalPageSizes[t].height});return i&&(this._originalPageSizes=a,this._originalLayoutSize=this.inverted?j(a):e,this.updateSizes()),i},e.prototype.addRotation=function(e){this._rotation=(this._rotation+e)%(B.f.Degree270+1),this.updateSizes()},Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e,this.updateSizes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return this._pageCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalLayoutSize",{get:function(){return this._originalLayoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layoutSize",{get:function(){return this._layoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalPageSizes",{get:function(){return this._originalPageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageSizes",{get:function(){return this._pageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inverted",{get:function(){return this.rotation===B.f.Degree90||this.rotation===B.f.Degree270},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mip",{get:function(){return this._mip},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMipDecrypted",{get:function(){return this._isMipDecrypted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAnnotAllowed",{get:function(){return this._isAnnotAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFormFieldAllowed",{get:function(){return this._isFormFieldAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCopyAllowed",{get:function(){return this._isCopyAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEditAllowed",{get:function(){return this._isEditAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrintAllowed",{get:function(){return this._isPrintAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCopyAccessibleAllowed",{get:function(){return this._isCopyAccessibleAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSignAllowed",{get:function(){return this._isSignAllowed},enumerable:!1,configurable:!0}),e.prototype.getDocPermissions=function(){return[{type:"Annot",isAllowed:this.isAnnotAllowed},{type:"Copy",isAllowed:this.isCopyAllowed},{type:"CopyAccessible",isAllowed:this.isCopyAccessibleAllowed},{type:"Edit",isAllowed:this.isEditAllowed},{type:"FormField",isAllowed:this.isFormFieldAllowed},{type:"Print",isAllowed:this.isPrintAllowed},{type:"Sign",isAllowed:this.isSignAllowed}]},e.prototype.updateSizes=function(){this.updatePageSizes(),this.updateLayoutSize()},e.prototype.updatePageSizes=function(){var e=this;this._pageSizes=this.originalPageSizes.map(function(t){var n=t.width*e.scale,a=t.height*e.scale,i=!e.inverted;return{width:i?n:a,height:i?a:n}})},e.prototype.updateLayoutSize=function(){this._layoutSize=this.inverted?j(this.originalPageSizes,this.scale):{width:this.originalLayoutSize.width*this.scale,height:this.originalLayoutSize.height*this.scale}},e}(),z=function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var t,n,i,r,o;return(0,a.qr)(this,function(a){switch(a.label){case 0:return m.a.isActivated("ExposePdfPermission")?[3,2]:[4,e.getDocumentMetaData()];case 1:return t=a.sent(),[2,new V(t.layoutSize,t.pageCount,t.pagesSize,t.isMip,t.isMipDecrypted,t.isAnnotAllowed,t.isFormFieldAllowed,t.isCopyAllowed,t.isEditAllowed,t.isPrintAllowed,t.isCopyAccessibleAllowed,t.isSignAllowed)];case 2:return[4,e.getDocumentLayoutSize()];case 3:return n=a.sent(),[4,e.getPageCount()];case 4:return i=a.sent(),[4,e.getPageSizes()];case 5:return r=a.sent(),[4,e.isMip()];case 6:return o=a.sent(),[2,new V(n,i,r,o)]}})})},G=function(){function e(e,t,n){this._viewHandler=e,this._inputEvtHandler=t,this._metadata=n}return e.getInstance=function(t,n){return(0,a.Zd)(this,void 0,void 0,function(){var i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return i=e.bind,r=[void 0,t,n],[4,z(t)];case 1:return[2,new(i.apply(e,r.concat([a.sent()])))]}})})},e.prototype.dispose=function(){this._viewHandler.dispose()},e.prototype.initMetadata=function(){return(0,a.Zd)(this,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return e=this,[4,z(this.viewHandler)];case 1:return e._metadata=t.sent(),[2]}})})},e.prototype.updateOriginalLayoutForProgressiveLoading=function(){return(0,a.Zd)(this,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,this._viewHandler.getDocumentLayoutSize()];case 1:return e=n.sent(),[4,this._viewHandler.getPageSizes()];case 2:return t=n.sent(),[2,this._metadata.updateOriginalLayoutForProgressiveLoading(e,t)]}})})},Object.defineProperty(e.prototype,"viewHandler",{get:function(){return this._viewHandler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputEvtHandler",{get:function(){return this._inputEvtHandler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),e}(),K=n(177),W=n.n(K),q=n(354),Q=n(534),Y=n(347),J=function(e){function t(t,n,i,r,o,d,l,f,p){var m=e.call(this,t)||this;return m.isSelecting=!1,m.scrollIntoView=W()(function(){if(m.searchScrollPayload){var e=m.searchScrollPayload,t=e.page,n=e.x,a=e.y,i=e.width,r=e.height,o=m.metadata,s=o.originalPageSizes,d=o.rotation,l=o.scale,u=(0,q.d)(new c.b(n,a,i,r),s[t],l,d).origin;m.goToPageFn(t,u,!0)}},500),m.handleTextSelected=W()(function(){var e;m.selectedText&&""!==m.selectedText&&(s.a.read(m.l10n.get("textSelectedAria",[m.selectedText])),null===(e=m.onTextSelected)||void 0===e||e.call(m,m.selectedText))},500),m.onKeyDown=function(e){return(0,a.Zd)(m,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:if(!e.ctrlKey)return[3,5];switch(e.code){case"KeyA":return[3,1];case"KeyC":return[3,3]}return[3,4];case 1:return e.preventDefault(),[4,this.viewHandler.selectAll()];case 2:return t.sent(),[3,5];case 3:return this.copyToClipboard(),[3,5];case 4:return[3,5];case 5:return[2]}})})},m.copyToClipboard=function(){m.selectedText&&window.navigator.clipboard.writeText(m.selectedText)},m.getPageText=function(e){return(0,a.Zd)(m,void 0,void 0,function(){return(0,a.qr)(this,function(t){return[2,this.viewHandler.getPageText(e)]})})},m.renderRect=function(e,t){return(0,a.Zd)(m,void 0,void 0,function(){var n,i,r,o=this;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=this.metadata.layoutSize,[4,this.viewHandler.selectRender(e.scale((0,u.a)()),{width:(0,u.b)(n.width),height:(0,u.b)(n.height)})];case 1:return(i=a.sent())&&(r=(0,Q.a)(i),requestAnimationFrame(function(){o.setStatesFn(r),null==t||t()})),[2]}})})},m.pointerDown=!1,m.layoutManager=n,m.l10n=i,m.setStatesFn=r,m.goToPageFn=o,m.scrollViewerFn=d,m.onTextSelected=l,m.onTextDeselected=f,m.refreshViewPortForProgressiveLoadingFn=p,m}return(0,a.XJ)(t,e),t.prototype.onNotification=function(e){var t;return(0,a.Zd)(this,void 0,void 0,function(){var n,i,r,o,s,c,d;return(0,a.qr)(this,function(a){switch(a.label){case 0:switch(e.name){case 13:return[3,1];case 4:return[3,2];case 2:return[3,6];case 7:return[3,8]}return[3,9];case 1:return this.selectedText=e.payload,!this.pointerDown&&this.isSelecting&&this.handleTextSelected(),[3,10];case 2:return n=e.payload,i=n.left,r=n.top,o=n.right,s=n.bottom,c=(0,Q.b)(i,r,o,s,this.metadata.scale),[4,null===(t=this.refreshViewPortForProgressiveLoadingFn)||void 0===t?void 0:t.call(this)];case 3:return a.sent()?[3,5]:[4,this.renderRect(c)];case 4:a.sent(),a.label=5;case 5:return[3,10];case 6:return d=this.layoutManager.viewportRectRelativeToDocument,[4,this.renderRect(d)];case 7:return a.sent(),[3,10];case 8:return this.searchScrollPayload=e.payload,this.scrollIntoView(),[3,10];case 9:return[3,10];case 10:return[2]}})})},t.prototype.onPointerDown=function(e){0===e.button&&(this.pointerDown=!0,this.deselectText(),this.isSelecting=!0)},t.prototype.onPointerMove=function(e){this.pointerDown&&this.trySelectionAutoScroll(e)},t.prototype.onPointerUp=function(){this.pointerDown&&(this.pointerDown=!1,this.cancelSelectionScrollTimer(),this.selectText(),this.isSelecting=!1)},t.prototype.selectText=function(){this.handleTextSelected()},t.prototype.deselectText=function(){var e,t=this.selectedText;this.selectedText="",t&&!this.selectedText&&(null===(e=this.onTextDeselected)||void 0===e||e.call(this,t))},t.prototype.onGripperMove=function(e){this.trySelectionAutoScroll(e)},t.prototype.onGirpperUp=function(){this.cancelSelectionScrollTimer()},t.prototype.hasTextSelected=function(){return!!this.selectedText},t.prototype.trySelectionAutoScroll=function(e){var t=this;this.cancelSelectionScrollTimer();var n=this.layoutManager.rootRect,a=n.y,i=a+n.getClientHeight(),r=e.y<=a,o=e.y>=i;if(!r&&!o)return!1;var s,c,d=r?e.y-a:e.y-i;return this.selectionAutoScrollTimerId=(s=function(){var e;null===(e=t.scrollViewerFn)||void 0===e||e.call(t,0,Math.min(N.b,d*N.c))},c=N.a,s(),window.setInterval(s,c)),!0},t.prototype.cancelSelectionScrollTimer=function(){this.selectionAutoScrollTimerId&&(window.clearInterval(this.selectionAutoScrollTimerId),this.selectionAutoScrollTimerId=void 0)},t}(Y.a),X=n(309),Z=n(318),$="PdfDocumentLoader",ee=function(){function e(e,t,n,a,i){void 0===n&&(n=0),void 0===a&&(a=!1),this.url=e,this.token=i,this._filename=void 0===t?(0,Z.a)(this.url):t,this._fileSize=n,this._enableRanges=a,this.abortController=new AbortController}return e.prototype.initPdfDocumentLoaderByQueue=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t;return(0,a.qr)(this,function(i){switch(i.label){case 0:return[4,(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(28).then(n.bind(n,658))];case 1:return[2,e.sent().PdfDocumentLoaderByQueue]}})})];case 1:return t=i.sent(),this._documentLoaderByQueue=new t(this.url,this._fileSize,e),[2]}})})},e.prototype.requestRange=function(e,t){var n;null===(n=this._documentLoaderByQueue)||void 0===n||n.requestRange(e,t)},e.prototype.fetchChunks=function(){var e;null===(e=this._documentLoaderByQueue)||void 0===e||e.fetchChunks()},e.prototype.dispose=function(){var e;this.abortController.abort(),null===(e=this._documentLoaderByQueue)||void 0===e||e.dispose()},e.prototype.fetch=function(e){return void 0===e&&(e=!1),(0,a.Zd)(this,void 0,void 0,function(){var t,n,i,r,o,s,c,d,l,u,p,m=this;return(0,a.qr)(this,function(a){switch(a.label){case 0:t="",null==(n=e?function(e){t+=" | ".concat(e)}:void 0)||n("Start fetch, url: ".concat(this.url,", filename: ").concat(this._filename,", enableRanges: ").concat(this._enableRanges)),this.abortController.abort(),i=this._enableRanges&&0!==this._fileSize,a.label=1;case 1:return a.trys.push([1,6,,7]),r=(this.abortController=new AbortController).signal,o={credentials:"same-origin",signal:r},this.token&&(o.headers={Authorization:"".concat(this.token)}),null==n||n("requestInit: ".concat(JSON.stringify(o))),i?[4,(0,X.b)(this.url,o,this._fileSize,function(){m.abortController.abort()},"GetDocument")]:[3,3];case 2:return c=a.sent(),[3,5];case 3:return[4,(0,X.c)(this.url,o,"GetDocument",n)];case 4:c=a.sent(),a.label=5;case 5:return s=c,_.a.verbose($,"The document is fetched"),d=new Uint8Array(s,0,s.byteLength),this._fileSize=d.byteLength,[2,d];case 6:if(l=a.sent(),null==n||n("Error: ".concat(l,", errorStack: ").concat(l.stack)),"AbortError"===l.name)return _.a.info($,"Aborted the document fetching request"),[2];throw u="NetworkError"===l.name?l.status:void 0,p=new f.c(f.b.FileDownloadFailed,"Fail to download the PDF file, \n          status: ".concat(u,", \n          downloadByRange?: ").concat(i,", \n          fileSize: ").concat(this._fileSize,", \n          noTempAuth: ").concat(!this.url.toLowerCase().includes("tempauth"),",\n          useToken: ").concat(!!this.token,", \n          debugString: ").concat(t)),b.a.logError(p.toCaughtError()),l.message+=t,l;case 7:return[2]}})})},Object.defineProperty(e.prototype,"filename",{get:function(){return this._filename},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fileSize",{get:function(){return this._fileSize},enumerable:!1,configurable:!0}),e}(),te=function(){function e(e){this.noFailedAttempt=!0,this.onNeedPassword=e}return e.prototype.tryOpen=function(e,t){var n;return void 0===e&&(e=""),(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(a){switch(a.label){case 0:return this._viewHandler?[4,this._viewHandler.openDocument(e)]:[2,!1];case 1:return a.sent()?[2,!0]:(this.noFailedAttempt?(null===(n=this.onNeedPassword)||void 0===n||n.call(this),this.noFailedAttempt=!1):null==t||t(),[2,!1])}})})},Object.defineProperty(e.prototype,"viewHandler",{set:function(e){this._viewHandler=e},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.noFailedAttempt=!0},e}(),ne="PdfFreeTextService",ae=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.setInitialFontAttributes=function(e){r.initialFontAttribute=e},r.getAccDataInPage=function(e){return(0,a.Zd)(r,void 0,void 0,function(){return(0,a.qr)(this,function(t){return[2,this.viewHandler.getAccDataInPage(e)]})})},r.applyFreeTextAttributes=function(){if(!m.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var e=window.localStorage.getItem(N.q);if(e){var t=JSON.parse(e);r.setInitialFontAttributes(t)}}catch(e){_.a.error(ne,e)}},r.originalPageRects=n,r.dispatchEventFn=i,r.initialFontAttribute={fontSize:14,fontColor:N.p},r.applyFreeTextAttributes(),r}return(0,a.XJ)(t,e),t.prototype.onNotification=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t,n,i,r,o,s,c,d,l,u,f;return(0,a.qr)(this,function(p){if(0===this.originalPageRects.length)return[2];switch(t={},e.name){case 18:n=e.payload,i=n.position,r=n.pageIndex,t={pageIndex:r,id:0,boundingBox:{left:i.x,top:i.y,right:0,bottom:0},text:"",textColor:this.initialFontAttribute.fontColor,fontSize:this.initialFontAttribute.fontSize,lineHeight:14*N.r/10,characterSpacing:N.n,newCreated:!0},this.dispatchEventFn(B.e.ShowFreeText,t);break;case 19:o=e.payload.freeText,s=o.boundingBox,c=s.left,d=s.top,l=s.right,u=s.bottom,f={left:c,top:d,right:c+(l-c),bottom:d+(u-d)},o.boundingBox=f,(t=(0,a.W_)((0,a.W_)({},o),{newCreated:!1})).fontSize=t.fontSize*this.metadata.scale,this.dispatchEventFn(B.e.ShowFreeText,t);break;case 20:this.dispatchEventFn(B.e.AnnotationChanged)}return[2]})})},t.prototype.storeFreeTextAttribute=function(){if(!m.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var e=JSON.stringify(this.initialFontAttribute);window.localStorage.setItem(N.q,e)}catch(e){_.a.error(ne,e)}},t}(Y.a),ie=n(535),re=function(e){switch(e){case"Content":return 0;case"Cursor":return 1;case"Link":return 2;case"Search":return 3;case"Ink":return 4;case"Document":return 5;case"Gripper":return 7;case"RangeRequest":return 8;case"FreeText":return 6;case"UpdateViewport":return 9;default:return 10}},oe=function(e){switch(e){case"DocumentSaved":return 0;case"InkStrokesAdded":return 1;case"InvalidateRect":return 4;case"InvalidateAll":return 2;case"DocumentSizeUpdated":return 3;case"SetDocumentDirty":return 8;case"ScrollIntoView":return 7;case"UpdateCursor":return 9;case"UpdateNumberOfFindResults":return 11;case"UpdateSelectedFindResult":return 12;case"UpdateLinkRect":return 10;case"UpdateSelectedText":return 13;case"NavigateTo":return 5;case"NavigateToDest":return 6;case"GripperPositionChanged":return 14;case"SendRangeRequest":return 15;case"DocumentReady":return 17;case"DocumentDownLoadComplete":return 16;case"ShowNewFreeText":return 18;case"ShowEditableFreeText":return 19;case"FreeTextChanged":return 20;case"VisiblePagesLoaded":return 21;default:return 22}},se=function(e){e.preventDefault()},ce=function(){function e(e){this.element=e}return e.prototype.activate=function(){this.element.addEventListener("touchmove",se,{passive:!1})},e.prototype.deactivate=function(){this.element.removeEventListener("touchmove",se)},e}(),de=function(e){function t(t,n,i,r,o){var s=e.call(this,t)||this;return s.onLongPress=function(){s.isGripperPosValid&&(s.isLongPress=!0,s.toggleGripperFn(!0),s.isGripperShown=!0)},s.onTouchMove=function(e,t){return(0,a.Zd)(s,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return this.isGripperMoving?(e.preventDefault(),n=new c.a(e.touches[0].clientX,e.touches[0].clientY),this.contentService.onGripperMove(n),[4,this.inputEvtHandler.onPointerMove(t)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},s.onTouchEnd=function(){return(0,a.Zd)(s,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return this.isGripperMoving||this.isLongPress?(this.contentService.onGirpperUp(),null===(t=this.contentService)||void 0===t||t.selectText()):(null===(e=this.contentService)||void 0===e||e.deselectText(),this.toggleGripperFn(!1),this.isGripperShown=!1),this.isGripperMoving?[4,this.inputEvtHandler.onPointerUp(new c.a(0,0))]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isGripperMoving=!1,this.isLongPress=!1,[2]}})})},s.onGripperTouchStart=function(e){return(0,a.Zd)(s,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return this.isGripperMoving=!0,t=e?this.originalGripperPos.right:this.originalGripperPos.left,n=e?this.originalGripperPos.left:this.originalGripperPos.right,[4,this.inputEvtHandler.onPointerDown(t)];case 1:return a.sent(),[4,this.inputEvtHandler.onPointerMove(n)];case 2:return a.sent(),[2]}})})},s.gripperDeSelectText=function(){return(0,a.Zd)(s,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,this.inputEvtHandler.onPointerDown(new c.a(0,0))];case 1:return e.sent(),[4,this.inputEvtHandler.onPointerUp(new c.a(0,0))];case 2:return e.sent(),[2]}})})},s.layoutManager=n,s.contentService=i,s.originalGripperPos={left:new c.a(0,0),right:new c.a(0,0)},s.isGripperMoving=!1,s.isLongPress=!1,s.isGripperPosValid=!1,s._isGripperShown=!1,s.toggleGripperFn=r,s.updateGripperPositionFn=o,s}return(0,a.XJ)(t,e),t.prototype.onNotification=function(e){if(7===e.type&&14===e.name){var t=e.payload,n=t.leftGripperBoundingRect,a=t.rightGripperBoungdingRect;if(this.isGripperPosValid=n.right-n.left>0||a.right-a.left>0,!this.isGripperPosValid)return;var i=function(e){return new c.a(e.left,(e.bottom+e.top)/2)};this.originalGripperPos.left=i(n),this.originalGripperPos.right=i(a),this.updateGripperPositionFn({left:(0,q.b)(n,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation),right:(0,q.b)(a,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation)})}},Object.defineProperty(t.prototype,"isGripperShown",{get:function(){return this._isGripperShown},set:function(e){this._isGripperShown=e},enumerable:!1,configurable:!0}),t}(Y.a),le="InputEvtService",ue=function(e){function t(t,n,i,r,o,d,l,u,f,p,h,b,g,v,y){void 0===y&&(y=!1);var S=e.call(this,t)||this;return S._isFormFocused=!1,S.setMode=function(e){var t,n;e!==S.mode&&(S.mode=e,S.isEraseMode()?(S.updateCursor("Eraser"),null===(t=S.preventDefaultOnTouchMove)||void 0===t||t.activate()):S.isFreeTextMode()?S.updateCursor("FreeText"):(S.updateCursorFn(B.b.Default),null===(n=S.preventDefaultOnTouchMove)||void 0===n||n.deactivate()))},S.showEditableFreeTextAt=function(e){return(0,a.Zd)(S,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return t=this.layoutManager.convertPointFromClientToOriginalDocument(e),[4,null===(n=this.inputEvtHandler)||void 0===n?void 0:n.onPointerUp(t)];case 1:return a.sent(),[2]}})})},S.onPointerDown=function(e){return(0,a.Zd)(S,void 0,void 0,function(){var t,n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return this.shouldHandlePointerEvt(e.pointerType)?(this.isDisplayMode()&&(null===(n=this.contentService)||void 0===n||n.onPointerDown(e)),t=this,[4,null===(i=this.inputEvtHandler)||void 0===i?void 0:i.onPointerDown(this.getCursorInOriginDocument(new c.a(e.x,e.y)))]):[2];case 1:return t.isFormFocused=a.sent(),[2]}})})},S.onPointerMove=function(e){var t=e.x,n=e.y,i=e.pointerType;return(0,a.Zd)(S,void 0,void 0,function(){var e,r,o,s,d;return(0,a.qr)(this,function(a){switch(a.label){case 0:return this.shouldHandlePointerEvt(i)?(e=new c.a(t,n),(r=this.getCursorType())&&(o=this.layoutManager.convertPointFromClientToDocument(e),(null===(s=this.layoutManager.pageManager)||void 0===s?void 0:s.isPointInVisiblePages(o))?this.updateCursor(r):this.updateCursorFn(B.b.Default)),[4,null===(d=this.inputEvtHandler)||void 0===d?void 0:d.onPointerMove(this.getCursorInOriginDocument(e))]):[2];case 1:return a.sent(),[2]}})})},S.getCursorType=function(){switch(S.mode){case B.a.Erase:return"Eraser";case B.a.FreeText:return"FreeText";default:return null}},S.onPointerUp=function(e){return(0,a.Zd)(S,void 0,void 0,function(){var t,n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return this.shouldHandlePointerEvt(e.pointerType)?(this.isDisplayMode()&&(null===(n=this.contentService)||void 0===n||n.onPointerUp()),t=this,[4,null===(i=this.inputEvtHandler)||void 0===i?void 0:i.onPointerUp(this.getCursorInOriginDocument(new c.a(e.x,e.y)))]):[2];case 1:return t.isFormFocused=a.sent(),[2]}})})},S.onClick=function(e){return(0,a.Zd)(S,void 0,void 0,function(){var t,n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return t=e.type,n=e.detail,"click"===t&&n>1&&n<4?(i=this,[4,null===(r=this.inputEvtHandler)||void 0===r?void 0:r.onMultiTapped(this.getCursorInOriginDocument(new c.a(e.x,e.y)),n)]):[3,2];case 1:i.isFormFocused=a.sent(),a.label=2;case 2:return[2]}})})},S.onTouchStart=function(e){return(0,a.Zd)(S,void 0,void 0,function(){var t,n,i=this;return(0,a.qr)(this,function(r){return e.touches.length>1||(t=new c.a(e.touches[0].clientX,e.touches[0].clientY),this.touchDownPoint=t,this.isFreeTextMode()||(n=this.getCursorInOriginDocument(t),!m.a.isActivated("UseGripperSelectText")&&this.isDisplayMode()&&(this.pressTimer=window.setTimeout(function(){return(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,this.inputEvtHandler.onMultiTapped(n,2)];case 1:return e.sent(),this.gripperService.onLongPress(),this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0),[2]}})})},500)))),[2]})})},S.onTouchMove=function(e){return(0,a.Zd)(S,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return m.a.isActivated("UseGripperSelectText")||!this.isDisplayMode()?[2]:(t=new c.a(e.touches[0].clientX,e.touches[0].clientY),n=this.getCursorInOriginDocument(t),this.resetTimer(),[4,this.gripperService.onTouchMove(e,n)]);case 1:return a.sent(),[2]}})})},S.onTouchEnd=function(e){return(0,a.Zd)(S,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return e.changedTouches.length>1?[2]:(t=new c.a(e.changedTouches[0].clientX,e.changedTouches[0].clientY),!this.gripperService.isGripperShown&&this.isTouchMoving(t)?[2]:(n=this.getCursorInOriginDocument(t),this.resetTimer(),m.a.isActivated("UseGripperSelectText")||!this.gripperService.isGripperShown?[3,2]:[4,this.gripperService.onTouchEnd()]));case 1:return a.sent(),[3,4];case 2:return[4,this.inputEvtHandler.onPointerUp(n)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},S.onGripperTouchStart=function(e){return(0,a.Zd)(S,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,this.gripperService.onGripperTouchStart(e)];case 1:return t.sent(),[2]}})})},S.gripperDeSelectText=function(){return(0,a.Zd)(S,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,this.gripperService.gripperDeSelectText()];case 1:return e.sent(),[2]}})})},S.pasteTextIntoFormField=function(){return(0,a.Zd)(S,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:e="",n.label=1;case 1:return n.trys.push([1,4,,5]),[4,window.navigator.clipboard.readText()];case 2:return 0===(e=n.sent()).length?[2]:[4,this.inputEvtHandler.pasteIntoFormField(e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),_.a.error(le,t),[2];case 5:return[2]}})})},S.onFocusPage=function(e){return(0,a.Zd)(S,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,this.inputEvtHandler.onFocusPage(e)];case 1:return t.sent(),[2]}})})},S.onBlurPage=function(){return(0,a.Zd)(S,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return this.enableFormFilling?[4,this.inputEvtHandler.onBlurPage()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},S.formCopyAndCut=function(e,t){return(0,a.Zd)(S,void 0,void 0,function(){var n,i,r,o,s,c,d,l,u;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,this.inputEvtHandler.getFormSelectedText()];case 1:n=a.sent(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,window.navigator.clipboard.writeText(n)];case 3:return a.sent(),[3,5];case 4:return i=a.sent(),_.a.error(le,i),[2];case 5:return"KeyX"===e&&n?null!==(d=this.inputEvtHandler)&&void 0!==d?[3,6]:(r=void 0,[3,9]):[3,11];case 6:return s=(o=d).onKeyDown,[4,null===(l=this.inputEvtHandler)||void 0===l?void 0:l.getVirtualKeyFromEvt("Delete")];case 7:return c=[a.sent()],[4,null===(u=this.inputEvtHandler)||void 0===u?void 0:u.getModifierKeyFromEvt("None")];case 8:r=s.apply(o,c.concat([a.sent(),t])),a.label=9;case 9:return[4,r];case 10:a.sent(),a.label=11;case 11:return[2]}})})},S.onKeyDown=function(e,t,n){return(0,a.Zd)(S,void 0,void 0,function(){var i,r,o,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w;return(0,a.qr)(this,function(a){switch(a.label){case 0:return i=e.key,this.isFreeTextMode()?e.altKey&&e.ctrlKey&&"F"===i.toUpperCase()?[4,this.addFreeText()]:[3,2]:[3,3];case 1:a.sent(),a.label=2;case 2:return[2];case 3:return n?this.isDisplayMode()&&!this.isFormFocused&&e.ctrlKey?[4,this.contentService.onKeyDown(e)]:[3,5]:[2];case 4:return a.sent(),[2];case 5:return this.enableFormFilling?(Object.values(B.d).includes(i)&&e.preventDefault(),this.isFormValidChars(i)&&this.isFormFocused&&e.preventDefault(),(r=!this.inputEvtHandler)?[3,8]:(o=1!==i.length)?[4,null===(S=this.inputEvtHandler)||void 0===S?void 0:S.getVirtualKeyFromEvt(i)]:[3,7]):[2];case 6:o=0===a.sent(),a.label=7;case 7:r=o,a.label=8;case 8:return r?[2]:e.ctrlKey?"KeyC"!==e.code&&"KeyX"!==e.code?[3,10]:[4,this.formCopyAndCut(e.code,t)]:[3,12];case 9:return a.sent(),[2];case 10:return"KeyV"!==e.code?[3,12]:[4,this.pasteTextIntoFormField()];case 11:return a.sent(),[2];case 12:return!this.isFormValidChars(i)||e.ctrlKey?[3,18]:(d=void 0,i!==B.d.Enter?[3,14]:[4,null===(D=this.inputEvtHandler)||void 0===D?void 0:D.getVirtualKeyFromEvt(i)]);case 13:return d=a.sent(),[3,15];case 14:d=i.charCodeAt(0),a.label=15;case 15:return u=(l=this.inputEvtHandler).onChar,f=[d],[4,null===(I=this.inputEvtHandler)||void 0===I?void 0:I.getModifierKeyFromEvt("None")];case 16:return[4,u.apply(l,f.concat([a.sent()]))];case 17:return c=a.sent(),i!==B.d.Space||c||this.goToPageFn(t+1),[2];case 18:return(h=e.shiftKey)?[4,null===(x=this.inputEvtHandler)||void 0===x?void 0:x.getModifierKeyFromEvt("Shift")]:[3,20];case 19:h=a.sent(),a.label=20;case 20:return(_=h)?[3,23]:(b=e.ctrlKey)?[4,null===(C=this.inputEvtHandler)||void 0===C?void 0:C.getModifierKeyFromEvt("Control")]:[3,22];case 21:b=a.sent(),a.label=22;case 22:_=b,a.label=23;case 23:return(m=_)?[3,25]:[4,null===(O=this.inputEvtHandler)||void 0===O?void 0:O.getModifierKeyFromEvt("None")];case 24:m=a.sent(),a.label=25;case 25:return p=m,null!==(w=this.inputEvtHandler)&&void 0!==w?[3,26]:(g=void 0,[3,28]);case 26:return y=(v=w).onKeyDown,[4,this.inputEvtHandler.getVirtualKeyFromEvt(i)];case 27:g=y.apply(v,[a.sent(),p,t]),a.label=28;case 28:return[4,g];case 29:if(c=a.sent(),i===B.d.Tab&&(this.isFormFocused=c),c)i===B.d.Tab&&s.a.read(this.l10n.get("formFieldAria"));else switch(i){case B.d.Home:this.scrollToFn(0,0);break;case B.d.End:this.scrollToFn(0,this.layoutManager.documentSize.height);break;case B.d.ArrowDown:this.scrollByFn(0,100);break;case B.d.ArrowUp:this.scrollByFn(0,-100);break;case B.d.ArrowLeft:this.scrollByFn(-100,0);break;case B.d.ArrowRight:this.scrollByFn(100,0);break;case B.d.Tab:e.shiftKey?this.focusOnVirtualBackwardFormFn():this.focusOnVirtualForwardFormFn()}return[2]}})})},S.enableFormFilling=y,S.mode=B.a.None,S.layoutManager=n,S.l10n=i,S.contentService=r,S.gripperService=new de(t,n,r,o,d),S.pressTimer=void 0,S.updateCursorFn=b,v&&(S.preventDefaultOnTouchMove=new ce(v)),S.goToPageFn=l,S.scrollByFn=u,S.scrollToFn=f,S.focusOnVirtualForwardFormFn=p,S.focusOnVirtualBackwardFormFn=h,S.onFormFocusFn=g,S}return(0,a.XJ)(t,e),t.prototype.dispose=function(){var e;null===(e=this.preventDefaultOnTouchMove)||void 0===e||e.deactivate()},t.prototype.onNotification=function(e){switch(e.type){case 1:9===e.name&&this.isDisplayMode()&&this.updateCursorFn(function(e){switch(e){case"Text":return B.b.Text;case"Link":return B.b.Link;default:return B.b.Default}}(e.payload));break;case 7:this.gripperService.onNotification(e)}},t.prototype.isTouchMoving=function(e){return!!this.touchDownPoint&&e.distanceTo(this.touchDownPoint)>5},t.prototype.resetTimer=function(){"number"==typeof this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0)},t.prototype.getCursorInOriginDocument=function(e){return this.layoutManager.convertPointFromClientToOriginalDocument(e)},t.prototype.isDisplayMode=function(){return this.mode===B.a.None},t.prototype.isEraseMode=function(){return this.mode===B.a.Erase||this.mode===B.a.PointErase},t.prototype.isFreeTextMode=function(){return this.mode===B.a.FreeText},t.prototype.shouldHandlePointerEvt=function(e){return!e||"mouse"===e||!this.isDisplayMode()},t.prototype.isFormValidChars=function(e){return 1===e.length||e===B.d.Enter},t.prototype.updateCursor=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,this.getCustomCursor(e)];case 1:return(t=n.sent())&&this.updateCursorFn(t),[2]}})})},t.prototype.getCustomCursor=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return this.cursorHelper?[3,2]:(t=this,[4,(0,ie.a)()]);case 1:t.cursorHelper=n.sent(),n.label=2;case 2:switch(e){case"Eraser":return[2,this.cursorHelper.getEraserCursor()];case"FreeText":return[2,this.cursorHelper.getFreeTextCursor()];default:return[2,void 0]}return[2]}})})},Object.defineProperty(t.prototype,"isFormFocused",{get:function(){return this._isFormFocused},set:function(e){this.onFormFocusFn(e),this._isFormFocused=e},enumerable:!1,configurable:!0}),t.prototype.addFreeText=function(){var e,t;return(0,a.Zd)(this,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=new c.a(document.documentElement.clientWidth/2,document.documentElement.clientHeight/2),[4,null===(e=this.inputEvtHandler)||void 0===e?void 0:e.onPointerDown(this.layoutManager.convertPointFromClientToOriginalDocument(n))];case 1:return a.sent(),[4,null===(t=this.inputEvtHandler)||void 0===t?void 0:t.onPointerUp(this.layoutManager.convertPointFromClientToOriginalDocument(n))];case 2:return a.sent(),s.a.read(this.l10n.get("freeTextAdded")),[2]}})})},t}(Y.a),fe=function(e){function t(t,n,i,r){var o=e.call(this,t)||this;return o.onNotification=function(e){switch(e.name){case 10:var t=e.payload,n=t.left,a=t.top,i=t.right,r=t.bottom;if(n===i||a===r)o.dispatchEventFn(B.e.ClearHighlightLink);else{var s=(0,Q.b)(n,a,i,r,o.metadata.scale),d=o.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();s.origin=s.origin.plus(d),o.dispatchEventFn(B.e.HighlightLink,s)}break;case 5:var l=e.payload;o.navigateToWebLink(l);break;case 6:o.dispatchEventFn(B.e.ClearHighlightLink);var u=e.payload,f=u.page,p=u.x,m=u.y;o.navigateToDocumentLink(f,new c.a(p,m))}},o.getLinkInfosInPage=function(e,t){return(0,a.Zd)(o,void 0,void 0,function(){return(0,a.qr)(this,function(n){return[2,this.viewHandler.getLinkInfosInPage(e,t?1:this.metadata.scale)]})})},o.layoutManager=n,o.goToPageFn=i,o.dispatchEventFn=r,o}return(0,a.XJ)(t,e),t.prototype.navigateToDocumentLink=function(e,t){t.scale(this.metadata.scale),this.goToPageFn(e,t)},t.prototype.navigateToWebLink=function(e){(0,Z.b)(e)?this.navigateToUrlViaATag(e):_.a.warn("PdfLinkService","Unsupported web link")},t.prototype.navigateToUrlViaATag=function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),t.click()},t}(Y.a),pe=function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var t,n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.target.apply(null,e.args)];case 1:return t=a.sent(),e.isCancelled?[2,!1]:(null===(i=e.onsuccess)||void 0===i||i.call(e,t),[2,!0]);case 2:return n=a.sent(),null===(r=e.onerror)||void 0===r||r.call(e,n),[2,!1];case 3:return[2]}})})},me=function(){function e(){var e=this;this.internalRun=function(){return(0,a.Zd)(e,void 0,void 0,function(){var e,t,n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return this.running=!0,(e=this.pickTask())?(t=e.type,n=e.task,[4,pe(n)]):(this.running=!1,[2]);case 1:switch(i=a.sent(),t){case"Micro":r=this.microQueue.findIndex(function(e){return e===n}),this.microQueue.splice(0,r+1);break;case"Normal":this.queue.shift();break;case"PreRender":i&&(this.preRenderTask=void 0)}return this.internalRun(),[2]}})})},this.microQueue=[],this.queue=[],this.running=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.add=function(e,t){t?this.microQueue.push(e):this.queue.push(e),this.running||this.run()},e.prototype.poll=function(e){return e?this.microQueue.shift():this.queue.shift()},e.prototype.setPreRenderTask=function(e){this.preRenderTask=e,this.running||this.run()},e.prototype.cancelPreRenderTask=function(){var e,t;(e=this.preRenderTask)&&(null===(t=e.oncancel)||void 0===t||t.call(e),e.isCancelled=!0,e=void 0)},e.prototype.run=function(){this.internalRun()},e.prototype.clear=function(){this.cancelPreRenderTask(),e.instance=void 0},e.prototype.pickTask=function(){if(this.preRenderTask&&this.preRenderTask.isPageVisible())return{type:"PreRender",task:this.preRenderTask};if(this.microQueue.length>=1){var e=this.microQueue.length;return{type:"Micro",task:this.microQueue[e-1]}}return this.queue.length>=1?{type:"Normal",task:this.queue[0]}:this.preRenderTask?{type:"PreRender",task:this.preRenderTask}:void 0},e}();!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Up=2]="Up",e[e.Down=3]="Down"}(F||(F={}));var _e=function(e){function t(t,n,a,i){var r=e.call(this,t)||this;return r.firstRender=!0,r.itemQueue=[],r.msgQueue=me.getInstance(),r.setStatesFn=n,r.handleErrorFn=a,r.onInitialMetadataUpdated=i,r.viewHandler.setDPR((0,u.a)()),r}return(0,a.XJ)(t,e),t.prototype.clear=function(){this.itemQueue=[],this.viewHandler.clearRender()},t.prototype.render=function(e){var t,n,i=function(e,t){if(e){var n=e.rect;return t&&n.x!==t.x&&n.y!==t.y?[{rect:new c.b(t.x,n.y,n.width,n.height),layoutSize:e.layoutSize},e]:[e]}}(function(e){var t=e.layoutSize;if(t.width*t.height!=0){var n=new c.b(0,0,t.width,t.height),i=e.rect.intersect(n);return i?(0,a.W_)((0,a.W_)({},e),{rect:i,layoutSize:{width:(0,u.b)(t.width),height:(0,u.b)(t.height)}}):void 0}}(e),null===(n=this.lastItemInQueue)||void 0===n?void 0:n.rect);i&&0!==i.length&&((t=this.itemQueue).push.apply(t,(0,a.AE)([],(0,a.MS)(i),!1)),this.updateMetadata(e.triggerType),this.itemQueue.length===i.length&&this.doRender(i[0]),this.internalRender())},t.prototype.updateMetadata=function(e){var t=this;if(this.lastItemInQueue){var n=this.lastItemInQueue,a=n.rect,i=n.layoutSize,r=n.rotation,o=c.b.create(a);this.msgQueue.add({target:this.viewHandler.setRenderingMetadata,args:[o.scale((0,u.a)()),i,r],onsuccess:function(){var n;"Init"===e&&(null===(n=t.onInitialMetadataUpdated)||void 0===n||n.call(t))},onerror:this.handleErrorFn},!0)}},t.prototype.internalRender=function(){for(;this.itemQueue.length>=2;)this.doRender(this.itemQueue[1],this.itemQueue[0]),this.itemQueue.shift()},t.prototype.doRender=function(e,t){var n=this,a=c.b.create(e.rect),i="Scroll"===e.triggerType,r=void 0;if(i&&t){var o=t.rect,s=a.intersect(o);if(s)if(a.y!==o.y){var d=a.y<o.y;r=d?F.Up:F.Down,a.height-=s.height,a.y=d?a.y:o.y+o.height}else if(a.x!==o.x){var l=a.x<o.x;r=l?F.Left:F.Right,a.width-=s.width,a.x=l?a.x:o.x+o.width}}a.scale((0,u.a)()),_.a.verbose("PdfRenderService","Rect to render: ".concat(a.toString(),", in layout(").concat(e.layoutSize.width,", ").concat(e.layoutSize.height)),this.msgQueue.add({target:this.viewHandler.scrollRender,args:[a,e.layoutSize,e.rotation,i,r],onsuccess:function(t){var a,i=!1;if(t){var r=t.layoutSize,o=t.rotation;if(t&&(!r||r.width===(0,u.b)(n.metadata.layoutSize.width))&&(void 0===o||o===n.metadata.rotation)){t.triggerType=e.triggerType;var s=(0,Q.a)(t);n.firstRender?(s.firstRender=!0,n.firstRender=!1):s.originRelativeToDoc=s.origin,n.setStatesFn(s),i=!0}}null===(a=e.onCompleted)||void 0===a||a.call(e,i)},onerror:function(t){var a;e.onError?e.onError(t):null===(a=n.handleErrorFn)||void 0===a||a.call(n,t)}})},Object.defineProperty(t.prototype,"lastItemInQueue",{get:function(){return this.itemQueue.length>=1?this.itemQueue[this.itemQueue.length-1]:void 0},enumerable:!1,configurable:!0}),t}(Y.a),he=function(e){function t(t){return e.call(this,t)||this}return(0,a.XJ)(t,e),t.prototype.onNotification=function(e){var t,n;return(0,a.Zd)(this,void 0,void 0,function(){var i,r,o,s;return(0,a.qr)(this,function(a){switch(a.label){case 0:switch(e.name){case 11:return[3,1];case 12:return[3,4]}return[3,5];case 1:return i=e.payload,r=i.totalResultCount,o=i.isFinalResult,0!==r?[3,3]:[4,this.stopSearch()];case 2:a.sent(),a.label=3;case 3:return null===(t=this.callbacks)||void 0===t||t.onTotalResultUpdate(r,o),[3,6];case 4:return s=e.payload,null===(n=this.callbacks)||void 0===n||n.onHitIndexUpdate(s),[3,6];case 5:return[3,6];case 6:return[2]}})})},t.prototype.startSearch=function(e,t,n,i){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(a){switch(a.label){case 0:return i&&(this.callbacks=i),[4,this.viewHandler.startSearch(e,t,n)];case 1:return a.sent(),[2]}})})},t.prototype.goToNextSearchResult=function(e){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,this.viewHandler.goToNextSearchResult(e)];case 1:return t.sent(),[2]}})})},t.prototype.stopSearch=function(){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,this.viewHandler.stopSearch()];case 1:return e.sent(),[2]}})})},t}(Y.a),be=function(){function e(){}return e.normalizeScale=function(e,t){void 0===t&&(t=1);var n=Math.pow(10,t);return Math.round(e*n)/n},e.normalizeScaleWithMinMaxScale=function(e,t,n){void 0===n&&(n=1);var a=Math.pow(10,n),i=Math.round(t*a)/a;return t/e>=1?Math.min(this._maxScale,i):Math.max(this._minScale,i)},e.setMinMaxScale=function(e,t){this._minScale=e,this._maxScale=t},e._minScale=N.v,e._maxScale=N.u,e}(),ge=function(){function e(){}return e.computeNewScale=function(e,t){var n=3*this.normalizeDelta(e),a=Math.pow(1.1,Math.ceil(Math.abs(n)));return be.normalizeScale(n>=0?t*a:t/a,2)},e.normalizeDelta=function(e){var t=e.deltaX,n=e.deltaY,a=Math.atan2(n,t),i=-45*Math.PI/180,r=135*Math.PI/180,o=Math.sqrt(t*t+n*n);switch(i<a&&a<r&&(o=-o),e.deltaMode){case WheelEvent.DOM_DELTA_PIXEL:return o/900;case WheelEvent.DOM_DELTA_LINE:return o/30;default:return o}},e}(),ve=function(e,t,n){return(e-1)*(t-n)},ye=function(e){function t(t,n,a,i,r,o,s){var d=e.call(this,t)||this;return d.unfinishedZoomingList=[],d.throttledWheelZoom=l()(function(e){var t=ge.computeNewScale(e,d.metadata.scale);d.isValidScale(t)&&(d.curZoomOpt=void 0,d.blurZoom(t),d.debouncedRender())},100),d.debouncedRender=W()(function(){d.render()},200),d.blurZoom=function(e,t){var n;if(!d.isValidScale(e))return!1;d.dispatchEventFn(B.e.ZoomStart),d.lastZoomSnapshot||d.refreshLastZoomSnapshot();var a=d.layoutManager.rootRect;t?d.metadata.layoutSize.width*e<=a.getClientWidth()&&(t.x=a.getClientWidth()/2):t=new c.a(a.getClientWidth()/2,a.getClientHeight()/2),_.a.verbose("PdfZoomService","newScale: ".concat(e,", anchor: (").concat(t.x,", ").concat(t.y,")"));var i=new c.a(a.getScrollLeft(),a.getScrollTop()),r=d.getViewportScrollVector(i,e/d.metadata.scale,t),o=d.lastZoomSnapshot,s=o.scale,l=o.visibleDocumentOrigin,u=e/(d.blurred?s:d.metadata.scale),f=d.getScaledVisibleDocumentOrigin(d.blurred?l:d.getCurrentVisibleDocumentOrigin(),u,t);d.scale=e,d.layoutManager.resetContentSize(),d.layoutManager.scrollPosition=new c.a(d.layoutManager.isDocumentWiderThanViewport()?Math.min(r.x,d.metadata.layoutSize.width-a.getClientWidth()):0,d.layoutManager.isDocumentHigherThanViewport()?Math.min(r.y,d.metadata.layoutSize.height-a.getClientHeight()):0);var p=Math.abs(i.x-a.getScrollLeft())<1&&(Math.abs(i.y-a.getScrollTop())<1||d.metadata.layoutSize.height<=a.getClientHeight());return d.triggerBlurDraw(f,u,p),d.blurred=!0,p||null===(n=d.preventScrollFn)||void 0===n||n.call(d),!0},d.render=function(){d.unfinishedZoomingList.push(d.metadata.scale),requestAnimationFrame(function(){var e={scale:d.metadata.scale,visibleDocumentOrigin:d.getCurrentVisibleDocumentOrigin()};d.renderFn("Zoom").then(function(t){var n=d.unfinishedZoomingList.findIndex(function(t){return t===e.scale});d.unfinishedZoomingList.splice(n,1),0===d.unfinishedZoomingList.length&&d.dispatchEventFn(B.e.ZoomEnd),t&&(d.blurred=!1,d.refreshLastZoomSnapshot(e))})})},d.layoutManager=n,d.renderFn=a,d.setStatesFn=i,d.dispatchEventFn=r,d.preventScrollFn=o,d.onScaleUpdated=s,be.setMinMaxScale(d.minScale,d.maxScale),d}return(0,a.XJ)(t,e),t.prototype.initScale=function(e){void 0===e&&(e=B.g.FitSize),this.updateZoomOpt(e),this.scale=this.getZoomScale(e)},t.prototype.isResponsiveZoomValid=function(){return!!this.curZoomOpt&&this.isValidScale(this.curZoomOpt)},t.prototype.responsiveZoom=function(e){if(!this.curZoomOpt)return!1;if(e){var t=this.getZoomScale(this.curZoomOpt);return!!this.isValidScale(t)&&(this.scale=t,!0)}return this.zoom(this.curZoomOpt)},t.prototype.zoom=function(e,t){var n=this.getZoomScale(e);if(!this.isValidScale(n))return!1;this.updateZoomOpt(e);var a=this.blurZoom(n,t);return this.debouncedRender(),a},t.prototype.wheelZoom=function(e){this.throttledWheelZoom(e)},t.prototype.isValidScale=function(e){var t=this.getZoomScale(e);return t>=this.minScale&&t<=this.maxScale&&t!==this.metadata.scale},Object.defineProperty(t.prototype,"minScale",{get:function(){return Math.min(N.v,this.convertScaleToNumber(B.g.FitWidth),this.convertScaleToNumber(B.g.FitSize))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScale",{get:function(){return Math.max(N.u,this.convertScaleToNumber(B.g.FitWidth),this.convertScaleToNumber(B.g.FitSize))},enumerable:!1,configurable:!0}),t.prototype.getZoomOpt=function(){return this.curZoomOpt},Object.defineProperty(t.prototype,"scale",{set:function(e){var t;this.metadata.scale=e,null===(t=this.onScaleUpdated)||void 0===t||t.call(this,e,this.curZoomOpt)},enumerable:!1,configurable:!0}),t.prototype.refreshLastZoomSnapshot=function(e){this.lastZoomSnapshot=e||{scale:this.metadata.scale,visibleDocumentOrigin:this.getCurrentVisibleDocumentOrigin()}},t.prototype.updateZoomOpt=function(e){this.curZoomOpt="number"==typeof e?void 0:e},t.prototype.getZoomScale=function(e){var t=this.convertScaleToNumber(e);return be.normalizeScale(t,2)},t.prototype.convertScaleToNumber=function(e){if("number"==typeof e)return e;var t=this.layoutManager.rootRect;return e===B.g.FitWidth?(t.getClientWidth()-10)/this.metadata.originalLayoutSize.width:(t.getClientHeight()+20)/this.getCurrentPageHeightInOriginalScale()},t.prototype.getViewportScrollVector=function(e,t,n){var a=new c.a(this.layoutManager.documentLeftToViewport,0),i=(a.y+e.y)*(t-1)+ve(t,n.y,a.y),r=Math.max(0,e.y+i),o=ve(t,n.x,a.x),s=o>a.x?o-a.x:e.x;return new c.a(s,r)},t.prototype.triggerBlurDraw=function(e,t,n){var a=this,i=this.getCurrentVisibleDocumentOrigin(),r=n?new c.a(0,0):new c.a(e.x-i.x,e.y-i.y);requestAnimationFrame(function(){a.setStatesFn({prevOrigin:r,ratio:t})})},t.prototype.getScaledVisibleDocumentOrigin=function(e,t,n){return new c.a(e.x-ve(t,n.x,e.x),e.y-ve(t,n.y,e.y))},t.prototype.getCurrentVisibleDocumentOrigin=function(){return new c.a(this.layoutManager.visibleDocumentLeftToViewport,0)},t.prototype.getCurrentPageHeightInOriginalScale=function(){var e,t=(null===(e=this.layoutManager.pageManager)||void 0===e?void 0:e.getCurrentPage())||0,n=this.metadata.originalPageSizes[t],a=n.width,i=n.height;return this.metadata.inverted?a:i},t}(Y.a),Se=n(94),De=function(){function e(){this.element=document.body}return e.prototype.initialize=function(e){this.element=e},e.prototype.setWidth=function(e){var t=this;requestAnimationFrame(function(){t.element.style.width="".concat(e,"px")})},e.prototype.getClientWidth=function(){return this.element.clientWidth},e.prototype.getWidth=function(){return this.element.getBoundingClientRect().width},e.prototype.setHeight=function(e){var t=this;requestAnimationFrame(function(){t.element.style.height="".concat(e,"px")})},e.prototype.getClientHeight=function(){return this.element.clientHeight},e.prototype.getHeight=function(){return this.element.getBoundingClientRect().height},e.prototype.setSize=function(e,t){this.setHeight(t),this.setWidth(e)},e.prototype.setScrollLeft=function(e){var t=this;requestAnimationFrame(function(){t.element.scrollLeft=e,t.element===document.body&&(document.documentElement.scrollLeft=e)})},e.prototype.getScrollLeft=function(){return Math.round(this.element.scrollLeft)||0},e.prototype.setScrollTop=function(e){var t=this;requestAnimationFrame(function(){t.element.scrollTop=e,t.element===document.body&&(document.documentElement.scrollTop=e)})},e.prototype.getScrollTop=function(){return Math.round(this.element.scrollTop)||0},e.prototype.setScrollLocation=function(e){this.setScrollLeft(e.x),this.setScrollTop(e.y)},Object.defineProperty(e.prototype,"x",{get:function(){return this.element.getBoundingClientRect().x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.element.getBoundingClientRect().y},enumerable:!1,configurable:!0}),e}(),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.XJ)(t,e),t.prototype.setScrollLeft=function(t){this.scrollLeft=t,e.prototype.setScrollLeft.call(this,this.scrollLeft)},t.prototype.getScrollLeft=function(){return void 0===this.scrollLeft&&(this.scrollLeft=e.prototype.getScrollLeft.call(this)),this.scrollLeft},t.prototype.setScrollTop=function(t){this.scrollTop=t,e.prototype.setScrollTop.call(this,this.scrollTop)},t.prototype.getScrollTop=function(){return void 0===this.scrollTop&&(this.scrollTop=e.prototype.getScrollTop.call(this)),this.scrollTop},t.prototype.clear=function(){this.scrollTop=void 0,this.scrollLeft=void 0},t.prototype.reset=function(){this.setScrollTop(0),this.setScrollLeft(0),this.clear()},t}(De),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.XJ)(t,e),t.prototype.setWidth=function(t){var n,a=(null===(n=this.element.parentElement)||void 0===n?void 0:n.clientWidth)||0;this.width=t>a?t:a,e.prototype.setWidth.call(this,this.width)},t.prototype.getWidth=function(){return void 0===this.width&&(this.width=e.prototype.getWidth.call(this)),this.width},t.prototype.setHeight=function(t){this.height=t,e.prototype.setHeight.call(this,t)},t.prototype.getHeight=function(){return void 0===this.height&&(this.height=e.prototype.getHeight.call(this)),this.height},t.prototype.clear=function(){this.width=void 0,this.height=void 0},t.prototype.reset=function(){this.setHeight(0),this.setWidth(0),this.clear()},t}(De),Ce=function(e,t,n){return 1-(Math.max(0,t-n.y)+Math.max(0,n.y+n.height-t-e))/n.height},Oe=function(){function e(e,t){var n=this;this.isPageVisible=function(e){var t=n.getYPosOfPage(e),a=n.rootRect.getScrollTop();return t+n.metadata.pageSizes[e].height>a&&t<a+n.rootRect.getClientHeight()},this.getScaledOriginalPageRects=function(e){var t,i;void 0===e&&(e=n.metadata.scale);var r=[],o=n.metadata.originalPageSizes,s=N.i*e,d=n.metadata.originalLayoutSize.width*e,l=N.h*e;try{for(var u=(0,a.OY)(o),f=u.next();!f.done;f=u.next()){var p=f.value,m=p.width*e,_=p.height*e;r.push(new c.b((d-m)/2,l,m,_)),l+=_+s}}catch(e){t={error:e}}finally{try{f&&!f.done&&(i=u.return)&&i.call(u)}finally{if(t)throw t.error}}return r},this.getScaledOriginalPageRectByIndex=function(e,t){void 0===t&&(t=n.metadata.scale);var a=n.metadata.pageSizes,i=t/n.metadata.scale,r=N.i*t,o=a.slice(0,e).reduce(function(e,t){return e+t.height*i+r},N.h*t),s=a[e],d=s.width*i,l=s.height*i,u=(n.metadata.layoutSize.width-s.width)/2*i;return new c.b(u,o,d,l)},this.metadata=e,this.rootRect=t,this._currentIndex=this.getCurrentPage()}return e.prototype.getVisiblePageRects=function(){return this.getVisiblePages().map(function(e){return e.rect})},e.prototype.getAccessiblePages=function(e,t){var n;void 0===t&&(t=0);var i=this.getVisiblePages().filter(function(t){return e.includes(t.index)});if(0===i.length||0===t)return i;t=Math.abs(t);for(var r=[],o=this.metadata.pageSizes,s=this.metadata.pageCount,d=i[0].index,l=i[0].rect.y,u=d-1;u>=d-t&&!(u<0);u--){var f=o[u],p=f.width,m=f.height;l=l-this.pageGap-m,r.push({index:u,rect:new c.b(0,l,p,m)})}(n=r.reverse()).push.apply(n,(0,a.AE)([],(0,a.MS)(i),!1));var _=i[i.length-1].index;l=i[i.length-1].rect.y;for(var h=_;h<_+t&&!(h>=s-1);h++){l=l+o[h].height+this.pageGap;var b=o[h+1];p=b.width,m=b.height,r.push({index:h+1,rect:new c.b(0,l,p,m)})}return r},e.prototype.isPointInVisiblePages=function(e){var t,n,i=e.x,r=e.y,o=this.getVisiblePages(),s=-1;try{for(var c=(0,a.OY)(o),d=c.next();!d.done;d=c.next()){var l=d.value,u=l.index,f=l.rect;if(r>=f.y&&r<=f.bottom&&i>=f.x&&i<=f.right){s=u;break}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return!(s<0)},e.prototype.getPageIndexFromPointInOriginalLayout=function(e){var t,n,i=e.x,r=e.y,o=-1,s=this.metadata.originalLayoutSize.width,d=N.h;try{for(var l=(0,a.OY)(this.metadata.originalPageSizes),u=l.next();!u.done;u=l.next()){var f=u.value,p=f.width,m=f.height;o++;var _=new c.b((s-p)/2,d,p,m);if(r>=_.y&&r<=_.bottom&&i>=_.x&&i<=_.right)return o;d+=m+N.i}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return o},e.prototype.getCurrentPage=function(){var e=this.getVisiblePages();if(0===e.length)return 0;if(1===e.length)return e[0].index;var t=this.rootRect.getClientHeight(),n=this.rootRect.getScrollTop();return Ce(t,n,e[0].rect)>=Ce(t,n,e[1].rect)?e[0].index:e[1].index},e.prototype.getYPosOfPage=function(e){var t=this.metadata.pageCount;if(e<0||e>=t)return-1;for(var n=this.metadata.pageSizes,a=this.pageGap,i=N.h*this.metadata.scale,r=0;r<e;r++)i+=n[r].height+a;return i},e.prototype.getOriginalPageRects=function(){var e,t,n=N.h,i=[],r=this.metadata.originalLayoutSize.width;try{for(var o=(0,a.OY)(this.metadata.originalPageSizes),s=o.next();!s.done;s=o.next()){var d=s.value;i.push(new c.b((r-d.width)/2,n,d.width,d.height)),n+=d.height+N.i}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return i},e.prototype.getVisiblePages=function(){for(var e=[],t=this.metadata.pageSizes,n=this.metadata.layoutSize.width,a=this.rootRect.getScrollTop(),i=a+this.rootRect.getClientHeight(),r=N.h*this.metadata.scale,o=0;o<t.length;o++){var s=t[o],d=s.width,l=s.height;if(r<a&&r+l>a||r>=a&&r<i)e.push({index:o,rect:new c.b((n-d)/2,r,d,l)});else if(r>=i)break;r+=l+this.pageGap}return e},Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(e){this._currentIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageGap",{get:function(){return N.i*this.metadata.scale},enumerable:!1,configurable:!0}),e}(),we=function(){function e(){var e=this;this.convertPointFromClientToOriginalDocument=function(t){var n,a=e.convertPointFromClientToDocument(t);return a.scale(1/((null===(n=e._metadata)||void 0===n?void 0:n.scale)||1)),a},this.convertPointFromOriginalDocumentToClient=function(t){var n,a=new c.a(t.x,t.y);return e.convertPointFromClientToDocument(a.scale((null===(n=e._metadata)||void 0===n?void 0:n.scale)||1),!0)},this.getDistToViewportCenter=function(t){if(e.pageManager&&e._metadata){var n=e.pageManager.getYPosOfPage(t)+e._metadata.pageSizes[t].height/2,a=e.rootRect.getScrollTop()+e.rootRect.getClientHeight()/2;return Math.abs(a-n)}},this._rootRect=new Ie,this._contentRect=new xe}return e.prototype.initialize=function(e,t,n){this._rootRect.initialize(e),this._contentRect.initialize(t),this._onScrollPositionUpdated=n},Object.defineProperty(e.prototype,"metadata",{set:function(e){this._metadata=e,this._pageManager=e?new Oe(e,this._rootRect):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollPosition",{set:function(e){var t;this.rootRect.setScrollLocation(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,e.x,e.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollLeft",{set:function(e){var t;this.rootRect.setScrollLeft(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,e,this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollTop",{set:function(e){var t;this.rootRect.setScrollTop(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,this.rootRect.getScrollLeft(),e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentSize",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootRect",{get:function(){return this._rootRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageManager",{get:function(){return this._pageManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentScrollPosition",{get:function(){return new c.a(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.rotation)||0},enumerable:!1,configurable:!0}),e.prototype.resetContentSize=function(){this.contentRect.setSize(this.documentSize.width,this.documentSize.height)},e.prototype.scrollRootByPage=function(e,t,n){var a,i;void 0===t&&(t=new c.a(0,0)),void 0===n&&(n=!1);var r=(null===(a=this._metadata)||void 0===a?void 0:a.pageCount)||0;if(e<0||e>=r)return!1;var o=null===(i=this.pageManager)||void 0===i?void 0:i.getYPosOfPage(e);if(void 0===o)return!1;var s=new c.a(t.x,o+t.y),d=this.rootRect;return(!n||s.y<d.getScrollTop()||s.y>d.getScrollTop()+d.getClientHeight())&&(this.scrollTop=s.y),0!==d.getScrollLeft()&&0!==s.x&&(s.x<d.getScrollLeft()||s.x>d.getScrollLeft()+d.getClientWidth())&&(this.scrollLeft=s.x),!0},e.prototype.convertPointFromClientToDocument=function(e,t){void 0===t&&(t=!1);var n=t?1:-1,a=new c.a(n*+this.rootRect.x,n*+this.rootRect.y);return this.convertPointFromViewportToDocument(e.plus(a),t)},e.prototype.isDocumentWiderThanViewport=function(){return this.documentSize.width>this.rootRect.getClientWidth()},e.prototype.isDocumentHigherThanViewport=function(){return this.documentSize.height>this.rootRect.getClientHeight()},Object.defineProperty(e.prototype,"viewportRectRelativeToContent",{get:function(){return new c.b(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop(),this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportRectRelativeToDocument",{get:function(){var e=this.convertPointFromViewportToDocument(new c.a(0,0));return new c.b(e.x,e.y,this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentRectRelativeToContent",{get:function(){return new c.b(this.visibleDocumentLeftToContent,this.rootRect.getScrollTop(),this.visibleDocumentWidth,this.visibleDocumentHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentWidth",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getClientWidth():this.documentSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentHeight",{get:function(){return this.rootRect.getClientHeight()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentLeftToContent",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getScrollLeft():(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentLeftToViewport",{get:function(){return this.isDocumentWiderThanViewport()?0:(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentLeftToViewport",{get:function(){return(this.contentRect.getWidth()-this.documentSize.width)/2-this.rootRect.getScrollLeft()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentLeftToContent",{get:function(){return this.documentSize.width>this.contentRect.getWidth()?0:(this.contentRect.getWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),e.prototype.convertPointFromViewportToDocument=function(e,t){void 0===t&&(t=!1);var n=t?-1:1,a=new c.a(n*this.rootRect.getScrollLeft(),n*this.rootRect.getScrollTop()).plus(this.contentOffsetFromDocument.scale(n));return e.plus(a)},Object.defineProperty(e.prototype,"contentOffsetFromDocument",{get:function(){return new c.a(this.isDocumentWiderThanViewport()?0:(this.documentSize.width-this.rootRect.getClientWidth())/2,0)},enumerable:!1,configurable:!0}),e}(),Ee=function(e,t){return e&&(!m.a.isActivated("DeprecateOldFileHandler")||t>N.f)},Ae=function(e){return new c.a(e.x,e.y)},Le=function(e){return"mouse"===e.pointerType},ke=function(){function e(e,t){var n=this;this.onPointerMove=l()(function(e){var t;if(!(Le(e)||n.pointerCache.length<2)){var a=n.pointerCache.findIndex(function(t){return t.id===e.pointerId});if(-1!==a){0===a?n.consecutiveActiveCount++:n.consecutiveActiveCount=1,n.consecutiveActiveCount>7&&(n.pointerCache[1].dir=void 0);var i=n.pointerCache.splice(a,1)[0];if(n.pointerCache.unshift(i),n.pointerCache[0].dir=new c.a(e.clientX-n.pointerCache[0].x,e.clientY-n.pointerCache[0].y),n.pointerCache[0].x=e.clientX,n.pointerCache[0].y=e.clientY,!function(e,t){if(!t)return!1;var n=e.x*t.y-t.x*e.y,a=e.x*t.x+e.y*t.y;return Math.atan2(n,a)<Math.PI/2}(n.pointerCache[0].dir,n.pointerCache[1].dir)){var r=Ae(n.pointerCache[0]),o=Ae(n.pointerCache[1]),s=r.distanceTo(o);if(!(s<60)){var d=s/(n.prePinchDist||60),l=be.normalizeScaleWithMinMaxScale(n.scale,n.scale*d,1),u=r.midPointTo(o);null===(t=n.blurZoomFn)||void 0===t||t.call(n,l,u),n.prePinchDist=s}}}}},100),this.onPointerDown=function(e){if(!Le(e)&&(n.pointerCache.length<2&&n.pointerCache.push({id:e.pointerId,x:e.clientX,y:e.clientY}),2===n.pointerCache.length)){var t=Ae(n.pointerCache[0]).distanceTo(Ae(n.pointerCache[1]));n.prePinchDist=t<60?void 0:t}},this.onPointerUp=function(e){var t;if(!Le(e)){for(var a=!1,i=0;i<n.pointerCache.length;i++)if(n.pointerCache[i].id===e.pointerId){n.pointerCache.splice(i,1),a=!0;break}a&&n.pointerCache.length<2&&(null===(t=n.renderViewportFn)||void 0===t||t.call(n),n.prePinchDist=void 0)}},this._scale=1,this.pointerCache=[],this.consecutiveActiveCount=0,this.blurZoomFn=e,this.renderViewportFn=t}return Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e},enumerable:!1,configurable:!0}),e.prototype.attach=function(e,t,n){this.element=e,this.blurZoomFn=t,this.renderViewportFn=n},e.prototype.bind=function(){this.element&&(this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("pointermove",this.onPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointercancel",this.onPointerUp),this.element.addEventListener("pointerout",this.onPointerUp),this.element.addEventListener("pointerleave",this.onPointerUp))},e.prototype.unbind=function(){this.element&&(this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("pointermove",this.onPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointercancel",this.onPointerUp),this.element.removeEventListener("pointerout",this.onPointerUp),this.element.removeEventListener("pointerleave",this.onPointerUp))},e}(),Me=n(188),Pe=n(350),Te=H.createContext(void 0),Ue=function(e){var t=e.children,n=(0,a.l7)(e,["children"]);return H.createElement(Te.Provider,{value:n},t)},Fe=function(){return H.useContext(Te)},He=n(360),Re=n(344),Ne="DisplayHelper",Be=function(e){return e instanceof DOMException&&"QuotaExceededError"===e.name},je=function(){try{var e=window.localStorage.getItem(N.d);return e?JSON.parse(e):[]}catch(e){return _.a.error(Ne,e),[]}},Ve=function(e){window.localStorage.setItem(N.d,JSON.stringify(e))},ze=function(e){var t=this;this.storeInfoInLocalStorage=function(e){try{var n={uniqueId:t.uniqueId,pos:e.pos,scale:e.scale,rotation:e.rotation},a=je(),i=a.findIndex(function(e){return e.uniqueId===t.uniqueId});-1!==i&&a.splice(i,1),a.unshift(n),a.length>30&&a.pop();try{Ve(a)}catch(e){!function(e,t){Be(e)?t.length>0&&(t.pop(),function(e){var t=1,n=function(e){try{Ve(e)}catch(a){if(Be(a)&&t<3){if(e.pop(),0===e.length)return;t++,n(e)}else _.a.error(Ne,a)}};n(e)}(t)):_.a.error(Ne,e)}(e,je())}}catch(e){_.a.error(Ne,e)}},this.applyInfoInLocalStorage=function(e){try{var n=je(),a=n.findIndex(function(e){return e.uniqueId===t.uniqueId});if(-1!==a){var i=n[a],r=i.pos,o=i.scale,s=i.rotation;void 0!==r&&void 0!==o&&void 0!==s&&(e.pageNumber=1,e.pos=r,e.scale=o,e.rotation=s)}}catch(e){_.a.error(Ne,e)}},this.uniqueId=e},Ge=n(366),Ke=n(71),We=n(361);(0,i.Bv)([{rawString:".page_0aca4f1f{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);background-color:rgba(0,0,0,0)}.pageText_0aca4f1f{position:absolute;width:100%;height:100%}"}]);var qe="pageText_0aca4f1f";(0,i.Bv)([{rawString:".root_26f9d840{width:100%;height:100%}.link_26f9d840{position:absolute}.link_26f9d840 a{display:inline-block;width:100%;height:100%;vertical-align:top}.link_26f9d840 a:hover{background-color:rgba(255,255,0,.2)}"}]);var Qe="_blank",Ye=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"".concat(e.x,"px"),top:"".concat(e.y,"px")}},Je=function(e){e.stopPropagation()},Xe=H.memo(function(e){var t=e.pageIndex,n=e.originalPageSize,i=e.scale,r=e.rotation,o=e.getLinkInfosFn,d=e.goToPageFn,l=e.toggleGripperFn,u=(0,a.MS)(H.useState(),2),f=u[0],p=u[1],m=(0,We.b)(),h=H.useCallback(function(e){null==l||l(!1),e.stopPropagation()},[l]);H.useEffect(function(){var e=!0;return null==o||o(t,!0).then(function(n){if(e){var a=[];null==n||n.forEach(function(e,n){var i=e.type,r=e.rect,o=e.text,s=e.url,d=e.targetPageIndex,l=e.targetOffset,u=function(e,t){return"Link-".concat(e,"-").concat(t)}(t,n);a.push({id:u,rect:c.b.create(r),text:o,href:1===i&&s?s:"",displayTarget:1===i?Qe:void 0,docTargetInfo:0===i?{pageIndex:void 0!==d?d:-1,offset:l&&new c.a(l.x,l.y)}:void 0})}),p(a)}}).catch(function(){_.a.warn("VirtualLinks","Fail to get link infos")}),function(){e=!1}},[t,o]);var b=H.useCallback(function(e){var t=e.pageIndex,n=e.offset;null==d||d(t,n)},[d]),g=H.useCallback(function(e,t){e.stopPropagation(),t&&"Enter"===e.key&&(e.preventDefault(),b(t))},[b]),v=H.useCallback(function(e,t){e.stopPropagation(),t&&(e.preventDefault(),b(t))},[b]),y=H.useCallback(function(e){s.a.read(e)},[]),S=H.useMemo(function(){var e=[];return null==f||f.forEach(function(t){var o=t.rect,s=t.docTargetInfo;e.push((0,a.W_)((0,a.W_)({},t),{rect:(0,q.c)(o.origin,n,i,r,o.size),docTargetInfo:s&&{pageIndex:s.pageIndex,offset:s.offset&&(0,q.c)(s.offset,n,i,r).origin}}))}),e},[f,n,r,i]);return H.createElement("div",{className:"root_26f9d840"},S.map(function(e){var t=e.id,n=e.rect,a=e.text,i=e.href,r=e.displayTarget,o=e.docTargetInfo;return H.createElement("div",{key:t,className:"link_26f9d840",style:Ye(n)},H.createElement("a",{tabIndex:m?-1:0,href:i,target:r,rel:r===Qe?"noopener noreferrer":void 0,onPointerDown:h,onPointerMove:Je,onKeyDown:function(e){g(e,o)},onClick:function(e){v(e,o)},onFocus:function(){y(a)}}))}))}),Ze=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),top:"".concat(e.y,"px")}},$e=function(e){return void 0===e||e===B.a.None},et=H.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(24)]).then(n.bind(n,662)).then(function(e){return{default:e.VirtualAnnots}})}),tt=function(e){return H.createElement(H.Suspense,{fallback:H.createElement("div",null)},H.createElement(et,(0,a.W_)({},e)))},nt=H.memo(H.forwardRef(function(e,t){var n=e.scale,i=e.rotation,r=e.mode,o=e.getPageTextFn,c=e.getLinkInfosFn,d=e.getAccDataInPage,l=e.goToPageFn,u=e.toggleGripperFn,f=e.onFocusPageFn,p=e.onBlurPageFn,m=(0,He.d)(),_=(0,We.b)(),h=H.useMemo(function(){return i%2==0},[i]),b=H.useRef(null),g=H.useRef(null),v=(0,Pe.c)().enableFreeText,y=(0,Re.b)(),S=y.eventBus,D=y.pageManager,I=(0,a.MS)(H.useState(),2),x=I[0],C=I[1];H.useEffect(function(){var e=function(e){var t=null==D?void 0:D.getAccessiblePages(e);C(t)};return S.on(B.e.VisiblePagesLoaded,e),function(){S.off(B.e.VisiblePagesLoaded,e)}},[S,D]);var O=H.useCallback(function(e,t){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return(null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.className)!==qe?[3,2]:(b.current=e.target.parentNode,g.current=e.target.nextSibling,[4,null==f?void 0:f(t)]);case 1:a.sent(),a.label=2;case 2:return[4,null==o?void 0:o(t)];case 3:return n=a.sent(),s.a.read(n||""),[2]}})})},[o,f]);return H.useImperativeHandle(t,function(){return{focusOnVirtualForwardForm:function(){var e;null===(e=g.current)||void 0===e||e.focus()},focusOnVirtualBackwardForm:function(){var e;null===(e=b.current)||void 0===e||e.focus()},isPageTextFocused:function(){var e;return(null===(e=document.activeElement)||void 0===e?void 0:e.className)===qe}}}),H.createElement("div",null,null==x?void 0:x.map(function(e){var t=e.index,a=e.rect;return H.createElement("div",{key:t,ref:b,className:"page_0aca4f1f",style:Ze(a),tabIndex:_?-1:0,"aria-label":m.get("currentPageNumberAria",[t+1])},H.createElement("div",{className:qe,tabIndex:_?-1:0,role:"paragraph",onFocus:function(e){O(e,t)},onBlur:p}),H.createElement("div",{ref:g,className:"vform",tabIndex:_?-1:0}),$e(r)&&H.createElement(Xe,{pageIndex:t,originalPageSize:{width:(h?a.width:a.height)/n,height:(h?a.height:a.width)/n},scale:n,rotation:i,getLinkInfosFn:c,goToPageFn:l,toggleGripperFn:u}),v&&function(e){return $e(e)||e===B.a.FreeText}(r)&&H.createElement(tt,{pageIndex:t,originalPageWidth:(h?a.width:a.height)/n,originalPageHeight:(h?a.height:a.width)/n,scale:n,rotation:i,mode:r,getAccDataInPage:d}))}))})),at=n(362),it=n(384),rt=n(189),ot=n(37),st=n(280),ct=R().memo(R().forwardRef(function(e,t){var n=e.isGripperVisible,i=e.scale,r=Fe().copyToClipboard,o=(0,Ke.a)(),s=(0,a.MS)(R().useState(new c.a(0,0)),2),d=s[0],l=s[1],u=R().useRef(null),f=(0,He.d)();R().useImperativeHandle(t,function(){return{updateContextualMenu:function(e){l(new c.a(e.x,e.y-50*i-36))}}});var p=R().useCallback(function(e){null==e||e.stopPropagation(),null==r||r()},[r]),m=R().useCallback(function(e){e.stopPropagation()},[]),_=R().useCallback(function(e){e.stopPropagation()},[]),h=R().useMemo(function(){return[{key:"Copy",text:f.get("Copy"),iconProps:{iconName:"Copy",style:{color:o.palette.neutralPrimary}},itemProps:{styles:{root:{overflow:"hidden"},menuItemText:{color:o.palette.black}}},onClick:p,onPointerDown:m,onPointerUp:m,onTouchStart:_,onTouchEnd:_}]},[f,o.palette.neutralPrimary,o.palette.black,p,m,_]),b=R().useMemo(function(){return{isBeakVisible:!1,directionalHint:ot.a.topLeftEdge,gapSpace:20,items:h,styles:{root:{backgroundColor:o.semanticColors.menuBackground}}}},[h,o.semanticColors.menuBackground]);return n?R().createElement("div",{id:"contextMenuParent",ref:u,style:{position:"absolute",left:"".concat(d.x,"px"),top:"".concat(d.y,"px")}},R().createElement(st.a,(0,a.W_)({id:"ContextualMenu"},b,{target:u.current,useTargetWidth:!0,hidden:!n}))):null}));ct.displayName="ContextMenu";var dt=H.memo(function(e){var t=e.isLeft,n=e.rotation,i=e.gripperLeft,r=e.gripperTop,o=Fe().onGripperTouchStart,s=H.useMemo(function(){var e="0%",a="0%";switch(n%4){case B.f.Degree0:e=t?"-45%":"-40%";break;case B.f.Degree90:e="-40%",a="100%";break;case B.f.Degree180:e=t?"45%":"50%",a="105%";break;case B.f.Degree270:e="40%"}return"rotate(".concat(n%4*90,"deg) translateX(").concat(e,") translateY(").concat(a,")")},[t,n]),c=H.useCallback(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){switch(n.label){case 0:return e.stopPropagation(),1===e.touches.length&&o?[4,o(t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},[o,t]);return H.createElement("div",null,H.createElement("svg",{width:25,height:25,viewBox:"-1.5 0 15 15",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"#000000",style:{position:"absolute",left:"".concat(i,"px"),top:"".concat(r,"px"),backgroundColor:"transparent",transform:"".concat(s)},onTouchStart:c},H.createElement("g",{strokeWidth:0}),H.createElement("g",{strokeLinecap:"round",strokeLinejoin:"round"}),H.createElement("g",null,H.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},H.createElement("g",{transform:"translate(".concat(-224,", ").concat(-7882,")"),fill:"#5f7eef"},H.createElement("g",{transform:"translate(".concat(56,", ").concat(160,")")},H.createElement("path",{d:"M180,7731 C180,7734.314 177.314,7737 174,7737 C170.686,7737 168,7734.314 168,7731 C168,7727.686 172.5,7722 174,7722 C175.5,7722 180,7727.686 180,7731"})))))))});dt.displayName="Gripper";var lt=H.memo(H.forwardRef(function(e,t){var n=e.rotation,i=e.isGripperVisible,r=(0,a.MS)(H.useState(new c.a(0,0)),2),o=r[0],s=r[1],d=(0,a.MS)(H.useState(new c.a(0,0)),2),l=d[0],u=d[1],f=H.useCallback(function(e){var t=e.left,n=e.right;s(t),u(n)},[]);return H.useImperativeHandle(t,function(){return{updateGripperPosition:function(e){f(e)}}}),H.createElement("div",null,i&&H.createElement("div",null,H.createElement(dt,{isLeft:!0,gripperLeft:o.x,gripperTop:o.y,rotation:n}),H.createElement(dt,{isLeft:!1,gripperLeft:l.x,gripperTop:l.y,rotation:n})))})),ut=n(355);(0,i.Bv)([{rawString:".root_d3fbf39d{width:100%}.page_d3fbf39d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);-webkit-box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13);box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13)}.page_d3fbf39d .childWrapper_d3fbf39d{width:100%;height:100%}"}]);var ft="ScrollBlurRendering",pt=function(e){var t=e.renderPreRenderList,n=function(e){var t=e.visiblePages,n=e.pageCount,i=e.rotation,r=e.renderTargetPageRectByIndex,o=e.getPageSize,s=e.getPredictedMemUsage,d=e.getDistToViewportCenter,l=e.isPageVisible,u=(0,a.MS)(H.useState({}),2),f=u[0],p=u[1],m=H.useRef({}),h=(0,ut.c)(t),b=function(){var e=(0,a.MS)(H.useState(!1),2),t=e[0],n=e[1],i=(0,Re.b)().eventBus;return H.useEffect(function(){var e=function(){n(!0)};return i.on(B.e.InitialDisplayInfoApplied,e),function(){i.off(B.e.Scrolling,e)}},[i]),t}(),g=(0,ut.c)(b),v=H.useRef([]),y=H.useRef(0),S=H.useRef(me.getInstance()),D=(0,ut.a)(function(e){var t,n;try{for(var i=(0,a.OY)(e),r=i.next();!r.done;r=i.next()){var o=r.value;delete m.current[o]}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}p(function(t){var n,i,r={};try{for(var o=(0,a.OY)(Object.entries(t)),s=o.next();!s.done;s=o.next()){var c=(0,a.MS)(s.value,2),d=c[0],l=c[1];e.includes(d)||(r[d]=l)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return _.a.verbose(ft,"removeInvalidatedPagesFromCache, pages=".concat(JSON.stringify(e)," | setCachedImgMap to ").concat(JSON.stringify(Object.keys(r)))),r})}),I=function(e){var t=(0,a.MS)(H.useState(!1),2),n=t[0],i=t[1],r=(0,Re.b)(),o=r.eventBus,s=r.pageManager,d=H.useRef(!1),l=H.useRef([]);return H.useEffect(function(){var e=function(){d.current=!0},t=function(e){var t=e.left,n=e.top;if(d.current&&s){d.current=!1;var a=s.getPageIndexFromPointInOriginalLayout(new c.a(t,n)),i="".concat(a);l.current.includes(i)||l.current.push(i)}};return o.on(B.e.DocumentDirty,e),o.on(B.e.InvalidateRect,t),function(){o.off(B.e.DocumentDirty,e),o.off(B.e.InvalidateRect,t)}},[o,s]),H.useEffect(function(){var t=function(){0!==l.current.length&&(e(l.current),i(!0),l.current=[])};return o.on(B.e.Scrolling,t),function(){o.off(B.e.Scrolling,t)}},[o,e]),{isInvalidateRendering:n,setIsInvalidateRendering:i}}(D),x=I.isInvalidateRendering,C=I.setIsInvalidateRendering,O=(0,ut.a)(function(e,t){if(t){var n=document.createElement("canvas"),r=n.getContext("2d");n.width=t.width,n.height=t.height,null==r||r.putImageData(t,0,0),_.a.verbose(ft,"completed for ".concat(e));var o=n.toDataURL(),s="".concat(e);m.current[s]={usedMemory:o.length,rotation:i},p(function(e){var t,n,i={};try{for(var r=(0,a.OY)(Object.entries(e)),c=r.next();!c.done;c=r.next()){var d=(0,a.MS)(c.value,2),l=d[0],u=d[1];i[l]=u}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i[s]=function(e,t){return H.createElement("img",{src:e,style:{width:"100%",height:"100%"}})}(o),i})}}),w=H.useCallback(function(){return Object.keys(m.current).map(function(e){return parseInt(e)})},[]),E=H.useCallback(function(){var e,t=-1;return w().forEach(function(n){var a=null==d?void 0:d(n);void 0!==a&&(void 0===e||a>e)&&(e=a,t=n)}),{maxDTV:e,indexWithMaxDTV:"".concat(t)}},[w,d]),A=H.useCallback(function(){var e=y.current=y.current+1,i=(0,a.MS)([Math.max.apply(Math,(0,a.AE)([],(0,a.MS)(t),!1))+e,Math.min.apply(Math,(0,a.AE)([],(0,a.MS)(t),!1))-e],2),r=i[0],o=i[1];r<n&&v.current.push(r),o>=0&&v.current.push(o)},[n,t]),L=(0,ut.a)(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var t,n,i,o,c,u;return(0,a.qr)(this,function(f){return t=Object.values(m.current).map(function(e){return e.usedMemory}).reduce(function(e,t){return e+t},0),n=s(e)||0,_.a.verbose(ft,"tryRenderTargetPage ".concat(e,", usedMemMap=").concat(JSON.stringify(m.current),", predictedIncomingMemUsage=").concat(n)),t+n<6291456?(v.current.shift(),[2,new Promise(function(t,n){S.current.setPreRenderTask({target:r,args:[e],isPageVisible:function(){return(null==l?void 0:l(e))||!1},onsuccess:function(n){O(e,n),t(!0)},onerror:n,oncancel:function(){_.a.verbose(ft,"cancel pre-render for ".concat(e)),t(!1)}})})]):(i=null==d?void 0:d(e),o=E(),c=o.maxDTV,u=o.indexWithMaxDTV,void 0!==i&&void 0!==c&&i<c?(delete m.current[u],p(function(e){var t,n,i={};try{for(var r=(0,a.OY)(Object.entries(e)),o=r.next();!o.done;o=r.next()){var s=(0,a.MS)(o.value,2),c=s[0],d=s[1];c!==u&&(i[c]=d)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return _.a.verbose(ft,"setCachedImgMap - ".concat(JSON.stringify(Object.keys(i)))),i}),[2,L(e)]):(v.current=[],y.current=0,[2,!1]))})})}),k=(0,ut.a)(function(){if(0===v.current.length&&(A(),0===v.current.length))return Promise.resolve(!1);var e=v.current[0];return w().includes(e)?(_.a.verbose(ft,"doRender return, page ".concat(e," hits the cache")),v.current.shift(),Promise.resolve(!0)):L(e)}),M=(0,ut.a)(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(t){return e||_.a.verbose(ft,"renderInLoop"),[2,k().then(function(e){return e?M(!0):void _.a.verbose(ft,"The render loop is ended")},function(e){_.a.error(ft,new Error(e))})]})})});H.useEffect(function(){(x||!g&&b||0!==t.length&&JSON.stringify(t)!==JSON.stringify(h))&&b&&(v.current=t.slice(),y.current=0,S.current.cancelPreRenderTask(),_.a.verbose(ft,"isInvalidateRendering=".concat(x,", visiblePages=").concat(JSON.stringify(t),", waitingList=").concat(JSON.stringify(v.current))),M(),C(!1))},[t,h,M,x,C,b,g]),H.useEffect(function(){var e=S.current;return function(){e.cancelPreRenderTask()}},[]);var P=(0,ut.a)(function(e,t){var n,i,r={};try{for(var o=(0,a.OY)(Object.entries(f)),s=o.next();!s.done;s=o.next()){var c=(0,a.MS)(s.value,2),d=c[0],l=c[1],u=m.current[d];if(u){var _=e-u.rotation,h=_%2==0,b=t(parseInt(d)),g=b.width,v=b.height,y=(0,a.MS)(h?["100%","100%",0]:["".concat(v,"px"),"".concat(g,"px"),(v-g)/2],3),S=y[0],D=y[1],I=y[2],x={width:S,height:D,transform:"translate(".concat(-I,"px, ").concat(I,"px) rotate(").concat(_*N.w,"deg)")};r[d]=H.cloneElement(l,{style:x})}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}p(r)});return H.useEffect(function(){P(i,o)},[o,P,i]),f}((0,a.l7)(e,["renderPreRenderList"]));return H.createElement(H.Fragment,null,t(function(e){return n[e]}))},mt=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),top:"".concat(e.y,"px")}},_t=H.memo(function(e){var t=e.pageInfos,n=e.metadata,i=e.curPageIndex,r=e.getScaledOriginalPageRectByIndex,o=e.getDistToViewportCenter,s=e.isPageVisible,c=(0,Re.b)(),d=c.viewHandler,l=c.dpr,u=c.eventBus,f=c.enablePreRender,p=(0,a.MS)(H.useState(!1),2),m=p[0],_=p[1],h=H.useMemo(function(){var e=null==t?void 0:t.map(function(e){return e.index});return o&&e?e.sort(function(e,t){return(o(e)||0)-(o(t)||0)}):e||[]},[o,t]),b=H.useMemo(function(){var e;if(f){var r=null===(e=null==t?void 0:t.find(function(e){return e.index===i}))||void 0===e?void 0:e.rect;if(r&&void 0!==i){var o=n.pageSizes[i],s=o.width,c=o.height,d=(0,a.MS)([s/n.scale,c/n.scale],2),u=d[0],p=d[1],m=Math.min(l,3),_=Math.min(r.height/2,900)/p*m;return Math.round(_*u)/u}}},[i,l,f,n.pageSizes,n.scale,t]),g=H.useCallback(function(e){if(void 0!==b){var t=n.originalPageSizes[e],a=t.width,i=t.height;return a*b*i*b*.5}},[n.originalPageSizes,b]),v=(0,ut.a)(function(e){var t=null==r?void 0:r(e,b),a=n.layoutSize,i=a.width,o=a.height;return d&&t&&void 0!==b?d.render(t,{width:i/n.scale*b,height:o/n.scale*b}):Promise.resolve(void 0)}),y=(0,ut.a)(function(e){return H.createElement("div",{className:"root_d3fbf39d"},null==t?void 0:t.map(function(t){var n=t.index,i=t.rect;return H.createElement("div",{key:n,className:"page_d3fbf39d",style:(0,a.W_)((0,a.W_)({},mt(i)),{backgroundColor:"#ffffff"})},H.createElement("div",{className:"childWrapper_d3fbf39d",style:{visibility:m?"hidden":"visible"}},null==e?void 0:e(n)))}))}),S=H.useCallback(function(e){return n.pageSizes[e]},[n.pageSizes]);return H.useEffect(function(){var e=function(){_(!0)},t=function(){_(!1)};return u.on(B.e.ZoomStart,e),u.on(B.e.ZoomEnd,t),function(){u.off(B.e.ZoomStart,e),u.off(B.e.ZoomEnd,t)}},[u]),H.createElement(H.Fragment,null,f?H.createElement(pt,{renderPreRenderList:y,visiblePages:h,pageCount:n.pageCount,rotation:n.rotation,renderTargetPageRectByIndex:v,getPredictedMemUsage:g,getDistToViewportCenter:o,isPageVisible:s,getPageSize:S}):y())});(0,i.Bv)([{rawString:".root_4eb6d5c3{position:absolute}.root_4eb6d5c3 canvas{position:absolute;width:100%;height:100%}.canvasFixingExtraWhitePage_4eb6d5c3{left:0px}"}]);var ht=function(e,t){var n;if(e.width&&e.height){var a=document.createElement("canvas");return a.width=e.width,a.height=e.height,null===(n=a.getContext("2d"))||void 0===n||n.drawImage(e,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0),a}},bt=function(e){var t=e.width,n=e.height,a=e.top,i=e.left,r=e.renderResult,o=e.blurRenderResult,s=e.onFirstRenderVisibleFn,d=(0,u.a)()*t,l=(0,u.a)()*n,f=(0,ut.c)({left:i,top:a})||{left:i,top:a},p=H.useRef(null),_=H.useRef();H.useLayoutEffect(function(){if(p.current&&t*n!=0&&!o){var e=new c.a(f.left-i,f.top-a).scale((0,u.a)()),r=ht(p.current,e),s=p.current.getContext("2d");null==s||s.clearRect(0,0,d,l),r&&(null==s||s.drawImage(r,0,0))}},[a,i,t,n,o,f.left,f.top,d,l]),H.useLayoutEffect(function(){var e=p.current;if(e){var t=e.getContext("2d");if(r){var n=r.image,a=r.origin,i=r.originRelativeToDoc;a.scale((0,u.a)()),null==t||t.clearRect(a.x,a.y,n.width,n.height),null==t||t.drawImage(function(e){var t,n=document.createElement("canvas");return n.width=e.width,n.height=e.height,null===(t=n.getContext("2d"))||void 0===t||t.putImageData(e,0,0),n}(n),a.x,a.y),"Zoom"===r.triggerType?h.a.sessionMark("End",{rect:JSON.stringify({x:a.x*(0,u.a)(),y:a.y*(0,u.a)(),width:n.width,height:n.height})}):"Scroll"===r.triggerType&&i&&h.a.sessionMark("End",{rect:JSON.stringify({x:i.x,y:i.y,width:n.width,height:n.height})}),r.firstRender&&(h.a.mark("FirstRenderCompleted"),null==s||s()),_.current=ht(e,new c.a(0,0))}else null==t||t.clearRect(0,0,d,l)}},[l,d,r,s]),H.useLayoutEffect(function(){if(p.current&&_.current&&o){var e=p.current.getContext("2d");null==e||e.clearRect(0,0,d,l);var t=o.prevOrigin;t.scale((0,u.a)()).round();var n=_.current.width*(o.ratio||1);null==e||e.drawImage(_.current,0,0,_.current.width,_.current.height,t.x,t.y,n,n*_.current.height/_.current.width),h.a.sessionMark("RenderBlur")}},[o,l,d]);var b={width:"".concat(t,"px"),height:"".concat(n,"px"),left:"".concat(i,"px"),top:"".concat(a,"px")};return H.createElement("div",{style:b,className:"root_4eb6d5c3"},H.createElement("canvas",{width:d,height:l,ref:p,className:m.a.isActivated("FixExtraWhitePage")?"":"canvasFixingExtraWhitePage_4eb6d5c3"}))},gt=H.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(24)]).then(n.bind(n,661)).then(function(e){return{default:e.AnnotationOverlays}})}),vt=H.forwardRef(function(e,t){var n=e.enableAnnotation,i=e.ariaHidden,r=e.visibleDocumentRect,o=e.viewportRenderResult,s=e.viewportBlurRenderResult,c=e.curPageIndex,d=e.visiblePageInfos,l=e.metadata,u=e.annotHandler,f=e.annotParams,p=e.viewHandler,_=e.contentRef,h=e.getScaledOriginalPageRectByIndex,b=e.getDistToViewportCenter,g=e.isPageVisible,v=e.onEditStateChanged,y=e.getPageTextFn,S=e.getLinkInfosFn,D=e.getAccDataInPageFn,I=e.goToPageFn,x=e.toggleGripperFn,C=e.renderRectFn,O=e.renderViewportFn,w=e.syncModeFn,E=e.onFocusPageFn,A=e.onBlurPageFn,L=e.onFirstRenderVisbileFn,k=(f||{}).mode,M=(0,it.b)(),P=M.editState,T=M.dispatchEditAction,U=(0,Re.b)().eventBus,F=(0,Ke.a)(),R=(0,a.MS)(H.useState(!1),2),N=R[0],j=R[1],V=H.useRef(null),z=H.useRef(null),G=H.useRef(null),K=Fe(),W=K.enableGripperContextualMenu,q=K.deSelectText,Q=H.useRef(),Y=H.useCallback(function(){T({type:rt.a.Reset})},[T]);H.useEffect(function(){Q.current=v},[v]),H.useEffect(function(){var e;null===(e=Q.current)||void 0===e||e.call(Q,P)},[P]),H.useEffect(function(){Y()},[Y]),H.useEffect(function(){var e=function(e){T({type:rt.a.Unknown,payload:{annotType:null==e?void 0:e.annotationType}})};return U.on(B.e.DocumentDirty,e),function(){U.off(B.e.DocumentDirty,e)}},[U,T]),H.useEffect(function(){void 0!==k&&(null==u||u.setAnnotationMode(k),null==w||w(k))},[k,u,w]);var J=H.useCallback(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return Y(),[4,null==p?void 0:p.rotate(l.rotation)];case 1:return e.sent(),[4,null==O?void 0:O("Rotate")];case 2:return e.sent(),[2]}})})},[l.rotation,O,Y,p]);return H.useImperativeHandle(t,function(){return{reloadCurrentDocument:function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,null==p?void 0:p.reloadCurrentDocument(e)];case 1:return t.sent(),[4,J()];case 2:return t.sent(),[2]}})})},discardEdits:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,null==p?void 0:p.dropAllChanges()];case 1:return e.sent(),[4,J()];case 2:return e.sent(),[2]}})})},focusOnVirtualForwardForm:function(){var e;null===(e=V.current)||void 0===e||e.focusOnVirtualForwardForm()},focusOnVirtualBackwardForm:function(){var e;null===(e=V.current)||void 0===e||e.focusOnVirtualBackwardForm()},isPageTextFocused:function(){var e;return null===(e=V.current)||void 0===e?void 0:e.isPageTextFocused()},updateGripperPosition:function(e){var t,n;null===(t=z.current)||void 0===t||t.updateGripperPosition(e),null===(n=G.current)||void 0===n||n.updateContextualMenu(e.left)},toggleGripper:function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return e===N?[3,3]:N?[4,null==q?void 0:q()]:[3,2];case 1:t.sent(),t.label=2;case 2:j(e),t.label=3;case 3:return[2]}})})}}},[q,N,J,p]),H.createElement("div",{className:Ge.b,ref:_,style:{backgroundColor:F.semanticColors.bodyBackground}},H.createElement(_t,{pageInfos:d,metadata:l,curPageIndex:c,getScaledOriginalPageRectByIndex:h,getDistToViewportCenter:b,isPageVisible:g}),H.createElement(bt,{width:r.width,height:r.height,left:r.x,top:r.y,renderResult:o,blurRenderResult:s,onFirstRenderVisibleFn:L}),H.createElement(We.a,{ariaHidden:!!i},H.createElement(nt,{ref:V,scale:l.scale,rotation:l.rotation,mode:k,getPageTextFn:y,getLinkInfosFn:S,getAccDataInPage:D,goToPageFn:I,toggleGripperFn:x,onFocusPageFn:E,onBlurPageFn:A})),n&&H.createElement(H.Suspense,{fallback:H.createElement("div",null)},H.createElement(at.a,{metadata:l,annotHandler:u},H.createElement(gt,(0,a.W_)({pageInfos:d,renderRectFn:C,getPageRectFn:h},f)))),!m.a.isActivated("UseGripperSelectText")&&H.createElement("div",null,H.createElement(lt,{ref:z,rotation:l.rotation,isGripperVisible:N}),W&&H.createElement(ct,{ref:G,isGripperVisible:N,scale:l.scale})))});vt.displayName="PdfViewerRendererInner";var yt=H.memo(H.forwardRef(function(e,t){return H.createElement("div",null,H.createElement(it.a,null,H.createElement(vt,(0,a.W_)({},e,{ref:t}))))}));yt.displayName="PdfViewerRenderer";var St={visibleDocumentRect:new c.b(0,0,0,0),viewportRenderResult:void 0,viewportBlurRenderResult:void 0,cursorType:B.b.Default,dpr:(0,u.a)(),fileReady:!1},Dt="PdfViewer",It=function(e){function t(t){var i=e.call(this,t)||this;return i.updateCurrentIndex=l()(function(){var e,t,n=i.pageManager;if(n){var a=n.getCurrentPage();a!==n.currentIndex&&(null===(t=(e=i.props).onCurrentPageChanged)||void 0===t||t.call(e,a),n.currentIndex=a)}i.eventBus.dispatch(B.e.Scrolling)},150),i.extract=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,this.getCurrentFileData()];case 1:return(t=a.sent())?[4,this.getManipulatorHandler()]:[2];case 2:return[2,null===(n=a.sent())||void 0===n?void 0:n.extract(t,e)]}})})},i.merge=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,this.getManipulatorHandler()];case 1:return[2,null===(t=n.sent())||void 0===t?void 0:t.merge(e)]}})})},i.focus=function(){var e;null===(e=i.rootRef.current)||void 0===e||e.focus()},i.verifyPassword=function(e,t){return(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(n){switch(n.label){case 0:return _.a.verbose(Dt,"Verifying password"),[4,this.tryOpenDocument(e,t)];case 1:return n.sent(),[2]}})})},i.startSearch=function(e,t,n,r){return void 0===t&&(t=i.currentIndex),(0,a.Zd)(i,void 0,void 0,function(){var i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,null===(i=this.searchService)||void 0===i?void 0:i.startSearch(e,t,n,r)];case 1:return a.sent(),[2]}})})},i.goToNextSearchResult=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,null===(n=this.searchService)||void 0===n?void 0:n.goToNextSearchResult(e)];case 1:return a.sent(),this.props.onScrollPositionUpdated&&(t=this.currentScrollPosition,this.props.onScrollPositionUpdated(t.x,t.y)),[2]}})})},i.stopSearch=function(){return(0,a.Zd)(i,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.searchService)||void 0===e?void 0:e.stopSearch()];case 1:return t.sent(),[2]}})})},i.scrollBy=function(e,t){var n;null===(n=i.rootRef.current)||void 0===n||n.scrollBy(e,t)},i.scrollTo=function(e,t,n){var a;null===(a=i.rootRef.current)||void 0===a||a.scrollTo({top:t,left:e,behavior:n})},i.goToPage=function(e,t,n){if(e<0)s.a.read(i.l10n.get("firstPagePrompt"));else if(e>=i.pageCount)s.a.read(i.l10n.get("lastPagePrompt"));else{var a=i.layoutManager.scrollRootByPage(e,t,n);e!==i.currentIndex&&a&&s.a.read(i.l10n.get("currentPageNumberAria",[e+1]))}},i.zoom=function(e){var t,n;_.a.verbose(Dt,"Received zoom evt"),h.a.sessionMark("Start"),(null===(t=i.zoomService)||void 0===t?void 0:t.isValidScale(e))&&(i.clearViewport(),null===(n=i.zoomService)||void 0===n||n.zoom(e))},i.rotate=function(e){return void 0===e&&(e=N.w),(0,a.Zd)(i,void 0,void 0,function(){var t,i,r,o=this;return(0,a.qr)(this,function(s){switch(s.label){case 0:return _.a.verbose(Dt,"Received rotate evt"),this.clearViewport(),this.rotateService||!this.viewContext?[3,2]:[4,(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(28).then(n.bind(n,659))];case 1:return[2,e.sent().PdfRotateService]}})})];case 1:t=s.sent(),this.rotateService=new t(this.viewContext,this.layoutManager,this.l10n,this.renderViewport),s.label=2;case 2:return[4,null===(i=this.rotateService)||void 0===i?void 0:i.rotate(e,function(){var e,t,n;null===(e=o.zoomService)||void 0===e||e.responsiveZoom(!0),o.eventBus.dispatch(B.e.RotationChanged),null===(n=(t=o.props).onRotationChanged)||void 0===n||n.call(t)})];case 3:return s.sent(),null===(r=this.viewerRendererRef)||void 0===r||r.toggleGripper(!1),[2]}})})},i.print=function(e,t,r){return(0,a.Zd)(i,void 0,void 0,function(){var i,o,s;return(0,a.qr)(this,function(c){switch(c.label){case 0:return _.a.verbose(Dt,"Received print evt"),this.printService?[3,2]:[4,(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(28).then(n.bind(n,656))];case 1:return[2,e.sent().PdfPrintService]}})})];case 1:i=c.sent(),this.printService=new i(this.getCurrentFileData),c.label=2;case 2:return this.pageManager&&this.viewContext&&(null===(o=this.printService)||void 0===o||o.initPagesPrinter(this.viewContext,this.pageManager.getScaledOriginalPageRects)),[4,null===(s=this.printService)||void 0===s?void 0:s.print(e,t,r)];case 3:return c.sent(),[2]}})})},i.cancelPrint=function(){var e;_.a.verbose(Dt,"Received cancelPrint evt"),null===(e=i.printService)||void 0===e||e.cancel()},i.renderThumbnail=function(e,t,r){return(0,a.Zd)(i,void 0,void 0,function(){var i,o;return(0,a.qr)(this,function(s){switch(s.label){case 0:return _.a.verbose(Dt,"Received renderThumbnail evt"),!this.thumbnailService&&this.viewContext&&this.pageManager?[4,(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(28).then(n.bind(n,657))];case 1:return[2,e.sent().PdfThumbnailService]}})})]:[3,2];case 1:i=s.sent(),this.thumbnailService=new i(this.viewContext,this.pageManager.getScaledOriginalPageRectByIndex),s.label=2;case 2:return[2,null===(o=this.thumbnailService)||void 0===o?void 0:o.renderThumbnail(e,t,r)]}})})},i.clearThumbnailCache=function(){var e;_.a.verbose(Dt,"Received clear thumbnail evt"),null===(e=i.thumbnailService)||void 0===e||e.dispose()},i.getCurrentFileData=function(){return(0,a.Zd)(i,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){return[2,null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler.getCurrentFileData()]})})},i.getTelemetryData=function(){return(0,a.Zd)(i,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){return[2,null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler.getTelemetryData()]})})},i.hasSignature=function(){return(0,a.Zd)(i,void 0,void 0,function(){var e,t,n;return(0,a.qr)(this,function(a){return[2,null===(n=null===(e=this.viewContext)||void 0===e?void 0:(t=e.viewHandler).hasSignature)||void 0===n?void 0:n.call(t)]})})},i.reloadCurrentDocument=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.viewerRendererRef)||void 0===t?void 0:t.reloadCurrentDocument(e)];case 1:return n.sent(),[2]}})})},i.discardEdits=function(){return(0,a.Zd)(i,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.viewerRendererRef)||void 0===e?void 0:e.discardEdits()];case 1:return t.sent(),[2]}})})},i.getEventHandlers=function(){return{onClick:i.onClick,onKeyDown:i.onKeyDown,onPointerDown:function(e){var t;i.onPointerDown(e),null===(t=i.pinchable)||void 0===t||t.onPointerDown(e)},onPointerMove:function(e){var t;i.onPointerMove(e),null===(t=i.pinchable)||void 0===t||t.onPointerMove(e)},onPointerUp:function(e){var t;i.onPointerUp(e),null===(t=i.pinchable)||void 0===t||t.onPointerUp(e)},onWheel:i.onWheel}},i.getPageText=function(e){var t;return(null===(t=i.contentService)||void 0===t?void 0:t.getPageText(e))||Promise.resolve("")},i.getWorkerPerfMarks=function(){return i.viewWorker.getPerfMarks()},i.getCurrentPageIndex=function(){var e;return(null===(e=i.pageManager)||void 0===e?void 0:e.getCurrentPage())||0},i.addFreeText=function(){return(0,a.Zd)(i,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.inputEvtService)||void 0===e?void 0:e.addFreeText()];case 1:return t.sent(),[2]}})})},i.getDocPermissions=function(){var e;return(null===(e=i.viewContext)||void 0===e?void 0:e.metadata.getDocPermissions())||[]},i.refreshViewPortForProgressiveLoading=function(){return(0,a.Zd)(i,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return this.useProgressiveLoading?[4,null===(e=this.viewContext)||void 0===e?void 0:e.updateOriginalLayoutForProgressiveLoading()]:[2,!1];case 1:return t.sent()?(this.layoutManager.resetContentSize(),this.renderViewport("Refresh"),[2,!0]):[2,!1]}})})},i.storeDisplayInfo=function(){var e,t,n,a={pos:i.currentScrollPosition,scale:(null===(e=i.zoomService)||void 0===e?void 0:e.getZoomOpt())||i.scale,rotation:i.rotation};null===(t=i.displayHelper)||void 0===t||t.storeInfoInLocalStorage(a),null===(n=i.freeTextService)||void 0===n||n.storeFreeTextAttribute()},i.setViewerRendererRef=function(e){i.viewerRendererRef=e},i.onScroll=function(){i.preventScrollRender?i.preventScrollRender=!1:i.renderViewport(),i.updateCurrentIndex()},i.onResize=function(){var e;_.a.verbose(Dt,"Received resize evt"),i.resizeViewer(),null===(e=i.viewerRendererRef)||void 0===e||e.toggleGripper(!1)},i.onWheel=function(e){var t,n;e.ctrlKey&&(e.preventDefault(),null===(t=i.renderService)||void 0===t||t.clear(),null===(n=i.zoomService)||void 0===n||n.wheelZoom(e))},i.onKeyDown=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onKeyDown(this.getNativeEvt(e),this.currentIndex,!!(null===(n=this.viewerRendererRef)||void 0===n?void 0:n.isPageTextFocused()))];case 1:return a.sent(),[2]}})})},i.onPointerDown=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(n=this.pinchable)||void 0===n||n.onPointerDown(t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onPointerDown(t)];case 1:return a.sent(),[2]}})})},i.onPointerMove=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(n=this.pinchable)||void 0===n||n.onPointerMove(t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onPointerMove(t)];case 1:return a.sent(),[2]}})})},i.onPointerUp=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(n=this.pinchable)||void 0===n||n.onPointerUp(t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onPointerUp(t)];case 1:return a.sent(),[2]}})})},i.onPointerCancel=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){return null===(t=this.pinchable)||void 0===t||t.onPointerUp(this.getNativeEvt(e)),[2]})})},i.onPointerOut=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){return null===(t=this.pinchable)||void 0===t||t.onPointerUp(this.getNativeEvt(e)),[2]})})},i.onPointerLeave=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){return null===(t=this.pinchable)||void 0===t||t.onPointerUp(this.getNativeEvt(e)),[2]})})},i.onTouchStart=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onTouchStart(e)];case 1:return n.sent(),[2]}})})},i.onTouchMove=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onTouchMove(e)];case 1:return n.sent(),[2]}})})},i.onTouchEnd=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onTouchEnd(e)];case 1:return n.sent(),[2]}})})},i.onClick=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onClick(this.getNativeEvt(e))];case 1:return n.sent(),[2]}})})},i.onContextMenu=function(e){e.preventDefault()},i.onGlobalMouseMove=function(e){var t;i.isEvtInsideViewer(e)||null===(t=i.contentService)||void 0===t||t.onPointerMove(new c.a(e.clientX,e.clientY))},i.onGlobalMouseUp=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return(null===(t=this.props.annotParams)||void 0===t?void 0:t.mode)!==B.a.None||this.isEvtInsideViewer(e)?[2]:[4,null===(n=this.inputEvtService)||void 0===n?void 0:n.onPointerUp(e)];case 1:return a.sent(),[2]}})})},i.onWorkerMessage=function(e){return(0,a.Zd)(i,void 0,void 0,function(){var t,n,i,r,o,s,c,d,l,u;return(0,a.qr)(this,function(a){switch(a.label){case 0:switch(f=e.data,(t={type:re(f.type),name:oe(f.name),payload:f.payload}).type){case 0:return[3,1];case 1:case 7:return[3,8];case 2:return[3,9];case 3:return[3,10];case 4:case 5:return[3,11];case 6:return[3,12];case 9:return[3,14];case 8:return[3,15]}return[3,17];case 1:return 3!==t.name?[3,4]:!this.useProgressiveLoading||this.state.fileReady?[3,3]:[4,this.refreshViewPortForProgressiveLoading()];case 2:a.sent(),a.label=3;case 3:return[3,18];case 4:return(n=4===t.name)&&this.eventBus.dispatch(B.e.InvalidateRect,t.payload),i=(null===(o=this.props.annotParams)||void 0===o?void 0:o.mode)||B.a.None,n&&(i===B.a.Highlight||i===B.a.Ink||this.props.enableEnhancedInk&&i===B.a.PointErase)?(this.eventBus.dispatch(B.e.InvalidateRectForAnnot,t.payload),[3,7]):[3,5];case 5:return[4,null===(s=this.contentService)||void 0===s?void 0:s.onNotification(t)];case 6:a.sent(),a.label=7;case 7:return[3,18];case 8:return null===(c=this.inputEvtService)||void 0===c||c.onNotification(t),[3,18];case 9:return null===(d=this.linkService)||void 0===d||d.onNotification(t),[3,18];case 10:return null===(l=this.searchService)||void 0===l||l.onNotification(t),[3,18];case 11:try{r=function(e){switch(e){case"DocumentSaved":return B.e.DocumentSaved;case"InkStrokesAdded":return B.e.InkStrokesAdded;case"InkAdded":return B.e.InkAdded;case"InkUpdated":return B.e.InkUpdated;case"SetDocumentDirty":return B.e.DocumentDirty;case"ShowEditableInk":return B.e.ShowEditableInk;case"ShowEraserableInk":return B.e.ShowErasableInk;default:throw"Unsupported notification name"}}(e.data.name),this.eventBus.dispatch(r,t.payload)}catch(e){}return[3,18];case 12:return[4,null===(u=this.freeTextService)||void 0===u?void 0:u.onNotification(t)];case 13:return a.sent(),[3,18];case 14:return 21===t.name&&this.eventBus.dispatch(B.e.VisiblePagesLoaded,t.payload),[3,18];case 15:return[4,this.handleRangeRequestNotification(t)];case 16:return a.sent(),[3,18];case 17:return[3,18];case 18:return[2]}var f})})},i.renderViewport=function(e){return void 0===e&&(e="Scroll"),(0,a.Zd)(i,void 0,void 0,function(){var t,n,i,r=this;return(0,a.qr)(this,function(a){return this.layoutManager.rootRect.clear(),"Scroll"===e&&h.a.sessionMark("Start",{scrollPos:JSON.stringify({x:this.layoutManager.rootRect.getScrollLeft(),y:this.layoutManager.rootRect.getScrollTop()})}),t=this.layoutManager.viewportRectRelativeToDocument,this.setState({visibleDocumentRect:this.layoutManager.visibleDocumentRectRelativeToContent}),null===(i=(n=this.props).onRenderViewport)||void 0===i||i.call(n),[2,new Promise(function(n,a){var i,o;null===(i=r.renderService)||void 0===i||i.render({rect:t,layoutSize:r.layoutManager.documentSize,rotation:null===(o=r.viewContext)||void 0===o?void 0:o.metadata.rotation,triggerType:e,onCompleted:function(e){n(e)},onError:function(e){a(e)}})})]})})},i.updateRenderResult=function(e){var t;if(e){var n=i.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();e.origin=null===(t=e.origin)||void 0===t?void 0:t.plus(n)}i.setState({viewportRenderResult:e,viewportBlurRenderResult:void 0})},i.updateBlurRenderResult=function(e){i.setState({visibleDocumentRect:i.layoutManager.visibleDocumentRectRelativeToContent,viewportBlurRenderResult:e})},i.updateCursorType=function(e){var t,n;e!==i.state.cursorType&&(i.setState({cursorType:e}),Object.values(B.b).includes(e)&&(null===(n=(t=i.props).onCursorUpdate)||void 0===n||n.call(t,e)))},i.onFormFocus=function(e){var t,n,a;if(i.props.enableFormFilling&&i.props.formAttributes){var r=null===(t=i.rootRef.current)||void 0===t?void 0:t.hasAttribute(i.props.formAttributes);e&&!r?null===(n=i.rootRef.current)||void 0===n||n.setAttribute(i.props.formAttributes,"true"):!e&&r&&(null===(a=i.rootRef.current)||void 0===a||a.removeAttribute(i.props.formAttributes))}},(0,o.a)(i),i.state=St,i.outerRef=H.createRef(),i.outerRect=new De,i.rootRef=H.createRef(),i.contentRef=H.createRef(),i.layoutManager=new we,i.l10n=(0,He.b)(),i.useProgressiveLoading=!!i.props.enableProgressiveLoading&&!!i.props.fileSize&&Ee(!!i.props.enableCopyByChunk,i.props.fileSize),i.wasmDataProvider=Me.a.getInstance(),i.worker=new Worker(Se.a.workerSrc),i.viewWorker=E(i.worker),i.viewWorker.setupEnv({wasmModuleInit:Se.a.wasmModuleInit,enableLogging:!!Se.a.enableLogging,activatedKillSwitches:m.a.activatedKillSwitches,globalVarNameForWorkerVer:Se.a.globalVarNameForWorkerVer}),i.docLoader=new ee(t.url,t.filename,t.fileSize,t.enableDownloadByRange,t.token),i.docOpener=new te(t.onNeedPassword),i.eventBus=new p.a,i.preventScrollRender=!1,i}return(0,a.XJ)(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.outerRect.initialize(this.outerRef.current),this.layoutManager.initialize(this.rootRef.current,this.contentRef.current,this.props.onScrollPositionUpdated),this.updateOuterHeight(),this.setLocaleStrings(),this.initViewer()},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.url,a=t.height,i=t.localeStrings;n!==e.url?(this.reset(),this.initViewer()):a!==e.height&&(this.updateOuterHeight(),this.resizeViewer()),i!==e.localeStrings&&this.setLocaleStrings()},t.prototype.componentWillUnmount=function(){var e,t;this.mounted=!1,this.initRenderRequestId&&cancelAnimationFrame(this.initRenderRequestId),this.dispose(),this.worker.terminate(),this.wasmDataProvider.dispose(),null===(t=(e=this.props).onDocumentUnloaded)||void 0===t||t.call(e)},t.prototype.render=function(){var e,t,n,a,i,o,s,c,d,l,u,f,p,m,_,h,b=(0,v.a)(this.props.theme,this.props.darkMode),g=this.pageManager;return H.createElement(r.a,{theme:b,className:Ge.a},H.createElement(He.a,{strings:this.strings},H.createElement(Re.a,{dpr:this.state.dpr,eventBus:this.eventBus,pageManager:g,viewHandler:null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler,enablePreRender:this.state.fileReady&&this.props.enablePreRender,enableEnhancedInk:this.props.enableEnhancedInk},H.createElement(Ue,{enableGripperContextualMenu:this.props.enableGripperContextualMenu||!1,onGripperTouchStart:null===(t=this.inputEvtService)||void 0===t?void 0:t.onGripperTouchStart,copyToClipboard:null===(n=this.contentService)||void 0===n?void 0:n.copyToClipboard,deSelectText:null===(a=this.inputEvtService)||void 0===a?void 0:a.gripperDeSelectText},H.createElement(Pe.a,{enableFreeText:this.props.enableFreeText,freeTextHandler:this.freeTextHandler,freeTextContainer:this.props.freeTextContainer,showEditableFreeTextAt:null===(i=this.inputEvtService)||void 0===i?void 0:i.showEditableFreeTextAt,setInitialFontAttributes:null===(o=this.freeTextService)||void 0===o?void 0:o.setInitialFontAttributes},H.createElement("div",{className:Ge.c,ref:this.outerRef},H.createElement("div",{className:Ge.d,style:{cursor:this.state.cursorType},tabIndex:this.props.isRootFocusable&&!this.props.ariaHidden?0:-1,"aria-label":this.docLoader.filename,ref:this.rootRef,onClick:this.onClick,onContextMenu:this.onContextMenu,onKeyDown:this.onKeyDown,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp,onPointerCancel:this.onPointerCancel,onPointerOut:this.onPointerOut,onPointerLeave:this.onPointerLeave,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},H.createElement(yt,{ref:this.setViewerRendererRef,enableAnnotation:this.props.enableAnnotation,ariaHidden:this.props.ariaHidden,contentRef:this.contentRef,visibleDocumentRect:this.state.visibleDocumentRect,curPageIndex:null==g?void 0:g.getCurrentPage(),visiblePageInfos:null==g?void 0:g.getVisiblePages(),viewportRenderResult:this.state.viewportRenderResult,viewportBlurRenderResult:this.state.viewportBlurRenderResult,metadata:(null===(s=this.viewContext)||void 0===s?void 0:s.metadata)||new V({width:0,height:0},0,[]),annotHandler:this.annotHandler,viewHandler:null===(c=this.viewContext)||void 0===c?void 0:c.viewHandler,annotParams:this.props.annotParams,getScaledOriginalPageRectByIndex:null==g?void 0:g.getScaledOriginalPageRectByIndex,getDistToViewportCenter:this.layoutManager.getDistToViewportCenter,isPageVisible:null==g?void 0:g.isPageVisible,getPageTextFn:null===(d=this.contentService)||void 0===d?void 0:d.getPageText,getLinkInfosFn:null===(l=this.linkService)||void 0===l?void 0:l.getLinkInfosInPage,getAccDataInPageFn:null===(u=this.freeTextService)||void 0===u?void 0:u.getAccDataInPage,renderRectFn:null===(f=this.contentService)||void 0===f?void 0:f.renderRect,renderViewportFn:this.renderViewport,goToPageFn:this.goToPage,toggleGripperFn:null===(p=this.viewerRendererRef)||void 0===p?void 0:p.toggleGripper,syncModeFn:null===(m=this.inputEvtService)||void 0===m?void 0:m.setMode,onEditStateChanged:this.props.onEditStateChanged,onFocusPageFn:null===(_=this.inputEvtService)||void 0===_?void 0:_.onFocusPage,onBlurPageFn:null===(h=this.inputEvtService)||void 0===h?void 0:h.onBlurPage,onFirstRenderVisbileFn:this.props.onFirstRenderVisible}))))))))},Object.defineProperty(t.prototype,"pageCount",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.pageCount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){var e=this.pageManager;return e?e.currentIndex:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentScrollPosition",{get:function(){return this.layoutManager.currentScrollPosition},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filename",{get:function(){return this.docLoader.filename},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalLayoutSize",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.originalLayoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layoutSize",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSizes",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.pageSizes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalPageRects",{get:function(){var e=this.pageManager;return e?e.getOriginalPageRects():[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){var e,t=null===(e=this.viewContext)||void 0===e?void 0:e.metadata.rotation;return t?t*N.w:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMip",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.mip)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMipDecrypted",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.isMipDecrypted)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coordinateConverters",{get:function(){return{convertPointFromClientToOriginalDocument:this.layoutManager.convertPointFromClientToOriginalDocument,convertPointFromOriginalDocumentToClient:this.layoutManager.convertPointFromOriginalDocumentToClient}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomOpt",{get:function(){var e;return null===(e=this.zoomService)||void 0===e?void 0:e.getZoomOpt()},enumerable:!1,configurable:!0}),t.prototype.setLocaleStrings=function(){return(0,a.Zd)(this,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return e=this,(t=this.props.localeStrings)?[3,2]:[4,(0,He.c)()];case 1:t=n.sent(),n.label=2;case 2:return e.strings=t,this.l10n.strings=this.strings,[2]}})})},t.prototype.getFileDataAndUpdateFlag=function(){return(0,a.Zd)(this,void 0,void 0,function(){var e,t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return this.useProgressiveLoading?[2,[new Uint8Array(0),this.props.fileSize,!0]]:this.props.enablePreview&&this.props.fileData?(t=this.props.fileData,[3,3]):[3,1];case 1:return[4,this.docLoader.fetch(this.props.enableDebugString)];case 2:t=a.sent(),a.label=3;case 3:return e=t,this.setState({fileReady:!0}),e?(n=e.length,[2,[e,n,Ee(!!this.props.enableCopyByChunk,n)]]):[2,[e,0,!1]]}})})},t.prototype.initViewer=function(e){var t,n,i,r;return void 0===e&&(e=!1),(0,a.Zd)(this,void 0,void 0,function(){var o,s,c,d,l,u,p,v,y,S,D,I,x,C,O,w,E,A,L;return(0,a.qr)(this,function(k){switch(k.label){case 0:e||(this.docLoadScenario=b.a.createScenario({name:g.a.DocumentLoad})),k.label=1;case 1:return k.trys.push([1,17,,18]),m.a.isActivated("CheckWorkerVersion")?[3,3]:[4,this.checkWorkerVersion()];case 2:k.sent(),k.label=3;case 3:return[4,this.getFileDataAndUpdateFlag()];case 4:return o=a.MS.apply(void 0,[k.sent(),3]),s=o[0],c=o[1],d=o[2],this.mounted&&s?(h.a.mark("Downloaded"),this.exposeFnsToWorker(),[4,this.wasmDataProvider.getModuleInnerInit()]):(l=new f.c(f.b.PdfLoadCanceled,"PdfViewer unmounted before opening document.unmounted:".concat(!this.mounted,", filedata undefined:").concat(!s)),b.a.logError(l.toCaughtError()),null===(t=this.docLoadScenario)||void 0===t||t.stop(),[2]);case 5:return u=k.sent(),[4,this.viewWorker.initialize(u)];case 6:return k.sent(),[4,this.viewWorker.getHandlerInstance(s,c,d)];case 7:return p=k.sent(),_.a.verbose(Dt,"Created PdfViewHandler instance"),[4,this.viewWorker.getInputEvtHandler()];case 8:return v=k.sent(),y=this,[4,G.getInstance(p,v)];case 9:return y.viewContext=k.sent(),this.docOpener.viewHandler=p,this.docOpener.reset(),this.useProgressiveLoading?(this.bindWorkerMessage(),[4,this.docLoader.initPdfDocumentLoaderByQueue(p.onRangeRequestDone.bind(p))]):[3,11];case 10:k.sent(),this.docLoader.fetchChunks(),k.label=11;case 11:return S={featureConfigInMspdfkit:{enableFormFilling:!!this.props.enableFormFilling,enableOpenMip:!!this.props.enableOpenMip,enableProgressiveLoading:this.useProgressiveLoading},featureConfigInPdfControl:{enableFreeText:!!this.props.enableFreeText,enableEnhancedInk:!!this.props.enableEnhancedInk}},[4,p.setFeatureConfig(S)];case 12:return k.sent(),D=this,[4,this.viewWorker.getAnnotationHandlerInstance()];case 13:return D.annotHandler=k.sent(),this.props.enableFreeText?(I=this,[4,this.viewWorker.getFreeTextHandler()]):[3,15];case 14:I.freeTextHandler=k.sent(),k.label=15;case 15:return x=this.props.enablePreview&&this.props.initialPassword?this.props.initialPassword:void 0,[4,this.tryOpenDocument(x)];case 16:return k.sent(),[3,18];case 17:return(null==(C=k.sent())?void 0:C.message)&&(O=Se.a.wasmModuleInit.length>0?Se.a.wasmModuleInit[0]:void 0)&&(w=O.wasmUrl,E=O.dataUrl,A=O.wasmJsUrlOrBlob,C.message+=". Additional: wasmUrl=".concat(encodeURIComponent(w),", wasmJsUrl=").concat("string"==typeof A&&encodeURIComponent(A),", dataUrl=").concat(encodeURIComponent(E||""))),(L=C instanceof f.c?C.toQosError():{isExpected:C.isExpected||C.name===f.b.InvalidPDF,error:C,code:C.name}).extraData={noTempAuth:!this.props.url.toLowerCase().includes("tempauth"),useToken:!!this.props.token},null===(n=this.docLoadScenario)||void 0===n||n.fail(L),null===(r=(i=this.props).onInitError)||void 0===r||r.call(i,L),[2];case 18:return[2]}})})},t.prototype.tryOpenDocument=function(e,t){var n;return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,this.docOpener.tryOpen(e,t)];case 1:return a.sent()?this.useProgressiveLoading?[3,3]:[4,this.initDocument()]:(null===(n=this.docLoadScenario)||void 0===n||n.stop(),[2]);case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.initDocument=function(){var e,t,n,i;return(0,a.Zd)(this,void 0,void 0,function(){var r,o,s,c=this;return(0,a.qr)(this,function(a){switch(a.label){case 0:if(h.a.mark("Opened"),!this.viewContext)throw new f.c(f.b.ViewContextNotInitialized,"PdfViewer viewContext empty");return[4,this.viewContext.initMetadata()];case 1:return a.sent(),r=this.layoutManager.metadata=this.viewContext.metadata,null===(e=this.docLoadScenario)||void 0===e||e.stop({extraData:{pageCount:r.pageCount,averagePageSize:0===r.pageCount?0:this.docLoader.fileSize/r.pageCount,mip:r.mip,noTempAuth:!this.props.url.toLowerCase().includes("tempauth"),useToken:!!this.props.token}}),[4,this.viewWorker.getFontHandler()];case 2:return o=a.sent(),this.loadFontPromise=Se.a.fontUrls&&o.loadFonts(Se.a.fontUrls),this.initServices(),this.pinchable=new ke(this.zoomService.blurZoom,function(){var e,t;null===(e=c.renderService)||void 0===e||e.clear(),null===(t=c.zoomService)||void 0===t||t.render()}),m.a.isActivated("StoreDisplayInfoInLocalStorage")||!this.props.enableCacheDisplayInfo||!this.props.uniqueId||this.props.defaultPageNumber||this.props.defaultScale||(this.displayHelper=new ze(this.props.uniqueId)),this.bindEvents(),s={pageNumber:this.props.defaultPageNumber,pos:void 0,scale:this.props.defaultScale,rotation:void 0},null===(t=this.displayHelper)||void 0===t||t.applyInfoInLocalStorage(s),[4,this.initContent(s)];case 3:return a.sent(),null===(i=(n=this.props).onDocumentLoaded)||void 0===i||i.call(n,r),[2]}})})},t.prototype.exposeFnsToWorker=function(){var e=this;this.props.enableOpenMip&&O({getMIPToken:function(){return(0,a.Zd)(e,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){return[2,(null===(t=(e=this.props).getMIPToken)||void 0===t?void 0:t.call(e))||""]})})}},this.worker)},t.prototype.initServices=function(){var e,t,n=this;this.viewContext&&(this.renderService=new _e(this.viewContext,this.updateRenderResult,this.props.onRenderError,function(){n.eventBus.dispatch(B.e.InitialDisplayInfoApplied)}),this.zoomService=new ye(this.viewContext,this.layoutManager,this.renderViewport,this.updateBlurRenderResult,this.eventBus.dispatch.bind(this.eventBus),function(){n.preventScrollRender=!0},function(e,t){var a,i,r;null===(a=n.viewerRendererRef)||void 0===a||a.toggleGripper(!1),n.pinchable&&(n.pinchable.scale=e),null===(r=(i=n.props).onScaleChanged)||void 0===r||r.call(i,e,t),n.eventBus.dispatch(B.e.ScaleChanged)}),this.contentService=new J(this.viewContext,this.layoutManager,this.l10n,this.updateRenderResult,this.goToPage,this.scrollBy,this.props.onTextSelected,this.props.onTextDeselected,this.useProgressiveLoading?this.refreshViewPortForProgressiveLoading:void 0),this.linkService=new fe(this.viewContext,this.layoutManager,this.goToPage,this.eventBus.dispatch.bind(this.eventBus)),this.searchService=new he(this.viewContext),this.inputEvtService=new ue(this.viewContext,this.layoutManager,this.l10n,this.contentService,function(e){var t;null===(t=n.viewerRendererRef)||void 0===t||t.toggleGripper(e)},function(e){var t;null===(t=n.viewerRendererRef)||void 0===t||t.updateGripperPosition(e)},this.goToPage,this.scrollBy,this.scrollTo,function(){var e;null===(e=n.viewerRendererRef)||void 0===e||e.focusOnVirtualForwardForm()},function(){var e;null===(e=n.viewerRendererRef)||void 0===e||e.focusOnVirtualBackwardForm()},this.updateCursorType,this.onFormFocus,this.rootRef.current||void 0,this.props.enableFormFilling),this.props.enableFreeText&&(this.freeTextService=new ae(this.viewContext,(null===(e=this.pageManager)||void 0===e?void 0:e.getOriginalPageRects())||[],this.eventBus.dispatch.bind(this.eventBus))),null===(t=this.loadFontPromise)||void 0===t||t.then(function(){n.renderViewport("Init")}))},t.prototype.initContent=function(e){var t;return(0,a.Zd)(this,void 0,void 0,function(){var n=this;return(0,a.qr)(this,function(a){switch(a.label){case 0:return null===(t=this.zoomService)||void 0===t||t.initScale(e.scale),e.rotation?[4,this.rotate(e.rotation)]:[3,2];case 1:a.sent(),a.label=2;case 2:return this.layoutManager.resetContentSize(),e.pageNumber&&this.goToPage(e.pageNumber-1,e.pos),this.initRenderRequestId=requestAnimationFrame(function(){n.layoutManager.resetContentSize(),requestAnimationFrame(function(){_.a.verbose(Dt,"Root size: ".concat(n.layoutManager.rootRect.getClientWidth(),", ").concat(n.layoutManager.rootRect.getClientHeight())),n.renderViewport("Init")})}),[2]}})})},t.prototype.initManipulator=function(){return(0,a.Zd)(this,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,this.wasmDataProvider.getModuleInnerInit("Manipulator")];case 1:return e=t.sent(),[4,this.viewWorker.initialize(e)];case 2:return t.sent(),[2,this.viewWorker.getManipulatorHandlerInstance()]}})})},t.prototype.getManipulatorHandler=function(){return this.manipulatorInitPromise||(this.manipulatorInitPromise=this.initManipulator()),this.manipulatorInitPromise},t.prototype.reset=function(){var e;null===(e=this.renderService)||void 0===e||e.clear(),this.dispose(),this.layoutManager.metadata=void 0,this.setState(St),this.layoutManager.contentRect.reset(),this.layoutManager.rootRect.clear(),this.docLoader=new ee(this.props.url,this.props.filename,this.props.fileSize,this.props.enableDownloadByRange),_.a.verbose(Dt,"Reset")},t.prototype.dispose=function(){var e,t,n,a,i;this.removeEvents(),this.storeDisplayInfo(),null===(e=this.renderService)||void 0===e||e.clear(),null===(t=this.printService)||void 0===t||t.dispose(),null===(n=this.inputEvtService)||void 0===n||n.dispose(),null===(a=this.viewContext)||void 0===a||a.dispose(),this.docLoader.dispose(),null===(i=this.thumbnailService)||void 0===i||i.dispose(),me.getInstance().clear(),h.a.clearMarks(),this.renderService=void 0,this.zoomService=void 0,this.contentService=void 0,this.inputEvtService=void 0},t.prototype.bindWorkerMessage=function(){this.worker.addEventListener("message",this.onWorkerMessage)},t.prototype.bindEvents=function(){m.a.isActivated("UseSizeObserver")?window.addEventListener("resize",this.onResize):this.observeOuterSizeChange(),window.addEventListener("mousemove",this.onGlobalMouseMove),window.addEventListener("mouseup",this.onGlobalMouseUp),window.addEventListener("beforeunload",this.storeDisplayInfo);var e=this.rootRef.current;null==e||e.addEventListener("touchmove",this.onTouchMove),null==e||e.addEventListener("scroll",this.onScroll),null==e||e.addEventListener("wheel",this.onWheel,{passive:!1}),this.useProgressiveLoading||this.bindWorkerMessage()},t.prototype.removeEvents=function(){var e;m.a.isActivated("UseSizeObserver")?window.removeEventListener("resize",this.onResize):null===(e=this.outerSizeObserver)||void 0===e||e.disconnect(),window.removeEventListener("mousemove",this.onGlobalMouseMove),window.removeEventListener("mouseup",this.onGlobalMouseUp),window.removeEventListener("beforeunload",this.storeDisplayInfo);var t=this.rootRef.current;null==t||t.removeEventListener("touchmove",this.onTouchMove),null==t||t.removeEventListener("scroll",this.onScroll),null==t||t.removeEventListener("wheel",this.onWheel),this.worker.removeEventListener("message",this.onWorkerMessage),this.eventBus.dispose()},t.prototype.observeOuterSizeChange=function(){var e=this,t=!0;this.outerSizeObserver=new ResizeObserver(function(n){var i,r;try{for(var o=(0,a.OY)(n),s=o.next();!s.done;s=o.next())if(s.value.target.className===Ge.c){t?t=!1:e.onResize();break}}catch(e){i={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}}),this.outerRef.current&&this.outerSizeObserver.observe(this.outerRef.current)},t.prototype.handleRangeRequestNotification=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t,n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:if(!this.useProgressiveLoading)return[2];switch(e.name){case 15:return[3,1];case 17:return[3,2];case 16:return[3,3]}return[3,6];case 1:return t=e.payload,n=t.start,i=t.size,this.docLoader.requestRange(n,i),[3,7];case 2:return e.payload.errorCode===B.c.Success?this.initDocument():(this.useProgressiveLoading=!1,this.dispose(),this.initViewer(!0)),[3,7];case 3:return e.payload.needUpdate?[4,this.refreshViewPortForProgressiveLoading()]:[3,5];case 4:a.sent(),a.label=5;case 5:return this.setState({fileReady:!0}),this.renderViewport("Init"),[3,7];case 6:return[3,7];case 7:return[2]}})})},t.prototype.resizeViewer=function(){var e,t,n=this,a=(0,u.a)();a!==this.state.dpr&&(this.setState({dpr:a}),this.clearViewport()),(null===(e=this.zoomService)||void 0===e?void 0:e.isResponsiveZoomValid())&&this.eventBus.dispatch(B.e.ResponsiveResize),(null===(t=this.zoomService)||void 0===t?void 0:t.responsiveZoom())||(this.layoutManager.resetContentSize(),requestAnimationFrame(function(){n.renderViewport()}))},t.prototype.updateOuterHeight=function(){this.props.height&&this.outerRect.setHeight(this.props.height)},t.prototype.clearViewport=function(){var e;null===(e=this.renderService)||void 0===e||e.clear(),this.setState({viewportRenderResult:void 0,viewportBlurRenderResult:void 0})},t.prototype.isEvtInsideViewer=function(e){var t,n,a=new c.a(e.clientX,e.clientY),i=e.target,r=null===(t=this.rootRef.current)||void 0===t?void 0:t.getBoundingClientRect();return i instanceof Node&&(null===(n=this.rootRef.current)||void 0===n?void 0:n.contains(i))||!!r&&a.x>=r.x&&a.x<=r.x+r.width&&a.y>=r.y&&a.y<=r.y+r.height},t.prototype.getNativeEvt=function(e){return e.nativeEvent||e},t.prototype.checkWorkerVersion=function(){var e,t;return(0,a.Zd)(this,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,this.viewWorker.getExtWorkerVersion()];case 1:if(n=a.sent(),null===(t=(e=this.props).isWorkerVersionMismatch)||void 0===t?void 0:t.call(e,n))throw new f.e("Fail to initialize viewer due to mismatching between web worker and the main app, workerVersion=".concat(n,", workerSrc=").concat(encodeURIComponent(Se.a.workerSrc)));return[2]}})})},Object.defineProperty(t.prototype,"pageManager",{get:function(){return this.layoutManager.pageManager},enumerable:!1,configurable:!0}),t.defaultProps={isRootFocusable:!0,enableCacheDisplayInfo:!0},t}(H.Component)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l});var a=n("tslib_826"),i=n("react-lib"),r=n(189),o=i.createContext(void 0),s={dirty:!1},c=function(e,t){var n;return t.type===r.a.Reset?s:{dirty:!0,annotTypeOfLatestEdit:null===(n=t.payload)||void 0===n?void 0:n.annotType}},d=function(e){var t=e.children,n=(0,a.MS)(i.useReducer(c,s),2),r=n[0],d=n[1],l=i.useMemo(function(){return{editState:r,dispatchEditAction:d}},[r]);return i.createElement(o.Provider,{value:l},t)},l=(o.Consumer,function(){return i.useContext(o)})}
,,(e,t,n)=>{"use strict";n.r(t);var a=n("tslib_826"),i=n(403),r=n(401),o=n(6),s=n(206),c={webThemeProvider:function(e){return new r.a({pageContext:e,getThemeDataSource:function(){return function(e){return new o.c(function(t,a){window.require.specified("@ms/odsp-datasources/lib/dataSources/theming/spList/WebThemeDataSource"),n.e(62).then(n.bind(n,626)).then(s.a).then(function(n){t(new n(e))})})}(e)}})}};i.a.initializeTheme(c);var d=n(363),l=n("fui.util_554"),u=window.require.toUrl("odsp-media/fluenthybridfont/");(0,d.a)(u);var f={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('".concat(u,"patch/odsp-patch-icons-33e61432.woff') format('woff')")},icons:{PinOff:"",PinNavMenu:"",PinOffSolid:"",PinSolid:""}};(0,l.bV)(f);var p=n("react-lib"),m=n.n(p),_=n(406),h=n(407),b=n(408),g=n(409),v=n(404),y=n(405),S=n(410),D=n(411),I=n(412),x=n(413),C="".concat(l.P4,"/"),O="".concat(C,"assets/item-types/"),w="".concat(C,"office-ui-fabric-react-assets/foldericons"),E="".concat(C,"assets/brand-icons/product/"),A=window.require.toUrl("odsp-media/images/addtoonedrive"),L=v.a,k=y.a;const M=n.p+"images/error_exclamation_v3_0c97827f.webp",P=n.p+"images/error_exclamation_v3_dark_4e4519b8.webp";(0,_.a)(O,{disableWarnings:!0}),(0,h.a)(w,{disableWarnings:!0}),(0,b.a)(E,{disableWarnings:!0}),(0,g.a)(A,{disableWarnings:!0}),(0,v.b)(L,{disableWarnings:!0}),(0,y.b)(k,{disableWarnings:!0}),(0,S.a)({disableWarnings:!0}),(0,D.a)({disableWarnings:!0}),(0,I.a)({disableWarnings:!0}),(0,x.a)({disableWarnings:!0}),(0,l.bV)({icons:{errorExclamation:p.createElement("img",{src:M,alt:""}),errorExclamationDark:p.createElement("img",{src:P,alt:""})}});var T=window.require.toUrl("odsp-media/fluenthybridfont/"),U=(n.e(19).then(n.bind(n,627)).then(function(e){(0,e.initializeIcons)(T,{disableWarnings:!0},!0)}).catch(function(e){console.error("Icons error",e)}),n(603)),F=(n("react-dom-lib"),n(437)),H=n("odsp.util_118"),R=n(5),N=n(49),B=n(370),j=n(139),V=n(85),z=n(605),G=n(122),K=n(89),W=n(606),q=n(352),Q=n(25),Y=n(607),J={crossDomainImageHelper:(0,H.c7)("".concat("ThumbnailHelper",".crossDomainImageHelper"),Y.a,{apiUrlHelper:q.a}),itemUrlHelper:Q.c},X=new H.hK({name:"ThumbnailHelper",factory:{dependencies:J,create:function(e){var t=new Y.b(e);return{instance:t,disposable:t}}}}),Z=n(338),$=n(86),ee=(0,H.c7)("MetaDataProcessor",Z.a,{pageContext:R.a,platformDetection:$.a}),te=n(608),ne=n(70),ae=n(196),ie=new H.hK({name:"updateThumbnailUrlCallback",factory:{dependencies:{},create:function(e){return{instance:function(e,t){e.itemsWaitingForCookies.map(function(n){var i=n.itemKey,r=(0,V.c)().consume(ne.b),o=null==r?void 0:r.getOneUpProperties();if(o&&i===o.focusItem.key){var s=t.authTokenV21,c=t.proofTokenV21,d=n.thumbnailUrl+"&access_token=".concat(s,"&prooftoken=").concat(c),l=e.thumbnailHelper.getThumbnail({baseUrl:d,itemKey:i,fileExtension:n.fileExtension,mediaServiceMetadata:n.mediaServiceMetadata});if(l){var u=(0,a.W_)({},o.focusItem);u.thumbnail=ae.replace(l),r.update({focusItem:u},"AuthCookieHelperUpdateThumbnail")}}})}}}}}),re=(0,H.c7)("AuthCookieHelper",te.a,{thumbnailHelper:X,platformDetection:$.a,updateThumbnailUrlCallback:ie}),oe=n(609),se=(0,H.c7)("AuthTokenStore",oe.a,{}),ce=new H.bx(W.a,{pageContext:R.a,thumbnailHelper:X,metaDataProcessor:ee,authCookieHelper:re,authTokenStore:se}),de=new H.hK({name:"MicroServiceDataSource",factory:ce}),le=n(182),ue=new H.hK({name:"ItemCommentsDataSource.key",loader:new H.vh(function(){return n.e(30).then(n.bind(n,688)).then(function(e){return e.resourceKey})})});(0,l.Bv)([{rawString:"div[class*=OneUpModalSizing]>div.ms-Dialog-main{height:100vh!important;height:100dvh!important;width:100vw!important;max-width:unset!important;max-height:unset!important;min-height:unset!important;border-radius:0!important}div[class*=OneUpSafariMobile]>div.ms-Dialog-main{height:100%!important}"}]);var fe,pe=n(462),me=n(461),_e=n(68),he=n(4),be=n(88),ge=n(140),ve=n(431),ye=n(138),Se=n(224),De=n(121),Ie=n(225),xe=(0,Ie.a)(),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.XJ)(t,e),t}(De.a.withManager(xe)),Oe=n(433);function we(e){if(e){var t=new URL(e);return{urlOrigin:t.origin,urlPath:t.pathname}}}!function(e){e.next="next",e.previous="previous",e.close="close"}(fe||(fe={}));var Ee={getValidViewerTypes:ve.b,isFastOneUp:ye.c.optional,pageContext:R.a,itemUrlHelper:Q.c},Ae=new H.hK({name:"OneUpLoadingCustomerPromiseFunctionsKey",factory:{dependencies:Ee,create:function(e){var t,n,i=void 0,r=e.pageContext,o=(null===(t=(0,Se.b)(r))||void 0===t?void 0:t.toLowerCase())||"unknown",s="View";return{instance:{newLoadingCustomerPromise:function(t,r){void 0===i&&(n=t,i=new Ce({scenario:"OneUpLightSpeed.load",perfGoalInMs:ge.c,pillar:s,extraData:(0,a.W_)({oneUpRenderingMode:e.isFastOneUp?ge.e.fastOneUp:ge.e.inlineOneUpFirstPage,viewerName:e.getValidViewerTypes.getValidViewerTypes(t),fileExtension:t.extension,fileSize:t.size,fileSizeRange:(0,ge.g)(t.size),Ring:o,isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList},r)}))},reportLoadingCXPSuccess:function(t){var r,c,d;null==i||i.end({resultType:he.b.Success,extraData:(0,a.W_)((0,a.W_)({},t.extraData),{navigationOption:null===(r=t.navExtraData)||void 0===r?void 0:r.navigationOption,isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList})}),i=void 0,t.navExtraData&&t.navExtraData.newItem&&(t.navExtraData.navigationOption===fe.previous||t.navExtraData.navigationOption===fe.next)&&(n=t.navExtraData.newItem,i=new Ce({scenario:"OneUpLightSpeed.load",perfGoalInMs:ge.c,pillar:s,extraData:{oneUpRenderingMode:ge.e.inlineOneUpSlide,viewerName:e.getValidViewerTypes.getValidViewerTypes(t.navExtraData.newItem),fileExtension:t.navExtraData.newItem.extension,fileSize:t.navExtraData.newItem.size,fileSizeRange:(0,ge.g)(t.navExtraData.newItem.size),Ring:o,isNavigating:!0,navigationOptions:t.navExtraData.navigationOption,navNewItemUniqueId:null===(d=null===(c=t.navExtraData.newItem)||void 0===c?void 0:c.properties)||void 0===d?void 0:d.uniqueId,isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList}}))},reportLoadingCXPFailure:function(t){var o,s,c,d,l,u,f=t.rawError,p=f.errorType,m=f.error,_=f.item,h=f.meTAQos;m instanceof H.EI?(d=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}((c=(0,be.a)(m)).resultCode||"Unknown"),l=c.resultType,u=m.correlationId):m instanceof H.EI?(d=m.code||m.message,l=m.isExpected?he.b.ExpectedFailure:he.b.Failure,u=m.correlationId):(d=m.message,l=he.b.Failure);var b="spdf"===(null===(o=r.cloudType)||void 0===o?void 0:o.toLowerCase()),g=(0,a.W_)((0,a.W_)((0,a.W_)({viewerName:_&&e.getValidViewerTypes.getValidViewerTypes(_)||ve.a.Unknown,extension:_&&_.extension||"Unknown",errorType:p,rawError:m,url:b?window.location.href:void 0},null==c?void 0:c.extraData),{CorrelationId:u||(null==r?void 0:r.CorrelationId),isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList}),we(null===(s=t.rawError.extraData)||void 0===s?void 0:s.url));null==i||i.end({resultType:l,errorCode:d,extraData:g}),i=void 0,h&&(0,Oe.b)(h,{resultType:l,resultCode:d,extraData:(0,a.W_)({},g)})}}}}}}),Le=n(343),ke=n(26),Me=n(101),Pe=n(232);(0,l.Bv)([{rawString:".OneUpHtml_e04bdda1{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIOS_e04bdda1{overflow:auto;position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIFrame_e04bdda1{width:100%;height:100%;background-color:#fff;border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}.OneUpHtmlNewDesign_e04bdda1{position:absolute;top:0;width:75%;bottom:0;left:0;right:0;margin:auto;text-align:center;-webkit-overflow-scrolling:touch}"}]);var Te=n(229),Ue=n(396),Fe=n(514),He=n(53);function Re(e,t){if(e)try{return e.getResponseHeader(t)||void 0}catch(e){}}function Ne(e){var t=e.item;if(!t)return p.createElement(p.Fragment,null);var n=(0,V.c)(),a=n.consume(He.e),i=n.consume($.a).isIOS,r=n.consume(Ue.downloadDataSourceKey),o=p.useState(!1),s=o[0],c=o[1],d=p.useState(),l=d[0],u=d[1],f=p.useState(),m=f[0],_=f[1],h=p.useState(!1),b=h[0],g=h[1],v=p.createRef();p.useEffect(function(){return function(){m&&window.URL.revokeObjectURL(m)}},[]),p.useEffect(function(){if(i&&v&&v.current){var e=v.current,t=e.clientWidth,n=e.clientHeight;v.current.style.width="".concat(t,"px"),v.current.style.height="".concat(n,"px")}},[v]),p.useEffect(function(){s||function(e){var a=e.extension,i=e.htmlConversion,o=a&&a.toLowerCase();if(i&&".htm"!==o&&".html"!==o&&".svg"!==o){var s=n.consume(Pe.a),c=i.url||s.getAuthenticationParams(t).then(function(e){return"".concat(s.getItemUrl(t,{useDirectEndpoint:!0}),"/content?format=html&").concat((0,ke.a)(e))});return Promise.resolve(c).then(function(e){return Me.a.startAndPostProcess({url:e},function(e,t){return e.responseText})})}return r.getItemContents(t).then(function(e){return Fe.c(e,"text/html")}).then(function(e){return e.text})}(t).then(function(n){if(n){if((0,Te.a)())u(n);else{var i=new Blob([n],{type:"text/html"}),r=window.URL.createObjectURL(i);_(r)}c(!0)}else{var o=(0,ge.i)("empty html file content","HTMLEmptyContentError");a.updateErrorState("oneupHtmlViewer",{errorType:ge.d.viewerInitLoadingError,error:o,item:t}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error("HTMLEmptyContentError"),"HTMLViewer")}},function(n){var i=ge.d.genericViewerLoadingError;if(n instanceof XMLHttpRequest){var r=function(e,t){var n=e&&e.status,a=e&&t&&-1!==t.indexOf(n),i=Re(e,"x-errorcode")||Re(e,"x-clienterrorcode");return new H.EI({isExpected:a,code:i||n.toString(),message:JSON.stringify(e.response)})}(n,[406]);i="HTMLErrorProcessingContent",a.updateErrorState("oneupHtmlViewer",{errorType:ge.d.viewerInitLoadingError,error:r,item:t})}else i="HTMLErrorRetrievingContent",a.updateErrorState("oneupHtmlViewer",{errorType:ge.d.viewerInitLoadingError,error:n,item:t});e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error(i),"HTMLViewer")})},[s,t]);var y=(0,_e.a)(function(){b||(e.onViewerLoaded&&e.onViewerLoaded(),g(!0))}),S=(0,_e.a)(function(n){if(0===e.offset){var i=(0,ge.i)("".concat(n.type," - Error loading HTML viewer"),"".concat(n.type," - HTMLIframeLoadError"));a.updateErrorState("oneupHtmlViewer",{errorType:ge.d.viewerInitLoadingError,error:i,item:t}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error("HTMLIframeLoadError"),"HTMLViewer")}});return s&&t?p.createElement("div",{className:i?"OneUpHtmlIOS_e04bdda1":"OneUpHtmlNewDesign_e04bdda1"},p.createElement("iframe",{ref:v,className:"OneUpHtmlIFrame_e04bdda1",sandbox:"",title:t.name,frameBorder:"0",src:m,srcDoc:l,onLoad:y,onError:S})):p.createElement(p.Fragment,null)}var Be=n(41),je=n(35),Ve=n(93),ze=H.HW.isActivated("033a2ec3-915d-4a0b-94d7-01220514a62b","05/13/2024","Use the blob approach for creating PDF web worker in non-embed scenarios"),Ge=H.HW.isActivated("441dc3a7-bbe8-456c-91fd-59e0e22bb611","08/26/2024","Add subpath for mpc in swproxy url to make it be processed in the farm where the user mysite is"),Ke=function(){function e(e,t){this._urlCache={};var n=t.window,a=void 0===n?window:n,i=t.urlDataSource,r=t.navigation;this._window=a,this._webAbsoluteUrl=t.pageContext.webAbsoluteUrl;var o=i.getPageType(r.viewParams);this._isEmbed=o===Ve.a.Embed}return e.prototype.getWorkerUrl=function(e,t){var n=this._window,a="".concat(n.location.protocol,"//").concat(n.location.host),i=new je.a(e);if(t||i.authority!==a){var r=new je.a(this._webAbsoluteUrl);if(a===r.authority&&(ze||this._isEmbed)){if(t){var o=Ge||"https://my.microsoftpersonalcontent.com"!==a?"":r.path;return"".concat(a).concat(o,"/_layouts/15/odspserviceworkerproxy.aspx?swManifestName=").concat(encodeURIComponent(t),"&debug=false&bypass=false")}return"".concat(a,"/_layouts/15/serviceworkerproxy.aspx?serviceWorkerUrl=").concat(encodeURIComponent(e))}var s=this._urlCache;if(s[e])return s[e];var c=n.URL.createObjectURL(new Blob(["importScripts(".concat(JSON.stringify(e),");")],{type:"text/javascript"}));return s[e]=c,c}return e},e.prototype.dispose=function(){var e=this._urlCache;for(var t in e)e.hasOwnProperty(t)&&this._window.URL.revokeObjectURL(e[t])},e}(),We=(0,H.c7)("WorkerDataSource",Ke,{pageContext:R.a,urlDataSource:K.a,navigation:N.a}),qe=n(165),Qe=n(125),Ye=n(166),Je=n(81),Xe=n(524),Ze=n(145),$e=n(54),et=n(523),tt=n(52),nt=n(141),at="OpenPdfInBrowserAction",it={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.Ci,platform:$.a,oneUpStateStore:He.e},rt=new H.hK({name:"OpenPdfInBrowserAction",factory:{dependencies:it,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e){var t;return!!e&&function(e){return!!(e&&e.extension&&e.openUrl&&e.itemStatus!==nt.b.ConditionalAccessViewOnly&&e.itemStatus!==nt.b.ConditionalAccessBlocked&&tt.a.hasItemPermission(e,tt.a.openItems))}(e)&&".pdf"===(null===(t=e.extension)||void 0===t?void 0:t.toLowerCase())}(e.item);return{isAvailable:n,id:at,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i,r;return(0,a.qr)(this,function(a){if(n=e.item,i=n.openUrl)return t.navigation.navigateTo({url:i,frameId:"_blank"}),[2,{resultType:he.b.Success}];throw r=(0,ge.i)("no url"),t.oneUpStateStore.updateErrorState(at,{errorType:ge.d.actionError,error:r,item:n}),r})})}}})}};var t}}}),ot=n(115),st=n(98),ct=n(44),dt=n(136),lt=n(133),ut=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(23).then(n.bind(n,647))];case 1:return[2,e.sent().MalwareDetectedDialog]}})})}),ft={oneUpStateStore:He.e},pt=new H.hK({name:"ShowMalwareDetectedAction",factory:{dependencies:ft,create:function(e){return{instance:function(t){try{var n=p.createElement(ut,(0,a.W_)({},t));e.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!0,content:n})}catch(t){throw e.oneUpStateStore.updateErrorState("showMalwareDetectedDialog",{errorType:ge.d.actionError,error:t,item:void 0}),t}}}}}}),mt=n(234),_t="DownloadAction",ht={pageContext:R.a,oneUpStore:ne.b,downloadDataSource:Ue.downloadDataSourceKey,resources:H.Ci,graphDataSource:Pe.a,oneUpStateStore:He.e,showMalwareDetectedDialog:pt,navigation:N.a,itemUrlHelper:Q.c},bt=new H.hK({name:"DownloadAction",factory:{dependencies:ht,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n={isAvailable:gt({item:e.item,appLevelPagecontext:t.pageContext,itemUrlHelper:t.itemUrlHelper,remoteWebPageContexts:t.oneUpStore.pageContexts}),id:_t,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I;return(0,a.qr)(this,function(x){switch(x.label){case 0:return e=t.oneUpStore.getOneUpProperties(),n=null==e?void 0:e.focusItem,!0!==(null===(S=null==n?void 0:n.lifeCycleStatus)||void 0===S?void 0:S.isMalwareDetected)?[3,1]:(i={item:n,allowInfectedFileDownload:!!(null===(D=t.pageContext)||void 0===D?void 0:D.allowInfectedDownload),onDismiss:function(){t.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!1,content:void 0})},onDownload:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e;return(0,a.qr)(this,function(a){return e=t.downloadDataSource.getItemClassicDownloadLink(n),t.navigation.navigateTo({url:e,frameId:"_blank"}),[2]})})}},t.showMalwareDetectedDialog(i),[3,8]);case 1:return n&&n.type===st.a.Folder&&n.urls?(r=n.urls[dt.a.itemUrl],mt.a?[3,3]:[4,t.graphDataSource.getAccessToken(n)]):[3,5];case 2:return s=x.sent(),[3,4];case 3:s=t.graphDataSource.getAccessToken(n),x.label=4;case 4:return o=s,c=[{name:n.name,size:n.size,docId:"".concat(r).concat(-1!==r.indexOf("?")?"&":"?","access_token=").concat(o.accessToken),isFolder:!0}],d="",c&&1===c.length&&(d=c[0].name+".zip"),l=n.urls[dt.a.downloadAsZip],u=function(){var e=document.createElement("iframe");return e.id="zip-download-iframe",e.name=e.id,e.hidden=!0,e}(),document.body.appendChild(u),(f=document.createElement("form")).target=u.id,f.method="POST",f.action=l,f.style.display="none",(p=document.createElement("input")).type="hidden",p.name="files",p.value=JSON.stringify({items:c}),f.appendChild(p),(m=document.createElement("input")).type="hidden",m.name="guid",m.value=ct.a.generate(),f.appendChild(m),(_=document.createElement("input")).type="hidden",_.name="accessToken",_.value=o.accessToken,f.appendChild(_),(h=document.createElement("input")).type="hidden",h.name="zipFileName",h.value=d,f.appendChild(h),(b=document.createElement("input")).type="hidden",b.name="provider",b.value="spo",f.appendChild(b),(g=document.createElement("input")).type="submit",f.appendChild(g),null===(I=u.contentWindow)||void 0===I||I.document.body.appendChild(f),f.submit(),[3,8];case 5:return n&&n.type!==st.a.Folder?(v={items:[n]},[4,t.downloadDataSource.downloadItems(v).then(function(){return{resultType:he.b.Success}}).catch(function(e){throw t.oneUpStateStore.updateErrorState("download action",{errorType:ge.d.actionError,error:e,item:n}),e})]):[3,7];case 6:return x.sent(),[3,8];case 7:throw y=(0,ge.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(_t,{errorType:ge.d.actionError,error:y,item:n}),y;case 8:return[2,{resultType:he.b.Success}]}})})}};return n})}};var t}}});function gt(e){var t=e.item,n=e.appLevelPagecontext,a=e.itemUrlHelper,i=e.remoteWebPageContexts;if(!t||!t.key||!t.urls)return!1;if(t.itemStatus===nt.b.ConditionalAccessBlocked||t.itemStatus===nt.b.ConditionalAccessViewOnly)return!1;if(t.type===st.a.OneNote)return!1;if(!tt.a.hasItemPermission(t,tt.a.openItems))return!1;var r=n,o=a.getItemUrlParts(t.key);if(o.fullWebUrl&&o.serverRelativeListUrl){var s={webAbsoluteUrl:o.fullWebUrl,listUrl:o.serverRelativeListUrl};i&&i.get(s)&&(r=i.get(s))}return!(r&&(r.blockDownloadFileTypePolicyEnabled||r.blockDownloadsExperienceEnabled||r.viewOnlyExperienceEnabled)||(!t.urls[dt.a.downloadAsZip]||!t.urls[dt.a.itemUrl]||0===t.childCount||t.type!==st.a.Folder)&&(t.isRootFolder||t.type!==st.a.File&&t.type!==st.a.Media&&t.type!==st.a.Unknown))}var vt={downloadActionProvider:bt},yt="downloadCommand",St=new H.hK({name:"DownloadCommand",factory:{dependencies:vt,create:function(e){var t=e.downloadActionProvider;return{instance:{id:yt,name:ot.r,title:ot.s,automationId:yt,iconProps:{iconName:"Download"},evaluateAction:t.evaluateAction}}}}}),Dt=n(137),It=n(518),xt=n(90),Ct=n(28),Ot="universalannotations",wt="$batch",Et="multipart/mixed;boundary=",At="application/json",Lt=function(){function e(e,t){this._token=null,this._layerPath="";var n=t.vroomDataRequestor,a=t.pageContext;this._dataRequestor=n,this._pageContext=a}return e.prototype.update=function(e,t,n){this._getSharePointToken=e,this._basePath="/drives/".concat(n,"/items/").concat(t),this._layerPath="".concat(this._basePath,"/").concat("annotationlayers")},e.prototype.createLayer=function(e){var t=e.title,n=e.mainFileVersion,a=void 0===n?"1.0":n,i=e.layerId,r=this._layerPath;return this._sendRequest({path:r,requestType:"POST",data:{title:t,mainFileVersion:a,id:i}})},e.prototype.deleteLayer=function(e){var t=e.layerId,n="".concat(this._layerPath,"/").concat(t);return this._sendRequest({path:n,requestType:"DELETE"})},e.prototype.getLayers=function(){var e=this._layerPath;return this._sendRequest({path:e,requestType:"GET"})},e.prototype.createAnnotation=function(e){var t=e.annotationId,n=e.layerId,a=e.content,i=e.partitionId,r=e.anchor,o=e.contentType,s=this._getAnnotationUrl(n);return this._sendRequest({path:s,requestType:"POST",data:{id:t,content:a,partitionId:i,anchor:r,contentType:o}})},e.prototype.getAnnotations=function(e){var t=e.layerId,n=e.partitionId,a=this._getAnnotationUrl(t);return n&&(a+="?partitionId=".concat(n)),this._sendRequest({path:a,requestType:"GET"})},e.prototype.deleteAnnotation=function(e){var t=e.layerId,n=e.partitionId,a=e.annotationId,i="".concat(this._getAnnotationUrl(t),"/").concat(a,"?partitionId=").concat(n);return this._sendRequest({path:i,requestType:"DELETE"})},e.prototype.batchCreateAnnotations=function(e){var t=e.payload;return(0,a.Zd)(this,void 0,void 0,function(){var e,n,i=this;return(0,a.qr)(this,function(r){return e="batch_"+ct.a.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.layerId,r=e.annotationId,o=(0,a.l7)(e,["id","layerId","annotationId"]);return{path:"".concat(i._basePath,"/AnnotationLayers('").concat(n,"')/").concat(Ot),requestType:"POST",id:t,data:(0,a.W_)({id:r},o)}})),[2,this._sendRequest({path:"/".concat(wt),requestType:"POST",headers:{"Content-Type":Et+e},data:n})]})})},e.prototype.batchDeleteAnnotations=function(e){var t=e.payload;return(0,a.Zd)(this,void 0,void 0,function(){var e,n,i=this;return(0,a.qr)(this,function(a){return e="batch_"+ct.a.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.annotationId,a=e.layerId,r=e.partitionId;return{path:"".concat(i._getAnnotationUrl(a),"/").concat(n,"?partitionId=").concat(r),requestType:"DELETE",id:t}})),[2,this._sendRequest({path:"/".concat(wt),requestType:"POST",headers:{"Content-Type":Et+e},data:n})]})})},Object.defineProperty(e.prototype,"hasLicense",{get:function(){return(0,Ct.Z)(Ct.J)?Boolean(this._pageContext.canUserUseSyntex)||Boolean(this._pageContext.isUserSyntexV2Licensed):Boolean(this._pageContext.canUserUseSyntex)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUniversalAnnotationDisabled",{get:function(){var e;return null!==(e=this._pageContext.isUniversalAnnotationDisabled)&&void 0!==e&&e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_server",{get:function(){return(0,Dt.b)(this._pageContext)},enumerable:!1,configurable:!0}),e.prototype._needRefreshToken=function(){return!this._token||!this._token.tokenExpiry||Date.now()>=this._token.tokenExpiry},e.prototype._getToken=function(){return(0,a.Zd)(this,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return this._needRefreshToken()&&this._getSharePointToken?[4,this._getSharePointToken(this._server)]:[3,2];case 1:e=t.sent(),this._token=e,t.label=2;case 2:return[2,this._token||void 0]}})})},e.prototype._getAnnotationUrl=function(e){return"".concat(this._layerPath,"/").concat(e,"/").concat(Ot)},e.prototype._createBatchBody=function(e,t){var n,a="\r\n",i="changeset_".concat(ct.a.generate()),r=(0,It.b)(e,"".concat(Et,'"').concat(i,'"'),"binary")+t.map(function(e){return n="--"+i+a,n+="Content-Type: application/http\r\n",n+="Content-Transfer-Encoding: binary\r\n",n+="Content-ID: "+(t=e).id+a,n+=a,n+=(0,It.a)(At,"".concat(At,";odata=verbose"),t.requestType,t.path),n+=a,t.data&&(n+=JSON.stringify(t.data)+a,n+=a),n;var t,n}).join("")+(n="--"+i+"--"+a,n+=a,n+="--"+e+"--"+a);return new Blob([r])},e.prototype._sendRequest=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t,n,i,r,o,s;return(0,a.qr)(this,function(c){switch(c.label){case 0:return[4,this._getToken()];case 1:return t=c.sent(),n=e.data,i=e.path,r=e.requestType,o=e.headers,s=n?n instanceof Blob?n:JSON.stringify(n):void 0,[2,this._dataRequestor.send({path:i,endpoint:"".concat(this._server,"/_api/v2.1"),headers:(0,a.W_)({Scenario:"Syntex_UniversalAnnotaion"},o),requestType:r,accessToken:t,apiName:"UniversalAnnotationAPI",apiVersion:"v2.1",postData:s,expectedErrorCodes:{resourceModified:!0}})]}})})},e.dependencies={vroomDataRequestor:xt.a,pageContext:R.a},e}(),kt=(0,H.c7)("UniversalAnnotationDataSource",Lt),Mt=n(221),Pt=n(222),Tt=n(428),Ut=n(194),Ft=n(34),Ht=n(67),Rt="OneUpViewer";function Nt(e){return void 0===e&&(e="unknownViwer"),(0,j.e)("oneUp-".concat(e,".start"))}function Bt(e){return"number"==typeof e&&isNaN(e)?void 0:{data:e,needFlatten:!0}}var jt=function(){function e(e,t){var n=this;this.resetRumOneApiMeasurement=function(){n._rumone.undoAPIInstrument()},this._computeRenderTime=function(e){if(e){var t=e.startTime,n=e.endTime;if(!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t)return n-t}return 0},this._checkRenderTimeRequiredDataAvailable=function(e){if(e){var t=e.startTime,n=e.endTime;return!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t}return!1};var a=t.pageContext,i=e.loggerName,r=void 0===i?"oneup":i;this._pageContext=a,this._initialized=!1;var o=(0,Ie.a)();this._rumone=Mt.a.getRUMOneLogger({name:r,onLog:function(e,t){Ut.a.withManager(o).logData({streamName:e,dictionary:t})}}),window.getRumOneForTAB=function(){return n._rumone}}return e.prototype.initRumoneLogger=function(){if(!this._initialized){this._initialized=!0;var e=this._pageContext&&this._pageContext.ariaCollectorUrl?new je.a(this._pageContext.ariaCollectorUrl).domain:"/Collector/3.0/";this._rumone.startAPIMeasurement({ignore:function(t){return t.indexOf(e)>=0},getAPIName:function(e){return e.toLowerCase().indexOf("/RenderListDataAsStream")?"RenderListDataAsStream":""}})}},e.prototype.logRumonePerformance=function(e,t){var n=this,i=e.viewerName,r=e.clientId,o=e.extension,s=e.fileSizeRange,c=e.embedStartLoadingTime,d=void 0===c?NaN:c,l=e.viewerStartTime,u=void 0===l?NaN:l,f=e.userClickTime,p=void 0===f?NaN:f,m=e.endTime,_=e.pageTransType,h=e.breakDownData,b=e.oneupScenario,g=e.isLightSpeed,v=e.isFullPageLogging,y=e.isServerSideTransfer,S=e.isFluentV9,D=e.isPdfNoTempAuth,I=e.isPdfUseToken;d=this._regulateTime(d),p=this._regulateTime(p),m=this._regulateTime(m),u=this._regulateTime(u);var x=this._regulateTime(performance.timing.navigationStart),C=this._regulateTime(this._getResponseEnd()),O=this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")),w=p;isNaN(w)&&(w=d),isNaN(w)&&(w=x);var E=new Ft.b;if(this._rumone&&this._rumone.isRunning()){var A=v?"FullPageLoad":"Load",L=g?0===b?"ODSPEmbedLightSpeed.".concat(A):"ODSPOneUpLightSpeed.".concat(A):0===b?"ODSPEmbed.".concat(A):"ODSPOneUp.".concat(A);this._rumone.writeScenarioId(L),this._rumone.addExpectedControl(Rt),this._rumone.writePageTransitionType(void 0!==_?_:Pt.a.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();var k=location.href.toLowerCase().indexOf("embed.aspx")>=0;k&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext);var M=new Ht.a("OneUpRumOneHelper");M.on(this._rumone,"measureTTI",function(){var a=n._rumone.getPerformanceData();t&&t({EUPL:a.EUPL,TTI:a.TTI}),E.complete({FCI:a.TTI,FMP:a.EUPL,startTiming:n._regulateAbsoluteTime(w),AbsoluteFCI:n._regulateAbsoluteTime(a.TTI+w),AbsoluteFMP:e.endTime}),M.dispose()}),this._rumone.setSettings({TTISettings:{enabled:!0},getStartTime:function(){return w}});var P=new Tt.a({controlId:Rt,startTime:w,endTime:m,renderTimeCalculator:this._computeRenderTime,renderTimeRequiredDataChecker:this._checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(P),h=(0,a.W_)((0,a.W_)({},h),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),isEmbedASPXHosted:Bt(k),w3cResponseEnd:Bt(C-x),appStart:Bt(O-C),render:Bt(m-O),viewerRenderTime:Bt(m-u),oneUpViewer:Bt(i),oneUpClientId:Bt(r),oneUpFileExtension:Bt(o),oneUpFileSizeRange:Bt(s),beforeOneUpLoading:Bt(x-p),beforeOneUpLoadingIframeCost:Bt(x-d),beforeOneUpLoadingHostCost:Bt(d-p),userClickTime:Bt(p),embedStartLoadingTime:Bt(d),isLightSpeed:Bt(!!g),isServerSideTransfer:Bt(!!y),isFluentV9:Bt(!!S),isPdfNoTempAuth:void 0!==D?Bt(D):void 0,isPdfUseToken:void 0!==I?Bt(I):void 0}),this._rumone.writeEUPLBreakdown(JSON.stringify(h))}return E.promise},e.prototype.resetRumOne=function(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)},e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()},e.prototype._regulateTime=function(e){return this._isDateTime(e)&&j.a?e-performance.timing.navigationStart:e},e.prototype._regulateAbsoluteTime=function(e){return!this._isDateTime(e)&&j.a?e+performance.timing.navigationStart:e},e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN},e}(),Vt=((0,H.c7)("OneUpRumoneHelper",jt,{pageContext:R.a.optional}),new H.hK({name:"OneUpRumoneHelper",factory:{dependencies:{pageContext:R.a.optional},create:function(e){var t=e.pageContext;return{instance:{getOneUpRumoneLogger:function(e){return new jt(e,{pageContext:t})}}}}}})),zt=n(228),Gt=n(522),Kt=new H.hK({name:"PdfSaveHelper.key",loader:new H.vh(function(){return n.e(46).then(n.bind(n,651)).then(function(e){return e.resourceKey})})});(0,l.Bv)([{rawString:".pdfWrapper_5bf134be{position:absolute;width:100%;height:100%}"}]);var Wt=n(39),qt=n(211),Qt=n(559),Yt=n(83),Jt=n(560),Xt={scale:1,rotation:0,currentScrollPosition:new Yt.a(0,0),originalLayoutSize:{width:0,height:0},originalPageRects:[]},Zt=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(14)]).then(n.bind(n,667))];case 1:return[2,e.sent().ESignWrapper]}})})},{useChildrenAsPlaceholder:!(0,Ct.ib)()}),$t=n(60),en=n(322),tn=n(323),nn=n(556),an=n(213),rn=n(43),on=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(44)]).then(n.bind(n,665))];case 1:return[2,e.sent().PdfFilePicker]}})})}),sn=m().forwardRef(function(e,t){var n=e.filePickerProps,i=e.telemetryHandler,r=(0,a.l7)(e,["filePickerProps","telemetryHandler"]),o=r.mode,s=r.filename,c=void 0===s?"PDF":s,d=m().useState(""),l=d[0],u=d[1],f=m().useRef(),p=m().useRef(),_=m().useRef([]),h=(0,nn.d)(t),b=(0,V.c)(),g=m().useCallback(function(e,t){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i;return(0,a.qr)(this,function(a){return n=b.consume(R.a),i=b.consume(an.a),[2,(0,en.c)(e,n,i,t)]})})},[b]),v=(0,nn.c)(g),y=m().useMemo(function(){return c.endsWith(".pdf")?c.slice(0,-4):c},[c]),S=o===Qe.a.Extract,D=m().useCallback(function(e,t){return(0,a.Zd)(void 0,void 0,void 0,function(){var i;return(0,a.qr)(this,function(a){return u("Extracted from ".concat(y)),null===(i=null==n?void 0:n.setMode)||void 0===i||i.call(n,"save"),f.current=e,p.current=t,[2]})})},[y,n]),I=m().useCallback(function(){var e;null===(e=null==n?void 0:n.setMode)||void 0===e||e.call(n,"close"),_.current=[]},[n]),x=m().useCallback(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var t;return(0,a.qr)(this,function(r){switch(r.label){case 0:return null===(t=null==n?void 0:n.setMode)||void 0===t||t.call(n,"close"),[4,h({successText:tn.c,runningText:tn.b,failedText:tn.a,telemetryHandler:i,scenarioName:$t.a.DocumentExtract,before:function(){var e;null===(e=p.current)||void 0===e||e.call(p)},runner:function(){return v(e,function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){return[2,null===(e=f.current)||void 0===e?void 0:e.call(f)]})})})}})];case 1:return r.sent(),[2]}})})},[n,v,h,i]),C=m().useCallback(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var r,o;return(0,a.qr)(this,function(s){switch(s.label){case 0:return Array.isArray(e)?(_.current=(0,a.AE)([],e,!0),u("Merged from ".concat(y)),null===(r=null==n?void 0:n.setMode)||void 0===r||r.call(n,"save"),[3,3]):[3,1];case 1:return null===(o=null==n?void 0:n.setMode)||void 0===o||o.call(n,"close"),[4,h({successText:tn.f,runningText:tn.e,failedText:tn.d,telemetryHandler:i,scenarioName:$t.a.DocumentMerge,runner:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){return[2,v(e,function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,i;return(0,a.qr)(this,function(r){switch(r.label){case 0:return[4,(0,en.b)((0,a.AE)([],_.current,!0).map(function(e){return e.webDavUrl}),{credentials:"same-origin"})];case 1:return e=r.sent(),n=e.map(function(e){return new Uint8Array(e,0,e.byteLength)}),[2,null===(i=t.current)||void 0===i?void 0:i.merge(n)]}})})})]})})},after:function(){_.current=[]}})];case 2:s.sent(),s.label=3;case 3:return[2]}})})},[y,n,v,t,h,i]),O=m().useCallback(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return S?[4,x(e)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,C(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},[S,x,C]),w=m().useMemo(function(){if(n){var e=b.consume(R.a),t=e.listId;t&&"{"===t[0]&&"}"===t[t.length-1]&&(t=t.substring(1,t.length-1));var i,r=n.item.parentKey;if(r){var o=new rn.a({},{pageContext:e}).getItemUrlParts(r);i={entry:{sharePoint:{byPath:{web:o.serverRelativeWebUrl,list:o.fullListUrl,folder:o.listRelativeItemUrl}}},telemetry:{sessionId:null==e?void 0:e.CorrelationId}}}return(0,a.W_)((0,a.W_)({},n),{item:{listId:t,siteUrl:e.siteAbsoluteUrl,listItemId:n.item.listItemId},pickerPageUrl:"".concat(e.webAbsoluteUrl,"/").concat(e.layoutsUrl,"/FilePicker.aspx"),defaultNewFileName:l,options:i,onClose:I,onConfirm:O})}},[n,b,l,I,O]),E=m().useMemo(function(){return m().createElement(Xe.a,(0,a.W_)({ref:t},r,{execExtract:D}))},[t,r,D]);return m().createElement(m().Fragment,null,E,w&&m().createElement(on,(0,a.W_)({},w)))}),cn=m().memo(sn),dn=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(58).then(n.bind(n,666))];case 1:return[2,e.sent().UniversalAnnotationWrapper]}})})},{useChildrenAsPlaceholder:!(0,Ct.ib)()}),ln=p.memo(function(e){var t,n,i,r,o,s,c=p.useState(!1),d=c[0],l=c[1],u=p.useState(!1),f=u[0],m=u[1],_=p.useRef(null),h=p.useRef(null),b=p.useRef(null),g=p.useRef(null),v=e.universalAnnotationProps,y=e.eSignProps,S=(0,a.l7)(e,["universalAnnotationProps","eSignProps"]),D=S.itemId,I=S.onDocumentLoaded,x=S.height,C=S.addOnsEnabled,O=S.filename,w=S.fileSize,E=S.pdfItemViewer,A=void 0===E?cn:E,L=(0,qt.a)(function(){return S},S),k=(null==y?void 0:y.isEsignSidePanelActive)||(null==y?void 0:y.isEsignRecipient),M=p.useCallback(function(e){var t=e.pageCount,n=e.mip,a=e.isMipDecrypted,i=e.isAnnotAllowed,r=e.isFormFieldAllowed,o=e.getDocPermissions;null==I||I({pageCount:t,mip:n,isMipDecrypted:a,isAnnotAllowed:i,isFormFieldAllowed:r,getDocPermissions:o}),m(!0)},[I]),P=p.useCallback(function(){l(!0)},[]),T=function(e,t,n){var a=p.useState(Qt.d),i=a[0],r=a[1],o=p.useState(!1),s=o[0],c=o[1],d=p.useCallback(function(){var e,t,a,i,o=null!==(t=null===(e=n.current)||void 0===e?void 0:e.getPdfMetadata())&&void 0!==t?t:Xt;r({scale:(a=o).scale,rotation:a.rotation/Qt.k%4,currentScrollPosition:{x:a.currentScrollPosition.x,y:a.currentScrollPosition.y},originalLayoutSize:{height:a.originalLayoutSize.height,width:a.originalLayoutSize.width},originalPageRects:(i=a.originalPageRects,i.map(function(e){return{top:e.origin.y,left:e.origin.x,height:e.height,width:e.width}}))})},[n,n.current]);return(0,Jt.a)(d),p.useEffect(function(){if(e&&t)return d(),void c(!0);e||c(!1)},[e,t]),{documentMetadataLoaded:s,documentMetadata:i}}(k||(null===(t=e.universalAnnotationProps)||void 0===t?void 0:t.isUniversalAnnotationActive),(0,Ct.ib)()?d&&f:f,_),U=T.documentMetadataLoaded,F=T.documentMetadata,H=(0,V.c)(),R=H.consume(Wt.resourceKey),N=p.useCallback(function(e,t){var n,a;(null==C?void 0:C.universalAnnotation)&&(null===(n=h.current)||void 0===n||n.updateScrollPosition(e,t)),(null==C?void 0:C.eSign)&&(null===(a=b.current)||void 0===a||a.updateScrollPosition(e,t))},[]),B=(0,_e.a)(function(e){var t,n;(null==C?void 0:C.universalAnnotation)&&(null===(t=h.current)||void 0===t||t.zoom(e)),(null==C?void 0:C.eSign)&&(null===(n=b.current)||void 0===n||n.zoom(e))}),j=(0,_e.a)(function(e){var t;(null==C?void 0:C.universalAnnotation)&&(null===(t=h.current)||void 0===t||t.updateCursorType(e))}),z=(0,_e.a)(function(){var e,t;(null==C?void 0:C.universalAnnotation)&&(null===(e=h.current)||void 0===e||e.rotateClockwise()),(null==C?void 0:C.eSign)&&(null===(t=b.current)||void 0===t||t.rotateClockwise())}),G=p.useMemo(function(){return p.createElement("div",{ref:g,className:"pdfWrapper_5bf134be"},p.createElement(A,(0,a.W_)({},L,{height:(null==y?void 0:y.isEsignRecipient)?void 0:L.height,ref:_,onDocumentLoaded:M,onRenderViewport:(0,Ct.ib)()?P:void 0,enableToolbar:!((null==C?void 0:C.eSign)&&k),shouldPlaceToolbarOnTop:!0,onScrollPositionUpdated:N,onRotationChanged:z,onScaleChanged:B,onCursorUpdate:j})))},[A,L,null==y?void 0:y.isEsignRecipient,M,P,null==C?void 0:C.eSign,k,N,z,B,j]);if((null==C?void 0:C.universalAnnotation)&&v){var K=v.driveId,W=v.progressRegister,q=v.onPreloadFailure,Q=v.onPreloadSuccess,Y=v.isUniversalAnnotationActive,J=H.consume(kt);o=p.createElement(dn,{pdfItemViewerRef:_,pdfAppRef:g,universalAnnotationRef:h,isUniversalAnnotationActive:Y,progressRegister:W,dataSource:J,driveId:K,itemId:D,onPreloadFailure:q,onPreloadSuccess:Q,viewerHeight:x,documentMetadataLoaded:U,documentMetadata:F},G)}if(null==C?void 0:C.eSign){var X=y||{},Z=X.uniqueId,$=X.isEsignSidePanelActive,ee=void 0!==$&&$,te=X.setIsEsignSidePanelActive,ne=X.parentItemPermission,ae=X.parentItemUri,ie=X.isEsignRecipient,re=X.documentUrl,oe=X.canSendToExternalRecipients,se=X.hasParentItemPermissionsLoaded,ce=!!(Z&&O&&re&&w&&te&&(null===(n=_.current)||void 0===n?void 0:n.getEventHandlers)),de=_.current||{},le=de.rotate,ue=de.scrollTo,fe=de.getEventHandlers,pe=de.hasSignature;((0,Ct.X)()||ce)&&(s=p.createElement(Zt,{item:{itemId:Z||"",name:O||"",size:w||0,openUrl:re||"",parent:{permissions:ne,openUrl:ae||"",hasLoaded:se}},esignWrapperRef:b,showCreatePanel:ee,isRecipient:ie,documentMetadataLoaded:U,documentMetadata:F,onCancelClick:function(){return null==te?void 0:te(!1)},getSessionToken:R.getOAuthSessionToken.bind(R),documentRotate:le,documentScrollTo:ue,height:null!==(r=null!=x?x:null===(i=g.current)||void 0===i?void 0:i.clientHeight)&&void 0!==r?r:0,getEventHandlers:fe,hasSignature:pe,isNewDesign:null==y?void 0:y.isNewOneup,canSendToExternalRecipients:oe},o||G))}return s||o||G}),un=n(91),fn=n(61),pn=n(519),mn=n(51),_n=n(38),hn={"PDF Save Failed":["GetPdfStreamFailed","UploadFileDataFailed"],"PDF Load Failed: Init":["GetDocument","GetDownloadUrl","GetWasmAsset","WasmCacheFailed","WasmModuleInitFailed","WasmModuleNotFound"],"PDF Load Failed: Previewer":["PreviewerFailToFetchFile","PreviewerFailToLoadPage","PreviewerFailToLoadTask","PreviewerUnmounted"],"PDF Load Failed: WasmRuntime":["RuntimeError","WasmRuntimeError"],"PDF Load Failed: Others":["AnnotationAddFailed","EventHandleFailed","FileDownloadFailed","FontLoadFailed","InvalidPDF","PrintFailed","RangeDownloadSizeMismatch","RangeError","ShowThumbnailFailed","TypeError","PDFWorkerMismatch","ViewContextNotInitialized"]},bn=function(e){switch(e){case"PDF.Edit":return"Edit";case"PDF.Load":return"View";default:return"None"}},gn=function(e){var t=function(){var t=e||"None";return t.endsWith("GetDocument")?"GetDocument":t.endsWith("GetDownloadUrl")?"GetDownloadUrl":t.endsWith("GetWasmAsset")?"GetWasmAsset":t}();return Object.keys(hn).find(function(e){var n;return-1!==(null===(n=hn[e])||void 0===n?void 0:n.indexOf(t))})||"None"},vn=function(){function e(e,t){var n=this;this._qosEventMap={},this.logQosStart=function(e){var t=e.payload.name,a=function(e){switch(e){case $t.a.DocumentSave:return"PDF.Edit";case $t.a.DocumentLoad:return"PDF.Load";default:return}}(t),i={scenario:a||"PDF."+t,pillar:bn(a),perfGoalInMs:18e5,extraData:{viewerName:"MSPdf"}};n._qosEventMap[t]=new Ce(i)},this.logQosEnd=function(e){var t,i=e.payload,r=i.name,o=i.status,s=i.extraData,c=n._qosEventMap[r];if(c){var d;if(o===$t.b.Succeed)d={resultType:De.c.Success,extraData:s};else{yn(e.payload,!!(null===(t=n._offlineDetection)||void 0===t?void 0:t.offline));var l=e.payload,u=l.code,f=l.error;d={resultType:l.isExpected?De.c.ExpectedFailure:De.c.Failure,errorCode:u,veto:gn(u),extraData:(0,a.W_)((0,a.W_)({},e.payload.extraData),{error:f})}}c.end(d),n._qosEventMap[r]=void 0}},this.logError=function(e){var t=e.payload,n=t.error,a=t.extraData,i={};for(var r in a)if(a.hasOwnProperty(r)){var o=a[r];i[r]=JSON.stringify(o)}mn.a.logError(n,i)},this.logEngagement=function(e){var t=e.payload,n=t.name,i=t.extraData,r=t.actionScenario,o={location:"MsPdfViewer",usageType:pn.a[pn.a.Click],isIntentional:!0};_n.a.logData((0,a.W_)((0,a.W_)({},o),{name:n,extraData:(0,a.W_)((0,a.W_)({},i),{actionScenario:r})}))},this._offlineDetection=t.offlineDetection}return e.dependencies={},e}();function yn(e,t){var n,i;if(e.error.name===fn.d.NetworkError){var r=e.extraData,o=null==r?void 0:r.status;e.isExpected=!!o&&(406===o||412===o)||t,e.extraData=(0,a.W_)((0,a.W_)({},r),{correlationId:(null===(n=null==r?void 0:r.responseHeaders)||void 0===n?void 0:n.get("SPRequestGuid"))||void 0,requestId:(null===(i=null==r?void 0:r.responseHeaders)||void 0===i?void 0:i.get("request-id"))||void 0})}}var Sn=(0,H.c7)("PdfTelemetryHandler",vn,{offlineDetection:un.a.optional});(0,l.Bv)([{rawString:".root_c10f3fe1{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}"}]);const Dn="root_c10f3fe1";var In=n(512);function xn(e){return e.ok||(t=e.status)>=400&&t<500;var t}function Cn(e){var t,n=this,i=e.item,r=e.onViewerLoaded,o=e.isMainViewer,s=e.offset,c=p.useState((null===(t=null==i?void 0:i.thumbnail)||void 0===t?void 0:t.url)||""),d=c[0],l=c[1],u=p.useState(!0),f=u[0],m=u[1],_=(0,V.c)(),h=_.consume(He.e),b=!!_.consume(ye.c.optional),g=p.useRef(),v=p.useRef();p.useEffect(function(){o||g.current||(g.current=new Ce({scenario:"OneUpLightSpeed.thumbnailViewer",perfGoalInMs:ge.c,extraData:{oneUpRenderingMode:b?ge.e.fastOneUp:ge.e.inlineOneUpFirstPage}}))},[o,g,b]);var y=(0,_e.a)(function(t){var n,r=(0,be.a)(t),s=r.resultType,c=r.resultCode,d=r.extraData;o?(h.updateErrorState("oneupThumbnailViewer",{errorType:ge.d.viewerInitLoadingError,error:t,item:i,extraData:(0,a.W_)({viewer:ve.a.Thumbnail,extension:i&&i.extension||"",url:null===(n=null==i?void 0:i.thumbnail)||void 0===n?void 0:n.url},d),meTAQos:v.current}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(t,"ThumbnailViewer")):g.current&&(g.current.end({resultType:s,errorCode:c,extraData:(0,a.W_)({viewer:ve.a.Thumbnail,extension:i&&i.extension||""},d)}),g.current=void 0)});p.useEffect(function(){var e;if(0===s){var t=null===(e=null==i?void 0:i.thumbnail)||void 0===e?void 0:e.url;(0,In.a)(t)&&(v.current=(0,Oe.a)(ve.a.Thumbnail)),t?fetch(t).then(function(e){return(0,a.Zd)(n,void 0,void 0,function(){var n,s,c,d,u,f,p,_;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=(0,In.b)(e),s=n.correlationId,c=n.failureReason,200!==e.status?[3,2]:[4,e.blob()];case 1:return d=a.sent(),u=URL.createObjectURL(d),l(u),null===(_=g.current)||void 0===_||_.end({resultType:he.b.Success,extraData:{viewer:ve.a.Thumbnail,extension:i&&i.extension||""}}),r&&o&&r({extraData:{url:t},meTAQos:v.current}),[3,3];case 2:f=xn(e),p=new H.EI({isExpected:f,code:"".concat(e.status.toString(),": ThumbnailUrlFetchException"),correlationId:s,extraData:{failureReason:c}}),y(p),a.label=3;case 3:return m(!1),[2]}})})}).catch(function(e){y(e),m(!1)}):m(!1)}},[s,y,i,r,o]);var S=(0,_e.a)(function(e){y(new Error(e.type))});return 0===e.offset&&!f&&d?p.createElement("div",{className:Dn},p.createElement("img",{alt:"",src:d,onError:S})):p.createElement(p.Fragment,null)}var On=n(230),wn=n(42),En=n(128),An=n(359);function Ln(e,t,n,a,i,r){var o;return!!t&&!(H.HW.isActivated("FE5BDF48-187F-4F55-B5B7-A4EFDFFAE1FD","11/14/2023","Disable e-signature")||n||t.isExternalGuestUser||".pdf"!==(null===(o=null==e?void 0:e.extension)||void 0===o?void 0:o.toLowerCase())||!i||!i()||r||a||!kn(t))}function kn(e){var t=e.isSyntexESignatureEnabled,n=e.isSyntexPAYGEnabled,a=e.webTemplate,i=e.listBaseTemplate,r=e.cloudType,o=Boolean((0,Ct.Z)(Ct.x)||t&&n);return!!((0,Ct.Z)(Ct.v)&&a!==wn.b.mySite.toString()&&i!==En.a.mySiteDocumentLibrary&&function(e){if(H.HW.isActivated("2AC9DFE6-103D-4580-B6BB-8BACB5CC54A0","11/14/2023","Disable cloud type checking for e-signature"))return!0;if(!e)return!1;switch(e){default:return!1;case"edog":case"spdf":case"prodbubble":case"prod":return!0}}(null==r?void 0:r.toLowerCase())&&o)}function Mn(e,t,n,a,i,r){return Ln(e,t,n,a,i,r)}function Pn(e,t,n,a){var i,r,o=!!(null===(i=null==n?void 0:n.syntexEsignatureThirdPartyEnabledProviders)||void 0===i?void 0:i.some(function(e){return e===An.b.Adobe})),s=!!(null===(r=null==n?void 0:n.syntexEsignatureThirdPartyEnabledProviders)||void 0===r?void 0:r.some(function(e){return e===An.b.Docusign})),c=(0,Ct.Z)(Ct.t)&&o,d=(0,Ct.Z)(Ct.u)&&s;return Ln(t,n,void 0,void 0,a,void 0)&&(0,Ct.Z)(Ct.w)&&e===An.a.Adobe?c:e===An.a.Docusign&&d}var Tn=n(246),Un=new H.hK({name:"IdentityDataSource.key",loader:new H.vh(function(){return Promise.resolve().then(n.bind(n,39)).then(function(e){return e.resourceKey})})}),Fn=function(){return{pdfDownloadTime:Bt(qe.a.getDurationBetweenMarks("Start","Downloaded")),pdfOpenTime:Bt(qe.a.getDurationBetweenMarks("Downloaded","Opened")),pdfFirstRenderTime:Bt(qe.a.getDurationBetweenMarks("Opened","FirstRenderCompleted"))}},Hn=function(e){return $e.a.language.toLowerCase()===e||$e.a.cultureLCID.toLowerCase()===e||window.navigator.language.toLowerCase()===e},Rn=["NoConnection","expiredToken"];function Nn(e){var t,n,i,r,o=this;void 0===(r="MSPdf")&&(r="unknownViwer"),(0,j.f)("oneUp-".concat(r,".start"));var s=e.item,c=e.offset,d=e.parentItem,l=e.onViewerLoaded,u=e.onLogFullPageRumone,f=e.fallbackToOtherViewer,m=(0,He.f)("currentState",function(e){var t;return null!==(t=e.pdfAppMode)&&void 0!==t?t:Qe.a.View})[0],_=(0,He.f)("currentState",function(t){var n,a,i;return e.item?null===(i=null===(a=null===(n=t.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===a?void 0:a.pdfViewerStates)||void 0===i?void 0:i.filePickerMode:"close"})[0],h=(0,V.c)(),b=h.consume(zt.b),g=h.consume(kt),v=h.consume(Pe.a),y=h.consume(He.e),S=h.consume(R.a),D=h.consumeAsync(Kt),I=h.consume(St),x=h.consume(rt),C=h.consume(N.a),w=h.consume(un.a.optional),E="ZXNpZ24"===C.viewParams[Be.b.navParamKey],A=(0,He.f)("currentState",function(e){return e.eSignData})[0],L=(0,He.f)("currentState",function(e){return e.annotationViewerState})[0],k=p.useState(!1),M=k[0],P=k[1],T=p.useState(!1),U=T[0],B=T[1],z=p.useState(!1),G=z[0],K=z[1],W=p.useState(void 0),q=W[0],Q=W[1],Y=p.useState({}),J=Y[0],X=Y[1],Z=p.useRef(Hn("zh-cn")),$=p.useMemo(function(){return 0===c},[c]),ee=M&&$?"OneUp-pdf OneUp-pdf--loaded":"OneUp-pdf",te=p.useRef();void 0===te.current&&(te.current=!b.isNotEmbed());var ne=p.useRef();void 0===ne.current&&(ne.current=(0,Ct.Z)(Ct.v)&&!te.current&&(!(0,Ct.ib)()||kn(S)));var ae=p.useRef();void 0===ae.current&&(ae.current=(0,Ct.Z)(Ct.K)&&g.hasLicense&&!te.current);var ie=h.consume(Sn);p.useEffect(function(){(0,Ye.b)(H.HW.isActivated),(0,Je.b)(ie)},[ie]);var re=(0,_e.a)(function(){return(0,a.Zd)(o,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,h.consumeAsync(Un)];case 1:if((e=t.sent()).getAzRMSToken)return[2,e.getAzRMSToken().then(function(e){return e.accessToken})];throw new Error("Identity datasource not found for AzRMS token")}})})}),oe=p.useRef(),se=p.useRef(),ce=(0,_e.a)(function(e){e.url===J.url&&e.token===J.token||(X((0,a.W_)({},e)),(0,In.a)(e.url)&&(se.current=(0,Oe.a)(ve.a.MSPdf)))}),de=(0,_e.a)(function(e,t){if(0===c){var n=e,i=n.code,r=!!n.isExpected||!!(null==w?void 0:w.offline)||-1!==Rn.indexOf(i||""),o="".concat(i||e.name||"UnknownError",".").concat(t),d=e instanceof H.EI?new H.EI((0,a.W_)((0,a.W_)({},e),{code:o,isExpected:r})):new H.EI({code:o,isExpected:r,message:e.details||e.message||JSON.stringify(e)});y.updateErrorState("oneupPDFViewer",{errorType:ge.d.viewerInitLoadingError,error:d,item:s}),f&&f(d,"MSPDFViewer")}}),le=(0,_e.a)(function(){U&&B(!1),M||P(!0)}),ue=(0,_e.a)(function(t){le(),e.item&&y.updateViewerState("updatePdfViewerLoaded",{key:e.item.key,options:{pdfViewerStates:{isOpened:!0,isPdfMip:null==t?void 0:t.mip,isAnnotAllowed:null==t?void 0:t.isAnnotAllowed}}})}),fe=(0,_e.a)(function(){le(),e.item&&y.updateViewerState("updatePasswordProtectedPdf",{key:e.item.key,options:{pdfViewerStates:{isPdfPasswordProtected:!0}}})}),pe=(0,_e.a)(function(e){if(0===c){yn(e,!!(null==w?void 0:w.offline));var t=e.code,n=e.isExpected,a=e.extraData,i=e.error,r=new H.EI({code:t,correlationId:null==a?void 0:a.correlationId,isExpected:n,message:i.message,innerError:i,extraData:a});y.updateErrorState("oneupPDFViewer",{errorType:ge.d.viewerInitLoadingError,error:r,item:s,meTAQos:se.current,extraData:{url:J.url}}),f&&f(r,"MSPDFViewer")}}),me=(0,_e.a)(function(t){!(0,On.a)()&&t===Qe.a.Edit&&(null==L?void 0:L.isActive)&&y.toggleAnnotationViewerVisiblity("OneUpMSPDFViewer"),e.item&&y.updatePdfState("updatePdfAppMode",t)}),be=(0,_e.a)(function(t){e.item&&y.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerMode:t}}})}),ye=p.useCallback(function(e){return(0,a.Zd)(o,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,h.consumeAsync(Gt.b.optional)];case 1:switch(t=n.sent(),e){case Gt.a.Modified:null==t||t.notifyModified();break;case Gt.a.ExitEdit:null==t||t.notifyExitEdit()}return[2]}})})},[h]),Se=(0,_e.a)(function(e){e.dirty&&ye(Gt.a.Modified)}),De=(0,_e.a)(function(){ye(Gt.a.Modified)}),Ie=(0,_e.a)(function(){return y.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!1)}),xe=(0,_e.a)(function(){return y.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!0)}),Ce=(0,et.a)({register:function(){},start:function(){},setMaximum:function(e){},setCurrent:function(e){},succeed:function(){xe()},fail:function(){Ie()}},[xe,Ie]),we=(0,_e.a)(function(){return(0,a.Zd)(o,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return s&&((0,On.e)()||b.isPdfEditAvailable(s)&&b.isPdfEditable(s))?(0,On.r)()?[3,1]:[2,v.getItemCurrentVersion(s,{useDirectEndpoint:!0})]:[2,Promise.resolve("")];case 1:return[4,D];case 2:return[2,(null==(e=t.sent())?void 0:e.getItemCurrentVersion(s,S))||Promise.resolve("")]}})})}),Ee=p.useCallback(function(){return(0,a.Zd)(o,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,oe.current];case 1:return e=n.sent()||Promise.resolve(""),[4,we()];case 2:return t=n.sent(),[2,!!e&&!!t&&t!==e]}})})},[we]),Ae=(0,_e.a)(function(t){return(0,a.Zd)(o,void 0,void 0,function(){var n,i,r,o,c,d,l;return(0,a.qr)(this,function(a){switch(a.label){case 0:return s&&t?te.current?[4,h.consumeAsync(Gt.b.optional)]:[3,2]:[2,Promise.reject(new Error("Invalid document"))];case 1:return[2,null==(n=a.sent())?void 0:n.execSave(t)];case 2:return[4,D];case 3:return[4,a.sent().execSave({item:s,parentItem:e.parentItem,oneUpStateStore:y,pageContext:S,fileData:t})];case 4:return i=a.sent(),(null===(l=null==i?void 0:i.extraData)||void 0===l?void 0:l.schema)&&(r=i.extraData.schema,o=r.resultType,c=r.resultCode,d=r.extraData,o!==he.b.Success)?[2,Promise.reject(new Error("errorCode:".concat(c,", extraData:").concat(JSON.stringify(d))))]:(oe.current=we(),[2])}})})}),Le=(0,_e.a)(function(){var e;if(s){var t=I.evaluateAction({item:s});t.isAvailable&&(null===(e=t.onExecute)||void 0===e||e.call(t,{}))}}),Me=(0,_e.a)(function(){var e;if(s){var t=x.evaluateAction({item:s});t.isAvailable&&(null===(e=t.onExecute)||void 0===e||e.call(t,{}))}}),Te=(0,_e.a)(function(){s&&b.isPreviewerEnabled(s)&&(U&&B(!1),K(!0)),l&&l({perfData:{euplBreakDownData:qe.a.getMarkerTime("Previewed")?{pdfTTI:Bt(qe.a.getDurationBetweenMarks("Start","Previewed"))}:(0,a.W_)((0,a.W_)({},Fn()),{pdfTTI:Bt(qe.a.getDurationBetweenMarks("Start","FirstRenderCompleted"))}),extraPerfData:b.getTempAuthLogData(J)},meTAQos:se.current,extraData:{url:J.url}})}),Ue=(0,_e.a)(function(){(0,On.m)()||null==u||u({perfData:{euplBreakDownData:Fn(),extraPerfData:b.getTempAuthLogData(J)}})}),Fe=(0,_e.a)(function(){M||G||B(!0)});p.useEffect(function(){var e=setTimeout(function(){Fe()},1e4);return function(){return clearTimeout(e)}},[Fe]),p.useEffect(function(){var e=zt.a.GetDownloadUrl;(0,a.Zd)(o,void 0,void 0,function(){var t,n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return s?(t=s.pdfConversion)?t.url?[2,{url:t.url}]:[4,v.getAuthenticationParams(s)]:[3,2]:[2,{}];case 1:return n=a.sent(),[2,{url:"".concat(v.getItemUrl(s,{useDirectEndpoint:!0}),"/content?format=pdf&").concat((0,ke.a)(n))}];case 2:return b.isTempAuthDeprecated(s)?[4,v.getDownloadUrl(s,{useDirectEndpoint:!0,excludeTempAuth:!0})]:[3,5];case 3:return i=a.sent(),e=zt.a.GetDownloadToken,[4,v.getDownloadToken(s)];case 4:return r=a.sent(),[2,{url:i,token:r}];case 5:return[2,v.getDownloadUrl(s,{useDirectEndpoint:!0}).then(function(e){return{url:e}})]}})}).then(ce,function(t){return de(t,e)})},[v,s,b,de,ce]),p.useEffect(function(){oe.current=we()},[s,we]),p.useEffect(function(){ne.current&&E&&me(Qe.a.Esign)},[me,E]),p.useEffect(function(){var e,t,n,i,r=(0,a.W_)((0,a.W_)({},Tn.b),{semanticColors:(0,a.W_)((0,a.W_)({},Tn.b.semanticColors),{bodyBackground:"transparent"})}),o=s?b.isPdfEditAvailable(s)&&b.isPdfEditable(s):void 0,c=s?null===(e=b.getEmbedOptions())||void 0===e?void 0:e.allowEdit:void 0,l=(0,Ct.Z)(Ct.h)?{enableOpenMip:!0,getMIPToken:re}:{enableOpenMip:!1,mipDialogProps:{enableDownload:!0,enableOpenInBrowser:!0,onDownload:Le,onOpenInBrowser:Me}},u=s?(0,a.W_)((0,a.W_)({url:"",filename:null==s?void 0:s.displayName,fileSize:s.size,mode:m,enableThumbnailView:m===Qe.a.Extract,telemetryHandler:ie,enableAnnotationBar:o,enableFormFilling:o&&(!te.current||c)&&(0,Ct.Z)(Ct.k)&&!Z.current,enableFreeText:o&&(!te.current||c)&&(0,Ct.Z)(Ct.l)&&!Z.current,enablePreRender:(0,Ct.Z)(Ct.m),enableProgressiveLoading:b.isProgressiveLoadingEnabled(s),darkMode:!0,theme:r,enablePreview:b.isPreviewerEnabled(s),shouldAutoFocus:!1,showOpenInNewWindow:!1,openUrl:"",toolbarAttributes:{"data-handle-special-keys":"Left Right Esc"},enableCopyByChunk:!(0,On.n)(),enableDebugString:(0,Ct.Z)(Ct.j)&&!te.current,formAttributes:"data-suppresskeyboardbinding"},l),{shouldExitEditModeAfterSave:!te.current,allowUnloadPageWithEdits:te.current,enableCacheDisplayInfo:(0,Ct.Z)(Ct.i),uniqueId:null===(t=s.properties)||void 0===t?void 0:t.uniqueId,onDocumentLoaded:ue,onNeedPassword:fe,onCurrentPageChanged:function(){},onInitError:pe,onEditStateChanged:te.current?Se:void 0,onExitEditMode:te.current?De:void 0,updateMode:me,execSave:Ae,isFileVersionChanged:Ee,itemId:null===(n=s.graph)||void 0===n?void 0:n.itemId,onFirstRenderVisible:Te,onDocumentFullyLoaded:Ue,filePickerProps:{app:"OneDrive",mode:null!=_?_:"close",setMode:be,getIconUrl:function(e){return"".concat(O).concat(e,"/").concat((0,Ze.a)("pdf"),".png")},item:{listItemId:(null===(i=s.properties)||void 0===i?void 0:i.ID)||"",parentKey:d.key||""}}}):void 0;u&&(u=(0,a.W_)((0,a.W_)({},u),{addOnsEnabled:{eSign:ne.current,universalAnnotation:ae.current}})),Q(u)},[m,Ae,_,re,ue,Le,Se,De,pe,Ue,Te,Me,be,me,Ee,s,fe,d.key,b,ie]);var Re=window.require,Ne=Re.toUrl?Re.toUrl("item-viewer-pdf/"):void 0,je=null===(t=Re.toUrl)||void 0===t?void 0:t.call(Re,"pdf.worker.min.js"),Ve=null===(n=Re.toUrl)||void 0===n?void 0:n.call(Re,"pdfjs-dist/cmaps/");p.useEffect(function(){var e=h.consume(We),t=(0,Ct.Z)(Ct.h)?{mipWasmUrl:"".concat(Ne,"mspdf2.wasm"),mipWasmJsUrl:"".concat(Ne,"mspdf2.min.js")}:{},n=(0,a.W_)((0,a.W_)({workerUrl:e.getWorkerUrl("".concat(Ne,"index.worker.js"),b.getWorkerManifestName()),pdfJsWorkerUrl:je&&s&&b.isPreviewerEnabled(s)?e.getWorkerUrl(je,"pdfwebworker"):void 0,pdfJsCMapUrl:Ve,wasmUrl:"".concat(Ne,"mspdfkit.wasm"),wasmJsUrl:"".concat(Ne,"mspdfkit.min.js"),dataUrl:"".concat(Ne,"mspdfkit.data")},t),{parserWasmUrl:s&&b.isPdfExtractAvailable(s)?"".concat(Ne,"mspdfparser.wasm"):void 0,parserWasmJsUrl:s&&b.isPdfExtractAvailable(s)?"".concat(Ne,"mspdfparser.min.js"):void 0}),i="".concat(Ne,"media/fonts/"),r=(0,On.t)()?"noto_sans.ttf":"arial.ttf",o=["".concat(i).concat(r)];Z.current?o.push("".concat(i,"noto_sans_sc.ttf")):(0,On.j)()||Hn("ja")||Hn("ja-jp")?o.push("".concat(i,"noto_sans_jp.otf")):(0,On.k)()||!Hn("ko")&&!Hn("ko-kr")||o.push("".concat(i,"noto_sans_ko.ttf")),(0,Xe.b)(n,o)},[Ne,Ve,s,je,b,h]);var ze=p.useMemo(function(){var e;return{isUniversalAnnotationActive:0===c&&!!(null==L?void 0:L.isActive),driveId:null===(e=null==s?void 0:s.graph)||void 0===e?void 0:e.driveId,onPreloadFailure:Ie,onPreloadSuccess:xe,progressRegister:function(){return Ce}}},[null==L?void 0:L.isActive,Ce,null===(i=null==s?void 0:s.graph)||void 0===i?void 0:i.driveId,Ie,xe,c]);p.useEffect(function(){var e=d.permissions,t=d.openUrl;!(null==A?void 0:A.isCreateSidePanelActive)||e&&t||(0,F.a)(h)},[h,d.permissions,d.openUrl,null==A?void 0:A.isCreateSidePanelActive,d]);var Ge=p.useMemo(function(){var e;if(ne.current&&s&&s.openUrl&&(null===(e=s.properties)||void 0===e?void 0:e.uniqueId)&&0===c)return{uniqueId:s.properties.uniqueId,documentUrl:s.openUrl,isEsignRecipient:m===Qe.a.Esign,isEsignSidePanelActive:null==A?void 0:A.isCreateSidePanelActive,setIsEsignSidePanelActive:function(e){y.updateESignDataState("SetIsEsignSidePanelActive",{isCreateSidePanelActive:e})},parentItemPermission:d.permissions,parentItemUri:d.openUrl,isNewOneup:!(0,On.b)(),hasParentItemPermissionsLoaded:y.state.currentState.hasValidPermissionToParent,canSendToExternalRecipients:null==A?void 0:A.isExternalSharingEnabled}},[s,c,m,null==A?void 0:A.isCreateSidePanelActive,null==A?void 0:A.isExternalSharingEnabled,d.permissions,d.openUrl,y]),Ke=p.useMemo(function(){return $&&q&&J.url&&""!==J.url?p.createElement(ln,(0,a.W_)({},q,{token:J.token,url:J.url,eSignProps:Ge,universalAnnotationProps:ze})):p.createElement(p.Fragment,null)},[$,q,J,Ge,ze]),$e=p.useRef();return $e.current||($e.current={viewer:ve.a.MSPdf,extension:s&&s.extension||"unknown"}),p.createElement("div",{className:ee},p.createElement("div",{className:"newOneUpPdfContainer",role:"document"},Ke),U&&p.createElement(Cn,(0,a.W_)({mainViewerEngagementData:$e.current,isMainViewer:!1},e)))}var Bn,jn=n(156),Vn=n(161);function zn(e){function t(t){var n,a=new he.a({name:"OneUpLightSpeed.commandInvoked.".concat(t.id)}),i="Unhandled exception executing an action";try{if(e.onClickCallback&&e.onClickCallback(),t.action.onExecute)null===(n=t.action.onExecute({qosEvent:a}))||void 0===n||n.then(function(e){var t=e||{resultType:he.b.Success};a.end(t)}).catch(function(t){e.updateErrorStateCallBack("Unhandled exception executing an action: ".concat(e.text));var n=t||new Error(i);a.end((0,be.a)(n))});else{e.updateErrorStateCallBack("no available action for ".concat(t.name));var r=new Error("no available action for ".concat(t.name));a.end((0,be.a)(r))}}catch(r){e.updateErrorStateCallBack("Unhandled exception executing an action: ".concat(e.text));var o=r||new Error(i);a.end((0,be.a)(o))}}var n=Tn.b;if(e.command.action.isDisabled)return p.createElement(p.Fragment,null);var i=p.createElement(p.Fragment,null);if(e.buttonType===Bn.primary)i=p.createElement(jn.f,{className:Le.e,onClick:function(){return t(e.command)},disabled:!!e.command.action.isDisabled,title:e.command.title,ariaLabel:e.toolTipText||e.command.title},e.text);else if(e.buttonType===Bn.iconButton){var r=n,o=r.palette,s=r.semanticColors,c="".concat(s.buttonBackground," !important"),d="".concat(s.buttonBackgroundHovered," !important"),l="".concat(s.buttonBackgroundPressed," !important"),u="".concat(s.buttonBorder," !important"),f={height:"".concat(40,"px"),width:"".concat(40,"px"),borderRadius:"25px",fontSize:"30px",zIndex:9999,color:o.black,border:"1px solid ".concat(u)},m={root:(0,a.W_)((0,a.W_)({},f),{backgroundColor:e.isActive?d:c,"&::before":{content:"''",width:"".concat(72,"px"),height:"".concat(72,"px"),position:"absolute",transform:"translate(-50%, calc(-50% + ".concat(20,"px))")}}),rootHovered:(0,a.W_)((0,a.W_)({},f),{backgroundColor:d,cursor:"pointer"}),rootPressed:(0,a.W_)((0,a.W_)({},f),{backgroundColor:l})};i=p.createElement(jn.e,{iconProps:{iconName:e.text},styles:m,disabled:!!e.command.action.isDisabled,onClick:function(){return t(e.command)},ariaLabel:e.toolTipText||e.command.title})}else i=p.createElement(jn.f,{className:"".concat(Le.d," ").concat(H.HW.isActivated("9038af9c-9d8f-4288-bff3-2b0ef5c72aa3","11/08/2023","Fix Download Button shim incorrect color (should be white)")?"":Le.c),disabled:!!e.command.action.isDisabled,onClick:function(){return t(e.command)},title:e.command.title,ariaLabel:e.toolTipText||e.command.title},e.text);return p.createElement(Vn.a,{content:e.toolTipText?e.toolTipText:e.text},i)}!function(e){e[e.primary=0]="primary",e[e.iconButton=1]="iconButton",e[e.default=2]="default"}(Bn||(Bn={})),(0,l.Bv)([{rawString:".OneUpOther_443bfddc{position:absolute;width:100%;height:100%;left:50%;top:50%;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc{text-align:center}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherFileName_443bfddc{font-size:21px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherDownload_443bfddc{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherMessage_443bfddc{margin:15px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherMessageNewDesign_443bfddc{margin-top:15px;margin-bottom:15px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherActions_443bfddc{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherActions_443bfddc{padding:4px 20px 6px 20px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherActions_443bfddc .odButtonBarMain_443bfddc{float:none}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherFileIcon_443bfddc .FileTypeIcon_443bfddc{outline:0}.OneUpOtherMalwareDetectedIcon_443bfddc{height:208px;width:208px}.OneUpOtherMalwareDetectedIconExperiment_443bfddc{height:256px;width:256px}"}]);var Gn=n(508),Kn={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.Ci,platform:$.a},Wn=new H.hK({name:"OpenInOfficeOnlineAction",factory:{dependencies:Kn,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n,i={isAvailable:!(!(n=e.item)||!n.appMap)&&n.itemStatus!==nt.b.ConditionalAccessBlocked&&n.itemStatus!==nt.b.ConditionalAccessViewOnly,id:"OpenInOfficeOnlineAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){return[2,t.resources.consumeAsync(an.a).then(function(n){var a,i=null===(a=t.oneUpStore.list)||void 0===a?void 0:a.id;if(i){var r=n.getOpenInOfficeOnlineUrl(e.item,i);return t.navigation.navigateTo({url:r,frameId:"_blank"}),{resultType:he.b.Success}}return{resultType:he.b.Failure}})]})})}};return i})}};var t}}}),qn={resources:H.Ci,navigation:N.a,oneUpUrlDataSource:an.a},Qn=new H.hK({name:"OpenInOtherViewerAction",factory:{dependencies:qn,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={isAvailable:!0,id:"OpenInOtherViewerAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return e.item.folder?[3,2]:(n={urlType:"default"},i=t.oneUpUrlDataSource.getDefaultClickUrlForOneUp(e.item,n),[4,t.navigation.navigateTo({url:i,frameId:"_blank"})]);case 1:return a.sent(),[3,4];case 2:return n={urlType:"default"},"#"===(i=t.oneUpUrlDataSource.getDefaultClickUrlForOneUp(e.item,n)).charAt(0)&&(i="?"+i.substring(1)),[4,t.navigation.navigateTo({url:i,frameId:"_blank"})];case 3:a.sent(),a.label=4;case 4:return[2,{resultType:he.b.Success}]}})})}};return n})};return{instance:n}}}}),Yn=n(509),Jn=n(71);function Xn(e){var t,n=e.iconName,a=e.iconFieldAriaLabel,i=e.desiredSize||16,r="";if(n){var o=e.iconSize||i;r=function(e,t,n,a){return function(e,t,n,a){var i=a||"png",r=e;return"".concat(O).concat(n).concat(r?"_2x":"","/").concat(t,".").concat(i)}(n,e,t,a)}(n,o,!!(null===(t=e.platformDetection)||void 0===t?void 0:t.isRetinaSupported),e.fileExtention)}var s=e.className||"FileTypeIcon-icon";return p.useMemo(function(){return p.createElement("img",{className:s,src:r,alt:a,style:{width:"".concat(i,"px"),height:"".concat(i,"px")}})},[s,r,a,i])}var Zn=H.HW.isActivated("4F69420A-9950-45CF-8BD3-2E57ED1A714D"),$n=H.HW.isActivated("875099EF-AA79-4289-8864-F787C33E6577");function ea(e){var t,n,a=(0,V.c)(),i=e.item,r=e.viewerType,o=e.offset,s=e.onViewerLoaded,c=a.consume(bt),d=i?c.evaluateAction({item:i}):void 0,l=a.consume(Wn),u=i?l.evaluateAction({item:i}):void 0,f=a.consume(Qn),m=i?f.evaluateAction({item:i}):void 0,_=a.consume(R.a),h=a.consume($.a),b=void 0,g=void 0,v=null==i?void 0:i.extension,y=!!v&&(".fluid"===v||".loop"===v||".note"===v||".whiteboard"===v||".wbtx"===v),S=(0,Jn.a)(),D=S.palette;p.useEffect(function(){0===o&&s&&s()},[o,s]),p.useEffect(function(){var t,n;null===(n=null===(t=e.fallbackCxpRef)||void 0===t?void 0:t.current)||void 0===n||n.end({resultType:De.c.Success,extraData:{viewer:ve.a.Other,extension:i&&i.extension||""}})},[]),i&&(d&&d.isAvailable&&(b={id:"downloadCommand",action:d}),r===ve.a.Other&&!y&&m&&m.isAvailable?g={id:"openCommand",action:m}:r===ve.a.WAC&&u&&u.isAvailable&&(g={id:"openCommand",action:u}));var I=a.consume(He.e),x=function(e){var t=(0,ge.i)(e);I.updateErrorState("otherViewerActionFailure: ".concat(e),{errorType:ge.d.actionError,error:t,item:i})},C=null!==(n=null===(t=null==i?void 0:i.lifeCycleStatus)||void 0===t?void 0:t.isMalwareDetected)&&void 0!==n&&n,O=!$n&&!Zn,w=!!(null==_?void 0:_.allowInfectedDownload),E=!!(null==_?void 0:_.m365GroupsBlockDownloadsExperienceEnabled),A=Gn.d,L=window.require,k=L.toUrl?L.toUrl("odsp-media/images/atp/malware_icon_208x208.svg"):void 0,M=void 0;if(O){var P=S&&S.isInverted?"_dark":"";M=L.toUrl?L.toUrl("odsp-media/images/error/web_warning_v3".concat(P,".webp")):void 0}return p.createElement("div",{className:"OneUpOther_443bfddc"},p.createElement("div",{className:"OneUpOtherContent_443bfddc"},O?p.createElement("img",{className:"OneUpOtherMalwareDetectedIconExperiment_443bfddc",src:M,alt:A}):C?p.createElement("img",{className:"OneUpOtherMalwareDetectedIcon_443bfddc",src:k,alt:A}):(null==i?void 0:i.iconName)?p.createElement("div",{className:"OneUpOtherFileIcon_443bfddc"},p.createElement(Xn,{iconName:i.iconName,platformDetection:h,desiredSize:96})):null,p.createElement("div",{className:"OneUpOtherFileName_443bfddc",style:{color:null==D?void 0:D.black}},null==i?void 0:i.name),p.createElement("div",{className:"OneUpOtherMessageNewDesign_443bfddc",style:{color:null==D?void 0:D.black}},C?p.createElement(Yn.a,{allowInfectedFileDownload:w}):(null==i?void 0:i.itemStatus)===nt.b.ConditionalAccessBlocked?E?Gn.a:Gn.b:O?Gn.e:Gn.f),p.createElement("div",{className:"OneUpOtherActions_443bfddc"},g&&i&&p.createElement(zn,{command:g,text:Gn.g,buttonType:Bn.primary,updateErrorStateCallBack:x,toolTipText:Gn.g}),b&&i&&p.createElement(zn,{command:b,text:Gn.c,buttonType:g?Bn.default:Bn.primary,updateErrorStateCallBack:x,toolTipText:Gn.c}))))}var ta=n(399),na=function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsCopy(e)||this.canSaveAsOriginal(e)},e.prototype.isWebFormat=function(e){var t,n=null===(t=null==e?void 0:e.extension)||void 0===t?void 0:t.toLowerCase();return n&&(".png"===n||".jpeg"===n||".jpg"===n)||!1},e}(),aa=!H.HW.isActivated("cb540c5d-0869-4154-9c8c-7b16a05565d4","03/04/2024","check parent folder permission for image editor save as copy"),ia=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.XJ)(t,e),t.prototype.canSaveAsCopy=function(e){var t=e.item,n=e.parentItem;return!!t&&tt.a.hasItemPermission(t,tt.a.insertListItems)&&(!aa||!!(null==n?void 0:n.permissions)&&tt.a.hasItemPermission(n,tt.a.insertListItems))},t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&this.isWebFormat(t)&&tt.a.hasItemPermission(t,tt.a.insertListItems)&&tt.a.hasItemPermission(t,tt.a.editListItems)},t.dependencies={},t}(na),ra=(0,H.c7)("ImageEditorDataSource",ia),oa=n(27),sa=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx"),n.e(21)]).then(n.bind(n,669))];case 1:return[2,e.sent().default]}})})});function ca(e){var t=this,i=e.resources,r=i.consume($.a),o=i.consume(ra),s=!!e.item&&o.isWebFormat(e.item),c=p.useState(void 0),d=c[0],l=c[1],u=(0,_e.a)(function(e){return(0,a.Zd)(t,void 0,void 0,function(){return(0,a.qr)(this,function(t){return[2,i.consumeAsync(Ue.downloadDataSourceKey).then(function(t){return t.getItemContents(e)})]})})}),f=(0,_e.a)(function(n){return(0,a.Zd)(t,void 0,void 0,function(){var t,n,i,r,o,s,c,d,l,u,f,p,m;return(0,a.qr)(this,function(a){return t=null===(o=null===(r=e.item)||void 0===r?void 0:r.thumbnail)||void 0===o?void 0:o.url,(n=(null===(c=null===(s=e.item)||void 0===s?void 0:s.thumbnail)||void 0===c?void 0:c.url)?new oa.a(null===(l=null===(d=e.item)||void 0===d?void 0:d.thumbnail)||void 0===l?void 0:l.url):void 0)&&(i={width:(null===(f=null===(u=e.item)||void 0===u?void 0:u.photo)||void 0===f?void 0:f.width)||1024,height:(null===(m=null===(p=e.item)||void 0===p?void 0:p.photo)||void 0===m?void 0:m.height)||1024},n.setQueryParameter("width",i.width.toString()),n.setQueryParameter("height",i.height.toString()),t=n.toString()),[2,t?fetch(t).then(function(e){return e.blob()}):Promise.reject()]})})}),m=(0,_e.a)(function(n){return(0,a.Zd)(t,void 0,void 0,function(){var t;return(0,a.qr)(this,function(a){return t=new he.a({name:"OneUpImageEditorGetFullImageUrl"}),[2,(s?u(n):f(n)).then(function(e){var n=URL.createObjectURL(e);l(n),t.end({resultType:he.b.Success})}).catch(function(n){var a,i;l(null===(i=null===(a=e.item)||void 0===a?void 0:a.thumbnail)||void 0===i?void 0:i.url),t.end({resultType:he.b.Failure,extraData:{error:n}})})]})})}),_=(0,_e.a)(function(e){return e&&".png"===e.extension?"image/png":"image/jpeg"}),h=(0,_e.a)(function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);return n}),b=(0,_e.a)(function(e){if(e&&e.extension&&e.name)return e.name+e.extension}),g=(0,_e.a)(function(e,t){var n=e.split(",")[1],a=atob(n),i=h(a),r=new Blob([i],{type:_(t)});return r.name=b(t),r}),v=(0,_e.a)(function(i,r){return void 0===r&&(r=!1),(0,a.Zd)(t,void 0,void 0,function(){var t,o,s,c,d,l,u,f,p=this;return(0,a.qr)(this,function(m){switch(m.label){case 0:return[4,n.e(1).then(n.bind(n,619))];case 1:return t=m.sent().resourceKey,o=e.resources.consumeAsync(t),s=null,e.item&&e.parentItem?[4,o]:[3,3];case 2:s=m.sent().evaluateAction({item:e.item,parentItem:e.parentItem}),m.label=3;case 3:return s&&s.onExecute&&e.item&&(c=new he.a({name:"OneUpLightSpeed.saveInvoked"}),d=i.toDataURL(_(e.item)),l=g(d,e.item),u={extension:e.item.extension,iconName:"photo",name:l.name,size:l.size,_file:l,slice:function(e,t){return l}},null===(f=s.onExecute({qosEvent:c,fileUpload:u,saveascopy:r}))||void 0===f||f.then(function(){return(0,a.Zd)(p,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,e.switchToView(!0)];case 1:return t.sent(),[2]}})})}).catch(function(e){})),[2]}})})});return p.useEffect(function(){e.item&&!d&&m(e.item)},[e.item,d,m]),p.useEffect(function(){e.parentItem.permissions||(0,F.a)(e.resources)},[e.parentItem,e.resources]),p.createElement(sa,{imageUrl:d,onClose:e.switchToView,canSaveCopy:o.canSaveAsCopy({item:e.item,parentItem:e.parentItem}),canSaveOriginal:o.canSaveAsOriginal({item:e.item}),executeSave:v,engagementCurrentPage:"",desktopMarkupToolbarPosition:"Left",platformDetection:r,onErrorCallBack:e.onErrorCallBack})}var da=n(562),la=new H.hK({name:"OneUpAuthTokenHelperAsync.key",loader:new H.vh(function(){return n.e(33).then(n.bind(n,668)).then(function(e){return e.authTokenHelperResourceKey})})}),ua=n(563);function fa(e){return!!e&&e.width>0&&e.height>0}var pa=/&(?:access_|proof)token=[^&]*/g;function ma(e){var t,n,i,r,o,s,c,d=this,l=e.size,u=e.scale,f=e.item,m=p.useState({localBlobImageUrl:"",scale:e.scale}),_=m[0],h=m[1],b={width:(null===(t=null==f?void 0:f.photo)||void 0===t?void 0:t.width)||0,height:(null===(n=null==f?void 0:f.photo)||void 0===n?void 0:n.height)||0},g=0===b.width||0===b.height,v=p.useState(g?void 0:b),y=v[0],S=v[1],D=p.useState(!0),I=D[0],x=D[1],C=(0,V.c)(),O=p.useRef(!1),w=p.useState(!0),E=w[0],A=w[1],L=(0,_e.a)(function(){return g?{width:(null==y?void 0:y.width)||0,height:(null==y?void 0:y.height)||0}:b}),k=(0,_e.a)(function(t){e.onImageLoadFail(new Error("img load fail"))}),M=p.useCallback(function(){return(0,a.Zd)(d,void 0,void 0,function(){var e,t,n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,C.consumeAsync(la)];case 1:return[4,a.sent().refreshAuthToken()];case 2:return(e=a.sent())&&(t=e.authToken,n=e.proofToken,null===(i=null==f?void 0:f.thumbnail)||void 0===i?void 0:i.url)?[2,null===(r=null==f?void 0:f.thumbnail)||void 0===r?void 0:r.url.replace(pa,"&access_token=".concat(t).concat(n?"&prooftoken=".concat(n):""))]:[3,4];case 3:return a.sent(),[2];case 4:return[2]}})})},[null===(i=null==f?void 0:f.thumbnail)||void 0===i?void 0:i.url,C]),P=(0,_e.a)(function(t,n,i){return void 0===t&&(t=_.scale),void 0===n&&(n={width:1024,height:1024}),(0,a.Zd)(d,void 0,void 0,function(){var r,o,s,c,d,l,u,f,p,m,b,v,y;return(0,a.qr)(this,function(a){switch(a.label){case 0:if(_.localBlobImageUrl&&t<=_.scale)return[2];r=i,o={width:Math.ceil(n.width*t*window.devicePixelRatio),height:Math.ceil(n.height*t*window.devicePixelRatio)},(s=r?new oa.a(r):void 0)&&(c=L(),g&&o&&(c=o),s.setQueryParameter("width",(c.width||1024).toString()),s.setQueryParameter("height",(c.height||1024).toString()),r=s.toString()),a.label=1;case 1:return a.trys.push([1,8,,9]),[4,fetch(r||"")];case 2:return d=a.sent(),l=(0,In.b)(d),u=l.correlationId,f=l.failureReason,200!==d.status?[3,4]:(O.current=!1,[4,d.blob()]);case 3:return p=a.sent(),m=URL.createObjectURL(p),h({localBlobImageUrl:m,scale:t}),A(!1),[3,7];case 4:return H.HW.isActivated("2b299c82-0c70-4872-a785-c8cc727cc798","04/15/2024","Enable refresh token when image url fetch failed for token issue")||O.current||401!==d.status&&400!==d.status?[3,6]:(O.current=!0,[4,M()]);case 5:if(b=a.sent())return P(t,n,b).catch(function(){}),[2];a.label=6;case 6:return v=new H.EI({isExpected:xn(d),code:"".concat(d.status.toString(),": ImageUrlFetchException"),correlationId:u,extraData:{failureReason:f}}),e.onImageLoadFail(v),[2];case 7:return[3,9];case 8:return y=a.sent(),e.onImageLoadFail(y),A(!1),[3,9];case 9:return[2]}})})}),T=_.localBlobImageUrl?_.localBlobImageUrl:null===(o=null===(r=e.item)||void 0===r?void 0:r.thumbnail)||void 0===o?void 0:o.url;if(p.useEffect(function(){var e;g||!_.localBlobImageUrl?P(u,l,null===(e=null==f?void 0:f.thumbnail)||void 0===e?void 0:e.url).catch(function(){}):A(!1)},[]),!l)return p.createElement(p.Fragment,null);var U=L(),F={width:l.width*u,height:l.height*u};return fa(U)&&fa(F)&&(c=(0,da.b)({boundsSize:F,contentSize:U,mode:"contain",maxScale:1/0})),c&&y&&c.width>y.width&&c.height>y.height&&(c=u<=1?y:{width:y.width*u,height:y.height*u}),p.createElement("div",{className:Dn,"data-automation-id":"oneup-image-container"},!E&&p.createElement("img",{"data-automation-id":"oneup-image-frame","tab-index":0,alt:H.OO(ua.a,null===(s=e.item)||void 0===s?void 0:s.displayName),src:T,style:y?{width:"".concat(null==c?void 0:c.width,"px"),height:"".concat(null==c?void 0:c.height,"px"),opacity:1}:{opacity:0},onLoad:function(t){if(I&&e.onViewerLoaded&&(e.onViewerLoaded(),x(!1)),T&&0===T.indexOf("blob:")&&1===u&&!y){var n={width:t.currentTarget.offsetWidth,height:t.currentTarget.offsetHeight};S(n)}},onError:k}))}var _a=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,399))];case 1:return[2,e.sent().Projector]}})})});function ha(e){var t,n,i=this,r=e.item,o=e.offset,s=e.fallbackToOtherViewer,c=e.onViewerLoaded,d=e.parentItem,l=(0,V.c)(),u=l.consume(He.e),f=(0,He.f)("currentState",function(e){return e.imageMode===He.c.edit})[0],m=!f&&(0,In.a)(null===(t=null==r?void 0:r.thumbnail)||void 0===t?void 0:t.url),_=p.useRef(),h={url:null===(n=null==r?void 0:r.thumbnail)||void 0===n?void 0:n.url};p.useEffect(function(){m&&0===o&&(_.current=(0,Oe.a)(ve.a.Photo))},[m,o]);var b=(0,_e.a)(function(e){return void 0===e&&(e=!1),(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(e){return u.updateImageState("openImageEditor",He.c.view),[2]})})}),g=(0,_e.a)(function(){c({meTAQos:_.current,extraData:h})}),v=(0,_e.a)(function(e){0===o&&(u.updateErrorState("oneupPhotoViewer",{errorType:ge.d.viewerInitLoadingError,error:e,item:r,meTAQos:_.current,extraData:h}),s&&s(new Error("photoViewerFailToLoad"),"PhotoViewer"))}),y=(0,_e.a)(function(e){if(0===o){var t=(0,ge.i)(e.message,e.id);u.updateErrorState("oneUpPhotoEditor",{errorType:ge.d.actionError,error:t,item:r}),s&&s(new Error("photoEditorFailToLoad"),"PhotoViewer")}});if(!r||0!==o)return p.createElement(p.Fragment,null);var S=p.createElement(_a,{mode:ta.ProjectorMode.preview},function(e){var t=e.size,n=e.transformV;return p.createElement(ma,{item:r,size:t,scale:n.scale,onImageLoadFail:v,onViewerLoaded:g})});return p.createElement(p.Fragment,null,f&&r?p.createElement(ca,{item:r,parentItem:d,resources:l,switchToView:b,onErrorCallBack:y}):S)}var ba=n(126),ga=n(218);(0,l.Bv)([{rawString:".OneUpTextFileContent_04a30d0d{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-flow:column nowrap;align-items:stretch;justify-content:space-between;box-shadow:0 0 7px 2px rgba(0,0,0,.15);border-radius:5px}.OneUpTextFileContent_04a30d0d .OneUpTextFileTitle_04a30d0d{flex:0 0 24px;font-size:14px;padding:6px 0 0 10px}html[dir=rtl] .OneUpTextFileContent_04a30d0d .OneUpTextFileTitle_04a30d0d{padding:6px 10px 0 0}.OneUpTextFileContent_04a30d0d .OneUpTextFileEditor_04a30d0d{position:relative;flex:1 1 auto;width:100%}.isFluentVNext_04a30d0d .OneUpTextFileContent_04a30d0d{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.isFluentVNext_04a30d0d .OneUpTextFileContent_04a30d0d .OneUpTextFileTitle_04a30d0d{border-top-left-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:";border-top-right-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.OneUpTextFileContentLight_04a30d0d{background-color:#fff;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpTextFileContainer_04a30d0d{position:relative;margin:auto;width:75%;height:100%}.oneUpTextEditor{height:100%}"}]);var va,ya=n(397),Sa=n(199),Da=n(307),Ia=!H.HW.isActivated("5B8CD4DE-74E3-46DF-9A3E-B28C31F8BA71");function xa(e){var t,n,a=e.focusItem,i=e.navigation,r=e.saveAction;return!(!Ia||!(null===(n=(t=i.beforeUnload).isHashNavDialogHandlerRegistered)||void 0===n?void 0:n.call(t)))&&!!a&&r.evaluateAction({item:a}).isAvailable&&i.beforeUnload.hasActiveBlock()}function Ca(e){var t,i=this,r=e.closeCallback,s=(0,V.c)(),c=s.consume(He.e),d=s.consume(ne.b),l=s.consume(N.a),u=s.consume(ye.b),f=p.useState(!1),m=f[0],_=f[1],h=p.useRef(e.editorContent),b=p.useState(e.editorContent),g=b[0],v=b[1],y=p.useState(void 0),S=y[0],D=y[1],I=s.consume(Da.a),x=!!e.item&&I.evaluateAction({item:e.item}).isAvailable;p.useEffect(function(){if(Ia){var e=function(e){var t,n;return(null===(n=(t=l.beforeUnload).isHashNavDialogHandlerRegistered)||void 0===n?void 0:n.call(t))&&x?va.OneUpTextFile:""},t=function(){return o.c.resolve(null==r?void 0:r(!0).then(function(){d.clean(),c.clean(),c.navClean()}))};return l.beforeUnload.registerHandler(e),l.beforeUnload.registerOnContinueHandler(t),function(){l.beforeUnload.unRegisterHandler(e),l.beforeUnload.unRegisterOnContinueHandler(t)}}},[x,l.beforeUnload,d,c,r]),p.useEffect(function(){window.innerWidth<1024&&!m?_(!0):window.innerWidth>=1024&&m&&_(!1)},[window.innerWidth]),p.useEffect(function(){e.editorContent!==g&&(v(e.editorContent),h.current=e.editorContent),e.item&&c.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!1}}})},[g,c,e.editorContent,e.item,null===(t=e.item)||void 0===t?void 0:t.key]);var C=(0,_e.a)(function(){return(0,a.Zd)(i,void 0,void 0,function(){var t,i,r,o,c;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,n.e(1).then(n.bind(n,619))];case 1:return t=a.sent().resourceKey,i=s.consumeAsync(t),r=null,e.item&&e.parentItem?[4,i]:[3,3];case 2:r=a.sent().evaluateAction({item:e.item,parentItem:e.parentItem}),a.label=3;case 3:return r&&r.onExecute&&e.item&&(o=new he.a({name:"OneUpLightSpeed.saveInvokedInEditor"}),null===(c=r.onExecute({qosEvent:o}))||void 0===c||c.then(function(){}).catch(function(e){})),[2]}})})}),O=(0,_e.a)(function(t){e.setEditorLoaded(!0),t.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KeyS,function(){C()},""),h.current=g,t.onDidChangeModelContent(function(){var n=t.getValue();if(void 0!==h.current&&n!==h.current&&e.item){D(n);var a=new Blob([n],{type:e.item.textEditorMimeType});a.name=e.item.name;var i={extension:e.item.extension,iconName:"text",name:(e.item.name||"")+e.item.extension,size:n.length,_file:a,slice:function(e,t){return a}},r=c.getViewerState(e.item.key);r&&r.saveData&&(r.saveData.fileUpload=i),r&&r.saveData&&r.saveData.saveButtonVisible||c.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!0,fileUpload:i}}})}else e.item&&n===g&&(D(n),c.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!1}}}))})}),w={wordWrap:"on",automaticLayout:!0,scrollbar:{alwaysConsumeMouseWheel:!1},minimap:{enabled:!m},readOnly:!e.isEditable,theme:u?"vs-dark":"vs"},E="OneUpTextFileContent_04a30d0d";return u||(E+=" ".concat("OneUpTextFileContentLight_04a30d0d")),p.createElement("div",{className:E,"data-automationid":"OneUpTextFile-Content"},p.createElement("div",{className:"OneUpTextFileTitle_04a30d0d","data-automationid":"OneUpTextFile-Title"},e.editorTitle),p.createElement("div",{className:"OneUpTextFileEditor_04a30d0d"},p.createElement(ya.a,{className:"oneUpTextEditor",editorDidMount:O,language:"plaintext",options:w,value:S||g,moduleType:Sa.a.ESM,getWorkerUrl:function(){return""},importESMModule:function(){return o.c.resolve(n.e(31).then(n.bind(n,649)))}})))}!function(e){e.Default="Default",e.OneUpTextFile="OneUpTextFile"}(va||(va={}));var Oa,wa=new H.hK({name:"EncodingProviderAsyncKey",loader:new H.vh(function(){return n.e(12).then(n.bind(n,648)).then(function(e){return e.resourceKey})})}),Ea=!H.HW.isActivated("5bbf5cba-aaed-483d-82d0-a2629a658259");function Aa(e){var t=this,n=(0,V.c)(),i=p.useState(""),r=i[0],s=i[1],c=p.useState(""),d=c[0],l=c[1],u=p.useState(!1),f=u[0],m=u[1],_=p.useState(Oa.shouldLoad),h=_[0],b=_[1],g=p.useState(!0),v=g[0],y=g[1],S=p.useState(!1),D=S[0],I=S[1],x=n.consume(R.a),C=n.consume(He.e),O=e.item,w=e.offset,E=e.fallbackToOtherViewer,A=e.parentItem,L=(0,_e.a)(function(e){0===w&&(C.updateErrorState("oneupTextViewer",{errorType:ge.d.viewerInitLoadingError,error:e,item:O}),E&&E(new Error("textViewerFailToLoad"),"TextViewer"))}),k=(0,_e.a)(function(t){if(t)h!==Oa.loaded&&b(Oa.loaded),v&&e.onViewerLoaded&&f&&(e.onViewerLoaded(),y(!1));else{var n=new Error("Error loading monaco editor");L(n)}}),M=(0,_e.a)(function(e){var i=e.extension?(0,ba.c)(e.extension):void 0;return o.c.resolve(n.consumeAsync(Ue.downloadDataSourceKey)).then(function(t){return t.getItemContents(e)}).then(function(e){return(0,a.Zd)(t,void 0,void 0,function(){var t,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return e&&i?Ea?[4,n.consumeAsync(wa)]:[3,2]:[3,3];case 1:return t=a.sent(),r=t.getEncoding(),[2,Fe.a(e,i,r)];case 2:return[2,Fe.c(e,i)];case 3:return[2]}})})}).then(function(e){s((null==e?void 0:e.text)||""),m(!0),I(!1)}).catch(function(e){L(e),I(!1)})}),P=(0,_e.a)(function(e){var t=e.displayName||e.name;l(t||"")});p.useEffect(function(){f&&h===Oa.loaded&&k(!0)},[k,h,f]),p.useEffect(function(){!f&&O&&(M(O),P(O)),setTimeout(function(){f||I(!0)},5e3)},[f,O,M,P,h]);var T=(0,_e.a)(function(){return(!O||!O.extension||".osts"!==O.extension)&&!!O&&function(e,t,n){var a;if(!tt.a.hasItemPermission(e,tt.a.editListItems))return!1;if(!t)return!1;var i=null===(a=null==n?void 0:n.list)||void 0===a?void 0:a.isForceCheckout;return!((0,ga.a)(e,t.userId)||i&&!(0,ga.b)(e,t.userId))}(O,x,e.list)}),U=p.createElement("div",{className:"OneUpTextFileContainer_04a30d0d"},p.createElement(Ca,{editorTitle:d,editorContent:f?r:void 0,isEditable:T(),setEditorLoaded:k,item:O,parentItem:A,closeCallback:e.closeCallback})),F=p.useRef();return F.current||(F.current={viewer:ve.a.TextFile,extension:O&&O.extension||"unknown"}),D&&!f&&(U=p.createElement(Cn,(0,a.W_)({mainViewerEngagementData:F.current,isMainViewer:!1},e))),U}!function(e){e[e.shouldLoad=0]="shouldLoad",e[e.loading=1]="loading",e[e.loaded=2]="loaded",e[e.error=3]="error"}(Oa||(Oa={})),(0,l.Bv)([{rawString:".OneUpWacFullScreen_19e64d4d{width:100%;height:100%;border:0}.OneUpWacNinetyPercent_19e64d4d{width:90%;height:100%;border:0;margin:auto}"}]);const La="OneUpWacFullScreen_19e64d4d";var ka,Ma=function(){function e(e,t){var n=t.platformDetection;this._wordAction=n.isMobile&&!n.isIPad?"mobileview":"embedview"}return e.prototype.getWopiFrameUrl=function(e,t){var n="ms-word"===e.appMap,a=e.wopiFrameUrl,i=n?this._wordAction:"embedview",r=a&&a.replace(/action=([^&]+)/,"action=".concat(i,"&wdnc=1&nobg=1&wdhostscenario=oneuplightspeed"));return r&&!H.Tb.isFeatureEnabled({ODB:60385})&&(r=null==r?void 0:r.concat("&bypassowl=true")),n&&!H.HW.isActivated("feaac491-2c3c-48e6-b23a-701bb912ce09")&&(r=null==r?void 0:r.concat("&wdignorefpo=1")),r?r.replace(/\/_layouts\/[^?]+/i,"/_layouts/15/".concat(t?"WopiEmbedFrame":"doc",".aspx")):void 0},e}(),Pa=(0,H.c7)("WopiFrameDataSource",Ma,{platformDetection:$.a}),Ta=new H.hK("wopiToken"),Ua=n(240),Fa=n(66),Ha=n(50),Ra=n(200);function Na(e){var t,n=!H.HW.isActivated("2c617684-fdeb-4e99-91af-9f322f25818d","7/18/2024","Killswitch to use channel message to communicate WAC page with parent frame")&&H.Tb.isFeatureEnabled({ODB:61620}),i=e.item,r=(0,V.c)(),o=r.consume(Pa),s=r.consume(Ta.optional),c=r.consume(He.e),d=r.consume(R.a),l=p.useState(!1),u=l[0],f=l[1],m=p.useState(),_=m[0],h=m[1],b=p.useState(""),g=b[0],v=b[1],y=p.createRef(),S=p.useRef(!1),D=p.useState(Math.random().toFixed(16))[0],I=p.useState(),x=I[0],C=I[1],O=function(t,n,r){c.updateErrorState("oneupWacViewer",{errorType:ge.d.viewerInitLoadingError,error:t,item:n,extraData:(0,a.W_)((0,a.W_)({},r),{extension:null==i?void 0:i.extension,appMap:null==i?void 0:i.appMap})}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(t,"WacViewer")},w=function(t,r,o,s,c,l){var u=he.b.Success,f=JSON.stringify(o);if(t)try{u=he.b[t]}catch(e){u=he.b.Failure,f="Additional Error: Failed to convert WAC Event Data resultType to known result type, using default of Failure. Original WAC errorInfo: "+f}var p={hostSessionId:s,loadResultSource:n?"wacChannelMessaging":"wacWindowPostMessage"};if(u!==he.b.Success||-1!==(null==t?void 0:t.toLowerCase().indexOf("failure"))){var m=new H.EI({code:r||"oneupWacLoadGenericFailure",message:f,correlationId:c||(null==d?void 0:d.CorrelationId),isExpected:u===he.b.ExpectedFailure,extraData:(0,a.W_)((0,a.W_)({},p),{stack:o?JSON.stringify(o):"",rawError:JSON.stringify(l)})});O(m,i,(0,a.W_)({},l))}else e.onViewerLoaded&&e.onViewerLoaded({extraData:(0,a.W_)((0,a.W_)({},p),l)})},E=function(e){var t,n,r,o;try{o=e.data}catch(t){var s=(0,ge.i)("Error loading Wac viewer iframe - cannot parse wac message","WacInitIframeError.ProcessWacMessage");return O(s,i,(0,a.W_)((0,a.W_)({},e),{e:t})),void(S.current=!0)}o.messageId===ka.WacHostInitialized&&w(null===(t=o.values)||void 0===t?void 0:t.resultType,null===(n=o.values)||void 0===n?void 0:n.resultCode,null===(r=o.values)||void 0===r?void 0:r.errorInfo,o.hostSessionId,o.correlationId||(null==d?void 0:d.CorrelationId),o),S.current=!0};p.useEffect(function(){i&&!u&&function(e){var t=void 0;if(s&&s.then(function(e){t=e}),i&&e&&""!==t){var a=o.getWopiFrameUrl(i,t);if(!a||/^javascript:\/\//i.test(a.trim()))return C=void 0,C=a?(0,ge.i)("wopiframeurl is not acceptable format","WacUrlFormatError"):(0,ge.i)("wopiframeurl is empty","WacUrlEmptyError"),void O(C,i);var r=Ua.a(d);r&&(a+="&wdorigin="+encodeURIComponent(String(r)));var c="OfficeDocClickTime",l=new Fa.a("",Ha.a.local),u=l.getValue(c,Ha.a.session),p=u?new Date(u):void 0;l.setValue(c,"",Ha.a.session),p&&(a+="&CT="+encodeURIComponent(String(p)));var m=new Ra.b,_=m&&m.viewParams.uih;_&&(a+="&uih="+_);var b=new URL(a).origin;if(v(b),n){var S={wdskipfccheck:"true",appName:"OneUp",origin:window.location.origin,channelId:D,app:"OneUp",scenario:"OneUpWacViewer"};a+=new URLSearchParams(S)}if(t){var I=m&&m.viewParams.EmbeddingPageOrigin,x=m&&m.viewParams.EmbeddingPageSessionInfo;!function(e){var t,n;if(y&&(null===(t=y.current)||void 0===t?void 0:t.contentDocument)){var a=y&&(null===(n=y.current)||void 0===n?void 0:n.contentDocument);a.body||a.createElement("body");var r=a.createElement("form");r.action=e.url,r.method="POST",r.style.visibility="hidden",r.target="_self";var o=e.postdata;for(var s in o)if(s&&o[s]){var c=a.createElement("input");c.type="hidden",c.name=s,c.value=o[s],r.appendChild(c)}a.body.appendChild(r),r.submit(),f(!0)}else{var d=(0,ge.i)("missing iframe reference for form post","WacIFrameReferenceError");O(d,i)}}({url:a,postdata:{access_token:t,EmbeddingPageOrigin:I||g,EmbeddingPageSessionInfo:x||""}})}else h(a),f(!0)}else{var C=(0,ge.i)("missing item or wopitokenval","WacItemOrTokenError");O(C,i)}}(i)},[u,i,s]),p.useEffect(function(){var e,t,a=null===(e=null==y?void 0:y.current)||void 0===e?void 0:e.contentWindow;function i(e){if(e.source&&a&&e.source===a){var t=e.data;if("initialize"===t.type&&t.channelId===D){var n=e.ports[0];n&&C(n)}}}if(n&&!x&&a)return t=window.setInterval(function(){a.postMessage({type:"identify-parent",channelId:D},g)},1e3),window.addEventListener("message",i),function(){t&&(clearInterval(t),t=void 0),window.removeEventListener("message",i)}},[x,y,_,D,n,g]),p.useEffect(function(){function e(e){!function(e){var t,n,a;if("notification"===e.type){var i=e.data;"page-loaded"===i.notification&&w(null===(t=i.result)||void 0===t?void 0:t.resultType,null===(n=i.result)||void 0===n?void 0:n.resultCode,null===(a=i.result)||void 0===a?void 0:a.errorInfo,i.hostSessionId,i.correlationId||(null==d?void 0:d.CorrelationId),i)}S.current=!0}(e.data)}if(x&&n)return x.addEventListener("message",e),x.start(),x.postMessage({type:"activate"}),function(){x.removeEventListener("message",e)}},[x,n]),p.useEffect(function(){n||window.addEventListener("message",E,!1)},[]),p.useEffect(function(){return function(){n||window.removeEventListener("message",E,!1)}},[]);var A=(0,_e.a)(function(){var e=24e4;setTimeout(function(){if(!S.current){var t=(0,ge.i)("Error loading Wac viewer iframe - no response from wac in callbacktimeout ".concat(e,"ms"),"WacInitIframeError.WacCallbackTimeout");O(t,i)}},e)}),L=(0,_e.a)(function(){A()}),k=(0,_e.a)(function(){if(0===e.offset){var t=(0,ge.i)("Error loading Wac viewer iframe","WacInitIframeError.IFrameLoadError");O(t,i)}}),M=e.isFallback?"fallback":"",P="ms-excel"===(null===(t=e.item)||void 0===t?void 0:t.appMap),T=u&&i?p.createElement("div",{className:"oneup-wac-container ".concat(P?"OneUpWacNinetyPercent_19e64d4d":La," ").concat(M),"data-automation-id":"oneup-wac-container"},p.createElement("iframe",{"data-automation-id":"oneup-wac-frame",className:"oneup-wac-frame ".concat(La),ref:y,title:i.name,onLoad:L,onError:k,src:_})):p.createElement(p.Fragment,null);return(0,Ct.vb)()?0===e.offset?T:p.createElement(p.Fragment,null):T}!function(e){e.WacHostInitialized="WacHost_initialized"}(ka||(ka={}));var Ba=function(){function e(e,t){this._makeXHR=t.makeXHR||Me.a.start,this._offlineDetection=t.offlineDetection}return e.prototype.getContents=function(e,t){var n=this,i=new he.a({name:"OneUpZipDataSourceGetContents"});return this._makeXHR({url:t}).then(function(t){var n=t.status;if(!(n>=200&&n<300)){var r={code:"".concat(n,".InvalidStatus"),message:"getContents xhr status unacceptable range",status:n,statusText:t.statusText,responseType:t.responseType,response:t.response,responseTxt:t.responseText};return i.end({resultType:he.b.Failure,extraData:(0,a.W_)({},r)}),o.c.reject(t)}try{var s=JSON.parse(t.responseText).metadata,c=s.delimiter,d=s.error,l=s.list,u=void 0===l?[]:l;return e.dateModified&&e.extension&&e.name&&i.end({resultType:he.b.Success}),{delimiter:c,error:d,root:{children:u,date:e.dateModified||"",extension:e.extension||"",isFolder:!0,name:e.name||"",childCount:u.length,parentFolder:void 0,path:"",size:0}}}catch(e){return i.end({resultType:he.b.ExpectedFailure,extraData:{e,code:"".concat(n,".InvalidResponse")}}),o.c.reject(new H.EI({code:"".concat(n,".InvalidResponse"),message:e&&e.message,correlationId:ja(t),isExpected:!0,extraData:{responseText:t.responseText}}))}}).catch(function(e){if(e instanceof H.EI)return i.end({resultType:he.b.Failure,extraData:{error:e,code:"".concat(e.code,".XhrExceptionApiErr")}}),o.c.reject(e);var t,a=!1,r=e&&e.message,s="GetZipContents";if(e instanceof XMLHttpRequest){var c=e&&e.status;a=!!c&&c>=400&&c<500,c&&!n._offlineDetection.offline||(a=!0),t=ja(e),s=e.getResponseHeader("X-ErrorCode")||"";try{for(var d=JSON.parse(e.responseText),l=d&&d.error;l.innererror;)l=l.innererror;l&&(r=l.message,s=l.code)}catch(t){r=e.responseText?"Invalid JSON response":"Empty response",a=!0}s="".concat(c,".").concat(s)}return i.end({resultType:a?he.b.ExpectedFailure:he.b.Failure,extraData:{code:"".concat(s,".XhrException"),error:e,resultCode:s,errorMessage:r,correlationId:t}}),o.c.reject(new H.EI({code:s,message:r,isExpected:a,correlationId:t,extraData:{responseText:e instanceof XMLHttpRequest?e.responseText:""}}))})},e}();function ja(e){return e.getResponseHeader("X-CorrelationId")||void 0}var Va=(0,H.c7)("OneUpZipDataSource",Ba,{makeXHR:void 0,offlineDetection:un.a}),za=n(564);(0,l.Bv)([{rawString:".OneUpZipContainer_cf15865b{margin:auto;margin-top:20px;box-shadow:0 0 7px 2px rgba(0,0,0,.15);display:flex;flex-direction:column;max-width:780px;min-width:70%;height:95%}.OneUpZipHeader_cf15865b{height:130px;display:flex;min-height:130px;justify-content:center;position:relative}.OneUpZipImage_cf15865b{height:130px;width:135px}.OneUpZipNumber_cf15865b{position:absolute;top:83px;font-size:medium;width:113px}html[dir=ltr] .OneUpZipNumber_cf15865b{text-align:right}html[dir=rtl] .OneUpZipNumber_cf15865b{text-align:left}.OneUpZipList_cf15865b{padding:0 20px;overflow:auto}"}]);var Ga=n(572);(0,l.Bv)([{rawString:".odZipContentListBreadcrumb_fe46f3dc{margin-bottom:20px}.odZipContentListLink_fe46f3dc{cursor:pointer;text-decoration:none;font-size:12px}.odZipContentListLink_fe46f3dc:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}"}]);var Ka=n(566),Wa=n(325),qa=n(84),Qa=n(567),Ya=n(327),Ja=n(268),Xa=n(321),Za=n(565),$a=n(18),ei=n(315),ti=function(e){function t(t){var n=e.call(this,t)||this,a=t.root;n._onItemInvoked=n._onItemInvoked.bind(n),n._onBreadcrumbClick=n._onBreadcrumbClick.bind(n),n._onDetailsListUpdated=n._onDetailsListUpdated.bind(n),n._columns=n._getAllColumns(),n.state={ancestors:[a],crumbs:n._appendBreadcrumb([],a.name),initialLoadComplete:!1};var i=n._selection=new Wa.a({selectionMode:qa.c.single,onSelectionChanged:function(){var e=n.state.ancestors;n.props.onSelect(i.getSelection(),e[e.length-1])}});return i.setItems(a.children,!0),n}return(0,a.XJ)(t,e),t.prototype.render=function(){var e=!!this.props.allowSelection,t=this.state.ancestors,n=this.state.crumbs.reduce(function(e,t){return e?H.OO(Za.a,t.text,e):t.text},""),a=t[t.length-1].childCount,i=H.Ot(Za.i,Za.h,a),r=i?H.OO(i,a):"";return p.createElement(Ja.a,null,p.createElement(Ka.a,{className:"odZipContentListBreadcrumb_fe46f3dc",ariaLabel:H.OO(Za.b,n),items:this.state.crumbs,maxDisplayedItems:5}),p.createElement(Qa.a,{className:"od-ZipContent-DetailsList",items:t[t.length-1].children,columns:this._columns,checkboxVisibility:e?Ya.a.onHover:Ya.a.hidden,selectionMode:e?qa.c.multiple:qa.c.none,layoutMode:Ya.e.fixedColumns,onItemInvoked:this._onItemInvoked,selection:this._selection,constrainMode:Ya.d.horizontalConstrained,selectionPreservedOnEmptyClick:!0,ariaLabel:r,onDidUpdate:this._onDetailsListUpdated}))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;this.props!==e&&e.root!==this.props.root&&this.setState(function(e,n){var a=n.root;return t._selection.setItems(a.children,!0),{ancestors:[a],crumbs:t._appendBreadcrumb([],a.name)}})},t.prototype._onDetailsListUpdated=function(){this.state.initialLoadComplete||(this.setState({initialLoadComplete:!0}),this.props.onLoad&&this.props.onLoad())},t.prototype._onItemInvoked=function(e){var t=this;e.isFolder&&this.setState(function(n){var i=n.crumbs,r=i.length;return t._selection.setItems(e.children,!0),t.props.onNavigate(e),{ancestors:n.ancestors.concat([e]),crumbs:t._appendBreadcrumb((0,a.AE)((0,a.AE)([],i.slice(0,-1),!0),[(0,a.W_)((0,a.W_)({},i[r-1]),{isCurrentItem:!1})],!1),e.name)}})},t.prototype._onBreadcrumbClick=function(e,t){var n=this;if(t){var a=parseInt(t.key,10);this.setState(function(e){var t=e.ancestors[a];return n._selection.setItems(t.children,!0),n.props.onNavigate(t),{ancestors:e.ancestors.slice(0,a+1),crumbs:n._appendBreadcrumb(e.crumbs.slice(0,a),t.name)}})}else console.log("no item available for breadCrumbClick")},t.prototype._appendBreadcrumb=function(e,t){var n=e.length;return(0,a.AE)((0,a.AE)([],e,!0),[{text:t,key:"".concat(n),isCurrentItem:!0,onClick:this._onBreadcrumbClick}],!1)},t.prototype._getAllColumns=function(){return[{key:"zipIcon",fieldName:void 0,minWidth:20,maxWidth:20,name:"",onRender:ni.bind(this)},{key:"zipName",fieldName:void 0,isResizable:!0,minWidth:200,name:Za.d,onRender:ai.bind(this,"name")},{key:"zipDateModified",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:Za.c,onRender:ai.bind(this,"date")},{key:"zipFileSize",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:Za.e,onRender:function(e,t,n){return e?p.createElement("div",null,e.size?Ga.a.getDisplayString(e.size,{language:$e.a.language,ignoreZero:!0}):""):p.createElement(p.Fragment,null)}}]},t}(p.Component);function ni(e,t,n){if(!e)return p.createElement(p.Fragment,null);var i=e.extension,r={extension:i,size:20,type:e.isFolder?l.qw.folder:void 0},o=(0,ei.a)(r);return p.createElement($a.a,(0,a.W_)({},o,{style:{width:"20px",height:"20px"},title:e.isFolder?Za.f:H.OO(Za.g,i)}))}function ai(e,t,n,a){var i=this;return t?"name"===e&&!0===t.isFolder?p.createElement(Xa.a,{className:"odZipContentListLink_fe46f3dc",onClick:function(){return i._onItemInvoked(t)}},t[e]):p.createElement("div",null,t[e]):p.createElement(p.Fragment,null)}const ii=ti;var ri=n(502);function oi(e){var t=e.item,n=(0,V.c)(),i=n.consume($.a).isRetinaSupported,r=n.consume(He.e),o=p.useState(!1),s=o[0],c=o[1],d=p.useState(),l=d[0],u=d[1],f=p.useState(),m=f[0],_=f[1],h=window.require,b=(null==h?void 0:h.toUrl)&&(null==h?void 0:h.toUrl("odsp-media/images/oneupzip/zipicon.svg")),g=p.useContext(ri.d),v={extension:(null==t?void 0:t.extension)||"unkown",viewer:ve.a.Zip,engagementContext:g},y=function(e,t){},S=function(e){u(e.childCount),(0,ri.g)("".concat(ri.c,".").concat("ZipNavigateNested"),v)};p.useEffect(function(){!s&&t&&function(a){var o=a.zip&&a.zip.zipMetaDataUrl,s=n.consume(Va);if(!o){var d=(0,ge.i)("zip url is null","ZipEmptyMetadataUrl");return r.updateErrorState("oneupZipViewer",{errorType:ge.d.viewerInitLoadingError,error:d,item:t}),void(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(d,"ZipViewer"))}var l=(0,In.a)(o)?(0,Oe.a)(ve.a.Zip):void 0,f={url:o};s.getContents(a,o).then(function(n){if(!n||n.error&&""!==n.error){var a=(0,ge.i)(n.error||"Missing zip contents","ZipErrorRetrievingContents");return r.updateErrorState("oneupZipViewer",{errorType:ge.d.viewerInitLoadingError,error:a,item:t,meTAQos:l,extraData:f}),void(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(a,"ZipViewer"))}u(n.root.childCount),_({allowSelection:!1,root:n.root,onNavigate:S,onSelect:y,isRetinaEnabled:i,onLoad:function(){e.onViewerLoaded&&e.onViewerLoaded({meTAQos:l,extraData:f})}}),c(!0)})}(t)},[s,t]);var D=(0,Jn.a)().palette;return s&&t&&m?p.createElement("div",{className:"OneUpZipContainer_cf15865b",style:{backgroundColor:null==D?void 0:D.white}},p.createElement("div",{className:"OneUpZipHeader_cf15865b",style:{backgroundColor:null==D?void 0:D.neutralLight},role:"heading"},p.createElement("img",{className:"OneUpZipImage_cf15865b",src:b,alt:za.a}),p.createElement("span",{className:"OneUpZipNumber_cf15865b",style:{color:null==D?void 0:D.white}},l)),p.createElement("div",{className:"OneUpZipList_cf15865b",style:{backgroundColor:null==D?void 0:D.white},role:"presentation","data-is-scrollable":"true"},p.createElement(ii,(0,a.W_)({},m)))):p.createElement(p.Fragment,null)}(0,l.Bv)([{rawString:".container{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}.od-Error{text-align:center;position:absolute}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}]);var si=n(506);function ci(e){var t,n=(0,V.c)().consume(He.e),a=e.errorTitle,i=e.errorDetailedText,r=e.correlationId,o=e.errorCode,s=e.actionUrl,c=e.actionText,d=(t=0===(t=Math.ceil(3*Math.random()))?1:t,window.require.toUrl("odsp-media/images/error/error".concat(t,".svg"))),l=p.useCallback(function(){window.open(s,"_blank")},[s,!0]);return p.useEffect(function(){e.itemKey&&n.updateViewerState("errorViewerAfterDelete",{key:e.itemKey,options:{showMainCommands:!1,showTitle:!0}})},[n,e.itemKey]),p.createElement("div",{className:"container"},p.createElement("div",{className:"od-Error"},p.createElement("div",{className:"od-Error-image"},p.createElement("img",{className:"od-Error-imageTag",src:d,alt:a})),p.createElement("div",{role:"alert"},p.createElement("p",{className:"od-Error-title"},a),i&&p.createElement("p",{className:"od-Error-subText"},i),r&&p.createElement("p",{className:"od-Error-code"},H.OO(si.b,r)),o&&p.createElement("p",{className:"od-Error-code"},H.OO(si.a,o)),s&&p.createElement("p",{className:"od-Error-code"},p.createElement(jn.d,{href:s,text:c,onClick:l})))))}var di=n(231);(0,l.Bv)([{rawString:".OneUpFileHandlerIFrame_2477f919{width:100%;height:100%;border:0}"}]);var li=n(513);function ui(e){var t,n=(0,He.f)("currentState",function(e){return e.fileHandlerOptions?e.fileHandlerOptions.data.actions.preview:void 0})[0],a=p.useState(),i=a[0],r=a[1],o=(0,V.c)(),s=o.consume(di.a),c=o.consume(He.e),d=o.consume(R.a),l=p.createRef(),u=d.userLoginName,f=d.currentUICultureName||d.currentCultureName||"en-US",m=p.useState(!1),_=m[0],h=m[1],b=(0,_e.a)(function(){_||(e.onViewerLoaded&&e.onViewerLoaded(),h(!0))}),g=(0,_e.a)(function(t){0===e.offset&&(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error("FileHandlerIframeLoadError"),"FileHandlerViewer"),c.updateErrorState("oneupFileHandlerViewer",{errorType:ge.d.viewerInitLoadingError,error:t,item:e.item}))});return p.useEffect(function(){n&&e.item&&s.getCorrespondingPreviewFileHandlerPostData(e.item).then(function(e){e&&(r(e),b())}).catch(function(e){g(e)})},[null===(t=e.item)||void 0===t?void 0:t.key,n,s,b,g]),p.useEffect(function(){var e;if(l&&(null===(e=l.current)||void 0===e?void 0:e.contentDocument)&&i)try{var t={cultureName:f,client:"OneUp",domainHint:"organizations",userId:u,appId:i.handler.appId,items:JSON.stringify(i.itemUrls)};(0,li.a)({url:i.url,postdata:t,document:l.current.contentDocument})}catch(e){g(e)}},[l,i,u,f,g]),p.createElement("iframe",{className:"OneUpFileHandlerIFrame_2477f919",ref:l,allow:"clipboard-read; clipboard-write",sandbox:"allow-scripts allow-same-origin allow-forms allow-top-navigation allow-popups allow-popups-to-escape-sandbox"})}var fi=n(503);function pi(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return"".concat(1<<t%10,"-").concat(1<<t%10+1).concat(t<10?" B":" ".concat("KMGTPEZY"[t/10-1|0],"iB"))}function mi(e){var t,i=this,r=e.item,o=(0,V.c)(),s=p.useContext(ri.d),c=o.consume(ye.c.optional),d=p.useRef(o.consume(ve.b)),l=o.consume(Q.c),u=p.useState(!1),f=u[0],m=u[1],_=d.current.getValidViewerTypes,h=p.useState(_(r)),b=h[0],g=h[1],v=o.consume(fi.a),y=p.useRef(void 0);p.useEffect(function(){e.setIsLoaded(!0)},[e]);var S=(0,He.f)("currentState",function(e){return e.viewerStates})[0],D=(0,He.f)("currentState",function(e){return e.deletedKeys})[0],I=(0,He.f)("currentState",function(e){return e.imageMode===He.c.edit})[0],x=(0,He.f)("currentState",function(e){return e.fileHandlerOptions})[0];p.useEffect(function(){g(_(r))},[x,r,_]);var C=null==S?void 0:S.get(r.key),O=p.useRef(),w=(0,_e.a)(function(t){var n,i,c,d,u=o.consume(ye.e.optional),f=r?v.evaluateAction({item:r}):void 0;s.isCopilotAvailable=null==f?void 0:f.isAvailable;var p=(null==t?void 0:t.extraData)||{},m=p.url,_=(0,a.l7)(p,["url"]),h=we(m);if(0!==e.offset&&e.offset||!u)u&&(0,ri.g)("".concat(ri.c,".").concat(ri.f),{extension:r.extension||"unknown",viewer:b,isInitalLoad:!1,engagementContext:s});else{var g=o.consume(ne.b),y=null===(n=g.focusItemSet)||void 0===n?void 0:n.map(function(e){var t;return null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.uniqueId});u({viewer:b,extension:r.extension,isCrossList:l.getItemUrlParts(r.key).isCrossList,fileSizeRange:pi(r.size),euplBreakDownData:null===(i=null==t?void 0:t.perfData)||void 0===i?void 0:i.euplBreakDownData,extraPerfData:null===(c=null==t?void 0:t.perfData)||void 0===c?void 0:c.extraPerfData,extraData:(0,a.W_)((0,a.W_)({},_),h),itemSetIds:y,focusItemUniqueId:null===(d=null==r?void 0:r.properties)||void 0===d?void 0:d.uniqueId,index:g.currentIndex}),(0,ri.g)("".concat(ri.c,".").concat(ri.f),{extension:r.extension||"unknown",viewer:b,isInitalLoad:!0,engagementContext:s})}(null==t?void 0:t.meTAQos)&&(0,Oe.c)(t.meTAQos,(0,a.W_)({},h))}),E=(0,_e.a)(function(t){var n,a,i=o.consume(ye.d.optional);0!==e.offset&&e.offset||!i||i({viewer:b,extension:r.extension,isCrossList:l.getItemUrlParts(r.key).isCrossList,fileSizeRange:pi(r.size),euplBreakDownData:null===(n=null==t?void 0:t.perfData)||void 0===n?void 0:n.euplBreakDownData,extraPerfData:null===(a=null==t?void 0:t.perfData)||void 0===a?void 0:a.extraPerfData})}),A=(0,_e.a)(function(t,n){0!==e.offset||f||(y.current=new Ce({scenario:"OneUpLightSpeed.fallBackToOtherViewer",perfGoalInMs:ge.c,extraData:{errorMessage:t.message,from:n,extension:r.extension,isFastOneUp:c}}),m(!0))});(c||I)&&e.setIsPanningEnabled?e.setIsPanningEnabled(!1):0===e.offset&&e.setIsPanningEnabled&&(b===ve.a.Thumbnail||b===ve.a.Photo||b===ve.a.Other?e.setIsPanningEnabled(!0):e.setIsPanningEnabled(!1));var L=(0,a.W_)((0,a.W_)({},e),{viewerType:b,onViewerLoaded:w,onLogFullPageRumone:E,fallbackToOtherViewer:A}),k=function(t){var o=t.viewerType,s=t.key,c=t.offset,d=t.mode,l=t.parentItem,u=t.list,f=t.isFallBackToOtherViewer,m=t.deletedKeysMap,_=t.errorViewerDisplayName,h=p.createElement(p.Fragment,null);if(O.current||(O.current={viewer:b,extension:r.extension||"unknown"}),m&&m.get(s))h=p.createElement(ci,{errorTitle:ot.Ub,itemKey:s,fileName:_});else if(f)h=p.createElement(ea,(0,a.W_)({},L,{isErrorFallBack:!0,fallbackCxpRef:y}));else if(0===c||o!==ve.a.MSPdf&&o!==ve.a.ThreeD&&o!==ve.a.TextFile)switch(o){case ve.a.FileHandler:h=p.createElement(ui,(0,a.W_)({},L));break;case ve.a.Html:h=d&&d===He.b.edit?p.createElement(Aa,(0,a.W_)({},L)):p.createElement(Ne,(0,a.W_)({},L));break;case ve.a.Image360:var g=(0,lt.a)(function(){return(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(36)]).then(n.bind(n,640))];case 1:return[2,e.sent().OneUpImage360Viewer]}})})});h=p.createElement(g,(0,a.W_)({},L));break;case ve.a.MSPdf:u&&l&&(h=p.createElement(Nn,(0,a.W_)({},L)));break;case ve.a.Photo:h=p.createElement(ha,(0,a.W_)({},L));break;case ve.a.TextFile:h=p.createElement(Aa,(0,a.W_)({},L));break;case ve.a.ThreeD:if((0,Ct.Z)(Ct.Db)){var v=(0,lt.a)(function(){return(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(32)]).then(n.bind(n,641))];case 1:return[2,e.sent().OneUp3DViewer]}})})});h=p.createElement(v,(0,a.W_)({},L))}else v=(0,lt.a)(function(){return(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(32)]).then(n.bind(n,642))];case 1:return[2,e.sent().OneUp3DViewer]}})})}),h=p.createElement(v,(0,a.W_)({},L));break;case ve.a.WAC:h=p.createElement(Na,(0,a.W_)({},L));break;case ve.a.Zip:h=p.createElement(oi,(0,a.W_)({},L));break;case ve.a.Copilot:var S=(0,lt.a)(function(){return(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(34)]).then(n.bind(n,643))];case 1:return[2,e.sent().OneUpCopilotViewer]}})})});h=p.createElement(S,(0,a.W_)({},L));break;case ve.a.OnePlayerVideo:case ve.a.OnePlayerAudio:if(0===c){var D=(0,lt.a)(function(){return(0,a.Zd)(i,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(40).then(n.bind(n,644))];case 1:return[2,e.sent().OneUpVideoViewer]}})})});h=p.createElement(D,(0,a.W_)({},L));break}h=p.createElement(ea,(0,a.W_)({},L,{isErrorFallBack:!1,fallbackCxpRef:y}));break;case ve.a.Error:var I=(0,a.W_)({},e.item.error);p.createElement(ci,(0,a.W_)({},I));break;case ve.a.Thumbnail:h=p.createElement(Cn,(0,a.W_)({isMainViewer:!0,mainViewerEngagementData:O.current},L));break;default:h=p.createElement(ea,(0,a.W_)({},L,{isErrorFallBack:!1,fallbackCxpRef:y}))}else h=p.createElement(Cn,(0,a.W_)({isMainViewer:!1,mainViewerEngagementData:O.current},L));return h},M={viewerType:b,key:e.item.key,offset:e.offset,mode:null==C?void 0:C.htmlMode,parentItem:e.parentItem,list:e.list,isFallBackToOtherViewer:f,deletedKeysMap:D,errorViewerDisplayName:e.item.displayName},P=p.useMemo(function(){return k(M)},[b,e.item.key,e.offset,null==C?void 0:C.htmlMode,e.parentItem,e.list,f,D,e.item.displayName,null===(t=e.item.thumbnail)||void 0===t?void 0:t.url]);return(0,Ct.tb)()?P:k(M)}var _i=n(574);function hi(e,t,n){return(0,a.Zd)(this,void 0,void 0,function(){var i,r,o;return(0,a.qr)(this,function(a){return i=t.consume(ye.a.optional),r=t.consume(N.a),(0,Ct.mb)()&&i?(o=i.getDefaultClickUrl(e,n),r.navigateTo({url:o,ignoreHistory:!0}),[2,{resultType:he.b.Success}]):[2,t.consumeAsync(an.a).then(function(a){var i=t.consume(He.e);(null==n?void 0:n.hasNavigationBlock)||i.navClean();var o=a.getDefaultClickUrlForOneUp(e,n);return r.navigateTo({url:o,ignoreHistory:!0}),{resultType:he.b.Success}}).catch(function(){return{resultType:he.b.Failure}})]})})}var bi=n(500),gi=n(501),vi="PreviousAction",yi={oneUpStore:ne.b,navigation:N.a,resources:H.Ci,oneUpStateStore:He.e,oneUpLoadingCustomerPromiseFunctions:Ae},Si=new H.hK({name:"PreviousAction",factory:{dependencies:yi,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i=t.oneUpStore.getOneUpProperties(),r={isDisabled:(n=i,!(n&&n.currentIndex&&n.focusItemSet&&n.focusItemSet.length)||0===n.currentIndex),isAvailable:!!i,id:vi,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,r,o;return(0,a.qr)(this,function(a){switch(a.label){case 0:return i&&i.currentIndex&&i.focusItemSet&&i.focusItemSet.length?(e=i.focusItemSet[i.currentIndex-1],t.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:fe.previous,newItem:e}}),[4,hi(e,t.resources,{parentItem:(0,Ct.mb)()&&(null===(r=i.parentStoreKey)||void 0===r?void 0:r.key)?{key:null===(o=i.parentStoreKey)||void 0===o?void 0:o.key}:i.parentItem,urlType:"focus"})]):[3,2];case 1:return a.sent(),[2,{resultType:he.b.Success}];case 2:throw n=(0,ge.i)("no focusItemSet"),t.oneUpStateStore.updateErrorState(vi,{errorType:ge.d.actionError,error:n,item:void 0}),n}})})}};return r})};return{instance:n}}}}),Di="NextAction",Ii={oneUpStore:ne.b,navigation:N.a,resources:H.Ci,oneUpStateStore:He.e,oneUpLoadingCustomerPromiseFunctions:Ae},xi=new H.hK({name:"NextAction",factory:{dependencies:Ii,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i=t.oneUpStore.getOneUpProperties(),r={isDisabled:(n=i,!(n&&void 0!==n.currentIndex&&n.focusItemSet&&n.focusItemSet.length)||n.currentIndex+1>=n.focusItemSet.length),isAvailable:!!i,id:Di,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,r,o;return(0,a.qr)(this,function(a){switch(a.label){case 0:return i&&void 0!==i.currentIndex&&i.focusItemSet&&i.focusItemSet.length?(e=i.focusItemSet[i.currentIndex+1])?(t.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:fe.next,newItem:e}}),[4,hi(e,t.resources,{parentItem:(0,Ct.mb)()&&(null===(r=i.parentStoreKey)||void 0===r?void 0:r.key)?{key:null===(o=i.parentStoreKey)||void 0===o?void 0:o.key}:i.parentItem,urlType:"focus"})]):[3,2]:[3,4];case 1:return a.sent(),[2,{resultType:he.b.Success}];case 2:return[2,{resultType:he.b.Failure,extraData:{errorType:"noNextItem"}}];case 3:return[3,5];case 4:throw n=(0,ge.i)("no focusItemSet"),t.oneUpStateStore.updateErrorState(Di,{errorType:ge.d.actionError,error:n,item:void 0}),n;case 5:return[2]}})})}};return r})};return{instance:n}}}}),Ci=n("fui.core_421"),Oi=!H.HW.isActivated("2beb39f3-1076-486e-b9a7-e673102fc285"),wi=(0,Ci.fsl)(),Ei="oneUpCarousel";function Ai(e){var t=this,n=(0,V.c)(),i=(0,gi.a)(),r=p.useContext(ri.d),o=p.useState(!1),s=o[0],c=o[1],d=p.useState(!0),l=d[0],u=d[1],f=p.useState(),m=f[0],_=f[1],h=p.useRef(""),b=p.useRef(n.consume(ve.b)).current.getValidViewerTypes,g=n.consume(Si),v=(null==i?void 0:i.focusItem)?g.evaluateAction({item:null==i?void 0:i.focusItem}):void 0,y=n.consume(xi),S=(null==i?void 0:i.focusItem)?y.evaluateAction({item:null==i?void 0:i.focusItem}):void 0,D=v?{id:"previousCommandNewDesign",action:v}:void 0,I=S?{id:"nextCommandNewDesign",action:S}:void 0;l&&((0,ri.g)("".concat(ri.c,".Load"),{isInitalLoad:!0,viewer:ve.a.Unknown,extension:"unknown",engagementContext:r}),u(!1));var x,C=(0,He.f)("currentState",function(e){return e.imageMode!==He.c.edit&&[Qe.a.Edit,Qe.a.Esign].every(function(t){return t!==e.pdfAppMode})&&!e.eSignData.isCreateSidePanelActive})[0],O=p.useCallback(function(e){c(e)},[]),w=p.useCallback(function(t){return t&&(null==t?void 0:t.item)&&t.item.parentItem&&t.item.listItem?p.createElement(mi,{item:t.item.currentItem,parentItem:t.item.parentItem,list:t.item.listItem,offset:t.offset,itemIndex:t.itemIndex,setIsLoaded:t.setIsLoaded,setIsPanningEnabled:O,closeCallback:e.closeCallback}):null},[]),E=(x=i)?{key:x.focusItem.key,currentItem:x.focusItem,parentItem:x.parentItem,listItem:x.list}:void 0,A=(0,a.W_)({extension:(null==E?void 0:E.currentItem.extension)||"",viewer:(null==E?void 0:E.currentItem)?b(null==E?void 0:E.currentItem):ve.a.Unknown},r),L=p.useRef(),k=p.useState(),M=k[0],P=k[1],T=p.useCallback(function(e){Oi&&(P(e),L.current&&clearTimeout(L.current),L.current=setTimeout(function(){P(void 0),L.current=void 0},500))},[]),U=(0,_e.a)(function(e,i,r){return(0,a.Zd)(t,void 0,void 0,function(){var t,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return t={parentItem:null==e?void 0:e.parentItem,urlType:"focus"},A.commandName="UnknownItemInvoked",(i=r)&&i.key===(wi?"ArrowLeft":"ArrowRight")?(T("next"),A.commandName=null==I?void 0:I.id):i&&i.key===(wi?"ArrowRight":"ArrowLeft")&&(T("previous"),A.commandName=null==D?void 0:D.id),(0,ri.g)("".concat(ri.c,".").concat(ri.a),A),e?[4,hi(e.currentItem,n,t)]:[3,2];case 1:return a.sent(),[3,2];case 2:return[2]}})})});return p.useEffect(function(){E&&(h.current=H.OO(bi.d,null==E?void 0:E.currentItem.displayName),m||_(E))},[E,m]),p.createElement("div",{className:Le.H},p.createElement("div",{"aria-live":"polite","tab-index":"-1",role:"alert",className:Le.b},h.current),C&&D&&D.action.isAvailable&&function(e,t,n){return p.createElement("div",{className:Le.I},p.createElement(zn,{command:e,onClickCallback:function(){return ki(e.id,t)},text:"ChevronLeft",buttonType:Bn.iconButton,updateErrorStateCallBack:function(){},toolTipText:bi.b,isActive:n}))}(D,A,"previous"===M),p.createElement(_i.a,{rootProps:{id:Ei,role:"main"},items:Li(i),item:E,onRenderSlide:w,onItemInvoked:U,isEnabled:s,slideAllocationCount:5}),C&&I&&I.action.isAvailable&&function(e,t,n){return p.createElement("div",{className:Le.a},p.createElement(zn,{command:e,onClickCallback:function(){return ki(e.id,t)},text:"ChevronRight",buttonType:Bn.iconButton,updateErrorStateCallBack:function(){},toolTipText:bi.a,isActive:n}))}(I,A,"next"===M))}function Li(e){var t=[];if(e&&e.focusItemSet&&e.focusItemSet.length>0)for(var n=0;n<e.focusItemSet.length;n++)t.push({key:e.focusItemSet[n].key,currentItem:e.focusItemSet[n],parentItem:e.parentItem,listItem:e.list});return t}function ki(e,t){t.commandName=e||"UnknownClicked",(0,ri.g)("".concat(ri.c,".").concat(ri.a),t)}var Mi=new H.hK({name:"OpenInfoPaneActionAsync.key",loader:new H.vh(function(){return n.e(43).then(n.bind(n,674)).then(function(e){return e.openInfoPaneActionKey})})}),Pi=new H.hK({name:"VersionHistoryActionExecutorAsync.key",loader:new H.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(61)]).then(n.bind(n,682)).then(function(e){return e.versionHistoryActionExecutorKey})})}),Ti=new H.hK({name:"CommentsPaneActionAsync.key",loader:new H.vh(function(){return n.e(4).then(n.bind(n,679)).then(function(e){return e.commentsPaneActionKey})})}),Ui=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(38).then(n.bind(n,687))];case 1:return[2,e.sent().OneUpRightPaneWithError]}})})});function Fi(){var e=this,t=(0,V.c)(),n=(0,He.f)("currentState",function(e){return e.rightPane})[0],i=t.consume(He.e),r=(0,gi.a)(),o=null==r?void 0:r.focusItem,s=(0,_e.a)(function(n){return(0,a.Zd)(e,void 0,void 0,function(){var e,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,t.consumeAsync(Mi)];case 1:return e=a.sent(),(i=e.evaluateAction({item:n})).isAvailable&&i.onExecute?[4,i.onExecute({qosEvent:new he.a({name:"openInfoPane"})})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})}),c=(0,_e.a)(function(n){return(0,a.Zd)(e,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,t.consumeAsync(Pi)];case 1:return[4,e.sent().executeOpenVersionHistory({item:n})];case 2:return e.sent(),[2]}})})}),d=(0,_e.a)(function(n){return(0,a.Zd)(e,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,t.consumeAsync(Ti)];case 1:return[4,e.sent().evaluateAction({item:n})];case 2:return e.sent(),[2]}})})}),l=(0,_e.a)(function(){i.updateRightPaneState("closeRightPane",{type:He.d.none,content:void 0})}),u=(0,_e.a)(function(t){return(0,a.Zd)(e,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:switch(null==n?void 0:n.type){case He.d.detailPane:return[3,1];case He.d.versionHistory:return[3,3];case He.d.commentsPane:return[3,5];case He.d.none:return[3,7]}return[3,7];case 1:return[4,s(t)];case 2:case 4:case 6:return e.sent(),[3,8];case 3:return[4,c(t)];case 5:return[4,d(t)];case 7:return l(),[3,8];case 8:return[2]}})})});p.useEffect(function(){var e=new he.a({name:"retriggerRightPane"});o&&u(o).then(function(){return e.end({resultType:he.b.Success})}).catch(function(t){e.end({resultType:he.b.Failure,extraData:{error:t}})})},[null==o?void 0:o.key,u]),p.useEffect(function(){if((null==n?void 0:n.firstFocusableTarget)&&(0,Ct.fb)()){var e=null;"string"==typeof n.firstFocusableTarget?e=document.querySelector(n.firstFocusableTarget):n.firstFocusableTarget&&(e=n.firstFocusableTarget()),null==e||e.focus()}},[n]);var f=p.useMemo(function(){return void 0!==(null==n?void 0:n.type)&&n.type!==He.d.none?p.createElement(Ui,{errorType:n.type,onClose:l}):p.createElement(p.Fragment,null)},[null==n?void 0:n.type,l]),m={borderRadius:5,overflow:"hidden",margin:8,backgroundColor:Tn.a};return p.createElement(p.Fragment,null,((null==n?void 0:n.content)||(null==n?void 0:n.hasError))&&p.createElement("div",{className:function(){if(!n)return"";switch(n.type){case He.d.detailPane:case He.d.commentsPane:case He.d.copilotPane:return Le.A;case He.d.versionHistory:return Le.G;default:return""}}(),style:m},function(){if(n)switch(n.type){case He.d.detailPane:case He.d.commentsPane:case He.d.copilotPane:case He.d.versionHistory:return(0,Ct.sb)()&&n.hasError?f:n.content||void 0;default:return}}()))}var Hi=n(600),Ri=(0,n(3).a)(Hi.a,function(e){var t,n=e.className,a=e.theme;return{root:[a.fonts.medium,"ms-CommandBar",{display:"flex",backgroundColor:"transparent",padding:"0 8px 0 8px",height:44},n],primarySet:["ms-CommandBar-primaryCommand",{flexGrow:(0,Ct.Sb)()?"1":"unset",display:"flex",alignItems:"stretch",flexBasis:(0,Ct.Sb)()?"25%":"unset",zIndex:1,color:a.palette.themePrimary}],middleSet:["ms-CommandBar-middleCommand",(t={display:"flex",justifyContent:"center",alignItems:"stretch",flexGrow:(0,Ct.Sb)()?"2":"1",flexBasis:(0,Ct.Sb)()?"50%":"unset"},t["@media (max-width: ".concat(Ci.X82,"px)")]={display:"none"},t.color=a.palette.themePrimary,t)],secondarySet:["ms-CommandBar-secondaryCommand",{display:"flex",alignItems:"stretch",justifyContent:"flex-end",flexGrow:(0,Ct.Sb)()?"1":"unset",flexBasis:(0,Ct.Sb)()?"25%":"unset",color:a.palette.themePrimary,marginRight:"-6px"}]}},void 0,{scope:"CommandBar"}),Ni="mainDividerCommand";function Bi(e){return{id:Ni,isAvailable:!0,isDisabled:!0}}var ji=new H.hK({name:"DividerNonInteractiveCommand",factory:{dependencies:{},create:function(){return{instance:{id:Ni,automationId:Ni,iconProps:{iconName:"Separator",iconStyle:"color: white !important"},ariaLabel:ot.q,buttonStyles:{root:{width:"20px !important",color:"white",background:"transparent",minWidth:"20px"}},evaluateAction:Bi}}}}}),Vi=n(599),zi=n(127);function Gi(e){for(var t=this,n=e.definitions,i=e.item,r=e.parentItem,o=[],s=!0,c=function(e){var c=n[e],d=c.evaluateAction,l=c.evaluateSubCommands,u=c.subCommands,f=c.getSubCommands,p=(0,a.l7)(c,["evaluateAction","evaluateSubCommands","subCommands","getSubCommands"]),m=d({item:i,parentItem:r});if(!m.isAvailable)return"continue";var _=void 0;if((null==u?void 0:u.length)&&(_=Gi({definitions:u,item:i})),l){var h=l(i);(null==h?void 0:h.length)&&(_=Gi({definitions:h,item:i}))}var b=void 0;return f&&(b=function(){return(0,a.Zd)(t,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return e=Gi,t={},[4,f()];case 1:return[2,e.apply(void 0,[(t.definitions=n.sent(),t.item=i,t)])]}})})}),!_||_.length||b||c.isSplit?c.isDivider&&(s||e===n.length-1)?"continue":(s=!!c.isDivider,void o.push((0,a.W_)((0,a.W_)((0,a.W_)((0,a.W_)({},p),{name:c.evaluateCommandName?c.evaluateCommandName(i):c.name,title:c.evaluateTitle?c.evaluateTitle(i):c.title,iconProps:c.evaluateIconProps?c.evaluateIconProps(i):c.iconProps,buttonStyles:c.evaluateButtonStyles?c.evaluateButtonStyles(i):c.buttonStyles,action:m}),_?{subCommands:_}:{}),b?{getSubCommands:b}:{}))):"continue"},d=0;d<n.length;d++)c(d);return o}var Ki,Wi={main:[],far:[],overflow:[]},qi=function(){function e(e){var t=this;this.isContextual=function(){return!1},this.onDisplaySetChange=function(e){return t._eventMC.subscribe("displaySetChange",function(t){e(t.detail.displaySet)})},this.getDisplaySetCommand=function(e){for(var n=0,a=[t._displaySet.main,t._displaySet.far,t._displaySet.overflow];n<a.length;n++)for(var i=0,r=a[n];i<r.length;i++){var o=r[i];if(o.id===e)return o}},this.getWorkingSetCommand=function(e){for(var n=0,a=[t._workingSetOverride.main,t._workingSetOverride.far,t._workingSetOverride.overflow];n<a.length;n++)for(var i=0,r=a[n];i<r.length;i++){var o=r[i];if(o.id===e)return o}};var n=e.item,a=e.workingSet,i=e.showCommands,r=void 0===i||i;this._item=n,this._parentItem=void 0,this._workingSet=a,this._showCommands=r,this._workingSetOverride=a,this._workingSetOverrides=new Set,this._displaySetOverrides=new Set,this._eventMC=new zi.a,this._displaySet=this._generateDisplaySet([]),this.updateWorkingSetOverride({publisher:"commandBarInitialLoad"})}return Object.defineProperty(e.prototype,"workingSet",{get:function(){return this._workingSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displaySet",{get:function(){return this._showCommands?this._displaySet:Wi},enumerable:!1,configurable:!0}),e.prototype.updateWorkingSetOverride=function(e){var t=this,n=(0,Vi.a)({suspensibles:Array.from(this._workingSetOverrides.values()),onRetry:function(){return t.updateWorkingSetOverride(e)}});n&&(this._workingSetOverride=this._generateWorkingSet(n),this.updateDisplaySet(e))},e.prototype.updateDisplaySet=function(e){var t=this,n=(0,Vi.a)({suspensibles:Array.from(this._displaySetOverrides.values()),onRetry:function(){return t.updateDisplaySet(e)}});if(n){var a=e.publisher,i=e.item;i&&(this._item=i),this._displaySet=this._generateDisplaySet(n),this._setShowCommands(!0),this._eventMC.publish("displaySetChange",{publisher:a,displaySet:this.displaySet})}},e.prototype.calcDisplaySet=function(e,t){this._item=e,this._parentItem=t,this._displaySet=this._generateDisplaySet([])},e.prototype.addWorkingSetOverride=function(e){var t=this;return this._workingSetOverrides.add(e),function(){return t._workingSetOverrides.delete(e)}},e.prototype.addDisplaySetOverride=function(e){var t=this;return this._displaySetOverrides.add(e),function(){return t._displaySetOverrides.delete(e)}},e.prototype.dispose=function(){this._eventMC.dispose(),this._displaySetOverrides.clear(),this._workingSetOverrides.clear()},e.prototype._generateWorkingSet=function(e){for(var t=this._workingSet,n=0,a=e;n<a.length;n++)t=(0,a[n])(t);return t},e.prototype._generateDisplaySet=function(e){for(var t=this._item,n=this._parentItem,a=function(e){var t=e.commandDefinitionSet,n=e.item,a=e.parentItem;return{main:Gi({definitions:t.main,item:n,parentItem:a}),far:Gi({definitions:t.far,item:n,parentItem:a}),overflow:Gi({definitions:t.overflow,item:n,parentItem:a})}}({commandDefinitionSet:this._workingSetOverride,item:t,parentItem:n}),i=0,r=e;i<r.length;i++)a=(0,r[i])({displaySet:a,item:t});return a},e.prototype._setShowCommands=function(e){this._showCommands=e},e}(),Qi=n(180),Yi="CloseAction",Ji=!H.HW.isActivated("4257E14F-706E-4B28-930D-00FE26D1ED7B"),Xi=!H.HW.isActivated("520D3434-B1DD-43EC-9350-065337C1E8E0"),Zi={oneUpStore:ne.b,navigation:N.a,resources:H.Ci,oneUpStateStore:He.e,oneUpLoadingCustomerPromiseFunctions:Ae,saveAction:Da.a,isFastOneUpKey:ye.c.optional},$i=function(e){var t=e.navigation,n=e.oneUpStore,i=e.oneUpStateStore,r=e.saveAction;return function(o){var s={isAvailable:!0,id:Yi,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I;return(0,a.qr)(this,function(x){switch(x.label){case 0:return s=xa({saveAction:r,navigation:t,focusItem:o.item}),c=function(){var e={},n=t.viewParams;if(n)for(var a=0,i=Object.keys(n);a<i.length;a++){var r=i[a];if(r===Be.b.queryParamKey||r===Be.b.searchScopeKey||r===Be.b.meetingIdKey||r===Be.b.personIdKey||r===Be.b.emailIdKey||(0,Ct.mb)()&&(r===Be.b.viewIdKey||r===Be.b.queryTypeParamKey||Be.c.test(r)||r===Be.b.sortFieldKey||r===Be.b.isAscendingKey||r===Be.b.groupByKey||r===Be.b.listUrlKey)||Xi&&r===Be.b.remoteItem)if((0,Ct.rb)())if(r===Be.b.listUrlKey){var o=n[Be.b.parentQueryTypeParamKey],s=(0,Qi.h)(n);o&&"0"!==o||s||(e[r]=n[r])}else e[r]=n[r];else e[r]=n[r]}return e},d=function(){var e,n,a=null===(e=t.viewParams)||void 0===e?void 0:e.q,i=null===(n=t.viewParams)||void 0===n?void 0:n.searchScope,r="";return a&&(r+="&q=".concat(a)),i&&(r+="&searchScope=".concat(i)),r},l=n.getOneUpProperties()||{},u=l.parentItem,f=l.focusItem,p=l.parentStoreKey,s||(n.clean(),i.clean()),_=null===(I=e.navigation.viewParams)||void 0===I?void 0:I.parentview,h="",(0,Ct.mb)()?(b={},_&&(b=(0,a.W_)((0,a.W_)({},b),((v={})[Be.b.queryTypeParamKey]="".concat(_),v))),p?(null==p?void 0:p.id)&&(b=(0,a.W_)((0,a.W_)({},b),((y={})[Be.b.idParamKey]="".concat(null==p?void 0:p.id),y))):b=(0,a.W_)((0,a.W_)({},b),((S={})[Be.b.idParamKey]="".concat(null==u?void 0:u.id),S)),h=(0,ke.a)((0,a.W_)((0,a.W_)({},b),c())),h="".concat(e.isFastOneUpKey?"?":"#").concat(h),e.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:fe.close}}),e.navigation.navigateTo({url:h,ignoreHistory:!0}),[2,{resultType:he.b.Success}]):[3,1];case 1:if(_)m={key:Ji?(0,ke.a)((0,a.W_)((D={},D[Be.b.queryTypeParamKey]="".concat(_),D),c())):"view=".concat(_).concat(d())};else{if(!u)throw g=(0,ge.i)("no parent view/item"),e.oneUpStateStore.updateErrorState(Yi,{errorType:ge.d.actionError,error:g,item:f}),g;m={key:Ji?(0,ke.a)((0,a.W_)((0,a.W_)({},(0,H.k1)(u.key)),c())):"".concat(u.key).concat(d())}}return e.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:fe.close}}),[4,hi(m,e.resources,{urlType:"focus",hasNavigationBlock:s})];case 2:return x.sent(),[2,{resultType:he.b.Success}]}})})}};return s}},er=new H.hK({name:"CloseAction",factory:{dependencies:Zi,create:function(e){return{instance:{evaluateAction:$i(e)}}}}}),tr={actionProvider:er},nr="closeCommand",ar=new H.hK({name:"CloseCommand",factory:{dependencies:tr,create:function(e){var t=e.actionProvider;return{instance:{id:nr,buttonStyles:{root:{margin:"auto 6px"}},automationId:nr,title:ot.d,iconProps:{iconName:"Cancel"},evaluateAction:t.evaluateAction}}}}}),ir=n(135),rr=n(40),or=!H.HW.isActivated("59A6C6C6-E122-4867-8174-C3939EF88BD6"),sr={ODB:-1434},cr={pageContext:R.a},dr=function(e){var t=e.pageContext,n=!(t&&(t.isExternalGuestUser||t.isAnonymousGuestUser))&&!(0,ir.b)()&&(or||!(0,Se.i)(null==t?void 0:t.env2)&&!(0,Se.d)(null==t?void 0:t.env2))&&!(0,rr.a)(sr);return dr=function(){return n},n},lr=new H.hK({name:"isFavoritesEnabled",factory:{dependencies:cr,create:function(e){return{instance:function(){return dr(e)}}}}}),ur=n(588),fr=n(120),pr=n(587),mr=n(178),_r=n(20);!function(e){e[e.Favorite=0]="Favorite",e[e.Unfavorite=1]="Unfavorite"}(Ki||(Ki={}));var hr={pageContext:R.a,oneUpStore:ne.b,resources:H.Ci,urlDataSource:an.a,oneUpStateStore:He.e,isFavoritesEnabled:lr,offlineDetection:un.a,navigation:N.a,identityDataSource:Wt.resourceKey};function br(e,t,i,r,o){var s,c=this,d="",l=(0,lt.a)(function(){return(0,a.Zd)(c,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(56).then(n.bind(n,621))];case 1:return[2,e.sent().ToastActionButton]}})})});if(i)switch(r){case Ki.Favorite:d=p.createElement(p.Fragment,null,pr.a,p.createElement("span",{style:{fontWeight:"bold"}},o||pr.e),pr.h);var u=function(e){var t=e.urlDataSource.getPageType(e.navigation.viewParams),n={};t!==Ve.a.Files&&(n[Be.b.pageParamKey]=t),n[Be.b.queryTypeParamKey]="".concat(fr.a.Favorites||"");var a="#"+(0,mr.b)(n,void 0,!0);return"".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(a)}(e);s=p.createElement(p.Fragment,null,p.createElement(l,{key:"openFavorites",text:pr.f,onClick:function(){window.open(u,"_blank")}}));break;case Ki.Unfavorite:default:d=p.createElement(p.Fragment,null,pr.g,p.createElement("span",{style:{fontWeight:"bold"}},o||pr.e),pr.d)}else switch(r){case Ki.Favorite:d=p.createElement(p.Fragment,null,pr.c,p.createElement("span",{style:{fontWeight:"bold"}},o||pr.e),pr.b);break;case Ki.Unfavorite:default:d=p.createElement(p.Fragment,null,pr.j,p.createElement("span",{style:{fontWeight:"bold"}},o||pr.e),pr.i)}e.oneUpStateStore.updateToastState("favoriteAction",{visible:!0,actionStatus:i?t.ToastActionStatus.succeed:t.ToastActionStatus.error,displayText:d,actionButtons:s})}var gr={actionProvider:new H.hK({name:"FavoriteAction",factory:{dependencies:hr,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var i,r,o=t.offlineDetection,s=!!t.pageContext&&function(e,t){return e()&&!t}(t.isFavoritesEnabled,o.offline),c=t.oneUpStore.getOneUpProperties(),d=void 0!==t.oneUpStateStore.currentAppState.isFocusItemFavorited,l=t.oneUpStateStore.currentAppState.isFocusItemFavorited||!1,u=(i=e.item,r=l,(0,ur.a)({extension:i.extension,isList:!1,isMountPoint:!!i.mountPoint})&&!r),f=l,p={isAvailable:(0,Ct.Z)(Ct.P)&&s&&(t.oneUpStateStore.currentAppState.isFocusItemFavorited?f:u),id:"FavoriteAction",isDisabled:!d};return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(39).then(n.bind(n,612))];case 1:return[2,e.sent()]}})}).then(function(i){p.onExecute=function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var r,o,s,d,u,f,p,m,_,h,b,g,v,y;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,n.e(17).then(n.bind(n,675))];case 1:return r=a.sent(),[4,t.resources.consumeAsync(r.resourceKey)];case 2:return o=a.sent(),s=new _r.b({context:t.pageContext}),d=(0,H.k1)(e.item.key),u=d.id,f=d.listurl,p=s.getUrlParts({listUrl:f,path:u}),m=p.fullWebUrl,[4,(S=t,D=m,D?S.identityDataSource.getSharePointToken(D).then(function(e){return e}):new Promise(function(){}))];case 3:return _=a.sent(),h={webAbsoluteUrl:m,listUrl:p.serverRelativeListUrl},b=null===(v=null==c?void 0:c.pageContexts)||void 0===v?void 0:v.get(h),(g={items:[{siteId:(null==b?void 0:b.siteId)||t.pageContext.siteId,webId:(null==b?void 0:b.webId)||t.pageContext.webId,listId:(null==b?void 0:b.listId)||t.pageContext.listId,listItemUniqueId:null===(y=e.item.properties)||void 0===y?void 0:y.uniqueId}],accessToken:_}).items[0].siteId&&g.items[0].webId&&g.items[0].listId&&g.items[0].listItemUniqueId?(l?o.unfavoriteItems(g).then(function(){return br(t,i,!0,Ki.Unfavorite,e.item.name),t.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!1),{resultType:he.b.Success}}).catch(function(n){return br(t,i,!1,Ki.Unfavorite,e.item.name),t.oneUpStateStore.updateErrorState("favoriteAction.Unfavorite",{errorType:ge.d.actionError,error:n,item:e.item}),{resultType:he.b.Failure}}):o.favoriteItems(g).then(function(){return br(t,i,!0,Ki.Favorite,e.item.name),t.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!0),{resultType:he.b.Success}}).catch(function(n){return br(t,i,!1,Ki.Favorite,e.item.name),t.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:ge.d.actionError,error:n,item:e.item}),{resultType:he.b.Failure}}),[2]):(t.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:ge.d.actionError,error:{name:"favoriteAction.MissingItemProperties",message:"Missing required item properties for favorite-unfavorite call"},item:e.item}),[2,{resultType:he.b.Failure}])}var S,D})})}}).catch(function(e){p.isAvailable=!1}),p})}};var t}}}),oneUpStateStore:He.e},vr="favoriteCommand",yr=new H.hK({name:"FavoriteCommand",factory:{dependencies:gr,create:function(e){var t=e.actionProvider,n=e.oneUpStateStore;return{instance:{id:vr,name:ot.A,automationId:vr,evaluateTitle:function(e){return n.currentAppState.isFocusItemFavorited?ot.Ob:ot.B},evaluateIconProps:function(e){return n.currentAppState.isFocusItemFavorited?{iconName:"FavoriteStarFill"}:{iconName:"FavoriteStar"}},evaluateAction:t.evaluateAction}}}}}),Sr=n(589);function Dr(e){if(e)switch((0,Sr.a)(e)){case"ms-word":return"Word";case"ms-excel":return"Excel";case"ms-powerpoint":return"PowerPoint";case"ms-visio":return"Visio";case"ms-project":return"Project";case"ms-publisher":return"Publisher";case"ms-access":return"Access";case"onenote|UsePlain":return"OneNote"}}var Ir={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.Ci,platform:$.a};function xr(e){if(e)switch((0,Sr.a)(e)){case"ms-word":return{iconName:"svg/word_16x1.svg",className:Le.h};case"ms-excel":return{iconName:"svg/excel_16x1.svg",className:Le.h};case"ms-powerpoint":return{iconName:"svg/powerpoint_16x1.svg",className:Le.h};case"ms-visio":return{iconName:"svg/visio_16x1.svg",className:Le.h};case"ms-project":return{iconName:"ProjectDocument",className:Le.h};case"ms-publisher":return{iconName:"PublisherLogo",className:Le.h};case"ms-access":return{iconName:"AccessLogo",className:Le.h};case"onenote|UsePlain":return{iconName:"svg/onenote_16x1.svg",className:Le.h}}}var Cr={actionProvider:new H.hK({name:"OpenInOfficeClientAction",factory:{dependencies:Ir,create:function(e){return{instance:{evaluateAction:(t=e,function(e){return{isAvailable:(n=e.item,i=t.platform,!!((i.isMac||i.isWindows||i.isIOS||i.isWinPhone||i.isAndroid)&&n&&tt.a.hasItemPermission(n,tt.a.openItems)&&n.openUrl&&n.appMap&&n.itemStatus!==nt.b.ConditionalAccessBlocked&&n.itemStatus!==nt.b.ConditionalAccessViewOnly)),id:"OpenInOfficeClientAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){return[2,t.resources.consumeAsync(an.a).then(function(n){var a=n.getOpenInOfficeClientUrl(e.item,t.navigation.viewParams);return t.navigation.navigateTo({url:a,frameId:"_blank"}),{resultType:he.b.Success}})]})})}};var n,i})}};var t}}}),oneUpStore:ne.b},Or="openInOfficeClientCommand";function wr(e){return Dr(e.extension)?H.OO(ot.$,Dr(e.extension)):ot._}var Er=new H.hK({name:"OpenInOfficeClientCommand",factory:{dependencies:Cr,create:function(e){return{instance:{id:Or,automationId:Or,evaluateAction:e.actionProvider.evaluateAction,evaluateIconProps:function(e){return xr(e.extension)},evaluateCommandName:function(e){return wr(e)},evaluateTitle:function(e){return wr(e)}}}}}}),Ar={actionProvider:Wn,oneUpStore:ne.b},Lr="openInOfficeOnlineCommand";function kr(e,t){return Dr(e.extension)?t?H.OO(ot.ab,Dr(e.extension)):H.OO(ot.tb,Dr(e.extension)):t?ot.nb:ot.eb}var Mr=new H.hK({name:"OpenInOfficeOnlineCommand",factory:{dependencies:Ar,create:function(e){return{instance:{id:Lr,automationId:Lr,evaluateAction:e.actionProvider.evaluateAction,evaluateIconProps:function(e){return xr(e.extension)},evaluateCommandName:function(e){return kr(e)},evaluateTitle:function(e){return kr(e,!0)}}}}}}),Pr=n(590),Tr=n(591);function Ur(e){var t=new H.nM;if(e.item&&e.item.urls&&e.item.urls[dt.b.immersiveReaderUrl]){var n=e.item.urls[dt.b.immersiveReaderUrl],a=(0,Pr.a)({url:n,qosName:"OneUpLightSpeed.OpenInImmersiveReader.GetReaderOptions"}).getImmersiveReaderContext,i=new H.nM;if(a){var r=new he.a({name:"OneUpLightSpeed.OpenInImmersiveReader.Launch"});return(0,Tr.a)({getImmersiveReaderContext:a,options:{onExit:function(){i.resolve(),e.onClose&&e.onClose()}}}).then(function(){return e.onRender&&e.onRender(),i.promise.then(function(){r.end({resultType:he.b.Success})}).catch(function(t){r.end({resultType:he.b.Failure,extraData:{error:t.message,stack:t.stack,extension:e.item.extension,fileSize:e.item.size}}),e.onError&&e.onError(t)})}).catch(function(t){r.end({resultType:he.b.Failure,extraData:{error:t.message,stack:t.stack,extension:e.item.extension,fileSize:e.item.size}}),e.onError&&e.onError(t)})}e.onError&&e.onError({name:"IM.MissingReaderContext",message:"IM context options missing"})}else e.onError&&e.onError({name:"IM.ItemMissingProps",message:"Item missing required properties"});return t.promise}var Fr=new H.hK({name:"ShowImmersiveReader",factory:{dependencies:{},create:function(e){return{instance:{showImmersiveReader:Ur}}}}}),Hr=n(592),Rr="OpenInImmersiveReaderAction",Nr=[".docx",".txt",".html"],Br={getExecutor:Fr.async.lazy,pageContext:R.a,oneUpStore:ne.b,resources:H.Ci,oneUpStateStore:He.e},jr={actionProvider:new H.hK({name:"OpenInImmersiveReaderAction",factory:{dependencies:Br,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=e.item,i=function(e){return!(!e.extension||!e.size)&&!(!e.urls||!e.urls[dt.b.immersiveReaderUrl])&&-1!==Nr.indexOf(e.extension)&&(0,Hr.a)(e.size)}(n),r={isAvailable:i,id:Rr,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var i,r,o;return(0,a.qr)(this,function(s){switch(s.label){case 0:return[4,t.getExecutor()];case 1:i=s.sent(),r=new Ft.b,o=(0,a.W_)((0,a.W_)({},e),{onClose:function(){},onRender:function(e){r.complete()},onError:function(e){e.name="IMLaunchFailure.".concat(e.name),t.oneUpStateStore.updateErrorState(Rr,{errorType:ge.d.actionError,error:e,item:n}),r.error(e)}}),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,i.showImmersiveReader(o)];case 3:case 4:return s.sent(),[3,5];case 5:return[2,r.getPromise()]}})})}};return r})}};var t}}})},Vr="openInImmersiveReaderCommand",zr=new H.hK({name:"OpenInImmersiveReaderCommand",factory:{dependencies:jr,create:function(e){var t=e.actionProvider;return{instance:{id:Vr,name:ot.Y,title:ot.Z,automationId:Vr,iconProps:{iconName:"ReadOutLoud"},evaluateAction:t.evaluateAction}}}}}),Gr={pageContext:R.a,oneUpStore:ne.b,resources:H.Ci,oneUpStateStore:He.e,getValidViewerTypesFromResource:ve.b},Kr={actionProvider:new H.hK({name:"OpenInHtmlViewerAction",factory:{dependencies:Gr,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),i=t.oneUpStateStore.getViewerState(e.item.key),r=!!i&&i.htmlMode===He.b.edit;return{isAvailable:n===ve.a.Html&&r,id:"OpenInHtmlViewerAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){return t.oneUpStateStore.updateViewerState("updateHtmlModeView",{key:e.item.key,options:{htmlMode:He.b.view}}),[2,{resultType:he.b.Success}]})})}}})}}}}})},Wr="openInHtmlViewerCommand",qr=new H.hK({name:"OpenInHtmlViewerCommand",factory:{dependencies:Kr,create:function(e){var t=e.actionProvider;return{instance:{id:Wr,name:ot.X,automationId:Wr,iconProps:{iconName:"View"},evaluateAction:t.evaluateAction}}}}}),Qr={pageContext:R.a,oneUpStore:ne.b,resources:H.Ci,oneUpStateStore:He.e,getValidViewerTypesFromResource:ve.b},Yr={actionProvider:new H.hK({name:"OpenInTextEditorAction",factory:{dependencies:Qr,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),i=t.oneUpStateStore.getViewerState(e.item.key),r=void 0===(null==i?void 0:i.htmlMode)||(null==i?void 0:i.htmlMode)===He.b.view;return{isAvailable:n===ve.a.Html&&r&&".msg"!==e.item.extension,id:"OpenInTextEditorAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){return t.oneUpStateStore.updateViewerState("updateHtmlModeEdit",{key:e.item.key,options:{htmlMode:He.b.edit}}),[2,{resultType:he.b.Success}]})})}}})}}}}})},Jr="openInTextEditorCommand",Xr=new H.hK({name:"OpenInTextEditorCommand",factory:{dependencies:Yr,create:function(e){var t=e.actionProvider;return{instance:{id:Jr,name:ot.rb,automationId:Jr,iconProps:{iconName:"Edit"},evaluateAction:t.evaluateAction}}}}}),Zr=!H.HW.isActivated("1cbefa0c-46a0-4a8e-90f8-0831761b38fb"),$r={navigation:N.a,getValidViewerTypesFromResource:ve.b},eo=new H.hK({name:"OpenInStreamAction",factory:{dependencies:$r,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),r=e.item.openUrl,o=Zr&&(0,In.a)(null===(n=e.item.urls)||void 0===n?void 0:n[dt.b.video])||!Zr,s=(i===ve.a.OnePlayerVideo||i===ve.a.OnePlayerAudio)&&o&&!!r,c=-1===(null==r?void 0:r.indexOf("?"))?"?web=1":"&web=1",d="".concat(r).concat(c,"&referrer=OneUpViewer.web&referrerScenario=OpenFile.view"),l={isAvailable:s,id:"OpenInStreamAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,t.navigation.navigateTo({url:d,frameId:"_blank"})];case 1:return e.sent(),[2,{resultType:he.b.Success}]}})})}};return l})};return{instance:n}}}}),to={actionProvider:eo,oneUpStore:ne.b},no="openInStreamCommand",ao=new H.hK({name:"OpenInStreamCommand",factory:{dependencies:to,create:function(e){var t=e.actionProvider;return{instance:{id:no,name:ot.ib,title:ot.ib,automationId:no,evaluateAction:t.evaluateAction,iconProps:{iconName:"svg/stream_16x1.svg",className:Le.h}}}}}}),io=n(152),ro=n(32),oo={oneUpStateStore:He.e,pageContext:R.a,fileHandlerHelper:di.a},so=new H.hK({name:"OpenInFileHandleCommand",factory:{dependencies:oo,create:function(e){function t(t){var n,i=this,r={imageProps:{src:null===(n=t.handler.appIcon)||void 0===n?void 0:n.svg,title:t.handler.actionMenuDisplayName,imageFit:io.b.contain}},o=t.handler.actionMenuDisplayName||t.displayName,s={id:"fileHanderOpen-".concat(o),name:o,title:t.handler.actionMenuDisplayName,automationId:"fileHanderOpen-".concat(o),iconProps:r,evaluateAction:function(n){var r=n.item,s={isAvailable:co(t.availableOn,n.item.extension,!1),id:"fileHandlerOpenAction-".concat(o),onExecute:function(){return(0,a.Zd)(i,void 0,void 0,function(){var i,o,s,c,d,l,u,f,p,m;return(0,a.qr)(this,function(_){switch(_.label){case 0:i=Number(e.pageContext.webTemplate)===wn.b.mySite,o=(0,Ct.lb)()?i?"OneDrive":"SharePoint":"OneUp",s={cultureName:e.pageContext.currentUICultureName||e.pageContext.currentCultureName||"en-US",client:o,domainHint:"organizations",userId:e.pageContext.userLoginName},c=function(e){var t=window.open({}.url||"","_blank");return t&&(t.opener=null),t||void 0}(),d=!!t.handler.isPromoted,_.label=1;case 1:return _.trys.push([1,3,,4]),[4,e.fileHandlerHelper.getFileHandlerItemUrl(n.item,t,d)];case 2:return l=_.sent(),[3,4];case 3:return f=_.sent(),u=f,[3,4];case 4:if(l&&l.length>0){if(p=(0,a.W_)((0,a.W_)({},s),{appId:t.handler.appId,items:JSON.stringify(l)}),c&&c.document)return c.opener=null,(0,li.a)({url:t.url,postdata:p,document:c.document}),[2,{resultType:ro.a.Success}];throw m=(0,ge.i)("No target window available to invoke File Handler"),e.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:ge.d.actionError,error:m,item:r}),m}throw m=u||(0,ge.i)("unknown error calling getFileHandlerItemUrl"),e.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:ge.d.actionError,error:m,item:r}),m}})})}};return s}};return s}return{instance:function(n){var a=[],i=n||e.oneUpStateStore.getFileHandlerOptions();if(i)for(var r=i.data.actions.open,o=0;o<r.length;o++){var s=t(r[o]);a.push(s)}return a}}}}});function co(e,t,n){var a=e.file,i=e.folder,r=e.file&&e.file.extensions||void 0;if(n)return!!i;if(a&&t){var o="."!==t.charAt(0)?"."+t:t;return!r||-1!==r.indexOf(o.toLowerCase())||-1!==r.indexOf("*")||-1!==r.indexOf(".*")}return!1}var lo=n(593),uo=n(594),fo=n(130),po=n(357),mo=function(e){return function(t){var n,i=e.oneUpStore.getOneUpProperties(),r=null==i?void 0:i.parentItem,o=!!t.item&&!!t.item.key&&!!e.pageContext&&function(e,t){var n,a,i,r=null!==(n=null==t?void 0:t.canUserUseClipchamp)&&void 0!==n&&n,o=(0,Ct.Z)({ODB:1344}),s=(0,Ct.Z)({ODB:61399}),c=null!==(a=t&&t.listBaseTemplate===fo.a.webPageLibrary)&&void 0!==a&&a,d=tt.a.hasItemPermission(e,tt.a.insertListItems);return(0,lo.b)(null!==(i=e.extension)&&void 0!==i?i:"",!0)&&d&&o&&!c&&(r||s)}(t.item,e.pageContext),s=(0,lo.a)(null==r?void 0:r.graph,e.pageContext.webAbsoluteUrl,{referrer:e.clientName||"OneUp",referrerScenario:"EditInClipchamp",video:null===(n=t.item)||void 0===n?void 0:n.graph});return{isAvailable:o,id:"EditInClipchampAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){return(0,uo.a)(s,{forceInSameWindow:!1}),[2,{resultType:he.b.Success}]})})}}}},_o={oneUpStore:ne.b,navigation:N.a,pageContext:R.a,clientName:po.a.optional},ho={actionProvider:new H.hK({name:"EditInClipchampAction",factory:{dependencies:_o,create:function(e){return{instance:{evaluateAction:mo(e)}}}}}),oneUpStore:ne.b},bo="editInClipchampCommand",go=window.require,vo=go&&go.toUrl?go.toUrl("odsp-media/images/clipchamp/clipchamp_256x.svg"):"",yo=new H.hK({name:"EditInClipchampCommand",factory:{dependencies:ho,create:function(e){var t=e.actionProvider;return{instance:{id:bo,name:ot.v,title:ot.v,automationId:bo,evaluateAction:t.evaluateAction,iconProps:{imageProps:{src:vo,styles:{root:{width:"16px",height:"16px",display:"flex !important"}}}}}}}}}),So=new H.hK({name:"OpenInAppDataSourceAsync.key",loader:new H.vh(function(){return n.e(42).then(n.bind(n,676)).then(function(e){return e.openInAppDataSourceKey})})}),Do=function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,e.resources.consumeAsync(So)];case 1:return[4,t.sent().openInApp(e.item,e.pageContexts)];case 2:return t.sent(),[2]}})})},Io=new H.hK({name:"OpenInAppActionExecutor",factory:{dependencies:{},create:function(e){return{instance:{executeOpenInApp:Do}}}}}),xo="OpenInAppAction",Co={oneUpStore:ne.b,platform:$.a,oneUpStateStore:He.e,itemUrlHelper:Q.c,getValidViewerTypesFromResource:ve.b,getExecutor:Io.async.lazy,resources:H.Ci},Oo={actionProvider:new H.hK({name:"OpenInAppAction",factory:{dependencies:Co,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n,i,r,o=(n=e.item,i=t.platform,r=t.getValidViewerTypesFromResource.getValidViewerTypes(e.item),!(!(i.isWindows||i.isWinPhone||i.isAndroid||i.isIOS||i.isMac)||!n||r===ve.a.Copilot||!tt.a.hasItemPermission(n,tt.a.openItems)||n.appMap||n.itemStatus===nt.b.ConditionalAccessBlocked||(r===ve.a.MSPdf||r===ve.a.Pdf||r===ve.a.Photo)&&tt.a.hasItemPermission(n,tt.a.insertListItems)&&tt.a.hasItemPermission(n,tt.a.editListItems))),s=t.oneUpStore.getOneUpProperties(),c={isAvailable:o,id:xo,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,i,r,o;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=(e=s).focusItem,i=e.parentItem,r=e.focusItemSet,s&&r&&r.length&&n&&i?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeOpenInApp({item:n,pageContexts:s.pageContexts,resources:t.resources})];case 2:return a.sent(),[2,{resultType:he.b.Success}];case 3:throw o=(0,ge.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(xo,{errorType:ge.d.actionError,error:o,item:n}),o}})})}};return c})}};var t}}}),oneUpStore:ne.b},wo="OpenInAppCommand",Eo=new H.hK({name:"OpenInAppCommand",factory:{dependencies:Oo,create:function(e){return{instance:{id:wo,name:ot.W,title:ot.W,automationId:wo,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:e.actionProvider.evaluateAction}}}}}),Ao=n(164),Lo={openInOfficeClientCommand:Er,openInOfficeOnlineCommand:Mr,openInImmersiveReaderCommand:zr,openInHtmlViewerCommand:qr,openInTextEditorCommand:Xr,openInStreamCommand:ao,openInFileHandlerCommands:so,editInClipchampCommand:yo,openInAppCommand:Eo},ko="openCommandGroup",Mo=function(e){return{isAvailable:!0}},Po=new H.hK({name:"OpenGroupCommand",factory:{dependencies:Lo,create:function(e){return{instance:function(){var t=e.openInOfficeClientCommand,n=e.openInImmersiveReaderCommand,i=e.openInOfficeOnlineCommand,r=e.openInTextEditorCommand,o=e.openInHtmlViewerCommand,s=e.openInStreamCommand,c=e.editInClipchampCommand,d=e.openInAppCommand,l=e.openInFileHandlerCommands();return{id:ko,name:ot.V,automationId:ko,subCommands:(0,a.AE)((0,a.AE)([t,i,r,o,n,s],l,!0),[c,d],!1),evaluateAction:Mo,buttonStyles:(0,Ao.a)(),evaluateIconProps:function(e){return xr(e.extension)||{iconName:"OpenInNewWindow"}}}}}}}}),To={openInfoPaneActionAsync:Mi.async,oneUpStateStore:He.e},Uo=new H.hK({name:"OnClickInfoButtonAction",factory:{dependencies:To,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={isAvailable:!0,id:"onClickInfoButtonAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==He.d.detailPane?[3,1]:(t.oneUpStateStore.updateRightPaneState("onClickInfoButton",{type:He.d.none}),[3,5]);case 1:return[4,t.openInfoPaneActionAsync()];case 2:return n=a.sent(),(i=n.evaluateAction({item:e.item})).isAvailable&&i.onExecute?[4,i.onExecute({qosEvent:new he.a({name:"openInfoPane"})})]:[3,4];case 3:return a.sent(),[3,5];case 4:throw new Error("openInfoPaneAction is not available");case 5:return[2]}})})}};return n})};return{instance:n}}}}),Fo={actionProvider:Uo},Ho="InfoPaneCommand",Ro=new H.hK({name:"InfoPaneCommand",factory:{dependencies:Fo,create:function(e){var t,n=e.actionProvider;return{instance:{id:Ho,name:ot.Q,title:ot.R,ariaLabel:ot.Q+", "+ot.R,properties:(t={},t["aria-label"]="".concat(ot.Q,", ").concat(ot.R),t),automationId:Ho,iconProps:{iconName:"Info"},evaluateAction:n.evaluateAction}}}}}),No=n(400),Bo=new H.hK({name:"OnPickCopyFileAsync.key",loader:new H.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(41)]).then(n.bind(n,677)).then(function(e){return e.onPickCopyFileKey})})}),jo=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(18)]).then(n.bind(n,623))];case 1:return[2,e.sent().Sdk80FilePickerHostModal]}})})});function Vo(e){var t=new H.nM;return e.onRender(p.createElement(zo,(0,a.W_)({},e))),t.promise}function zo(e){var t=(0,V.c)(),n="".concat(e.pageContext.webAbsoluteUrl,"/").concat(e.pageContext.layoutsUrl,"/FilePicker.aspx"),a={title:ot.j,selection:{mode:"pick"},commands:{pick:{label:ot.i}},typesAndSources:{mode:"folders"},entry:{sharePoint:{byPath:{web:e.web,list:e.list,folder:e.folder}}}},i=(0,_e.a)(function(t){return e.onClose(),Promise.resolve()}),r=(0,_e.a)(function(e){return Promise.resolve()}),o=(0,_e.a)(function(n){var a=new he.a({name:"OneUpCopyToOnPick"}),i=t.consumeAsync(Bo);return e.onClose(),i.then(function(t){t(n,e.folder).then(function(){return a.end({resultType:he.b.Success})}).catch(function(e){a.end({resultType:he.b.Failure,error:e})})}).catch(function(e){a.end({resultType:he.b.Failure,error:e})}),Promise.resolve()});return p.createElement(jo,{pickerPageUrl:n,app:e.clientName,scenario:"MoveCopy",options:a,onPick:o,onClose:i,onLoad:r})}var Go=new H.hK({name:"ShowFilePicker",factory:{dependencies:{},create:function(e){return{instance:{showFilePicker:Vo}}}}}),Ko=function(e){return function(t){var n={isAvailable:Wo(t.item),id:"copyToAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i,r,o,s,c,d;return(0,a.qr)(this,function(a){switch(a.label){case 0:return e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0}),[4,e.getExecutor()];case 1:return n=a.sent(),i=e.itemUrlHelper.getItemUrlParts(t.item.key),r=e.oneUpStore.parentItem?e.itemUrlHelper.getItemUrlParts(e.oneUpStore.parentItem.key):void 0,o=i.fullListUrl,s=i.fullWebUrl,c=null==r?void 0:r.fullItemUrl,d={pageContext:e.pageContext,clientName:e.clientName||"OneUp",onClose:function(){e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!1})},onRender:function(t){e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0,content:t})},list:o,web:s,folder:c},[4,n.showFilePicker(d)];case 2:return a.sent(),[2,{resultType:he.b.Success}]}})})}};return n}};function Wo(e){var t;return e.itemStatus!==nt.b.ConditionalAccessBlocked&&e.itemStatus!==nt.b.ConditionalAccessViewOnly&&!!tt.a.hasItemPermission(e,tt.a.openItems)&&!e.isRootFolder&&!(null===(t=e.lifeCycleStatus)||void 0===t?void 0:t.isMalwareDetected)}var qo={getExecutor:Go.async.lazy,pageContext:R.a,clientName:po.a.optional,oneUpStateStore:He.e,itemUrlHelper:Q.c,oneUpStore:ne.b},Qo={actionProvider:new H.hK({name:"CopyToAction",factory:{dependencies:qo,create:function(e){return{instance:{evaluateAction:Ko(e)}}}}})},Yo="copyToCommand",Jo=new H.hK({name:"CopyToCommand",factory:{dependencies:Qo,create:function(e){var t=e.actionProvider;return{instance:{id:Yo,name:ot.j,title:ot.k,automationId:Yo,iconProps:{iconName:"Copy"},evaluateAction:t.evaluateAction}}}}}),Xo=n(595),Zo=new H.hK({name:"DeleteActionExecutor.key",loader:new H.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(9)]).then(n.bind(n,678)).then(function(e){return e.deleteActionExecutorKey})})}),$o="DeleteAction",es={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.Ci,platform:$.a,oneUpStateStore:He.e,getExecutor:Zo.async.lazy},ts={actionProvider:new H.hK({name:"DeleteAction",factory:{dependencies:es,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n,i=(n=e.item,tt.a.hasItemPermission(n,tt.a.deleteListItems)),r=t.oneUpStore.getOneUpProperties(),o={isAvailable:i,id:$o,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,i,o,s,c,d,l,u,f,p;return(0,a.qr)(this,function(m){switch(m.label){case 0:return i=(n=r).focusItem,o=n.parentItem,s=n.focusItemSet,c=n.currentIndex,d=n.list,r&&s&&s.length&&i&&o?(l={parentKey:(0,Ct.mb)()?o.key:t.oneUpStore.currentItemSetKey,items:[e.item],deletionType:Xo.a.Recycle,allowUndo:!1,emptyRecycleBin:!1,listId:null===(p=null==d?void 0:d.list)||void 0===p?void 0:p.id,overrideLock:!0,enforceETag:!1},u=o,u=void 0!==c&&c+1<s.length?s[c+1]:c&&c-1>=0?s[c-1]:o,[4,t.getExecutor()]):[3,2];case 1:return m.sent().executeDelete({deleteItemsContext:l,resources:t.resources,oneUpStateStore:t.oneUpStateStore,item:e.item}).then(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){switch(a.label){case 0:return e?((n=t.oneUpStateStore.currentAppState.deletedKeys)?n.set(i.key,!0):(n=new Map).set(i.key,!0),t.oneUpStateStore.updateDeletedKeysState("DeleteAction",n),u.key!==o.key?[3,3]:[4,(0,H.j_)(5e3)]):[3,5];case 1:return a.sent(),[4,hi(u,t.resources,{urlType:"focus"})];case 2:return a.sent(),[3,5];case 3:return[4,hi(u,t.resources,{parentItem:r.parentItem,urlType:"focus"})];case 4:a.sent(),a.label=5;case 5:return[2,{resultType:he.b.Success}]}})})}).catch(function(e){throw t.oneUpStateStore.updateErrorState("delete action",{errorType:ge.d.actionError,error:e,item:i}),e}),[3,3];case 2:throw f=(0,ge.i)("no parent view/item"),t.oneUpStateStore.updateErrorState($o,{errorType:ge.d.actionError,error:f,item:i}),f;case 3:return[2]}})})}};return o})}};var t}}})},ns="deleteCommand",as=new H.hK({name:"DeleteCommand",factory:{dependencies:ts,create:function(e){var t=e.actionProvider;return{instance:{id:ns,name:ot.m,title:ot.n,automationId:ns,iconProps:{iconName:"Delete"},evaluateAction:t.evaluateAction}}}}}),is=n(340),rs="AnnotateAction",os={oneUpStateStore:He.e,uaDataSource:kt,pdfHelper:zt.b,itemUrlHelper:Q.c,openCommentsPaneActionAsyncKey:Ti.async},ss=function(e){return function(t){var n={id:rs,isAvailable:ds(t.item,e),isDisabled:is.i&&e.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){switch(n.label){case 0:return e.oneUpStateStore.toggleAnnotationViewerVisiblity(rs),(0,Ct.Z)(Ct.r)?[4,cs(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2,{resultType:he.b.Success}]}})})}};return n}};function cs(e,t){var n;return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(a){switch(a.label){case 0:return(null===(n=t.oneUpStateStore.state.currentState.annotationViewerState)||void 0===n?void 0:n.viewerVisiblity)!==He.a.On?[3,3]:[4,t.openCommentsPaneActionAsyncKey()];case 1:return[4,a.sent().evaluateAction({item:e.item})];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function ds(e,t){var n,a,i;if(!(0,Ct.Z)(Ct.K))return!1;var r=t.uaDataSource.isUniversalAnnotationDisabled;if((0,Ct.Z)(Ct.E)&&r)return!1;if(!(0,On.d)()&&(null===(i=null===(a=null===(n=t.oneUpStateStore.currentAppState.viewerStates)||void 0===n?void 0:n.get(e.key))||void 0===a?void 0:a.pdfViewerStates)||void 0===i?void 0:i.isPdfMip))return!1;if(!t.pdfHelper.isSupportedFileType(e))return!1;if(t.itemUrlHelper.getItemUrlParts(e.key).geoRelation!==Q.a.sameGeo)return!1;if(!t.pdfHelper.isMsPdfViewerAvailable(e)||!t.pdfHelper.isMsPdfViewerSupported(e.size))return!1;var o=t.oneUpStateStore.getESignData().isCreateSidePanelActive;return!(!is.i&&o||!t.uaDataSource.hasLicense||!t.pdfHelper.isNotEmbed())}var ls={actionProvider:new H.hK({name:"AnnotateAction",factory:{dependencies:os,create:function(e){return{instance:{evaluateAction:ss(e)}}}}}),oneUpStateStore:He.e},us="annotateCommand",fs=new H.hK({name:"AnnotateCommand",factory:{dependencies:ls,create:function(e){var t=e.actionProvider,n=e.oneUpStateStore;return{instance:{id:us,automationId:us,name:ot.a,iconProps:{iconName:"InkingTool"},evaluateTitle:function(e){return n.currentAppState.annotationViewerState.isActive?ot.O:ot.yb},evaluateAction:t.evaluateAction}}}}}),ps=n(596),ms={openCommentsPaneActionAsync:Ti.async,oneUpStateStore:He.e},_s=new H.hK({name:"OnClickCommentsButtonAction",factory:{dependencies:ms,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={id:"onClickCommentsButtonAction",isAvailable:(0,ps.a)(e.item),onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){switch(n.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==He.d.commentsPane?[3,1]:(t.oneUpStateStore.updateRightPaneState("onClickCommentsButton",{type:He.d.none}),[3,4]);case 1:return[4,t.openCommentsPaneActionAsync()];case 2:return[4,n.sent().evaluateAction({item:e.item})];case 3:n.sent(),n.label=4;case 4:return[2]}})})}};return n})};return{instance:n}}}}),hs={actionProvider:_s,oneUpStateStore:He.e},bs="commentCommand",gs=new H.hK({name:"CommentsCommand",factory:{dependencies:hs,create:function(e){var t=e.actionProvider,n=e.oneUpStateStore;return{instance:{id:bs,automationId:bs,iconProps:{iconName:"Comment"},evaluateTitle:function(e){return n.currentAppState.rightPane.type===He.d.commentsPane?ot.P:ot.Sb},evaluateAction:t.evaluateAction}}}}}),vs=n(336),ys={oneUpStore:ne.b,oneUpStateStore:He.e,pageContext:R.a,platformDetection:$.a,pdfHelper:zt.b},Ss=function(e){return function(t){var n,i,r,o=t.item,s=e.oneUpStateStore,c=e.oneUpStore,d=e.pageContext,l=e.platformDetection,u=e.pdfHelper,f=!!(r=s.currentAppState.annotationViewerState)&&r.viewerVisiblity===He.a.On,p=null===(i=null===(n=s.currentAppState.viewerStates)||void 0===n?void 0:n.get(o.key))||void 0===i?void 0:i.pdfViewerStates,m={id:"toggleESignAction",isAvailable:Mn(c.focusItem,d,f,(null==p?void 0:p.isPdfPasswordProtected)||(null==p?void 0:p.isPdfMip),function(){return!!c.focusItem&&u.isMsPdfViewerAvailable(c.focusItem)},l.isMobile),isDisabled:is.i&&!(null==p?void 0:p.isOpened),onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){return e=!(null===(t=s.currentAppState.eSignData)||void 0===t?void 0:t.isCreateSidePanelActive),s.updateESignDataState("ToggleESign",{isCreateSidePanelActive:e}),e&&is.e&&function(e,t,n){(0,a.Zd)(void 0,void 0,void 0,function(){var i,r,o,s;return(0,a.qr)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),i=e.listId?e.listId.replace(/^\{|\}$/g,""):"",[4,new vs.a({pageContext:e,getParentListId:function(){return i},itemProvider:{invalidateItem:function(){}}}).getSharingInformation(t)];case 1:return r=a.sent(),o=null===(s=n.currentAppState.eSignData)||void 0===s?void 0:s.isCreateSidePanelActive,n.updateESignDataState("ToggleESign",{isCreateSidePanelActive:o,isExternalSharingEnabled:r.canAddExternalPrincipal}),[3,3];case 2:return a.sent(),[3,3];case 3:return[2]}})})}(d,o,s),[2,{resultType:ro.a.Success}]})})}};return m}},Ds=new H.hK({name:"createSyntexSignRequestAction",factory:{dependencies:ys,create:function(e){return{instance:{evaluateAction:Ss(e)}}}}}),Is=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(13)]).then(n.bind(n,680))];case 1:return[2,e.sent().ESignGatewayWrapper]}})})}),xs=function(e){var t;switch(e&&(null===(t=e.cloudType)||void 0===t?void 0:t.toLowerCase())){case"prod":case"prodbubble":case"ag08":case"ag09":case"chn":case"dod":case"gcch":case"gcc":return"396ef0b6-ae1c-4404-86ce-0a869d4d2987";default:return"9471276c-aa67-4dd2-bde2-291a033f3c3c"}},Cs={oneUpStore:ne.b,oneUpStateStore:He.e,pageContext:R.a,pdfHelper:zt.b,identityDataSource:Wt.resourceKey,itemUrlHelper:Q.c},Os=function(e,t){return function(n){var i,r=n.item,o=e.oneUpStore,s=e.oneUpStateStore,c=e.pageContext,d=e.pdfHelper,l=e.identityDataSource,u="create_".concat(t,"RequestAction"),f=null!==(i=o.focusItem)&&void 0!==i?i:r,m=gt({item:f,appLevelPagecontext:e.pageContext,itemUrlHelper:e.itemUrlHelper,remoteWebPageContexts:e.oneUpStore.pageContexts}),_={isAvailable:Pn(t,f,c,function(){return!!f&&d.isMsPdfViewerAvailable(f)}),id:u,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,i,r;return(0,a.qr)(this,function(o){switch(o.label){case 0:return s.updateESignDataState(u,{isCreateSidePanelActive:!1}),[4,l.getOAuthSessionToken(xs(c))];case 1:return e=o.sent(),n={provider:t,item:{name:f.displayName,driveId:null===(i=f.graph)||void 0===i?void 0:i.driveId,openUrl:f.openUrl,size:f.size,permissions:f.permissions,policies:{canDownload:m}},sessionToken:(0,a.W_)((0,a.W_)({},e),{correlationId:null!==(r=e.correlationId)&&void 0!==r?r:(_=function(){var e=btoa(ct.a.generate().match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""));return"".concat(e.replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))}(),h={},d=h[_]||0===h[_]?h[_]+1:0,h[_]=d,"".concat(_,".").concat(d))})},s.updateModalState(u,{showModal:!0,content:p.createElement(Is,(0,a.W_)({key:n.sessionToken.correlationId},n))}),[2,{resultType:ro.a.Success}]}var d,_,h})})}};return _}},ws=new H.hK({name:"create3PESignRequestAction",factory:{dependencies:Cs,create:function(e){return{instance:{evaluateAction:Os(e,An.a.Adobe)}}}}}),Es=new H.hK({name:"create3PESignRequestAction",factory:{dependencies:Cs,create:function(e){return{instance:{evaluateAction:Os(e,An.a.Docusign)}}}}});const As=n.p+"images/syntexLogo16px_e5151034.svg",Ls=n.p+"images/sharepoint_16x1_9891ae75.svg",ks=n.p+"images/adobeAcrobatSign_6ded66ba.svg",Ms=n.p+"images/docuSign_e53ed1dc.svg",Ps=n.p+"images/signature_c0654d5b.svg";var Ts,Us=H.HW.isActivated("16df4305-290a-43cf-a29e-f589c7adb748","11/14/2023","Disable 3p e-signature"),Fs={syntexSignActionProvider:Ds,adobeSignActionProvider:ws,docuSignActionProvider:Es,pageContext:R.a},Hs=new H.hK({name:"ToggleESignCommand",factory:{dependencies:Fs,create:function(e){var t=e.syntexSignActionProvider,n=e.adobeSignActionProvider,a=e.docuSignActionProvider,i=e.pageContext,r=i.syntexEsignatureThirdPartyEnabledProviders&&i.syntexEsignatureThirdPartyEnabledProviders.length>0,o=(0,Ct.Z)(Ct.w)&&r&&!Us,s=o?[{id:"GetSyntexSignatures",name:(0,is.b)()?ot.K:ot.L,title:(0,is.b)()?ot.K:ot.M,automationId:"GetSyntexSignatures",groupHeader:ot.z,iconProps:{imageProps:{src:(0,is.b)()?Ls:As}},evaluateAction:t.evaluateAction},{id:"GetAdobeSignatures",name:ot.E,title:ot.F,automationId:"GetAdobeSignatures",groupHeader:ot.z,iconProps:{imageProps:{src:ks}},evaluateAction:n.evaluateAction},{id:"GetDocusignSignatures",name:ot.G,title:ot.H,automationId:"GetDocusignSignatures",groupHeader:ot.z,iconProps:{imageProps:{src:Ms}},evaluateAction:a.evaluateAction}]:[];return{instance:{id:"GetSignatures",name:ot.I,title:ot.J,automationId:"GetSignatures",iconProps:is.j?{imageProps:{src:Ps}}:{iconName:"InsertSignatureLine"},evaluateAction:t.evaluateAction,subCommands:s,buttonStyles:o?{root:{".ms-Icon":{margin:"0 2px"}},flexContainer:{padding:"0 6px"}}:void 0}}}}}),Rs=new H.hK({name:"UniversalActionExecutor.key",loader:new H.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(59)]).then(n.bind(n,681)).then(function(e){return e.universalPrintActionExecutorKey})})}),Ns="UniversalPrintAction",Bs={pageContext:R.a,oneUpStore:ne.b,resources:H.Ci,platform:$.a,oneUpStateStore:He.e,getExecutor:Rs.async.lazy,pdfViewerHelper:zt.b},js=new H.hK({name:"UniversalPrintAction",factory:{dependencies:Bs,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e,t,n){var a,i,r;if(e&&e.extension&&e.openUrl&&e.itemStatus!==nt.b.ConditionalAccessViewOnly&&e.itemStatus!==nt.b.ConditionalAccessBlocked&&tt.a.hasItemPermission(e,tt.a.openItems)&&(!(0,On.d)()&&!(null===(r=null===(i=null===(a=n.currentAppState.viewerStates)||void 0===a?void 0:a.get(e.key))||void 0===i?void 0:i.pdfViewerStates)||void 0===r?void 0:r.isPdfMip)||(0,On.d)())){var o=(0,Sr.a)(e.extension);if(o&&"ms-word"===o&&n.currentAppState.isUniversalPrintLicenseValid)return!0;if(t.isSupportedFileType(e))return!0}return!1}(e.item,t.pdfViewerHelper,t.oneUpStateStore),i=t.oneUpStore.getOneUpProperties(),r={isAvailable:n,id:Ns,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,r,o,s;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=(e=i).focusItem,r=e.parentItem,o=e.focusItemSet,i&&o&&o.length&&n&&r?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeUniversalPrint({item:n,resources:t.resources,oneUpStateStore:t.oneUpStateStore})];case 2:return a.sent(),[2,{resultType:he.b.Success}];case 3:throw s=(0,ge.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(Ns,{errorType:ge.d.actionError,error:s,item:n}),s}})})}};return r})}};var t}}}),Vs={actionProvider:(0,Ct.Z)(Ct.s)?js:rt},zs="printCommand",Gs=new H.hK({name:"PrintCommand",factory:{dependencies:Vs,create:function(e){var t,n=e.actionProvider;return{instance:{id:zs,name:ot.lb,title:ot.ub,automationId:zs,iconProps:{iconName:"Print"},evaluateAction:n.evaluateAction,properties:(t={},t["aria-label"]="".concat(ot.ub,", ").concat(ot.Nb),t)}}}}}),Ks={pdfViewerHelper:zt.b,oneUpStateStore:He.e},Ws=new H.hK({name:"ExtractAction",factory:{dependencies:Ks,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i,r=t.pdfViewerHelper,o=null===(i=null===(n=t.oneUpStateStore.currentAppState.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===i?void 0:i.pdfViewerStates;return{isAvailable:r.isPdfExtractAvailable(e.item)&&r.isPdfEditable(e.item)&&!(null==o?void 0:o.isPdfMip),id:"PdfExtract",isDisabled:!(null==o?void 0:o.isOpened)||is.i&&t.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){return t.oneUpStateStore.state.currentState.annotationViewerState.viewerVisiblity===He.a.On&&t.oneUpStateStore.toggleAnnotationViewerVisiblity(rs),t.oneUpStateStore.updatePdfState("updatePdfAppMode",Qe.a.Extract),t.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerMode:"close"}}}),[2]})})}}})};return{instance:n}}}}),qs=!1,Qs={actionProvider:Ws},Ys="pdfExtractCommand",Js=new H.hK({name:"PdfExtractCommand",factory:{dependencies:Qs,create:function(e){var t=e.actionProvider,n={id:Ys,automationId:Ys,title:ot.ob,name:ot.sb,iconProps:{iconName:"PdfExtract"},evaluateAction:t.evaluateAction};return qs||((0,l.bV)({icons:{PdfExtract:p.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 17",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M4 0C2.89543 0 2 0.895431 2 2V12C2 13.1046 2.89543 14 4 14H5.20703C5.11588 13.6777 5.05337 13.3434 5.02242 13H4C3.44772 13 3 12.5523 3 12V2C3 1.44772 3.44772 1 4 1H10C10.5523 1 11 1.44772 11 2V7.02242C11.3434 7.05337 11.6777 7.11588 12 7.20703V2C12 0.89543 11.1046 0 10 0H4ZM3.5 15H5.59972C5.78261 15.3578 6.00354 15.6929 6.25717 16H3.5C1.567 16 0 14.433 0 12.5V4.00001C0 3.25973 0.402199 2.61339 1 2.26758V12.5C1 13.8807 2.11929 15 3.5 15ZM10.5 8C12.9853 8 15 10.0147 15 12.5C15 14.9853 12.9853 17 10.5 17C8.01472 17 6 14.9853 6 12.5C6 10.0147 8.01472 8 10.5 8ZM12.8532 12.854L12.8557 12.8514C12.9026 12.804 12.938 12.7495 12.9621 12.6914C12.9861 12.6333 12.9996 12.5697 13 12.503L13 12.5L13 12.497C12.9996 12.4303 12.9861 12.3667 12.9621 12.3086C12.9377 12.2496 12.9015 12.1944 12.8536 12.1464L10.8536 10.1464C10.6583 9.95118 10.3417 9.95118 10.1464 10.1464C9.95118 10.3417 9.95118 10.6583 10.1464 10.8536L11.2929 12H8.5C8.22386 12 8 12.2239 8 12.5C8 12.7761 8.22386 13 8.5 13H11.2929L10.1464 14.1464C9.95118 14.3417 9.95118 14.6583 10.1464 14.8536C10.3417 15.0488 10.6583 15.0488 10.8536 14.8536L12.8532 12.854Z",fill:"currentColor"})),PdfMerge:p.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 10",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M0 0.5C0 0.223858 0.223858 0 0.5 0H2.1528C3.15253 0 4.10455 0.427517 4.76873 1.17473L6.97867 3.66091C7.45309 4.19463 8.1331 4.5 8.8472 4.5H13.2929L9.64645 0.853554C9.45118 0.658291 9.45118 0.341709 9.64645 0.146447C9.84171 -0.0488154 10.1583 -0.0488154 10.3536 0.146447L14.8536 4.64645C15.0488 4.84171 15.0488 5.15829 14.8536 5.35355L10.3536 9.85355C10.1583 10.0488 9.84171 10.0488 9.64645 9.85355C9.45118 9.65829 9.45118 9.34171 9.64645 9.14645L13.2929 5.5H8.8472C8.1331 5.5 7.45309 5.80537 6.97867 6.33909L4.76873 8.82527C4.10455 9.57248 3.15253 10 2.1528 10H0.5C0.223858 10 0 9.77614 0 9.5C0 9.22386 0.223858 9 0.5 9H2.1528C2.8669 9 3.54691 8.69463 4.02133 8.16091L6.23127 5.67473C6.46908 5.40718 6.7438 5.18062 7.0444 5C6.7438 4.81938 6.46908 4.59282 6.23127 4.32527L4.02133 1.83909C3.54691 1.30537 2.8669 1 2.1528 1H0.5C0.223858 1 0 0.776142 0 0.5Z",fill:"currentColor"}))}}),qs=!0),{instance:n}}}}),Xs={pdfViewerHelper:zt.b,oneUpStateStore:He.e},Zs=new H.hK({name:"MergeAction",factory:{dependencies:Xs,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i,r=t.pdfViewerHelper,o=null===(i=null===(n=t.oneUpStateStore.currentAppState.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===i?void 0:i.pdfViewerStates;return{isAvailable:r.isPdfExtractAvailable(e.item)&&r.isPdfEditable(e.item)&&!(null==o?void 0:o.isPdfMip),id:"PdfMerge",isDisabled:!(null==o?void 0:o.isOpened),onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){return t.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerMode:"merge"}}}),[2]})})}}})};return{instance:n}}}}),$s={actionProvider:Zs},ec="pdfMergeCommand",tc=new H.hK({name:"PdfMergeCommand",factory:{dependencies:$s,create:function(e){var t=e.actionProvider;return{instance:{id:ec,automationId:ec,title:ot.cb,name:ot.db,iconProps:{iconName:"PdfMerge"},evaluateAction:t.evaluateAction}}}}}),nc={getExecutor:Pi.async.lazy,oneUpStateStore:He.e},ac=new H.hK({name:"onClickVersionHistoryAction",factory:{dependencies:nc,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={isAvailable:!0,id:"openVersionHistoryAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(n){switch(n.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==He.d.versionHistory?[3,1]:(t.oneUpStateStore.updateRightPaneState("closeVersionHistory",{type:He.d.none}),[3,3]);case 1:return[4,t.getExecutor()];case 2:return[2,n.sent().executeOpenVersionHistory({item:e.item})];case 3:return[2]}})})}};return n})};return{instance:n}}}}),ic={actionProvider:ac},rc="VersionHistoryCommand",oc=new H.hK({name:"VersionHistoryCommand",factory:{dependencies:ic,create:function(e){var t,n=e.actionProvider;return{instance:{id:rc,name:ot.wb,title:ot.Eb,ariaLabel:ot.wb+", "+ot.Eb,properties:(t={},t["aria-label"]="".concat(ot.wb,", ").concat(ot.Eb),t),automationId:rc,iconProps:{iconName:"StackIndicator"},evaluateAction:n.evaluateAction}}}}}),sc=new H.hK({name:"EmbedDialogExecutor.key",loader:new H.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(11)]).then(n.bind(n,683)).then(function(e){return e.embedDialogExecutorKey})})}),cc="EmbedAction",dc={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.Ci,platform:$.a,oneUpStateStore:He.e,getExecutor:sc.async.lazy,getValidViewerTypesFromResource:ve.b},lc={actionProvider:new H.hK({name:"EmbedAction",factory:{dependencies:dc,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e,t){return!(!e||5===e.queryType||13===e.queryType||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected||t.getValidViewerTypesFromResource.getValidViewerTypes(e)===ve.a.Copilot)}(e.item,t),i=t.oneUpStore.getOneUpProperties(),r={isAvailable:n,id:cc,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var n,r,o,s,c,d;return(0,a.qr)(this,function(a){switch(a.label){case 0:return r=(n=i).focusItem,o=n.parentItem,s=n.focusItemSet,c=n.list,i&&s&&s.length&&r&&o&&c?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeEmbedDialog({item:e.item})];case 2:return a.sent(),[2,{resultType:he.b.Success}];case 3:throw d=(0,ge.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(cc,{errorType:ge.d.actionError,error:d,item:r}),d}})})}};return r})}};var t}}})},uc="embedCommand",fc=new H.hK({name:"EmbedCommand",factory:{dependencies:lc,create:function(e){var t=e.actionProvider;return{instance:{id:uc,name:ot.x,title:ot.y,automationId:uc,iconProps:{iconName:"Embed"},evaluateAction:t.evaluateAction}}}}}),pc={pageContext:R.a,navigation:N.a},mc={actionProvider:new H.hK({name:"ViewOriginalImageAction",factory:{dependencies:pc,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e){var t,n=null===(t=e.photo)||void 0===t?void 0:t.originalUrl;return n&&n.replace(/#/g,"%23")}(e.item),i=!!n&&function(e,t){return!t.blockDownloadsExperienceEnabled&&!t.viewOnlyExperienceEnabled&&tt.b.hasItemPermission(e,tt.b.openItems)}(e.item,t.pageContext),r={isAvailable:i,id:"ViewOriginalImageAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return n?[4,t.navigation.navigateTo({url:n,frameId:"_blank"})]:[2,{resultType:he.b.Failure}];case 1:return e.sent(),[2,{resultType:he.b.Success}]}})})}};return r})}};var t}}}),oneUpStore:ne.b},_c="viewOriginalImageCommand",hc=new H.hK({name:"ViewOriginalImageCommand",factory:{dependencies:mc,create:function(e){var t,n=e.actionProvider;return{instance:{id:_c,name:ot.Ab,title:ot.Ab,automationId:_c,iconProps:{iconName:"Picture"},evaluateAction:n.evaluateAction,properties:(t={},t["aria-label"]="".concat(ot.Ab,", ").concat(ot.Nb),t)}}}}}),bc=n(335),gc=new H.hK({name:"RequestMoreAccessAction",factory:{dependencies:{},create:function(){return{instance:{evaluateAction:function(){return{isAvailable:!0,id:"RequestMoreAccessAction",onExecute:function(){}}}}}}}}),vc=function(e,t,n){var a=!0;return t.map(function(t){tt.a.hasPermission(e,t)||(a=!1)}),a},yc=[tt.a.insertListItems,tt.a.editListItems],Sc=[tt.a.reviewListItems],Dc=[tt.a.openItems],Ic=[tt.a.viewListItems],xc=function(e){return e?vc(e,yc)?bc.a.edit:vc(e,Sc)?bc.a.review:vc(e,Dc)?bc.a.view:vc(e,Ic)?bc.a.restrictedview:bc.a.none:bc.a.none},Cc=new H.hK({name:"ShowRequestMoreAccessDialog.key",loader:new H.vh(function(){return n.e(50).then(n.bind(n,673)).then(function(e){return e.showRequestMoreAccessDialogKey})})}),Oc=function(e){switch(e){case bc.a.review:case bc.a.restrictedview:case bc.a.view:return!0;default:return!1}},wc=function(e){var t=e.oneUpStore,n=e.oneUpStateStore,i=e.pageContext,r=e.resources,o=e.getExecutor;return function(){var e,s=xc(null===(e=t.focusItem)||void 0===e?void 0:e.permissions),c={isAvailable:!i.isAnonymousGuestUser&&Oc(s),id:"EditRequestAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e;return(0,a.qr)(this,function(a){switch(a.label){case 0:return(e=t.getOneUpProperties())&&s?[4,o()]:[3,3];case 1:return[4,a.sent().showRequestMoreAccessDialog({item:e.focusItem,pageContext:i,itemRole:s,requestRole:bc.a.edit,resources:r,onClose:function(){n.updateModalState("editRequestCommand",{showModal:!1,content:void 0})},onRender:function(e){n.updateModalState("editRequestCommand",{showModal:!0,content:e})}})];case 2:a.sent(),a.label=3;case 3:return[2]}})})}};return c}},Ec={oneUpStore:ne.b,oneUpStateStore:He.e,pageContext:R.a,resources:H.Ci,getExecutor:Cc.async.lazy},Ac=new H.hK({name:"EditRequestAction",factory:{dependencies:Ec,create:function(e){return{instance:{evaluateAction:wc(e)}}}}}),Lc={actionProvider:Ac},kc="editRequestMoreAccessCommand",Mc=new H.hK({name:"EditRequestMoreAccessCommand",factory:{dependencies:Lc,create:function(e){var t=e.actionProvider;return{instance:{id:kc,name:ot.fb,automationId:kc,iconProps:{iconName:"Lock"},evaluateAction:t.evaluateAction}}}}}),Pc={actionProvider:gc,editRequestMoreAccessCommand:Mc,oneUpStore:ne.b},Tc="requestMoreAccessCommand",Uc=new H.hK({name:"RequestMoreAccessCommand",factory:{dependencies:Pc,create:function(e){var t,n=e.oneUpStore,a=e.actionProvider,i=e.editRequestMoreAccessCommand,r=function(e){switch(e){case bc.a.none:return{label:ot.S,icon:""};case bc.a.review:return{label:ot.pb,icon:"Feedback"};case bc.a.view:case bc.a.restrictedview:return{label:ot.Lb,icon:"View"};default:return{label:ot.S,icon:""}}}(xc(null===(t=n.focusItem)||void 0===t?void 0:t.permissions)),o=r.label,s={iconName:r.icon};return{instance:{id:Tc,automationId:Tc,buttonStyles:(0,Ao.a)(),iconProps:s,subCommands:[i],evaluateAction:a.evaluateAction,evaluateCommandName:function(){return o}}}}}}),Fc=n(597),Hc={oneUpStateStore:He.e,resources:H.Ci,oneUpStore:ne.b,pageContext:R.a},Rc=new H.hK({name:"FeedbackAction",factory:{dependencies:Hc,create:function(e){var t,i={evaluateAction:(t=e,function(e){var i=t.resources,r=t.pageContext,o={isAvailable:!0,id:"Feedback",isDisabled:!1,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var o,s,c,d,l,u,f,p,m,_,h,b;return(0,a.qr)(this,function(a){switch(a.label){case 0:return o=t.oneUpStore.getOneUpProperties(),s=new _r.b({context:r}),c=(0,H.k1)(e.item.key),d=c.id,l=c.listurl,u=s.getUrlParts({listUrl:l,path:d}),f=u.fullWebUrl,p={webAbsoluteUrl:f,listUrl:u.serverRelativeListUrl},(m=null===(b=null==o?void 0:o.pageContexts)||void 0===b?void 0:b.get(p))||r?[3,1]:(_=(0,ge.i)("FeedbackAction: missing pagecontext"),t.oneUpStateStore.updateErrorState("feedbackAction.onExecute",{errorType:ge.d.actionError,error:_,item:e.item}),[2,{resultType:he.b.Failure}]);case 1:return h=document.getElementById("oneupCommandBarOverflow"),[4,Promise.all([n.e("ondemand.resx"),n.e(35)]).then(n.bind(n,686))];case 2:a.sent().showOneUpFeedback(e.item,i,m||r).then(function(){return document.activeElement instanceof HTMLElement&&h&&document.activeElement===h&&document.activeElement.blur(),{resultType:he.b.Success}}).catch(function(n){return t.oneUpStateStore.updateErrorState("feedbackAction.showOneUpFeedback",{errorType:ge.d.actionError,error:n,item:e.item}),n instanceof H.EI&&n.isExpected?{resultType:he.b.ExpectedFailure}:{resultType:he.b.Failure}}),a.label=3;case 3:return[2]}})})}};return o})};return{instance:i}}}}),Nc=!1,Bc=function(){Nc||((0,l.bV)({icons:{QuestionCircleRegular:p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},p.createElement("g",{id:"Fluent-icon"},p.createElement("path",{id:"Shape",d:"M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2ZM10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3ZM10 13.5C10.4142 13.5 10.75 13.8358 10.75 14.25C10.75 14.6642 10.4142 15 10 15C9.58579 15 9.25 14.6642 9.25 14.25C9.25 13.8358 9.58579 13.5 10 13.5ZM10 5.5C11.3807 5.5 12.5 6.61929 12.5 8C12.5 8.72959 12.1848 9.40774 11.6513 9.8771L11.4967 10.0024L11.2782 10.1655L11.1906 10.2372C11.1348 10.2851 11.0835 10.3337 11.0346 10.3859C10.6963 10.7464 10.5 11.2422 10.5 12C10.5 12.2761 10.2761 12.5 10 12.5C9.72386 12.5 9.5 12.2761 9.5 12C9.5 10.988 9.79312 10.2475 10.3054 9.70162C10.4165 9.5832 10.532 9.47988 10.6609 9.37874L10.9076 9.19439L11.0256 9.09468C11.325 8.81435 11.5 8.42206 11.5 8C11.5 7.17157 10.8284 6.5 10 6.5C9.17157 6.5 8.5 7.17157 8.5 8C8.5 8.27614 8.27614 8.5 8 8.5C7.72386 8.5 7.5 8.27614 7.5 8C7.5 6.61929 8.61929 5.5 10 5.5Z",fill:"#F3F2F1"}))),PersonFeedbackRegular:p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},p.createElement("g",{id:"Fluent-icon"},p.createElement("path",{id:"Shape",d:"M10.5 12C11.3284 12 12 12.6716 12 13.5V14C12 15.9714 10.1405 18 7 18C3.85951 18 2 15.9714 2 14V13.5C2 12.6716 2.67157 12 3.5 12H10.5ZM10.5 13H3.5C3.22386 13 3 13.2239 3 13.5V14C3 15.4376 4.43216 17 7 17C9.56784 17 11 15.4376 11 14V13.5C11 13.2239 10.7761 13 10.5 13ZM7 5.5C8.51878 5.5 9.75 6.73122 9.75 8.25C9.75 9.76878 8.51878 11 7 11C5.48122 11 4.25 9.76878 4.25 8.25C4.25 6.73122 5.48122 5.5 7 5.5ZM16 2C17.0544 2 17.9182 2.81588 17.9945 3.85074L18 4V6C18 7.05436 17.1841 7.91817 16.1493 7.99451L16 8H14.499L13.301 9.59979C12.7716 10.306 11.6965 10.0199 11.5243 9.22426L11.5066 9.11264L11.5008 9L11.5 7.935L11.4224 7.91532C10.697 7.69685 10.1452 7.07753 10.0246 6.3148L10.0055 6.14926L10 6V4C10 2.94564 10.8159 2.08183 11.8507 2.00549L12 2H16ZM7 6.5C6.0335 6.5 5.25 7.2835 5.25 8.25C5.25 9.2165 6.0335 10 7 10C7.9665 10 8.75 9.2165 8.75 8.25C8.75 7.2835 7.9665 6.5 7 6.5ZM16 3H12C11.4872 3 11.0645 3.38604 11.0067 3.88338L11 4V6C11 6.51284 11.386 6.93551 11.8834 6.99327L12 7H12.5008V9L14 7H16C16.5128 7 16.9355 6.61396 16.9933 6.11662L17 6V4C17 3.48716 16.614 3.06449 16.1166 3.00673L16 3Z",fill:"#F3F2F1"}))),LearningAppRegular:p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},p.createElement("g",{id:"Fluent-icon"},p.createElement("path",{id:"Shape",d:"M6 3H14C14.5523 3 15 3.44772 15 4V9.02242C15.3434 9.05337 15.6777 9.11588 16 9.20703V4C16 2.89543 15.1046 2 14 2H6C4.89543 2 4 2.89543 4 4V16C4 17.1046 4.89543 18 6 18H10.2572C10.0035 17.6929 9.78261 17.3578 9.59971 17H6C5.44772 17 5 16.5523 5 16H9.20703C9.11588 15.6777 9.05337 15.3434 9.02242 15H5V4C5 3.44772 5.44772 3 6 3ZM7 4C6.44772 4 6 4.44772 6 5V6C6 6.55228 6.44772 7 7 7H13C13.5523 7 14 6.55228 14 6V5C14 4.44772 13.5523 4 13 4H7ZM13 5V6H7V5H13ZM19 14.5C19 16.9853 16.9853 19 14.5 19C12.0147 19 10 16.9853 10 14.5C10 12.0147 12.0147 10 14.5 10C16.9853 10 19 12.0147 19 14.5ZM14.0203 12.534C13.9423 12.4811 13.8559 12.4546 13.7609 12.4546C13.6948 12.4546 13.6321 12.4687 13.5728 12.4969C13.5134 12.5234 13.4617 12.5596 13.4177 12.6054C13.3736 12.6513 13.338 12.7051 13.3108 12.7668C13.2854 12.8286 13.2727 12.8938 13.2727 12.9626V16.0374C13.2727 16.1045 13.2854 16.1689 13.3108 16.2306C13.338 16.2924 13.3736 16.347 13.4177 16.3947C13.4634 16.4405 13.516 16.4776 13.5753 16.5058C13.6346 16.5323 13.6965 16.5455 13.7609 16.5455C13.8101 16.5455 13.8559 16.5384 13.8983 16.5243C13.9423 16.5102 13.9856 16.489 14.028 16.4608L16.3242 14.8943C16.3937 14.8485 16.448 14.7867 16.4869 14.7091C16.5259 14.6315 16.5454 14.5503 16.5454 14.4656C16.5454 14.3774 16.5251 14.2963 16.4844 14.2222C16.4437 14.1463 16.3878 14.0855 16.3166 14.0396L14.0203 12.534Z",fill:"#F3F2F1"})))}}),Nc=!0)},jc={actionProvider:Rc},Vc="feedbackCommand",zc=new H.hK({name:"FeedbackCommand",factory:{dependencies:jc,create:function(e){var t=e.actionProvider;return Bc(),{instance:{id:Vc,automationId:Vc,title:ot.C,name:ot.C,iconProps:{iconName:"PersonFeedbackRegular"},evaluateAction:t.evaluateAction}}}}}),Gc={oneUpStateStore:He.e},Kc={actionProvider:new H.hK({name:"TutorialFreAction",factory:{dependencies:Gc,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n=t.oneUpStateStore.currentAppState.isOneUpFreOpen;return{isAvailable:!0,id:"TutorialFre",isDisabled:n,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){return n||t.oneUpStateStore.updateOneUpShellFreIsOpen("tutorialFreAction",!0),[2]})})}}})}}}}})},Wc="tutorialFreCommand",qc=new H.hK({name:"TutorialFreCommand",factory:{dependencies:Kc,create:function(e){var t=e.actionProvider;return Bc(),{instance:{id:Wc,automationId:Wc,title:ot.Cb,name:ot.Cb,iconProps:{iconName:"LearningAppRegular"},evaluateAction:t.evaluateAction}}}}}),Qc={feedbackCommand:zc,tutorialFreCommand:qc},Yc="helpCommandGroup",Jc=function(e){return{isAvailable:!0}},Xc=new H.hK({name:"HelpGroupCommand",factory:{dependencies:Qc,create:function(e){var t=e.feedbackCommand,n=e.tutorialFreCommand;return Bc(),{instance:{id:Yc,name:ot.N,title:ot.N,automationId:Yc,subCommands:[t,n],evaluateAction:Jc,iconProps:{iconName:"QuestionCircleRegular"}}}}}}),Zc=n(598),$c=!1,ed=function(e){var t=e.oneUpStore,n=e.oneUpStateStore,i=e.pageContext,r=e.resources,o=e.getExecutor;return function(){var e,s,c=xc(null===(e=t.focusItem)||void 0===e?void 0:e.permissions),d={isAvailable:!i.isAnonymousGuestUser&&(s=c,s===bc.a.restrictedview),id:"DownloadRequestAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e;return(0,a.qr)(this,function(a){switch(a.label){case 0:return(e=t.getOneUpProperties())&&c?[4,o()]:[3,3];case 1:return[4,a.sent().showRequestMoreAccessDialog({item:e.focusItem,pageContext:i,itemRole:c,requestRole:bc.a.view,resources:r,onClose:function(){n.updateModalState("downloadRequestCommand",{showModal:!1,content:void 0})},onRender:function(e){n.updateModalState("downloadRequestCommand",{showModal:!0,content:e})}})];case 2:a.sent(),a.label=3;case 3:return[2]}})})}};return d}},td={oneUpStore:ne.b,oneUpStateStore:He.e,pageContext:R.a,resources:H.Ci,getExecutor:Cc.async.lazy},nd={actionProvider:new H.hK({name:"DownloadRequestAction",factory:{dependencies:td,create:function(e){return{instance:{evaluateAction:ed(e)}}}}})},ad="downloadRequestMoreAccessCommand",id=function(e){var t=e.onClick,n=e.dismissMenu,a=(0,l.n6)(),i=p.useCallback(function(){t(),n(void 0,!0)},[]),r=p.useCallback(function(){n(void 0,!0)},[]);return p.createElement("div",{id:"RequestDownload-container",style:{display:"flex",flexDirection:"row",padding:"8px",backgroundColor:"#292827"}},p.createElement($a.a,{iconName:"InfoSolid",styles:{root:{paddingRight:"8px",paddingTop:"8px",color:"white"}}}),p.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:"20px",paddingTop:"5px"}},p.createElement("div",{id:"RequestDownload-title",style:{fontWeight:600,color:"white"}},ot.t),p.createElement("div",null,p.createElement(jn.a,{id:"RequestDownload-button",styles:{root:{padding:"7px 0px",height:"auto",color:"#2899F5"},rootHovered:{textDecoration:"underline"},label:{margin:"0"}},onClick:i},ot.fb))),p.createElement(jn.e,{id:"RequestDownload-cancel",onClick:r,iconProps:{iconName:"Cancel"},styles:{root:{color:a.palette.white}}}))},rd=new H.hK({name:"DownloadRequestCommand",factory:{dependencies:nd,create:function(e){var t=e.actionProvider;return{instance:{id:ad,name:ot.r,automationId:ad,iconProps:{iconName:"Feedback"},contextualMenuStyles:{title:{},root:{backgroundColor:"#292827"},list:{padding:"0"},header:{},container:{},subComponentStyles:{menuItem:{},callout:{calloutMain:{backgroundColor:"#292827"}}}},evaluateAction:t.evaluateAction,evaluateRenderMenuList:function(e){return function(t,n){return p.createElement(id,{onClick:e,item:t,dismissMenu:n})}}}}}}}),od={blockDownloadActionProvider:new H.hK({name:"BlockDownloadAction",factory:{dependencies:{},create:function(){return{instance:{evaluateAction:function(){return{isAvailable:!0,id:"BlockDownloadAction",onExecute:function(){}}}}}}}}),downloadRequestMoreAccessCommand:rd},sd="blockDownloadCommand",cd=new H.hK({name:"BlockDownloadCommand",factory:{dependencies:od,create:function(e){var t=e.blockDownloadActionProvider,n=e.downloadRequestMoreAccessCommand,a={id:sd,name:ot.b,title:ot.c,automationId:sd,subCommands:[n],buttonStyles:{menuIcon:{display:"none"}},iconProps:{iconName:"BlockDownload"},evaluateAction:t.evaluateAction};return $c||((0,l.bV)({icons:{BlockDownload:p.createElement("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L10.9993 12.0602L10.999 16.4329L7.27997 12.7192L7.1958 12.6467C6.90204 12.429 6.48539 12.4535 6.21931 12.72C5.92661 13.0131 5.92694 13.4879 6.22003 13.7806L11.2235 18.7772L11.3076 18.8498C11.6012 19.0673 12.0176 19.043 12.2837 18.7769L15.0001 16.0611L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM13.9393 15.0002L12.499 16.4399L12.4992 13.5601L13.9393 15.0002ZM17.1218 13.9399L16.0611 12.8792L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L17.1218 13.9399ZM10.9996 7.81764L12.4995 9.31756L12.5 2.75488L12.4932 2.65311C12.4435 2.28704 12.1297 2.00488 11.75 2.00488L11.6482 2.01173C11.2822 2.06139 11 2.37519 11 2.75488L10.9996 7.81764ZM18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999Z",fill:"currentColor"}))}}),$c=!0),{instance:a}}}}),dd="EditInAppAction",ld={oneUpStore:ne.b,platform:$.a,oneUpStateStore:He.e,itemUrlHelper:Q.c,getValidViewerTypesFromResource:ve.b,resources:H.Ci,getExecutor:Io.async.lazy},ud={actionProvider:new H.hK({name:"EditInAppAction",factory:{dependencies:ld,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e,t,n){if(!(t.isWindows||t.isMac||(0,On.c)()&&(t.isWinPhone||t.isAndroid||t.isIOS))||!e)return!1;if(n===ve.a.Copilot)return!1;var a=!!tt.a.hasItemPermission(e,tt.a.openItems);return(n===ve.a.MSPdf||n===ve.a.Pdf||n===ve.a.Photo)&&a&&!e.appMap&&tt.a.hasItemPermission(e,tt.a.insertListItems)&&tt.a.hasItemPermission(e,tt.a.editListItems)}(e.item,t.platform,t.getValidViewerTypesFromResource.getValidViewerTypes(e.item)),i=t.oneUpStore.getOneUpProperties(),r={isAvailable:n,id:dd,onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,n,r,o,s;return(0,a.qr)(this,function(a){switch(a.label){case 0:return n=(e=i).focusItem,r=e.parentItem,o=e.focusItemSet,i&&o&&o.length&&n&&r?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeOpenInApp({item:n,pageContexts:i.pageContexts,resources:t.resources})];case 2:return a.sent(),[2,{resultType:he.b.Success}];case 3:throw s=(0,ge.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(dd,{errorType:ge.d.actionError,error:s,item:n}),s}})})}};return r})}};var t}}}),oneUpStore:ne.b},fd="EditInAppCommand",pd=new H.hK({name:"EditInAppCommand",factory:{dependencies:ud,create:function(e){return{instance:{id:fd,name:ot.W,title:ot.W,automationId:fd,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:e.actionProvider.evaluateAction}}}}}),md=new H.hK({name:"isImageEditableInOneUp.key",factory:new H.t_(function(){return!0})}),_d={oneUpStateStore:He.e,getValidViewerTypesFromResource:ve.b,pdfViewerHelper:zt.b,isImageEditable:md},hd=new H.hK({name:"EditAction",factory:{dependencies:_d,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i,r,o,s,c=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),d=c===ve.a.Photo&&tt.a.hasItemPermission(e.item,tt.a.editListItems)&&t.isImageEditable(),l=t.oneUpStateStore.currentAppState,u=(null===(n=l.eSignData)||void 0===n?void 0:n.isCreateSidePanelActive)||(null===(i=l.annotationViewerState)||void 0===i?void 0:i.isActive);if(c===ve.a.MSPdf){var f=null===(o=null===(r=l.viewerStates)||void 0===r?void 0:r.get(e.item.key))||void 0===o?void 0:o.pdfViewerStates;d=t.pdfViewerHelper.isPdfEditAvailable(e.item)&&t.pdfViewerHelper.isPdfEditable(e.item)&&!(null==f?void 0:f.isPdfMip)&&!u&&(null===(s=null==f?void 0:f.isAnnotAllowed)||void 0===s||s)}return{isAvailable:d,id:"EditAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){return t.oneUpStateStore.currentAppState.rightPane.type!==He.d.none&&t.oneUpStateStore.updateRightPaneState("closeRightPane",{type:He.d.none,content:void 0}),c===ve.a.MSPdf?t.oneUpStateStore.updatePdfState("updatePdfAppMode",Qe.a.Edit):t.oneUpStateStore.updateImageState("openImageEditor",He.c.edit),[2]})})}}})};return{instance:n}}}}),bd={editInClipchampCommand:yo,editInAppCommand:pd,actionProvider:hd},gd="editSplitCommand",vd=H.HW.isActivated("cf60fb7c-d5d8-4232-9286-0ee6464b542a","07/11/2024","Refine style of the edit split button when no subcommands are available"),yd={splitButtonMenuButton:{width:"24px !important"},label:{textOverflow:"ellipsis",overflow:"hidden"},flexContainer:{padding:"0px 8px !important"}},Sd=new H.hK({name:"EditSplitCommand",factory:{dependencies:bd,create:function(e){var t,n=e.editInClipchampCommand,i=e.editInAppCommand,r=e.actionProvider,o=[n,i];return{instance:(0,a.W_)((0,a.W_)({id:gd,name:ot.u,automationId:gd,subCommands:o,evaluateAction:r.evaluateAction,isSplit:!0,splitButtonAriaLabel:ot.w,title:ot.u},vd?{buttonStyles:yd}:{evaluateButtonStyles:function(e){return o.some(function(t){return t.evaluateAction({item:e}).isAvailable})?yd:(0,Ao.a)()}}),{iconProps:{iconName:"Edit"},properties:(t={},t["aria-roledescription"]=ot.Db,t)})}}}}),Dd=new H.hK({name:"SyntexTranslateExecutor.key",loader:new H.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(54)]).then(n.bind(n,685)).then(function(e){return e.translateActionExecutorKey})})}),Id=H.HW.isActivated("48b367b1-f71c-4fcc-bf00-9ebcbe2665ff","04/11/2024","Settings check for syntex translation in ODB My files"),xd={oneUpStateStore:He.e,getExecutor:Dd.async.lazy,oneUpStore:ne.b,pageContext:R.a},Cd=new Set([".csv",".doc",".docx",".htm",".html",".markdown",".md",".msg",".odp",".ods",".pdf",".ppt",".pptx",".rtf",".txt",".xls",".xlsx"]),Od=function(e){return function(t){var n,i=e.pageContext,r=e.oneUpStore.getOneUpProperties(),o=null==r?void 0:r.focusItem,s=null!==(n=null==o?void 0:o.extension)&&void 0!==n?n:"",c=!1;Id?c=(0,Ct.Z)(Ct.D)&&!!(null==i?void 0:i.isSyntexPAYGEnabled)&&!!(null==i?void 0:i.isSyntexTranslationEnabled)&&((null==i?void 0:i.listBaseTemplate)===fo.a.documentLibrary||(null==i?void 0:i.listBaseTemplate)===fo.a.mySiteDocumentLibrary)&&Cd.has(s):(null==i?void 0:i.listBaseTemplate)===fo.a.mySiteDocumentLibrary?c=!!(null==i?void 0:i.isSyntexPAYGEnabled)&&!!(null==i?void 0:i.isODBSyntexTranslationEnabled)&&(0,Ct.Z)(Ct.D)&&Cd.has(s):(null==i?void 0:i.listBaseTemplate)===fo.a.documentLibrary&&(c=!!(null==i?void 0:i.isSyntexPAYGEnabled)&&!!(null==i?void 0:i.isSyntexTranslationEnabled)&&(0,Ct.Z)(Ct.D)&&Cd.has(s));var d=null==i?void 0:i.listPermsMask,l=!!d&&tt.b.hasPermission(d,tt.b.manageLists),u={isAvailable:c&&l,id:"syntexTranslateAction",onExecute:function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var t,n;return(0,a.qr)(this,function(a){switch(a.label){case 0:if(!o)return[3,5];t={item:o,pageContext:i,onRender:function(t){e.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!0,content:t})},onClose:function(){e.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!1,content:void 0})}},a.label=1;case 1:return a.trys.push([1,4,,5]),[4,e.getExecutor()];case 2:return[4,a.sent().showTranslationDialog(t)];case 3:return a.sent(),[2,{resultType:ro.a.Success}];case 4:return n=a.sent(),[2,{resultType:ro.a.Failure,exception:n}];case 5:return[2]}})})}};return u}},wd={actionProvider:new H.hK({name:"SyntexTranslateAction",factory:{dependencies:xd,create:function(e){return{instance:{evaluateAction:Od(e)}}}}})},Ed="syntexTranslateCommand",Ad=new H.hK({name:"SyntexTranslateCommand",factory:{dependencies:wd,create:function(e){var t=e.actionProvider;return{instance:{id:Ed,name:ot.Ib,title:ot.xb,automationId:Ed,iconProps:{iconName:"MicrosoftTranslatorLogo"},evaluateAction:t.evaluateAction}}}}}),Ld=n(64);function kd(){return!H.HW.isActivated("38e570f6-99f2-4061-8d53-4bbfa2e7c692","09/03/2024","RMA dialog KS")&&(!!(0,Ct.ob)()||!!Ts&&1===Ts.variantToDisplay)}var Md=!H.HW.isActivated("e716b6d4-f575-4940-bc25-37eee28d93a","04/15/2024","Display translate command in 1-up viewer"),Pd={oneUpStore:ne.b,dividerCommand:ji,openInfoPaneCommand:Ro,closeCommand:ar,downloadCommand:St,favoriteCommand:yr,blockDownloadCommand:cd,openGroupCommand:Po,editSplitCommand:Sd,saveCommand:No.saveCommandKey,copyToCommand:Jo,deleteCommand:as,annotateCommand:fs,commentsCommand:gs,toggleESignCommand:Hs,printCommand:Gs,pdfExtractCommand:Js,pdfMergeCommand:tc,openVersionHistoryCommand:oc,embedCommand:fc,viewOriginalImageCommand:hc,openCopilotPaneCommand:fi.a,requestMoreAccessCommand:Uc,presenceCommand:Fc.a,shareGroupCommand:Zc.a,translateCommand:Ad,helpCommandGroup:Xc},Td=new H.hK({name:"GenerateOneUpCommandBarWorkingSet",factory:{dependencies:Pd,create:function(e){var t=e.dividerCommand,n=e.openInfoPaneCommand,a=e.closeCommand,i=e.downloadCommand,r=e.favoriteCommand,o=e.blockDownloadCommand,s=e.openGroupCommand,c=e.editSplitCommand,d=e.saveCommand,l=e.copyToCommand,u=e.deleteCommand,f=e.annotateCommand,p=e.commentsCommand,m=e.printCommand,_=e.toggleESignCommand,h=e.pdfExtractCommand,b=e.pdfMergeCommand,g=e.openVersionHistoryCommand,v=e.embedCommand,y=e.viewOriginalImageCommand,S=e.openCopilotPaneCommand,D=e.requestMoreAccessCommand,I=e.presenceCommand,x=e.shareGroupCommand,C=e.translateCommand,O=e.helpCommandGroup;return{instance:{generateWorkingSets:function(){return{main:this.generateMainWorkingSet(),far:this.generateFarWorkingSet(),overflow:this.generateOverflowWorkingSet()}},generateMainWorkingSet:function(){var e=[];return e.push(d,i),(0,Ct.Z)(Ct.P)&&e.push(r),kd()&&e.push(o),e.push(u,t,f,_,h,b,n),e},generateOverflowWorkingSet:function(){var e=[];return Md&&e.push(C),e.push(l,m,y,v,g),(0,Ct.Z)(Ct.R)&&e.push(O),e},generateFarWorkingSet:function(){var e=[];return(0,Ct.Z)(Ct.g)&&e.push(I),(0,Ct.Z)(Ct.r)&&e.push(p),e.push(S),kd()&&e.push(D),e.push(s(),c,x,a),e}}}}}}),Ud={generateOneUpCommandBarWorkingSet:Td},Fd=new H.hK({name:"FileHandlerCommandsWorkingSetOverrideFunc",factory:{dependencies:Ud,create:function(e){return{instance:{read:function(){return function(){return e.generateOneUpCommandBarWorkingSet.generateWorkingSets()}}}}}}}),Hd={oneUpStore:ne.b,generateOneUpCommandBarWorkingSet:Td,fileHandlerCommandWorkingSetOverrideFunc:Fd},Rd=new H.hK({name:"OneUpCommandBarManager",factory:{dependencies:Hd,create:function(e){var t=e.generateOneUpCommandBarWorkingSet.generateWorkingSets(),n=e.oneUpStore.focusItem?new qi({item:e.oneUpStore.focusItem,showCommands:!0,workingSet:t}):void 0;return(0,Ct.S)()&&(null==n||n.addWorkingSetOverride(e.fileHandlerCommandWorkingSetOverrideFunc)),{instance:n,disposable:n}}}}),Nd=n(320);(0,l.Bv)([{rawString:".OneUpNonInteractiveCommandWrapper_156f96ef{justify-content:center;align-items:center;line-height:40px;font-size:16px;display:flex;flex-wrap:nowrap}.OneUpNonInteractiveCommandSpan_156f96ef{display:contents;justify-content:center;align-items:center}.OneUpNonInteractiveCommand_156f96ef{cursor:default;color:"},{theme:"black",defaultValue:"#000"},{rawString:";vertical-align:top;line-height:40px}.OneUpNonInteractiveCommandNewDesign_156f96ef{cursor:default;color:#fff;vertical-align:top;line-height:40px}.OneUpNonInteractiveIconNewDesign_156f96ef{margin:0 4px;color:#fff}.OneUpNonInteractiveTitleIcon_156f96ef{margin:0 6px}"}]);const Bd="OneUpNonInteractiveCommandWrapper_156f96ef";var jd=function(){return function(e){var t;return m().createElement("div",{className:Bd,role:"menuitem",id:e.id,"aria-label":e.ariaLabel,tabIndex:-1,"aria-disabled":!0},(null===(t=e.iconProps)||void 0===t?void 0:t.iconName)?m().createElement("span",{className:"OneUpNonInteractiveCommandSpan_156f96ef"},m().createElement($a.a,{className:"OneUpNonInteractiveIconNewDesign_156f96ef",iconName:e.iconProps.iconName})):m().createElement(m().Fragment,null))}},Vd=n(78),zd=n(198),Gd=H.HW.isActivated("675a5397-4561-4df2-a9d8-cb730d9c9b88");function Kd(e,t){var n=e.displayName,a=!1;if(n)if(Gd)n.length>23&&(n=null==n?void 0:n.replace(/(.{21}).+(\..+)/,"$1...$2"),a=!0);else{var i=Array.from(n);if(i&&i.length>23){var r=Math.floor(11.5),o=i.slice(0,r).join(""),s=i.slice(i.length-r).join("");n="".concat(o,"...").concat(s),a=!0}}return{key:"title",id:"titleCommand",text:n,title:a?e.displayName:void 0,iconProps:{iconName:e.iconName},commandBarButtonAs:function(e){var t,n=m().createElement(Nd.a,{className:(0,l.vJ)("OneUpNonInteractiveCommandNewDesign_156f96ef","OneUpCommandBarTitle")},e.text),a="OneUpNonInteractiveTitleIcon_156f96ef";return m().createElement("div",{className:(0,l.vJ)(Bd,"OneUpCommandBarTitleWrapper"),role:"menuitem"},m().useMemo(function(){var t;return(null===(t=e.iconProps)||void 0===t?void 0:t.iconName)?m().createElement(Xn,{iconName:e.iconProps.iconName,desiredSize:17,iconSize:32,fileExtention:"svg",className:a,iconFieldAriaLabel:ot.Gb}):m().createElement(m().Fragment,null)},[a,null===(t=e.iconProps)||void 0===t?void 0:t.iconName]),e.title?m().createElement(Vn.a,{content:e.title},n):n)},data:{automationid:"titleCommand"}}}function Wd(e){var t=e.command,n=e.onClickQos,a=e.onClickCustomerPromise,i=e.computeVeto;if(t.action.onExecute){var r=t.action.onExecute({qosEvent:n});r&&r.then(function(e){var t=e||{resultType:he.b.Success};n.end(t),null==a||a.end(t)}).catch(function(e){var r=new H.EI({code:"OneUpCommandException",innerError:e,extraData:{commandId:t.id}}),o=(0,be.a)(r);n.end(o),a&&Jd(r,a,o,i)})}else{var o=new H.EI({code:"NoAvailableAction",extraData:{commandId:t.id}});n.end((0,be.a)(o)),null==a||a.end((0,be.a)(o))}}function qd(e,t,n){var i=e.action.customerPromise||{},r=i.startSchema,o=i.computeVeto,s="OneUpLightSpeed.commandInvoked.".concat(e.id),c=new he.a({name:s,extraData:{extention:t.extension,viewer:t.viewer}}),d=new Ce((0,a.W_)((0,a.W_)({scenario:s,perfGoalInMs:ge.b},r||{}),{extraData:(0,a.W_)({extention:t.extension,viewer:t.viewer},(null==r?void 0:r.extraData)||{})}));t.commandName=(null==e?void 0:e.id)||(null==e?void 0:e.name)||(null==e?void 0:e.title)||"UnknownCmdBar",(0,ri.g)("".concat(ri.c,".").concat(ri.a),t);var l={command:e,onClickQos:c,onClickCustomerPromise:d,computeVeto:o,fallbackErrorMsg:"Unhandled exception executing an action"};try{"CloseAction"===e.action.id&&e.action.isAvailable&&n?n().then(function(){Wd(l)}).catch(function(){}):Wd(l)}catch(e){var u=new H.EI({code:"commandExecutionError",innerError:e}),f=(0,be.a)(u);c.end(f),d&&Jd(u,d,f,o)}}function Qd(e,t,n,i){var r,o,s,c,d,l=[];if(e&&e.length>0)for(var u=function(u){var f,p,m=!!i||!e[u].name,_=!!(e[u].isSplit&&e[u].subCommands&&(null===(r=e[u].subCommands)||void 0===r?void 0:r.length))||void 0,h=(0,a.W_)(((f={key:e[u].id,id:e[u].id,iconOnly:m,iconProps:e[u].iconProps,text:e[u].name,title:m?void 0:e[u].title,disabled:e[u].action.isDisabled,onRender:e[u].onRender,onClick:function(){return qd(e[u],t,n)},buttonStyles:e[u].buttonStyles,split:_,splitButtonAriaLabel:e[u].splitButtonAriaLabel})["data-automation-id"]=e[u].automationId||e[u].action.id,f.ariaLabel=(null===(o=e[u].properties)||void 0===o?void 0:o["aria-label"])||e[u].title||e[u].name,f.data=((p={automationid:e[u].automationId||e[u].action.id})["aria-label"]=(null===(s=e[u].properties)||void 0===s?void 0:s["aria-label"])||e[u].title||e[u].name,p),f.tooltipHostProps={content:e[u].title||e[u].name},f),null===(c=e[u])||void 0===c?void 0:c.properties);h.iconProps=(0,a.W_)((0,a.W_)({},h.iconProps),{style:(0,a.W_)((0,a.W_)({},null===(d=h.iconProps)||void 0===d?void 0:d.style),{color:"inherit"})});var b=e[u].subCommands;b&&b.length>0&&(h.subMenuProps=function(e,t){for(var n,a,i,r=[],o={},s=function(s){var c,d=((c={key:e[s].id,iconProps:e[s].iconProps,text:e[s].name,title:e[s].title,disabled:e[s].action.isDisabled,onRender:e[s].onRender,onClick:function(){return qd(e[s],t)}})["data-automation-id"]=e[s].automationId||e[s].action.id,c.ariaLabel=(null===(n=e[s].properties)||void 0===n?void 0:n["aria-label"])||e[s].title||e[s].name,c),l=e[s].evaluateRenderMenuList;l&&(d.onRender=l(function(){return qd(e[s],t)})),a=e[s].contextualMenuStyles,(i=e[s].groupHeader)&&!o[i]&&(r.push({key:i,itemType:2,text:i}),o[i]=!0),r.push(d)},c=0;c<e.length;c++)s(c);return{items:r,styles:a,ariaLabel:i}}(b,t)),l.push(h)},f=0;f<e.length;f++)u(f);return l}function Yd(e,t,n,a){e.calcDisplaySet(t.focusItem,t.parentItem);var i=e.displaySet,r=[],o=[];return i&&i.main&&i.main.length>0&&(r=Qd(i.main,n,void 0,!0)),i&&i.overflow&&i.overflow.length>0&&(o=Qd(i.overflow,n)),i&&i.far&&i.far.length>0?{main:r,overflow:o,far:Qd(i.far,n,a)}:{main:r,overflow:o,far:[]}}function Jd(e,t,n,a){var i=(0,zd.a)(e,{computeVeto:a,qosEndSchema:n});t.end(i)}var Xd=function(e){return p.createElement(Vn.a,{content:ot.U},p.createElement(jn.b,(0,a.W_)({},e)))};function Zd(e){var t=(0,V.c)(),n=t.consume(ne.b),i=p.useContext(ri.d),r=p.useRef(t.consume(ve.b)).current.getValidViewerTypes,o=p.useState(n.getOneUpProperties()),s=o[0],c=o[1],d=p.useState(!0),l=d[0],u=d[1],f=p.useState(!0),m=f[0],_=f[1],h=p.useRef(void 0),b=p.useCallback(function(){if(s){var t=(0,a.W_)({extension:s.focusItem.extension||"",viewer:r(s.focusItem)},i),n=h.current?Yd(h.current,s,t,e.onCloseCallback):void 0;if(n)return n}return{main:[],overflow:[],far:[]}},[s,h]),g=p.useCallback(function(){return b()},[b]),v=p.useCallback(function(){return b().main},[b]),y=p.useCallback(function(){return b().overflow},[b]),S=v(),D=p.useState(S),I=D[0],x=D[1],C=y(),O=p.useState(C),w=O[0],E=O[1],A=p.useState(function(){if(s){var t=(0,a.W_)({extension:s.focusItem.extension||"Unknown",viewer:r(s.focusItem)},i),n=h.current?Yd(h.current,s,t,e.onCloseCallback):void 0;if(n)return n.far}return[]}),L=A[0],k=A[1],M=p.useCallback(function(){return function(e){var t=e.map(function(e){return e.key}).indexOf("mainDividerCommand");if(t>-1){var n=e[t];n=(0,a.W_)((0,a.W_)({},n),{iconOnly:!0,disabled:!0,ariaLabel:ot.q,commandBarButtonAs:jd(),onRender:function(e){return function(e,t){if(e.renderedInOverflow||t<1)return p.createElement(p.Fragment,null);var n=jn.b,i=(0,Vd.a)(jd(),n);return p.createElement(i,(0,a.W_)({},e))}(e,t)}}),e[t]=n}}(I),[I,L]},[I,L]),P=(0,_e.a)(function(e,t){if(e&&t){var n=t.get(e);if(n){u(void 0===n.showMainCommands||n.showMainCommands),_(void 0===n.showTitle||n.showTitle);var a=g();x(a.main),E(a.overflow),k(a.far)}else u(!0),_(!0)}else u(!0),_(!0)}),T=(0,He.f)("currentState",function(e){return e.viewerStates})[0];p.useEffect(function(){P(null==s?void 0:s.focusItem.key,T)},[T,s,P]);var U=(0,He.f)("currentState",function(e){return e.eSignData})[0],F=(0,He.f)("currentState",function(e){return e.annotationViewerState})[0];p.useEffect(function(){var e=b();x(e.main),E(e.overflow),k(e.far)},[U,F,b]);var H=(0,He.f)("currentState",function(e){return e.isFocusItemFavorited})[0];p.useEffect(function(){if((null==s?void 0:s.focusItem)&&(0,Ct.Z)(Ct.P)){var e=b();x(e.main)}},[H]);var R=(0,He.f)("currentState",function(e){return e.isUniversalPrintLicenseValid})[0];p.useEffect(function(){if((null==s?void 0:s.focusItem)&&(0,Ct.Z)(Ct.s)){var e=b();x(e.main)}},[R]);var N=(0,He.f)("currentState",function(e){return e.fileHandlerOptions})[0];p.useEffect(function(){if(N){(0,Ct.S)()&&h.current&&h.current.updateWorkingSetOverride({publisher:"fileHandlerData"});var e=b();k(e.far)}},[N,b,t]);var B=p.useMemo(function(){return s&&m?[Kd(s.focusItem,r(s.focusItem))]:[]},[null==s?void 0:s.focusItem]);(0,gi.b)({updateOneUpStatus:function(n){if("update"in n.detail&&n.detail.update&&"publisher"in n.detail){var o=n.detail.update;h.current||(h.current=t.consume(Rd));var s=(0,a.W_)({extension:o.focusItem.extension||"Unknown",viewer:r(o.focusItem)},i),d=h.current?Yd(h.current,o,s,e.onCloseCallback):void 0;if(c(o),null==d?void 0:d.main){var l=d.main;x(l),(null==d?void 0:d.overflow)&&E(d.overflow)}(null==d?void 0:d.far)&&k(d.far)}}},ne.a.oneUpItemCacheUpdate);var j=M(),z={id:"oneupCommandBarOverflow","data-automationid":"overflowButton",menuProps:{items:[],id:"oneupCommandBarOverflowMenu",isBeakVisible:!1},"aria-label":ot.U};return p.createElement(Ri,{id:"OneUpCommandBar",items:l&&j?j[0]:[],overflowItems:l?w:[],middleItems:B,farItems:j?j[1]:[],overflowButtonProps:z,overflowButtonAs:Xd})}(0,l.Bv)([{rawString:".reatOneUpToast_dbebf17a{position:absolute;bottom:12px;left:50%;transform:translate(-50%,0)}"}]);var $d=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(39).then(n.bind(n,612))];case 1:return[2,e.sent().ToastComponent]}})})}),el=function(e){var t,n,a=e.toastData;return a?p.createElement("div",{className:"reatOneUpToast_dbebf17a","data-automation-id":"ReactOneUpToastContainer"},(t=[],n=0,a.forEach(function(e,a){t.push(p.createElement($d,{index:n++,visible:e.visible,actionStatus:e.actionStatus,displayText:e.displayText,toastKey:e.toastKey,actionButtons:e.actionButtons}))}),t)):p.createElement(p.Fragment,null)},tl=n(332),nl=!H.HW.isActivated("058098C5-2E70-4392-980F-D2B0F0E85353"),al=p.lazy(function(){return n.e(47).then(n.bind(n,670))}),il=p.lazy(function(){return Promise.all([n.e("ondemand.resx"),n.e(20)]).then(n.bind(n,671))});function rl(){var e=(0,He.f)("currentState",function(e){return e.modal})[0];return e&&(null==e?void 0:e.showModal)?p.createElement("div",{id:"OneUpModalContainer"},e.content):p.createElement(p.Fragment,null)}function ol(){var e=(0,He.f)("currentState",function(e){return e.imageMode!==He.c.edit&&e.pdfAppMode!==Qe.a.Edit&&e.pdfAppMode!==Qe.a.Esign&&e.pdfAppMode!==Qe.a.Extract})[0],t=(0,He.f)("currentState",function(e){return e.toast})[0],n=(0,He.f)("currentState",function(e){return e.errorState})[0];!function(){var e=(0,V.c)(),t=(0,gi.a)(),n=window.location.search.substring(1),a=(0,H.k1)(n),i="true"===a.openShare,r="true"===a.openRMA;m().useEffect(function(){var n,a,o;if(i&&t){var s=t.focusItem;n=(c=e.consume(tl.c).evaluateAction({item:s})).isAvailable,a=c.onExecute,o=new Error("no available action for ".concat(tl.c.name))}else if(kd()&&r&&t){var c;n=(c=e.consume(Ac).evaluateAction()).isAvailable,a=c.onExecute,o=new Error("no available action for ".concat(Ac.name))}if(t&&(i||kd()&&r)){var d=new he.a({name:"OneUpLightSpeed.autoActionExecutorInvoked"}),l="Unhandled exception executing an auto action";try{if(n&&a){var u=a({qosEvent:d});u&&u.then(function(e){var t=e||{resultType:he.b.Success};d.end(t)}).catch(function(e){var t=e||new Error(l);d.end((0,be.a)(t))})}else d.end((0,be.a)(o))}catch(e){var f=e||new Error(l);d.end((0,be.a)(f))}}},[t])}();var i=(0,ri.h)(),r=window.matchMedia("(prefers-reduced-motion: reduce)"),o=!r||r.matches?0:300,s=Le.k,c=Le.l,d=p.useState(""),u=d[0],f=d[1],_=p.useState(!0),h=_[0],b=_[1],g=(0,gi.a)(),v=(0,V.c)(),y=v.consume(N.a),S=v.consume(er),D=v.consume(Da.a),I=v.consume(ar),x=p.useRef(null),C=p.useCallback(function(e){return!e&&xa({navigation:y,saveAction:D,focusItem:null==g?void 0:g.focusItem})?Promise.resolve():(f(c),new Promise(function(e){setTimeout(e,o)}))},[y,D,g]),O=(0,_e.a)(function(e){var t;if(g.focusItem&&"Escape"===e.key&&"Escape"===e.key&&(null==g?void 0:g.parentItem)){var n=new he.a({name:"OneUpLightSpeed.commandInvoked.".concat(I.id)});if(nl){var a=S.evaluateAction({item:g.focusItem});C().then(function(){var e;null===(e=a.onExecute({qosEvent:n}))||void 0===e||e.then(function(e){var t=e||{resultType:he.b.Success};n.end(t)}).catch(function(e){var t=e;n.end((0,be.a)(t))})}).catch(function(){})}else null===(t=S.evaluateAction({item:g.focusItem}).onExecute({qosEvent:n}))||void 0===t||t.then(function(e){var t=e||{resultType:he.b.Success};n.end(t)}).catch(function(e){var t=e;n.end((0,be.a)(t))})}});return p.useEffect(function(){var e;x&&x.current&&g&&(null===(e=x.current)||void 0===e||e.focus(),x.current.addEventListener("keydown",O))},[x,x.current,O]),p.useEffect(function(){setTimeout(function(){return f(s)},10)},[]),p.useEffect(function(){u===c&&setTimeout(function(){return b(!1)},o)},[u]),p.useEffect(function(){n&&n.errorType===ge.d.rldsApiError&&b(!1)},[n]),p.createElement(p.Fragment,null,h&&p.createElement("div",(0,a.W_)({id:"oneUpRoot"},(0,Ct.nb)()&&{"data-suppresskeyboardbinding":"true"},{className:(0,l.vJ)(Le.B,u),ref:x}),p.createElement(ri.d.Provider,{value:i},e&&p.createElement(Zd,{onCloseCallback:C}),p.createElement("div",{className:(0,l.vJ)(e?Le.E:Le.D,Le.C)},p.createElement(Ai,{closeCallback:C}),p.createElement(Fi,null),t&&p.createElement(el,{toastData:t})),p.createElement(rl,null),(0,Ct.Z)(Ct.xb)&&p.createElement("div",null,p.createElement(p.Suspense,{fallback:p.createElement(p.Fragment,null)},p.createElement(al,null))),((0,Ct.Z)(Ct.Ib)||(0,Ct.Z)(Ct.R))&&p.createElement("div",null,p.createElement(p.Suspense,{fallback:p.createElement(p.Fragment,null)},p.createElement(il,null))))))}var sl={isFastOneUp:ye.c.optional,pageContext:R.a},cl=new H.hK({name:"OneUpBootCustomerPromiseFunctionsKey",factory:{dependencies:sl,create:function(e){var t,n=void 0,i=e.pageContext,r=(null===(t=(0,Se.b)(i))||void 0===t?void 0:t.toLowerCase())||"unknown";return{instance:{newBootCustomerPromise:function(t){void 0===n&&(n=new Ce({scenario:"OneUpLightSpeed.Boot",perfGoalInMs:ge.a,pillar:"View",extraData:(0,a.W_)({oneUpRenderingMode:e.isFastOneUp?ge.e.fastOneUp:ge.e.inlineOneUpFirstPage,Ring:r,correlationId:null==i?void 0:i.CorrelationId},t)}))},reportBootCXPSuccess:function(e){null==n||n.end({resultType:he.b.Success,extraData:(0,a.W_)({},e)}),n=void 0},reportBootCXPFailure:function(e){var t=e.rawError,i=t.errorType,r=t.error,o=(0,be.a)(r),s=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}(o.resultCode||"Unknown"),c=o.resultType;null==n||n.end({resultType:c,errorCode:s,extraData:(0,a.W_)({errorType:i,rawError:r},o.extraData)}),n=void 0}}}}}});function dl(){var e,t=(0,V.c)(),n=(0,He.f)("currentState",function(e){return e.errorState})[0],a=p.useState(!1),i=a[0],r=a[1],o=(0,gi.a)(),s=(0,ri.h)();(0,p.useEffect)(function(){var e=t.consume(cl);(null==o?void 0:o.focusItem)&&(e.reportBootCXPSuccess({engagementContext:s}),t.consume(Ae).newLoadingCustomerPromise(o.focusItem,s))},[null==o?void 0:o.focusItem.key,t]),(0,p.useEffect)(function(){var e=t.consume(cl),a=t.consume(Ae);(null==n?void 0:n.errorType)===ge.d.viewerInitLoadingError&&a.reportLoadingCXPFailure({rawError:n}),(null==n?void 0:n.errorType)===ge.d.rldsApiError&&(e.reportBootCXPFailure({rawError:n}),r(!0)),(null==n?void 0:n.errorType)===ge.d.rldsApiErrorNoAccess&&r(!0),(null==n?void 0:n.errorType)===ge.d.processOneUpItemError&&e.reportBootCXPFailure({rawError:n})},[n,t]);var c=null===(e=null==n?void 0:n.error)||void 0===e?void 0:e.message;return c||(c=(null==n?void 0:n.errorType)===ge.d.rldsApiErrorNoAccess?bi.f:bi.e),i&&n?p.createElement("div",null,p.createElement(ci,{errorTitle:c})):p.createElement(p.Fragment,null)}var ll=n(456);function ul(e){return{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:e}}}var fl=(0,a.W_)((0,a.W_)({},ll.a),{Pivot:{styles:function(e){var t=e.linkFormat,n=e.theme,i=n.effects,r=n.semanticColors,o=n.palette,s="tabs"===t,c={border:"2px solid transparent",borderRadius:i.roundedCorner4,height:"44px",lineHeight:"20px",marginRight:0,".ms-Fabric--isFocusVisible &:focus":{border:"2px solid ".concat(r.focusBorder),borderRadius:i.roundedCorner4,inset:0,outline:"none"}},d={color:s?r.primaryButtonText:o.themePrimary};return{link:(0,a.W_)((0,a.W_)({},c),{backgroundColor:"transparent","&:hover::before":{borderRadius:i.roundedCorner4,height:"3px",backgroundColor:s?"transparent":o.neutralQuaternary},"&:hover":{".ms-Pivot-icon":d}}),icon:{height:"14px",width:"14px"},linkIsSelected:(0,a.W_)((0,a.W_)({},c),{"&::before":{borderRadius:i.roundedCorner4,height:"3px"},".ms-Pivot-icon":d})}}},CommandBarButton:{styles:function(e){var t=e.theme,n=t,i=n.semanticColors,r=n.effects,o={borderRadius:0,borderTopRightRadius:r.roundedCorner6,borderBottomRightRadius:r.roundedCorner6},s={borderRadius:0,borderTopLeftRadius:r.roundedCorner6,borderBottomLeftRadius:r.roundedCorner6},c=function(e){var t=e.effects,n=e.semanticColors,i={borderRadius:0,borderTopRightRadius:t.roundedCorner6,borderBottomRightRadius:t.roundedCorner6},r={borderRadius:0,borderTopLeftRadius:t.roundedCorner6,borderBottomLeftRadius:t.roundedCorner6};return{splitButtonContainer:{borderRadius:t.roundedCorner6,color:n.buttonText,".ms-Button:first-child":(0,a.W_)((0,a.W_)({},r),{height:"100%"}),".ms-Button--primary:hover":{border:"none"}},splitButtonMenuButton:(0,a.W_)((0,a.W_)({},i),{height:"100%",padding:"0px",width:20}),splitButtonContainerFocused:{":focus::after":{inset:"0px",outline:"none",borderRadius:t.roundedCorner6,border:"2px solid ".concat(n.focusBorder)}},splitButtonMenuFocused:{":focus::after":(0,a.W_)({inset:"0px",outline:"none",border:"2px solid ".concat(n.focusBorder)},i)},splitButtonDivider:{display:"none"},splitButtonDividerDisabled:{display:"none"}}}(t);return(0,a.W_)((0,a.W_)({root:{backgroundColor:"transparent",height:"100%",minWidth:"20px",padding:"0px",margin:"0px 2px",borderRadius:r.roundedCorner6,".ms-Fabric--isFocusVisible &:focus::after":{top:4,right:0,bottom:4,left:0,outline:"none",borderRadius:r.roundedCorner6,border:"2px solid ".concat(i.focusBorder)}},rootHovered:ul(i.buttonBackgroundHovered),rootPressed:ul(i.buttonBackgroundPressed),rootExpanded:(0,a.W_)((0,a.W_)({},ul("transparent")),{color:"inherit"}),rootChecked:ul(i.buttonBackgroundChecked),rootCheckedHovered:ul(i.buttonBackgroundCheckedHovered),rootCheckedPressed:ul(i.buttonBackgroundPressed),rootExpandedHovered:ul(i.buttonBackgroundHovered),flexContainer:{height:32,width:32,paddingLeft:0,paddingRight:0,borderRadius:r.roundedCorner6},icon:{color:"inherit"},menuIcon:{color:"inherit",fontSize:"10px"},rootDisabled:{backgroundColor:"transparent"},textContainer:{height:16}},c),{splitButtonContainer:{borderRadius:r.roundedCorner6,color:i.buttonText,".ms-Button:first-child":{".ms-Button-flexContainer":(0,a.W_)((0,a.W_)({},s),{width:"auto",height:30,border:"1px solid ".concat(i.buttonBorder),backgroundColor:i.buttonBackground}),".ms-Button-textContainer":{width:"auto",minWidth:25,maxWidth:100,marginTop:2}}},splitButtonMenuButton:(0,a.W_)((0,a.W_)({},o),{height:"100%",padding:"0px",width:20,marginLeft:"-2px",backgroundColor:"transparent",".ms-Button-flexContainer":(0,a.W_)((0,a.W_)({},o),{height:32,width:32,paddingLeft:4,paddingRight:4}),"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:i.buttonBackgroundHovered}}}),splitButtonContainerFocused:{":focus::after":{inset:"4px 0px",outline:"none",borderRadius:r.roundedCorner6,border:"2px solid ".concat(i.focusBorder)}},splitButtonMenuButtonExpanded:{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:i.buttonBackgroundChecked},"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:i.buttonBackgroundCheckedHovered}}},splitButtonFlexContainer:{borderTop:"1px solid ".concat(i.buttonBorder),borderRight:"1px solid ".concat(i.buttonBorder),borderBottom:"1px solid ".concat(i.buttonBorder),backgroundColor:i.buttonBackground,height:"30px !important",width:"auto !important",".ms-Button-textContainer":{marginTop:2}}})}},TeachingBubble:{styles:function(e){var t,n=e.theme.palette;return{root:{color:n.black,backgroundColor:n.themePrimary},subText:{color:n.black},headline:{color:n.black},footer:(t={color:n.black},t["& > .ms-StackItem"]={display:"flex",flexDirection:"row-reverse"},t["& > .ms-StackItem > .ms-Button:not(:first-child)"]={margin:"0 15px 0 0"},t),subComponentStyles:{callout:{borderRadius:"6px",beak:{borderRadius:0}}},primaryButton:{backgroundColor:n.black,color:n.white,borderColor:n.black,borderRadius:"4px",":hover":{borderColor:n.black,backgroundColor:n.black,color:n.white},":focus":{borderColor:n.black,backgroundColor:n.black,color:n.white}},secondaryButton:{borderColor:n.black,".ms-Button-label":{color:n.black},":hover":{borderColor:n.black,backgroundColor:n.themeSecondary}},closeButton:{backgroundColor:n.themePrimary,color:n.black,":hover":{backgroundColor:n.themeSecondary+"!important",color:n.black}}}}}}),pl=n(147);function ml(){(0,j.f)("OneUpLightSpeed");var e,t,n,i=(0,V.c)(),r=i.consume($.a),o=i.consume(R.a),s=r.isSafari&&r.isMobile,c=(0,_e.a)(function(e,t){var n={errorType:ge.d.reactRenderError,error:e.name?e:new Error("ReactRenderError"),extraData:{info:t.toString(),error:e.toString()}};i.consume(Ae).reportLoadingCXPFailure({rawError:n})}),d=Tn.b;H.HW.isActivated("662e8b03-bcd7-47a7-9520-1f9801974b7b")||(t={aadUserId:(e=o).aadUserId,experimentData:e.experimentData,experimentDataLookup:e.experimentDataLookup,serverTime:e.serverTime,siteId:e.siteId},null==(Ts=(0,Ld.b)(90304,t))||Ts.logExposure()),n=H.HW.isActivated("28a7c449-3563-4201-b8a9-60840b5f6222")?s?"100%":"100vh":"100dvh";var l=!H.HW.isActivated("3cf1a381-4d99-4581-870e-fca14d0a3884"),u={height:l?"".concat(n," !important"):n,width:l?"100vw !important":"100vw",maxWidth:l?"unset !important":"unset",maxHeight:l?"unset !important":"unset",minHeight:l?"unset !important":"unset",borderRadius:l?"0px !important":"0px"};u=(0,a.W_)((0,a.W_)({},u),{background:d.semanticColors.bodyBackground});var f="";!H.HW.isActivated("f91e6032-6933-42ff-b732-5f0af7c73f1c")&&(f="OneUpModalSizing ".concat(s?"OneUpSafariMobile":""));var m=(0,a.W_)((0,a.W_)({},d),{components:fl});return p.createElement(pl.a,{theme:m},p.createElement(me.a,{componentName:"OneUpLightSpeed",onError:c},p.createElement(pe.a,{className:"".concat(Le.s," ").concat(f),allowTouchBodyScroll:!0,isOpen:!0,focusTrapZoneProps:{firstFocusableTarget:"#".concat(Ei)},layerProps:{eventBubblingEnabled:!0},styles:{main:u,layer:{zIndex:1e3}}},p.createElement(dl,null),p.createElement(ol,null))))}for(var _l=n(381),hl=n(436),bl=H.HW.isActivated("3C8E1B8A-96C9-4AC3-ACAA-0A79AA85F566"),gl={ITEMSVIEWDEMO:"ItemsViewDemo",LISTALLITEMS:"ListAllItems",LISTSHOME:"ListsHome","ODB WEB":"ODB Web",ONEDRIVELTI:"OneDriveLti",SPARTANLIST:"SpartanList","SPLIST WEB":"SPList Web",TEAMS:"Teams",TEAMSLIST:"Teams.List",TEAMSFILE:"Teams.File",TEAMSPAGE:"Teams.Page",YAMMER:"Yammer"},vl={LISTS:"Lists"},yl=0,Sl=["Word","Excel","PowerPoint","OneNote","Visio"];yl<Sl.length;yl++){var Dl=Sl[yl],Il="WACHost.".concat(Dl);gl[Il.toUpperCase()]=Il;for(var xl=0,Cl=["Teams"];xl<Cl.length;xl++){var Ol="".concat(Cl[xl],".UnifiedUiHost.").concat(Dl);gl[Ol.toUpperCase()]=Ol}}var wl=n(186),El=n(238),Al=n(435),Ll=n(124);function kl(e){var t=(0,_l.a)(),n=t.manifest,a=t.version,i=e.pageContext,r=e.clientName,o=e.ashaProduct,s=Number(i.webTemplate)===wn.a.mySite;return{Product:o||(s?"Files":"Lists"),Manifest:n,Version:a,ClientName:r}}(0,Ie.a)();var Ml,Pl=void 0,Tl=n(422),Ul=n(421),Fl=n(345),Hl=n(420),Rl=(0,lt.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(48).then(n.bind(n,615))];case 1:return[2,e.sent().OnePlayerHost2]}})})}),Nl=new H.hK({name:"".concat("fluent2Theme.key",".Fluent2Theme"),factory:new H.t_({})}),Bl=n(423),jl=new H.hK({name:"".concat("oneDriveFluent2Theme.key",".Fluent2Theme"),factory:{dependencies:{},create:function(){return{instance:(0,Bl.a)({semanticColors:{bodyBackground:Bl.b.neutralLighterAlt}})}}}}),Vl=new H.hK({name:"DeferredSetupTasks.key",loader:new H.vh(function(){return n.e(8).then(n.bind(n,628)).then(function(e){return e.resourceKey})})}),zl=n(611),Gl=n(610),Kl=(0,H.c7)("FileHandlerResourceKeys",Gl.a,{pageContext:R.a}),Wl={fileHandlerService:(0,H.c7)("FileHandlerResourceKeys",zl.a,{dataRequestor:xt.a,localFileHandlerProvider:Kl}),oneUpStateStore:He.e,pageContext:R.a,itemUrlHelper:Q.c},ql=new H.hK({name:"OneUpFileHandlerProvider",factory:{dependencies:Wl,create:function(e){return{instance:{getFileHandlerDataThruAPI:function(){return(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,e.fileHandlerService.getFileHandlerData({includePromotedApp:!0})];case 1:return[2,t.sent()]}})})},getFileHandlerDataThruLocalStorage:function(){if("localStorage"in window){var e=this.getFileHandlerCacheKey();if(localStorage.getItem(e))return JSON.parse(localStorage.getItem(e)||"")}},isCacheDataValid:function(e){return Date.now()-e.lastModified<864e5},getFileHandlerEndpoint:function(){return new je.a(e.pageContext.webAbsoluteUrl).authority+"/_api/v2.0"},getFileHandlerCacheKey:function(){return"".concat("fileHandlerCache_").concat(JSON.stringify({endpoint:this.getFileHandlerEndpoint(),driveId:""}))},setDataToLocalStorage:function(e){if("localStorage"in window)try{var t=this.getFileHandlerCacheKey();localStorage.setItem(t,JSON.stringify(e))}catch(e){}},getFileHandlerData:function(){return(0,a.Zd)(this,void 0,void 0,function(){var t,n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return(t=e.oneUpStateStore.getFileHandlerOptions())&&this.isCacheDataValid(t)?[2]:[3,1];case 1:return(n=this.getFileHandlerDataThruLocalStorage())&&this.isCacheDataValid(n)?(e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",n),[3,4]):[3,2];case 2:return[4,this.getFileHandlerDataThruAPI()];case 3:(i=a.sent())&&(r={data:i,lastModified:Date.now(),signature:{driveId:"",endpoint:this.getFileHandlerEndpoint(),includePromotedApp:!0}},this.setDataToLocalStorage(r),e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",r)),a.label=4;case 4:return[2]}})})}}}}}}),Ql={oneUpFileHandlerProvider:ql,oneUpStateStore:He.e},Yl=new H.hK({name:"GetFileHandlerData",factory:{dependencies:Ql,create:function(e){return{instance:{getFileHandlerDataForOneUp:function(){return(0,a.Zd)(this,void 0,void 0,function(){var t,n,i,r;return(0,a.qr)(this,function(a){switch(a.label){case 0:return(t=e.oneUpStateStore.getFileHandlerOptions())&&e.oneUpFileHandlerProvider.isCacheDataValid(t)?[2]:[3,1];case 1:return(n=e.oneUpFileHandlerProvider.getFileHandlerDataThruLocalStorage())&&e.oneUpFileHandlerProvider.isCacheDataValid(n)?(e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",n),[3,4]):[3,2];case 2:return[4,e.oneUpFileHandlerProvider.getFileHandlerDataThruAPI()];case 3:(i=a.sent())&&(r={data:i,lastModified:Date.now(),signature:{driveId:"",endpoint:e.oneUpFileHandlerProvider.getFileHandlerEndpoint(),includePromotedApp:!0}},e.oneUpFileHandlerProvider.setDataToLocalStorage(r),e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",r)),a.label=4;case 4:return[2]}})})}}}}}}),Jl={urlDataSource:K.a},Xl=new H.hK({name:"isImageEditableInOneUp",factory:{dependencies:Jl,create:function(e){return{instance:function(){return e.urlDataSource.getQueryType()!==fr.a.AllMyPhotos}}}}}),Zl=new H.hK({name:"PushNotifierAsync.key",loader:new H.vh(function(){return n.e(15).then(n.bind(n,629)).then(function(e){return e.pushNotifierKey})})}),$l=new H.hK({name:"onRenderOnePlayerHost",loader:new H.vh(function(){return n.e(48).then(n.bind(n,630)).then(function(e){return e.onRenderOnePlayerHostKey})})}),eu=n(372),tu=new H.hK({name:"getOneUpOnePlayerResources",loader:new H.vh(function(){return n.e(48).then(n.bind(n,631)).then(function(e){return e.getOneUpOnePlayerResourcesKey})})}),nu=n(183),au={pageContext:R.a,navigation:N.a},iu=new H.hK({name:"AshaHelper",factory:{dependencies:au,create:function(e){return{instance:{getASHAProductName:function(){var t=e.navigation.viewParams;return(0,nu.a)(t)===fr.a.AllMyPhotos?"Photos":Number(e.pageContext.webTemplate)===wn.b.mySite?"Files":"SPO DocLib"}}}}}}),ru=n(373),ou={ODB:-61546},su=H.HW.isActivated("5C13E82A-C9EC-4009-AA5D-874B11711EC5"),cu=n(388),du=void 0,lu=n(427),uu=n(123),fu=n(227);(0,_.a)(),performance.mark("EUPL.AppStart");var pu=new H.t4({owner:"ODBOneUpLightSpeed",useFactoriesOnKeys:!0}),mu=window._spPageContextInfo,_u=lu.a?function(e){if(!du){!function(){var e=window.g_oneUpPathAndQueryString;if(e){var t=new URL(e);t.searchParams&&t.searchParams.get("ga")&&window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",e)}}();var t=function(e){var t;return!!(null===(t=null==e?void 0:e.serverRequestPath)||void 0===t?void 0:t.toLowerCase().includes("onedrive.aspx"))}(e)&&function(e){var t=e.platformDetection,n=e.spPageContext;return!(!((0,rr.a)(ru.b)&&n&&n.isMySiteOwner)||n.isAnonymousGuestUser||n.isExternalGuestUser||t.isPWA||(function(e){return(0,rr.a)(ru.a)||su&&1===(0,Ld.c)(90291,e)}(n)?(location.pathname.toLowerCase().includes("onedrive.aspx")&&history.replaceState(null,"","/".concat(location.search).concat(location.hash)),0):((0,rr.a)(ou)&&"/"===location.pathname&&history.replaceState(null,"","".concat(n.webServerRelativeUrl,"/_layouts/15/onedrive.aspx").concat(location.search).concat(location.hash)),1)))}({platformDetection:new H.QC,spPageContext:e}),n=t?cu.a:void 0;a=(du=new B.a({prettyPathMap:n})).viewParams,Ml||(Ml=a),du.updateViewParams({},{ignoreHistory:!0})}var a;return du}(mu):new B.b,hu=pu.consume(Vt),bu=hu.getOneUpRumoneLogger({});pu.expose(R.a,window._spPageContextInfo),pu.expose(N.a,_u);var gu,vu=pu.consume(cl);vu.newBootCustomerPromise({clientName:Iu(),view:(gu=_u.viewParams[Be.b.queryTypeParamKey],gu?"view=".concat(gu):"")}),bu.initRumoneLogger(),(0,Ct.eb)()&&(0,Ld.b)(90198,mu);var yu,Su=function(e){pu.consumeAsync(Vl).then(function(e){e.setupDeferredComponents(pu)});var t=_u.viewParams.ga,n=!!window.g_oneUpPathAndQueryString,i=(0,a.W_)({viewerName:e.viewer,isShareLinkRedeeming:void 0!==t,extension:e.extension||"unknown",fileSizeRange:e.fileSizeRange,isCrossList:e.isCrossList,isFluentV9:(0,fu.a)()},e.extraData),r=(0,a.W_)((0,a.W_)({oneupScenario:1,endTime:Date.now(),pageTransType:Pt.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:Iu(),viewerStartTime:Nt(e.viewer),breakDownData:e.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:n},i),e.extraPerfData);j.f("EUPL.glass"),bu.logRumonePerformance(r,function(e){pu.consume(He.e).updatePerfButtonState("FastOneUp-OnSlideLoaded",e)}),pu.consume(Ae).reportLoadingCXPSuccess({extraData:i})},Du=function(e){var t=hu.getOneUpRumoneLogger({loggerName:"fullPage"}),n=!!window.g_oneUpPathAndQueryString;t.initRumoneLogger(),t.logRumonePerformance((0,a.W_)({oneupScenario:1,endTime:Date.now(),pageTransType:Pt.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:Iu(),viewerStartTime:Nt(e.viewer),breakDownData:e.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:n,viewerName:e.viewer,extension:e.extension||"unknown",fileSizeRange:e.fileSizeRange,isCrossList:e.isCrossList,isFullPageLogging:!0,isFluentV9:(0,fu.a)()},e.extraPerfData))};!function(e){if(e.spPageContext){var t=(0,a.W_)((0,a.W_)({},function(e){var t,n=e.viewParams,i=e.onGetContext,r=n.app,o=n.scenario;if(r){var s=gl[r.toUpperCase()]||!H.HW.isActivated("B750D979-8389-4419-9DFE-79EAE5360404","05/03/2022","Allow all host-provided app values")&&r||"Unknown";t=(0,a.W_)((0,a.W_)({},n),{app:s})}if(!bl&&o){var c=vl[o.toUpperCase()]||o||"Unknown";t=(0,a.W_)((0,a.W_)({},t||n),{scenario:c})}var d=t?(0,a.W_)((0,a.W_)({},e),{viewParams:t}):e,l=function(e){var t=e.viewParams,n=e.clientName,a=t.app,i=t.scenario,r=!0;try{r=window.parent!==window.self||!!window.opener}catch(e){}return{Scenario:i||(r?"Unknown":"Default"),ClientName:"".concat(a?"".concat(a,"."):"").concat(n)}}(d);return i?i({context:l,viewParams:d.viewParams}):l}({viewParams:e.viewParams,clientName:e.clientName})),e.context||{});e.initDefaultHandler&&(0,_l.b)((0,hl.a)({sourceName:"oneup-lightspeed",tokens:El.a,initOneDS:!0,pageContext:e.spPageContext,context:t})),Pl&&"dispose"in Pl&&(null==Pl||Pl.dispose()),Pl=function(e){var t,i=(0,_l.a)().ariaEnvironment,r=e.pageContext,o=e.initOneDS,s=e.tokens,c=e.resultTypeWhenUnload,d=void 0===c?he.b.ExpectedFailure:c,l=Number(r.webTemplate)===wn.a.mySite;t=s?"prod"===i?s.prod:s.ppe:"prod"===i?l?El.a.prod:El.b.prod:l?El.a.ppe:El.b.ppe;var u=e.customerPromiseManager||(0,Ll.a)();if(u.addOnBeforeUnloadHandler(function(e){var t=void 0;if(!H.HW.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&"unload"===(t=(0,a.W_)({resultType:d},d===he.b.ExpectedFailure||d===he.b.Failure?{errorCode:"unload"}:{})).errorCode)switch(null==e?void 0:e.data.pillar){case"Create":t.veto="unload (create)";break;case"Boot":t.veto="unload (boot)";break;case"View":t.veto="unload (view)";break;case"Edit":t.veto="unload (edit)";break;case"Delete":t.veto="unload (delete)";break;case"Share":t.veto="unload (share)";break;case"Freshness":t.veto="unload (freshness)";break;case"Social":t.veto="unload (social)";break;case"Upload":t.veto="unload (upload)";break;case"Search":t.veto="unload (search)"}e.end(!H.HW.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&t?t:(0,a.W_)({resultType:d},d===he.b.ExpectedFailure||d===he.b.Failure?{errorCode:"unload"}:{}))}),o){var f=function(e){var t=kl(e);return(0,Al.a)(e.pageContext,t)}(e),p=r.oneDsCollectorUrl,m=new wl.a({sourceName:"odsp-spo",tenantToken:t,context:{context:f,oneDsCollectorUrl:p}});return m.attach(u),m}var _=kl(e),h=(0,Al.b)({ariaLoader:function(){return n.e(2).then(n.t.bind(n,181,23))},pageContext:r,customerContext:_,tenantToken:t});return h.attach(u),h}({pageContext:e.spPageContext,clientName:"".concat(e.clientName,"-").concat(e.viewParams[Be.b.queryTypeParamKey]),initOneDS:!0,customerPromiseManager:(0,Ie.a)(),tokens:El.a})}}({clientName:"OneUpLightSpeed-fastOneUp",viewParams:_u.viewParams,spPageContext:mu,initDefaultHandler:!0}),function(e){try{if(mu){try{var t=window&&"true"===window.localStorage.getItem("isODBDarkMode");e.expose(ye.b,t)}catch(e){}e.exposeFactory(G.a,new H.S7(de)),e.exposeFactory(K.a,new H.S7(an.a)),e.exposeFactory(le.a,new H.S7(ue)),e.expose(ye.c,!0),e.expose(ye.e,Su),e.expose(ye.d,Du);var i=function(){if(Pl&&"dispose"in Pl)return Pl}(),r=e.consume(iu).getASHAProductName();null==i||i.updateContext({product:r}),e.expose(po.a,Iu()),H.HW.isActivated("B34E3F01-04D5-4161-9629-4B783CA48830","01/23/2024","Customize image editing in one up")||e.exposeFactory(md,new H.S7(Xl)),mt.a?function(e){var t=this;e.expose(Ul.a,function(){return(0,a.Zd)(t,void 0,void 0,function(){var t,i,r,o,s,c;return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,Promise.all([n.e(48).then(n.bind(n,616)),n.e(48).then(n.bind(n,396)),n.e(48).then(n.bind(n,202)),Promise.resolve().then(n.bind(n,39)),n.e(48).then(n.bind(n,617))])];case 1:return t=a.sent(),i=t[0].resourceKey,r=t[1].downloadDataSourceKey,o=t[2].legacyGraphDataSourceKey,s=t[3].resourceKey,c=t[4].isOnePlayerEnabledResourceKey,e.exposeFactory(Fl.f,new H.S7(i)),e.exposeFactory(Fl.a,new H.S7(r)),e.exposeFactory(Fl.b,new H.S7(o)),e.exposeFactory(Fl.e,new H.S7(an.a)),e.exposeFactory(Fl.c,new H.S7(s)),e.exposeFactory(Hl.a,new H.S7(c)),[2]}})})}),e.expose(Tl.b,Rl)}(e):e.exposeFromPack(((o=new H.Kk).addAlias(eu.a,tu),o.addAlias(Tl.a,$l),o)),mu.webTemplate===wn.b.mySite.toString()&&e.exposeFactory(Nl,new H.S7(jl)),H.HW.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")||e.exposeFactory(uu.a,new H.S7(Wt.resourceKey))}else vu.reportBootCXPFailure({rawError:{errorType:ge.d.processOneUpItemError,error:new H.EI({code:"fastOneUp-NoPageContext"})}})}catch(e){vu.reportBootCXPFailure({rawError:{errorType:ge.d.processOneUpItemError,error:new H.EI({code:"fastOneUp-initResourcesException",innerError:e})}})}var o}(pu);try{(0,F.b)(pu),function(e){(0,a.Zd)(this,void 0,void 0,function(){return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,e.consume(Yl).getFileHandlerDataForOneUp()];case 1:return t.sent(),[2]}})})}(pu),yu=pu,(0,Ct.Z)(Ct.g)&&yu.consumeAsync(Zl)}catch(e){pu.consume(He.e).updateErrorState("fastOneUpAdapterException",{errorType:ge.d.rldsApiError,error:e,item:void 0})}function Iu(){return Number(mu.webTemplate)===wn.b.mySite?"ODB Web":"SPList Web"}j.f("EUPL.BeforeWaitForDomReady"),(0,z.a)(function(){j.f("EUPL.AfterWaitForDomReady"),function(){try{var e=document.getElementById("od-oneup");e&&document.body.removeChild(e),(e=document.createElement("div")).setAttribute("id","od-oneup"),document.body.appendChild(e);var t=p.createElement(V.a,{resources:pu},p.createElement(ml,null));U.a(t,document.getElementById("od-oneup"))}catch(e){vu.reportBootCXPFailure({rawError:{errorType:ge.d.processOneUpItemError,error:new H.EI({code:"fastOneUp-initizationException",innerError:e})}})}}()}).catch(function(e){console.log("dom error: ",e)})}
,,,(e,t,n)=>{"use strict";new Date}
,,,,(e,t,n)=>{"use strict";e.exports=n(394)}
,(e,t,n)=>{"use strict";n(187);var a=n("react-lib"),i=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var r=Symbol.for;i=r("react.element"),t.Fragment=r("react.fragment")}var o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var a,r={},d=null,l=null;for(a in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,a)&&!c.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:i,type:e,key:d,ref:l,props:r,_owner:o.current}}t.jsx=d,t.jsxs=d}
,(e,t,n)=>{"use strict";e.exports=n(176)}
,(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f,downloadDataSourceKey:()=>p});var a=n(507),i=n("odsp.util_118"),r=n(695);function o(e){if(void 0!==e)return e}var s=n(25),c=n(9),d=n(39),l=n(5),u=function(){function e(e,t){this._common=new a.a(t.pageContext),this._dataRequestor=new t.dataRequestorType({}),this._itemUrlHelper=t.itemUrlHelper,this._identityDataSource=t.identityDataSource}return e.prototype.getDownloadUrl=function(e,t){return void 0===t&&(t={}),this._common.getDownloadUrl(o(e),o(void 0),t)},e.prototype.getItemClassicDownloadLink=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl+"?avcmd=1"},e.prototype.downloadItems=function(e){var t=this,n=e.items[0];return this.getDownloadRequestParameters(n,0).then(function(e){var n=t._initIframe(e.url);setTimeout(function(){window.document.body.removeChild(n)},2e4)})},e.prototype.getItemContents=function(e){var t=this;return this.getDownloadRequestParameters(e,2).then(function(e){var n=e.headers,a=n&&n.Authorization,i=a&&a.slice(7);return t._dataRequestor.getData({url:e.url,method:"GET",noRedirect:!0,qosName:"ItemDataSource.getItemContents",responseType:"blob",needsRequestDigest:!1,authToken:i})})},e.prototype.getDownloadRequestParameters=function(e,t,n){var a=this,i=this._itemUrlHelper.getItemUrlParts(e.key),r=new c.a(i.normalizedItemUrl);return i.isCrossDomain?this._identityDataSource.getSharePointToken(r.authority).then(function(n){var i=n.accessToken;return a.getDownloadUrl(e,{downloadType:t,authToken:i}).then(function(e){return{url:e,headers:{Authorization:"bearer ".concat(i)}}})}):this.getDownloadUrl(e,{downloadType:t}).then(function(e){return{url:e,withCredentials:!0}})},e.prototype._initIframe=function(e){var t=document.createElement("iframe");return t.src=e,t.style.display="none",window.document.body.appendChild(t),t},e}();const f=u;var p=(0,i.c7)("DownloadDataSource",u,{dataRequestorType:r.b,pageContext:l.a,itemUrlHelper:s.c,identityDataSource:d.resourceKey})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>Je});var a=n("tslib_826"),i=n(147),r=n(554),o=["currentPageNumberAria","lastPagePrompt","firstPagePrompt","textSelectedAria","rotationAria","formFieldAria","Copy","freeTextFoucs","freeTextAdded"],s=n(702),c=n("react-lib"),d=n.n(c),l=n(341),u=n(353),f=n(179),p=["needsPasswordLabel","enterPassword","enterPasswordDialogLabel","invalidPasswordPrompt","dialogOk","dialogCancel","zoomPageFitSize","zoomPageFitWidth","previousPageTooltip","nextPageTooltip","zoomTooltip","zoomOutTooltip","zoomInTooltip","rotateTooltip","openInNewWindowTooltip","searchTooltip","previousTooltip","nextTooltip","upCommandAria","downCommandAria","zoomCommandAria","zoomOutCommandAria","zoomInCommandAria","rotateCommandAria","openInNewWindowCommandAria","searchCommandAria","closeSearchCommandAria","searchQueryAria","searchInputAria","noSearchResultAria","noSearchResultPrompt","searchResultAria","previousResultCommandAria","nextResultCommandAria","pageNumberAria","pageInputAria","searchInputPlaceholder","printModalAria","printProgressLabel","mipPdfTitle","mipPdfMessage","download","openInBrowser","saveChanges","save","saveTooltip","saveAria","exitEditTooltip","clearExtractTooltip","clearExtractAria","exitExtractAria","exitExtractTooltip","fileHeaderSuffixInEditMode","unsavedChangesTitle","unsavedChangesMessage","discard","discardTooltip","discardAria","versionChangeTitle","versionChangeMessage","editToastText","noEditPermissionToastText","previewToastText","previewToastFinishedText","doExtract","doExtractTooltip","doExtractAria","extractCommandBarTitle","thumbnailItemAria","selectExtractPageTip","searchTotalCount","searchIndex","displayInfo","freeTextPlaceHolder","freeTextDeleteButtonTooltip","freeTextDeleteButtonAria","freeTextDeleted","freeTextDecFontSizeTooltip","freeTextDecFontSizeAria","freeTextFontSizeInputAria","freeTextIncFontSizeTooltip","freeTextIncFontSizeAria","freeTextFontSizeChanged","freeTextColorPickerTooltip","freeTextColorPickerAria","freeTextMoved","focusFreeTextHandle","docNeedPermissionTitle","docNeedPermissionMessage","docShowPermissionTitle","docPermissionAllowAnnot","docPermissionAllowCopy","docPermissionAllowCopyAccessible","docPermissionAllowEdit","docPermissionAllowFormField","docPermissionAllowPrint","docPermissionAllowSign","protectedByMip","viewDocPermission"],m=n("fui.util_554");(0,m.Bv)([{rawString:".root_58dd2d21{width:100%;height:100%;position:relative;overflow:hidden}"}]);var _=n(536),h=n(346),b=n(319),g=n(61),v=n(81),y=n(60),S=n(382),D=n(18),I=n(156),x=n(58),C=n(47),O=n(315),w=n(71),E=n(525),A=n("fui.core_421"),L=(0,m.Ww)(function(e,t){var n=e.palette,a={root:{height:44,flexShrink:0,padding:"0 14px",backgroundColor:e.semanticColors.menuBackground,border:"".concat(1,"px solid ").concat(n.neutralLight),boxSizing:"content-box",overflow:"hidden"}};return(0,A.BPT)(a,t)}),k={display:"flex",alignItems:"center"},M=(0,a.W_)((0,a.W_)({},k),{flexBasis:"33.3%"}),P=(0,a.W_)((0,a.W_)({},k),{justifyContent:"flex-end",flexBasis:"33.3%"}),T=(0,m.J4)((0,a.W_)((0,a.W_)({},k),{justifyContent:"center",padding:"0 15px","@media (max-width: 460px)":{display:"none"}})),U=function(e){var t=e.leftItems,n=void 0===t?[]:t,a=e.centerItems,i=void 0===a?[]:a,r=e.rightItems,o=void 0===r?[]:r,s=e.styles,d=(0,w.a)(),l=L(d,s);return c.createElement(E.b,{horizontal:!0,styles:{root:l.root}},c.createElement(E.b.Item,{style:M,grow:!0},n),c.createElement(E.b.Item,{styles:{root:T},grow:!0},i),c.createElement(E.b.Item,{style:P,grow:!0},o))},F=d().memo(function(e){var t=e.disabled,n=e.text,a=e.onClick,i=(0,l.c)(),r=(0,w.a)(),o=d().useCallback(function(){a(),v.a.logEngagement({name:"SaveChanges",actionGesture:"Click"})},[a]);return d().createElement(I.f,{text:n||i.get("save"),title:i.get("saveTooltip"),disabled:t,theme:r,onClick:o,styles:{label:{whiteSpace:"nowrap",textOverflow:"ellipsis"}}})}),H=d().memo(function(e){var t=e.disabled,n=e.onClick,a=(0,l.c)(),i=(0,w.a)(),r=d().useCallback(function(){n(),v.a.logEngagement({name:"DiscardChanges",actionGesture:"Click"})},[n]);return d().createElement(I.d,{text:a.get("discard"),title:a.get("discardTooltip"),ariaLabel:a.get("discardAria"),disabled:t,theme:i,onClick:r})}),R=n(528),N=n(167),B=n(168),j={isBlocking:!0,isModeless:!0,styles:{main:{"@media (min-width: 640px)":{width:480,maxWidth:480},minWidth:320}}},V=function(e){var t=e.hidden,n=e.contentTitle,a=e.contentSubText,i=e.children,r=e.onDismiss,o=(0,w.a)();return d().createElement(R.a,{hidden:t,theme:o,dialogContentProps:{type:N.a.normal,title:n,subText:a},modalProps:j,onDismiss:r},d().createElement(B.a,null,i))},z=function(e){var t=e.hidden,n=e.onSave,a=e.onDiscard,i=e.onDismiss,r=(0,l.c)();return d().createElement(V,{hidden:t,contentTitle:r.get("unsavedChangesTitle"),contentSubText:r.get("unsavedChangesMessage"),onDismiss:i},d().createElement(F,{onClick:n}),d().createElement(H,{onClick:a}))},G=function(e){var t=e.hidden,n=e.onSave,a=e.onDiscard,i=e.onDismiss,r=(0,l.c)();return d().createElement(V,{hidden:t,contentTitle:r.get("versionChangeTitle"),contentSubText:r.get("versionChangeMessage"),onDismiss:i},d().createElement(F,{onClick:n}),d().createElement(H,{onClick:a}))};(0,m.Bv)([{rawString:"html[dir=ltr] .saveBtn_00e42b0f{padding-left:16px}html[dir=rtl] .saveBtn_00e42b0f{padding-right:16px}.fileHeader_00e42b0f{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;text-align:center;padding:10px}.fileHeader_00e42b0f>*{padding:0 4px}.fileHeader_00e42b0f .fileTitle_00e42b0f{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;max-width:200px;line-height:1}.fileHeader_00e42b0f .fileTitle_00e42b0f>div{white-space:nowrap}.fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-right:4px}html[dir=rtl] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-left:4px}.closeButton_00e42b0f{color:inherit}"}]);var K=function(e){void 0===e&&(e="");var t=e.match(/^([^\\]*)\.(\w+)$/);return t?t[2]:".pdf"},W=c.forwardRef(function(e,t){var n=e.hasEdits,i=e.filename,r=e.allowUnloadPageWithEdits,o=e.onSave,s=e.onClose,d=e.onDiscard,u=e.isFileVersionChanged,f=(0,a.MS)(c.useState(!1),2),p=f[0],m=f[1],_=(0,a.MS)(c.useState(!1),2),h=_[0],b=_[1],y=(0,l.c)(),S=c.useCallback(function(){n?m(!0):s()},[n,s]);c.useEffect(function(){var e=function(e){n&&!r&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}},[r,n]),c.useImperativeHandle(t,function(){return{close:S}},[S]);var w=c.useCallback(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t,n,i;return(0,a.qr)(this,function(a){switch(a.label){case 0:m(!1),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null==u?void 0:u()];case 2:return e=a.sent(),[3,4];case 3:return t=a.sent(),n=(null==t?void 0:t.message)||JSON.stringify(t),i=new g.c(void 0,"Fail to check file version when saving, reason: ".concat(n)),v.a.logError(i.toCaughtError()),[3,4];case 4:return e?b(!0):o(),[2]}})})},[u,o]),E=c.useCallback(function(){v.a.logEngagement({name:"ExitEditMode",actionGesture:"Click",extraData:{hasEdits:n}}),S()},[S,n]),A=c.useCallback(function(){m(!1),d(),s()},[s,d]),L=c.useCallback(function(){m(!1)},[]),k=c.useCallback(function(){b(!1)},[]),M=c.useMemo(function(){return[c.createElement("div",{key:"Save",className:"saveBtn_00e42b0f"},c.createElement(F,{disabled:!n,text:y.get("saveChanges"),onClick:w}))]},[n,y,w]),P=y.get("fileHeaderSuffixInEditMode"),T=c.useMemo(function(){return[c.createElement("div",{key:"FileHeader",className:"fileHeader_00e42b0f",tabIndex:0,"aria-label":"".concat(i,", ").concat(P),"data-is-focusable":!0},c.createElement(D.a,(0,a.W_)({},(0,O.a)({extension:K(i),size:16}))),c.createElement("div",{className:"fileTitle_00e42b0f"},c.createElement("div",{className:"fileName_00e42b0f"},i),c.createElement("div",null,"- ".concat(P))))]},[P,i]),H=c.useMemo(function(){return[c.createElement(I.e,{key:"Cancel",iconProps:{iconName:"Cancel"},title:y.get("exitEditTooltip"),role:"button",onClick:E,className:"closeButton_00e42b0f"})]},[y,E]);return c.createElement("div",{role:"menubar"},c.createElement(x.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:C.b.all,direction:C.a.horizontal},c.createElement(U,{leftItems:M,centerItems:T,rightItems:H})),c.createElement(z,{hidden:!p,onSave:w,onDiscard:A,onDismiss:L}),c.createElement(G,{hidden:!h,onSave:o,onDiscard:A,onDismiss:k}))});W.displayName="EditCommandBar";var q=n(285),Q=d().memo(function(e){var t=e.disabled,n=e.onClick,a=(0,l.c)(),i=(0,w.a)(),r=d().useCallback(function(){n(),v.a.logEngagement({name:"DoExtract",actionGesture:"Click"})},[n]);return d().createElement(I.f,{text:a.get("doExtract"),title:a.get("doExtractTooltip"),ariaLabel:a.get("doExtractAria"),disabled:t,theme:i,onClick:r})});(0,m.Bv)([{rawString:"html[dir=ltr] .saveBtn_edd24649{padding-left:16px}html[dir=rtl] .saveBtn_edd24649{padding-right:16px}.title_edd24649{display:inline-block;max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.rightDivider_edd24649{height:16px;margin:0 20px}.selectionCounter_edd24649{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.closeButton_edd24649{color:inherit}"}]);var Y="closeButton_edd24649",J=c.forwardRef(function(e,t){var n=e.onSave,i=e.onClose,r=e.viewerRef,o=(0,l.c)(),s=(0,a.MS)(c.useState([]),2),d=s[0],f=s[1],p=(0,u.c)(),m=c.useMemo(function(){return d.filter(function(e){return e}).length},[d]),_=m>0;c.useEffect(function(){return p.setMode("Select"),p.subscribe(function(e){f(e)}),function(){var e;null===(e=p.unsubscribe)||void 0===e||e.call(p)}},[p]),c.useEffect(function(){var e=function(e){_&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}},[_]);var h=c.useCallback(function(){var e;null===(e=p.resetPageSelection)||void 0===e||e.call(p),v.a.logEngagement({name:"DiscardExtractSelections",actionGesture:"Click"})},[p]),b=c.useCallback(function(){var e;null===(e=p.resetPageSelection)||void 0===e||e.call(p),p.toggle(!1),i(),v.a.logEngagement({name:"CancelExtract",actionGesture:"Click"})},[i,p]),g=c.useCallback(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t,i,o,s;return(0,a.qr)(this,function(a){return e=null===(s=null===(o=r.current)||void 0===o?void 0:o.getViewer())||void 0===s?void 0:s.extract,p&&e?0===(t=(null==d?void 0:d.map(function(e,t){return e?t:null}).filter(function(e){return null!==e}))||[]).length?[2]:(i=function(){return e(t)},[2,null==n?void 0:n(i,b)]):[2]})})},[n,b,d,p,r]);c.useImperativeHandle(t,function(){return{close:b}},[b]);var y=c.useMemo(function(){return[c.createElement("div",{key:"Save",className:"saveBtn_edd24649"},c.createElement(Q,{disabled:!_,onClick:g}))]},[_,g]),S=c.useMemo(function(){return[c.createElement("div",{key:"Title",className:"title_edd24649"},o.get("extractCommandBarTitle"))]},[o]),D=c.useMemo(function(){return[c.createElement("div",{key:"Discard",className:"selectionCounter_edd24649"},c.createElement(I.e,{className:Y,iconProps:{iconName:"Cancel"},ariaLabel:o.get("clearExtractAria",[m]),title:o.get("clearExtractTooltip"),role:"button",onClick:h,disabled:0===m}),c.createElement("span",{style:{marginLeft:"6px"}},m," selected")),c.createElement(q.a,{key:"Divider",className:"rightDivider_edd24649"}),c.createElement(I.e,{key:"Cancel",className:Y,iconProps:{iconName:"Cancel"},ariaLabel:o.get("exitExtractAria"),title:o.get("exitExtractTooltip"),role:"button",onClick:b})]},[o,b,h,m]);return c.createElement(U,{leftItems:y,centerItems:S,rightItems:D})}),X=n(365),Z=n(87),$=n(316),ee=n(348),te=n(304);(0,m.Bv)([{rawString:".spinner_c7f02c9d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;max-width:50%;padding:12px 15px;border-radius:33px;z-index:99}"}]);var ne=function(e){return{root:{backgroundColor:e.semanticColors.menuBackground},circle:{animationDuration:"0.7s",minWidth:20},label:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.palette.neutralPrimary,padding:"0 2px"}}},ae=function(){var e=(0,ee.b)().contentViewer,t=(0,w.a)();return c.createElement(te.a,{styles:ne(t),className:"spinner_c7f02c9d",label:e.getFilename(),labelPosition:"right"})};(0,m.Bv)([{rawString:".root_72829470{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mainWrapper_72829470{position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1}.saveModal_72829470{position:absolute;bottom:0;width:100%;height:100%;background:rgba(0,0,0,.2)}.main_72829470{position:relative;height:100%}"}]);var ie=n(166);(0,m.Bv)([{rawString:".bottomToolArea_787277d4{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:16px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.placeBottomToolOnTop_787277d4{z-index:99}.inkBar_787277d4{position:absolute;top:50%;-webkit-transform:translate(0, -50%);transform:translate(0, -50%);left:20px}"}]);var re={main:{minHeight:100}},oe={title:{padding:"20px",paddingBottom:"10px",fontSize:"1.6rem",fontWeight:"normal"},inner:{padding:"20px",paddingTop:0}},se=function(e){var t=e.hidden,n=e.onCancelPrint,a=(0,l.c)();return c.createElement(R.a,{hidden:t,onDismiss:n,modalProps:{titleAriaId:a.get("printModalAria"),styles:re,isBlocking:!0,topOffsetFixed:!0},dialogContentProps:{title:a.get("printProgressLabel"),styles:oe}},c.createElement(_.a,null),c.createElement(B.a,null,c.createElement(I.d,{onClick:n,text:a.get("dialogCancel")})))},ce=function(e){var t=e.onDownload,n=e.onOpenInBrowser,i=e.enableDownload,r=e.enableOpenInBrowser,o=(0,a.MS)(c.useState(!1),2),s=o[0],d=o[1],u=(0,ee.b)().contentViewer,f=(0,l.c)(),p=(0,w.a)();c.useEffect(function(){u.isMip()&&d(!0)},[u]);var m=c.useCallback(function(){d(!1)},[]),_=c.useCallback(function(){t(),m()},[t,m]),h=c.useCallback(function(){n(),m()},[n,m]);return c.createElement(R.a,{hidden:!s,minWidth:480,theme:p,dialogContentProps:{type:N.a.normal,title:f.get("mipPdfTitle"),subText:f.get("mipPdfMessage")},modalProps:{isBlocking:!0,isModeless:!0},onDismiss:m},c.createElement(B.a,null,c.createElement(I.d,{onClick:_,text:f.get("download"),disabled:!i}),c.createElement(I.f,{onClick:h,text:f.get("openInBrowser"),disabled:!r})))},de=n(57),le=n(320),ue=n(321),fe={background:"#323130",runningIcon:"#FAF9F8",successIcon:"#92c353",errorIcon:"#F1707B",infoIcon:"#EDEBE9",link:"#C087B8",text:"#EDEBE9",hoveredButtonBackground:"#484644",barColor:"#FAF8F8",barBackground:"#605E5C"},pe={background:"#F3F2F1",runningIcon:"#292827",successIcon:"#107C10",errorIcon:"#F1707B",infoIcon:"#292827",link:"#974B8B",text:"#292827",hoveredButtonBackground:"#EDEBE9",barColor:"#292827",barBackground:"#A19F9D"};(0,m.Bv)([{rawString:".wrapper_9c898eca{padding:0 10px;z-index:99;width:352px;border-radius:4px;display:block;overflow:hidden;-webkit-transform-origin:center;transform-origin:center;will-change:transform;-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipShow_9c898eca 300ms ease 1;animation:tooltipShow_9c898eca 300ms ease 1}.hidden_9c898eca{-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipHide_9c898eca 300ms ease forwards 1;animation:tooltipHide_9c898eca 300ms ease forwards 1}.displayNone_9c898eca{display:none}@-webkit-keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.rotate_9c898eca{-webkit-animation:rotating_9c898eca 1s linear infinite;animation:rotating_9c898eca 1s linear infinite}.toastInfo_9c898eca{gap:8px;padding:6px 4px}.toastLeadIconContainer_9c898eca,.toastPostIconContainer_9c898eca{width:24px;height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.toastLeadIconContainer_9c898eca{font-size:16px}.toastPostIconContainer_9c898eca{font-size:14px;cursor:pointer;border-radius:5px}.toastText_9c898eca{padding:4px 0}@-webkit-keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@-webkit-keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}@keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}"}]);var me=c.memo(function(e){var t=e.darkMode,n=void 0!==t&&t,i=(0,f.d)(),r=(0,f.c)(),o=r.type,s=r.text,d=r.link,l=r.linkText,u=r.percentComplete,p=r.infoIconName,h=r.shouldAutoFocus,b=void 0===h||h,g=r.onClickButton,v=c.useMemo(function(){return n?pe:fe},[n]),y=c.useMemo(function(){return function(e,t,n){switch(e){case f.b.Error:return{iconName:"StatusErrorFull",iconButtonName:"clear",iconColor:t.errorIcon};case f.b.Success:return{iconName:"SkypeCircleCheck",iconButtonName:"clear",iconColor:t.successIcon};case f.b.Info:return{iconName:n||"Info",iconButtonName:"clear",iconColor:t.infoIcon};case f.b.Running:default:return{iconName:"SyncStatusSolid",iconButtonName:"FullScreen",iconColor:t.runningIcon}}}(o,v,p)},[v,p,o]),S=y.iconName,D=y.iconButtonName,x=y.iconColor,C=c.useRef(f.b.Hidden),O=(0,a.MS)(c.useState(o===f.b.Hidden),2),w=O[0],A=O[1],L=c.useRef(null),k=(o===f.b.Success||o===f.b.Error)&&d&&l,M=c.useCallback(function(){setTimeout(function(){i({type:f.b.Hidden})},5e3)},[i]);c.useEffect(function(){C.current===f.b.Running&&o===f.b.Success?M():C.current!==f.b.Hidden&&o===f.b.Hidden?setTimeout(function(){A(!0)},500):C.current===f.b.Hidden&&o!==f.b.Hidden&&(A(!1),o===f.b.Info&&M()),C.current=o},[M,w,o]),c.useEffect(function(){var e;w||(b&&o!==f.b.Info&&o!==f.b.Hidden&&(null===(e=L.current)||void 0===e||e.focus()),$.a.read(s))},[w,b,s,o]);var P=c.useMemo(function(){return{root:{width:24,height:24},icon:{color:v.text,width:14,height:14,fontSize:14},rootHovered:{backgroundColor:v.hoveredButtonBackground},rootPressed:{backgroundColor:v.hoveredButtonBackground},rootExpanded:{backgroundColor:v.hoveredButtonBackground}}},[v.hoveredButtonBackground,v.text]);return c.createElement("div",{style:{background:v.background,color:v.text},className:(0,m.vJ)("wrapper_9c898eca",o===f.b.Hidden&&"hidden_9c898eca",w&&"displayNone_9c898eca"),tabIndex:0,"data-is-focusable":!0,ref:L},c.createElement(E.b,{className:"toastInfo_9c898eca",horizontal:!0,horizontalAlign:"space-between",verticalAlign:"start"},c.createElement(E.a,{className:(0,m.vJ)("toastLeadIconContainer_9c898eca",o===f.b.Running&&"rotate_9c898eca")},c.createElement(de.a,{style:{color:x},"aria-label":o,iconName:S})),c.createElement(E.a,{grow:!0,className:"toastText_9c898eca"},c.createElement(E.b,null,c.createElement(E.a,null,c.createElement(le.a,{style:{color:v.text}},s)),k&&c.createElement(E.a,null,c.createElement(ue.a,{style:{color:v.link},href:d,target:"_blank"},l)))),c.createElement(E.a,{className:"toastPostIconContainer_9c898eca"},g&&c.createElement(I.e,{onClick:g,styles:P,iconProps:{iconName:D}}))),o===f.b.Running&&c.createElement(_.a,{styles:{itemProgress:{paddingTop:0,paddingBottom:4},progressBar:{background:u?v.barColor:"linear-gradient(to right, ".concat(v.barBackground," 0%, ").concat(v.barColor," 50%, ").concat(v.barBackground," 100%)")},progressTrack:{backgroundColor:v.barBackground}},percentComplete:u}))}),_e=n(161),he=function(e){var t=e.semanticColors.menuIcon,n={backgroundColor:e.semanticColors.menuItemBackgroundHovered,color:t};return{root:{backgroundColor:e.semanticColors.menuBackground,color:t},rootHovered:n,rootPressed:n,rootExpanded:n}},be={root:{verticalAlign:"baseline",display:"inline-block"}};(0,m.Bv)([{rawString:".toolIcon_66e857e6{height:0;padding:15px 20px;margin:calc(7px) 0;border-radius:5px}.menuIcon_66e857e6{height:0;padding:15px calc(8px);margin:calc(7px) 0}"}]);var ge="toolIcon_66e857e6",ve=function(){document.activeElement instanceof HTMLButtonElement&&document.activeElement.blur()},ye=function(e){var t=(0,w.a)();return e.hidden?c.createElement(c.Fragment,null):c.createElement(_e.a,{content:e.tooltip,styles:be},c.createElement(I.e,(0,a.W_)({},e,{iconProps:{iconName:e.iconName},className:ge,styles:he(t),onMouseUp:ve})))},Se=n(37),De=function(){return"rtl"===(document.body&&document.body.getAttribute("dir")||document.documentElement.getAttribute("dir"))},Ie=function(){return null},xe=function(e){var t=e.iconName,n=e.tooltip,i=e.items,r=e.defaultCheckedKey,o=e.uncheckAll,s=e.onClickMenuItem,d=e.onOpen,l=e.onDismiss,u=(0,a.MS)(c.useState([]),2),f=u[0],p=u[1],_=(0,a.MS)(c.useState(""),2),h=_[0],b=_[1],g=(0,w.a)();return c.useEffect(function(){var e=[],t=function(e,t){var n,r;if(t){var o=void 0;try{for(var c=(0,a.OY)(i),d=c.next();!d.done;d=c.next()){var l=d.value;if(l.key===t.key){o=l.value;break}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}null==s||s.call(void 0,o),b(t.key)}};i.forEach(function(n){e.push({key:n.key,text:n.text,canCheck:!0,checked:n.key===h,onClick:t})}),p(e)},[i,h,s]),c.useEffect(function(){b(r||"")},[r]),c.useEffect(function(){o&&b("")},[o]),c.createElement(_e.a,{content:n,styles:be},c.createElement(I.e,(0,a.W_)({},e,{iconProps:{iconName:t},className:(0,m.vJ)(ge,"menuIcon_66e857e6"),styles:he(g),persistMenu:!0,menuProps:{shouldFocusOnMount:!0,shouldFocusOnContainer:!0,items:f,focusZoneProps:{handleTabKey:0},directionalHint:De()?Se.a.topRightEdge:Se.a.topLeftEdge,directionalHintFixed:!0,styles:{root:{".ms-ContextualMenu-itemText":{flexGrow:0}}},onMenuOpened:d,onMenuDismissed:l},onRenderMenuIcon:Ie})))},Ce=n(367);(0,m.Bv)([{rawString:".root_fa619dc3{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;bottom:calc(61px);border-radius:21px 21px 0 0;border-bottom:1px solid}.fadeOut_fa619dc3{visibility:hidden;opacity:0;-webkit-transition:visibility 0s linear 300ms,opacity 300ms;transition:visibility 0s linear 300ms,opacity 300ms}.fadeIn_fa619dc3{visibility:visible;opacity:1;-webkit-transition:visibility 0s linear 0s,opacity 150ms;transition:visibility 0s linear 0s,opacity 150ms}.keyword_fa619dc3{display:inline-table;border-collapse:separate;border-spacing:8px}.keyword_fa619dc3 input{display:table-cell;width:100%;text-indent:5px}html[dir=ltr] .keyword_fa619dc3 input{padding-left:4px}html[dir=rtl] .keyword_fa619dc3 input{padding-right:4px}html[dir=ltr] .keyword_fa619dc3 input{padding-right:2px}html[dir=rtl] .keyword_fa619dc3 input{padding-left:2px}html[dir=ltr] .keyword_fa619dc3 input{text-align:left}html[dir=rtl] .keyword_fa619dc3 input{text-align:right}.keyword_fa619dc3 .result_fa619dc3{display:table-cell;text-align:center}html[dir=ltr] .keyword_fa619dc3 .result_fa619dc3{padding-left:10px}html[dir=rtl] .keyword_fa619dc3 .result_fa619dc3{padding-right:10px}"}]);var Oe=function(e){var t=e.visible,n=e.width,i=(0,a.MS)(c.useState(0),2),r=i[0],o=i[1],s=(0,a.MS)(c.useState(0),2),d=s[0],u=s[1],f=(0,a.MS)(c.useState(""),2),p=f[0],_=f[1],h=c.useRef(!1),b=(0,ee.b)().contentViewer.getViewer(),g=(0,l.c)(),v=(0,w.a)();c.useEffect(function(){t||(null==b||b.stopSearch(),o(0),u(0),_(""))},[t,b]);var y=c.useCallback(function(e){o(0),u(0);var t=0,n=0;null==b||b.startSearch(e,void 0,void 0,{onHitIndexUpdate:function(a){-1===a?null==b||b.goToNextSearchResult(!0):(u(a),n&&$.a.read(g.get("searchIndex",[e,a+1,t])))},onTotalResultUpdate:function(a,i){o(a),t=a,n=i,$.a.read(g.get("searchTotalCount",[e,a]))}})},[g,b]),S=c.useCallback(function(e){var t=e.target.value;_(t),h.current||y(t)},[y]),D=c.useCallback(function(){h.current=!0},[]),I=c.useCallback(function(){h.current=!1,y(p)},[p,y]),x=c.useCallback(function(e){void 0===e&&(e=!0),null==b||b.goToNextSearchResult(e)},[b]),C=c.useCallback(function(){x(!1)},[x]),O=c.useCallback(function(){x(!1)},[x]),E=c.useCallback(function(){x(!0)},[x]);return c.createElement("div",{className:(0,m.vJ)("root_fa619dc3",t?"fadeIn_fa619dc3":"fadeOut_fa619dc3"),style:{backgroundColor:v.semanticColors.menuBackground,borderBottomColor:v.semanticColors.menuDivider},role:"menubar"},c.createElement(Ce.a,{visible:t,autoFocusOnInput:!0,rootProps:{className:"keyword_fa619dc3",style:{color:v.semanticColors.disabledText,width:n?"".concat(n-100,"px"):"auto"},role:"menuitem","aria-label":g.get("searchQueryAria")},inputProps:{type:"text",value:p,placeholder:g.get("searchInputPlaceholder"),maxLength:100,role:"textbox","aria-label":g.get("searchInputAria"),onChange:S,onCompositionStart:D,onCompositionUpdate:D,onCompositionEnd:I},onEnterWhenFocused:x,onShiftEnterWhenFocused:C},c.createElement("div",{className:"result_fa619dc3",style:r?{color:v.semanticColors.menuItemText}:void 0,"aria-label":r?g.get("searchResultAria",[d+1,r]):g.get("noSearchResultAria")},c.createElement("span",null,r?d+1:0),"/",c.createElement("span",null,r))),c.createElement(ye,{iconName:"ChevronLeft",tooltip:g.get("previousTooltip"),role:"menuitem",ariaLabel:g.get("previousResultCommandAria"),onClick:O}),c.createElement(ye,{iconName:"ChevronRight",tooltip:g.get("nextTooltip"),role:"menuitem",ariaLabel:g.get("nextResultCommandAria"),onClick:E}))};(0,m.Bv)([{rawString:".root_5a88b9b2{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;border-radius:33px;-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13)}.fadeOut_5a88b9b2{visibility:hidden;opacity:0;-webkit-transition:visibility 0s linear 300ms,opacity 300ms;transition:visibility 0s linear 300ms,opacity 300ms}.fadeIn_5a88b9b2{visibility:visible;opacity:1;-webkit-transition:visibility 0s linear 0s,opacity 150ms;transition:visibility 0s linear 0s,opacity 150ms}.pagination_5a88b9b2{display:inline-table}html[dir=ltr] .pagination_5a88b9b2{margin-left:10px}html[dir=rtl] .pagination_5a88b9b2{margin-right:10px}html[dir=ltr] .pagination_5a88b9b2{padding-right:10px}html[dir=rtl] .pagination_5a88b9b2{padding-left:10px}.pagination_5a88b9b2 input{display:table-cell;width:30px;padding:0 2px;text-align:center}.pagination_5a88b9b2 .status_5a88b9b2{display:table-cell;text-align:center}.slash_5a88b9b2{padding:0 5px}.expanded_5a88b9b2{border-radius:0 0 21px 21px;-webkit-box-shadow:none;box-shadow:none}.shadowBox_5a88b9b2{-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);border-radius:21px}"}]);var we=/^[0-9\b]+$/,Ee=[.5,.75,1,1.25,1.5,2,3,4],Ae={height:"16px",margin:"14px 10px"},Le=function(e){e.stopPropagation()},ke=function(e){e.currentTarget.select()},Me=c.forwardRef(function(e,t){var n=e.visible,i=e.disableSearch,r=e.currentIndex,o=e.showOpenInNewWindow,s=e.dataAttributes,d=e.defaultScale,u=e.onAutoHide,f=e.onOpenInNewWindow,p=(0,a.MS)(c.useState(0),2),_=p[0],h=p[1],b=(0,a.MS)(c.useState(!1),2),g=b[0],y=b[1],S=(0,a.MS)(c.useState(!1),2),D=S[0],I=S[1],O=c.useRef(),E=c.useRef(!1),A=c.useRef(!1),L=c.useRef(!1),k=c.useRef(null),M=c.useRef(null),P=(0,ee.b)().contentViewer.getViewer(),T=(0,l.c)(),U=(0,w.a)(),F=c.useCallback(function(){O.current&&window.clearTimeout(O.current)},[]),H=c.useCallback(function(){A.current||E.current||L.current||D||(F(),O.current=window.setTimeout(function(){u()},4e3))},[u,D,F]),R=c.useCallback(function(){P&&(_>=0&&_<P.pageCount?(P.goToPage(_),v.a.logEngagement({name:"GoToCertainPage",actionGesture:"Click",extraData:{pageIndex:_}})):h(r))},[_,P,r]);c.useEffect(function(){return n&&H(),function(){F()}},[n,H,F]),c.useEffect(function(){h(r)},[r]),c.useImperativeHandle(t,function(){return{focus:function(){window.setTimeout(function(){var e;null===(e=k.current)||void 0===e||e.focus()})},uncheckZoomMenu:function(){y(!0)}}},[]);var N=c.useCallback(function(){E.current=!0,F()},[F]),B=c.useCallback(function(){E.current=!1,H()},[H]),j=c.useCallback(function(){A.current=!0,F()},[F]),V=c.useCallback(function(){A.current=!1,H()},[H]),z=c.useCallback(function(e){void 0===e&&(e=!0);var t=e?r+1:r-1;null==P||P.goToPage(t),v.a.logEngagement({name:e?"GoToNextPage":"GoToPreviousPage",actionGesture:"Click"})},[r,P]),G=c.useCallback(function(){R()},[R]),K=c.useCallback(function(e){var t=e.target.value;t?we.test(t)&&h(parseInt(t,10)-1):h(-1)},[]),W=c.useCallback(function(e){"Enter"===e.key&&R()},[R]),Q=c.useCallback(function(e){null==P||P.zoom(e),y(!1),v.a.logEngagement({name:"SelectZoomOption",actionGesture:"Click",extraData:{zoomOption:e}})},[P]),Y=c.useCallback(function(){var e=[],t=0;return e.push({key:"".concat(t++),text:T.get("zoomPageFitSize"),value:Z.g.FitSize}),e.push({key:"".concat(t++),text:T.get("zoomPageFitWidth"),value:Z.g.FitWidth}),Ee.forEach(function(n){e.push({key:"".concat(t++),text:"".concat(100*n,"%"),value:n})}),e},[T]),J=c.useCallback(function(){var e="number"==typeof d?"".concat(100*d,"%"):"",t=(null==P?void 0:P.zoomOpt)||e,n=Y().find(function(e){return e.value===t});return n?n.key:""},[d,Y,P]),X=c.useCallback(function(){L.current=!0,F(),v.a.logEngagement({name:"OpenZoomMenu",actionGesture:"Click"})},[F]),$=c.useCallback(function(){L.current=!1,H()},[H]),te=c.useCallback(function(){null==P||P.rotate(),v.a.logEngagement({name:"Rotate",actionGesture:"Click"})},[P]),ne=c.useCallback(function(){null==f||f(),v.a.logEngagement({name:"OpenInNewWindow",actionGesture:"Click"})},[f]),ae=c.useCallback(function(){I(function(e){return!e}),F(),v.a.logEngagement({name:"ToggleSearchBar",actionGesture:"Toggle"})},[F]),ie=c.useCallback(function(){var e;return null===(e=k.current)||void 0===e?void 0:e.getBoundingClientRect().width},[]),re=c.useCallback(function(){z(!1)},[z]),oe=c.useCallback(function(){z(!0)},[z]);return c.createElement("div",(0,a.W_)({},s,{className:D?"shadowBox_5a88b9b2":""}),c.createElement(x.a,{direction:C.a.horizontal,shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:C.b.all},c.createElement(Oe,{visible:D,width:ie()})),c.createElement(x.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:C.b.all,direction:C.a.horizontal},c.createElement("div",{className:(0,m.vJ)("root_5a88b9b2",n||D?"fadeIn_5a88b9b2":"fadeOut_5a88b9b2",D?"expanded_5a88b9b2":""),style:{backgroundColor:U.semanticColors.menuBackground},ref:k,tabIndex:0,role:"menubar",onMouseEnter:N,onMouseLeave:B,onClick:Le,onMouseDown:Le,onMouseMove:Le,onFocus:j,onBlur:V},c.createElement(ye,{iconName:"ChevronUp",tooltip:T.get("previousPageTooltip"),role:"menuitem",ariaLabel:T.get("upCommandAria"),onClick:re}),c.createElement(ye,{iconName:"ChevronDown",tooltip:T.get("nextPageTooltip"),role:"menuitem",ariaLabel:T.get("downCommandAria"),onClick:oe}),c.createElement(Ce.a,{rootProps:{className:"pagination_5a88b9b2",role:"menuitem","aria-label":T.get("pageNumberAria",[r+1,(null==P?void 0:P.pageCount)||1]),style:{color:U.semanticColors.menuItemText}},inputProps:{type:"text",value:_>=0?_+1:"",autoComplete:"off","aria-label":T.get("pageInputAria",[(null==P?void 0:P.pageCount)||1]),onFocus:ke,onBlur:G,onChange:K,onKeyDown:W},outerRef:M},c.createElement("div",{className:"status_5a88b9b2"},c.createElement("span",{className:"slash_5a88b9b2"},"/"),c.createElement("span",null,(null==P?void 0:P.pageCount)||1))),c.createElement(q.a,{styles:{divider:Ae}}),c.createElement(xe,{iconName:"ZoomIn",tooltip:T.get("zoomTooltip"),role:"menuitem",ariaLabel:T.get("zoomCommandAria"),items:Y(),defaultCheckedKey:J(),uncheckAll:g,onClickMenuItem:Q,onOpen:X,onDismiss:$}),c.createElement(ye,{iconName:"Rotate",tooltip:T.get("rotateTooltip"),role:"menuitem",ariaLabel:T.get("rotateCommandAria"),onClick:te}),!i&&c.createElement(ye,{iconName:"Search",tooltip:T.get("searchTooltip"),role:"menuitem",ariaLabel:D?T.get("closeSearchCommandAria"):T.get("searchCommandAria"),"aria-expanded":D,onClick:ae}),c.createElement(ye,{iconName:"OpenInNewTab",tooltip:T.get("openInNewWindowTooltip"),role:"menuitem",ariaLabel:T.get("openInNewWindowCommandAria"),onClick:ne,hidden:!o}))))});Me.defaultProps={defaultScale:Z.g.FitSize};var Pe=n(125),Te=c.lazy(function(){return n.e(55).then(n.bind(n,663)).then(function(e){return{default:e.ThumbnailView}})}),Ue=c.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(24)]).then(n.bind(n,620)).then(function(e){return{default:e.InkingToolbar}})}),Fe=c.lazy(function(){return n.e(26).then(n.bind(n,664)).then(function(e){return{default:e.MipNeedPermissionDialog}})}),He=c.memo(c.forwardRef(function(e,t){var n=e.enableToolbar,i=e.enableThumbnailView,r=e.enableAnnotationBar,o=e.enableToast,s=e.enableOpenMip,d=e.mode,l=e.mipDialogProps,p=e.toolbarProps,_=e.inkingToolbarProps,h=e.darkMode,b=void 0!==h&&h,g=e.hasAnnotationPermission,v=void 0===g||g,y=(0,a.MS)(c.useState(!1),2),S=y[0],D=y[1],I=(0,a.MS)(c.useState(!1),2),x=I[0],C=I[1],O=(0,u.b)(),w=(0,u.c)(),E=(0,f.d)(),A=c.useRef(null),L=(0,ee.b)().contentViewer.getViewer();c.useEffect(function(){O({toggle:function(e){C(e??function(e){return!e})}})},[O]),c.useImperativeHandle(t,function(){return{print:function(e,t){return(0,a.Zd)(void 0,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){return D(!0),n={onPrintEnd:function(){window.setTimeout(function(){D(!1)})}},null==L||L.print(e,t,n),[2]})})},getThumbnailView:function(){return w},getToolbar:function(){return A.current||{}},getToastOperation:function(){return E}}},[E,w,L]);var k=c.useCallback(function(){D(!1),null==L||L.cancelPrint()},[L]),M=(null==_?void 0:_.defaultToolType)||"";return c.createElement("div",null,i&&c.createElement(c.Suspense,{fallback:c.createElement("div",null)},c.createElement(Te,{visible:!!x})),c.createElement("div",{className:(0,m.vJ)("bottomToolArea_787277d4",p.shouldPlaceToolbarOnTop&&"placeBottomToolOnTop_787277d4")},n&&c.createElement(Me,(0,a.W_)({ref:A},p)),!ie.a.isActivated("UseGlobalToast")&&o&&c.createElement(me,{darkMode:b})),r&&d===Pe.a.Edit&&v&&c.createElement(c.Suspense,{fallback:c.createElement("div",null)},c.createElement("div",{className:"inkBar_787277d4"},c.createElement(Ue,(0,a.W_)({key:M,actionScenario:"PdfAnnotation"},_)))),s?c.createElement(c.Suspense,{fallback:c.createElement("div",null)},c.createElement(Fe,null)):l&&c.createElement(ce,(0,a.W_)({},l)),c.createElement(se,{hidden:!S,onCancelPrint:k}))}));He.displayName="PdfViewerControls",(0,m.Bv)([{rawString:".enterPanel_c6d49072{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);top:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);text-align:center}.prompt_c6d49072{margin-bottom:10px;font-size:16px}"}]);var Re=n(546),Ne={isBlocking:!0,styles:{main:{padding:15}}},Be=function(e){var t=(0,a.MS)(c.useState(!0),2),n=t[0],i=t[1],r=(0,a.MS)(c.useState(!0),2),o=r[0],s=r[1],d=c.useRef(null),u=(0,ee.b)().contentViewer,f=(0,l.c)(),p=c.useCallback(function(){var e;u.verifyPassword((null===(e=d.current)||void 0===e?void 0:e.value)||"",function(){var e;s(!1),null===(e=d.current)||void 0===e||e.select()})},[u]),m=c.useCallback(function(e,t){o||s(!0),i(!t)},[o]);return c.createElement(R.a,{hidden:e.hidden,dialogContentProps:{type:N.a.normal,title:f.get("enterPasswordDialogLabel")},modalProps:Ne,onDismiss:e.onClose},c.createElement(Re.a,{type:"password",errorMessage:o?"":f.get("invalidPasswordPrompt"),autoComplete:"off",autoFocus:!0,componentRef:d,ariaLabel:n?f.get("enterPasswordDialogLabel"):"",onChange:m}),c.createElement(B.a,null,c.createElement(I.f,{onClick:p,text:f.get("dialogOk"),disabled:n}),c.createElement(I.d,{onClick:e.onClose,text:f.get("dialogCancel")})))},je=function(){var e=(0,a.MS)(c.useState(!1),2),t=e[0],n=e[1],i=(0,ee.b)().contentViewer,r=(0,l.c)(),o=c.useCallback(function(){n(!0)},[]),s=c.useCallback(function(){n(!1)},[]);return c.createElement("div",{className:"enterPanel_c6d49072"},c.createElement("div",{className:"prompt_c6d49072"},r.get("needsPasswordLabel",[i.getFilename()])),c.createElement(I.f,{onClick:o,text:r.get("enterPassword")}),c.createElement(Be,{hidden:!t,onClose:s}))},Ve=function(e){var t=e.tool,n=e.color,a=e.thickness,i=function(e,t){return(2*e+5)/5*(t===h.b.Highlighter?10:1)}(null!=a?a:3,t);return{width:i,color:{hex:null!=n?n:"#1f1f1f",alpha:t===h.b.Highlighter?.3:1}}},ze=c.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(24)]).then(n.bind(n,654)).then(function(e){return{default:e.FreeTextContainer}})}),Ge=function(e){return c.createElement(c.Suspense,{fallback:c.createElement("div",null)},c.createElement(ze,(0,a.W_)({},e)))},Ke=c.memo(c.forwardRef(function(e,t){var n=e.mode,i=void 0===n?Pe.a.View:n,r=e.defaultScale,o=void 0===r?Z.g.FitSize:r,s=e.showLoadingSpinner,d=void 0===s||s,u=e.disableSearch,p=void 0!==u&&u,m=e.enableToolbar,_=void 0===m||m,b=e.enableAnnotationBar,g=e.enableFormFilling,v=void 0!==g&&g,y=e.enableFreeText,S=void 0!==y&&y,D=e.enableGripperContextualMenu,I=void 0===D||D,x=e.enableToast,C=void 0===x||x,O=e.enableEnhancedInk,E=void 0!==O&&O,A=e.darkMode,L=void 0!==A&&A,k=e.enablePreview,M=e.enableProgressiveLoading,P=e.annotBarStrings,T=e.defaultAnnotationToolType,U=e.contentViewerRef,F=e.controlsRef,H=e.onNeedPassword,R=e.onDocumentLoaded,N=e.onCurrentPageChanged,B=e.onScaleChanged,j=(0,a.MS)(c.useState(!1),2),V=j[0],z=j[1],G=(0,a.MS)(c.useState(!1),2),K=G[0],W=G[1],q=(0,a.MS)(c.useState(!1),2),Q=q[0],Y=q[1],J=(0,a.MS)(c.useState(!1),2),te=J[0],ne=J[1],ie=(0,a.MS)(c.useState(!0),2),re=ie[0],oe=ie[1],se=(0,a.MS)(c.useState(0),2),ce=se[0],de=se[1],le=(0,a.MS)(c.useState(),2),ue=le[0],fe=le[1],pe=(0,a.MS)(c.useState(_),2),me=pe[0],_e=pe[1],he=!!k&&!M,be=(0,l.c)(),ge=(0,w.a)(),ve=c.useCallback(function(e){var t=function(e){switch(e){case h.b.FreeText:return Z.a.FreeText;case h.b.Pen:return Z.a.Ink;case h.b.Highlighter:return Z.a.Highlight;case h.b.Eraser:return Z.a.Erase;default:return Z.a.None}}(e);return E&&t===Z.a.Erase&&(t=Z.a.PointErase),t},[E]);c.useEffect(function(){i===Pe.a.Edit?T&&fe({mode:ve(T)}):fe({mode:Z.a.None})},[T,ve,i]);var ye=c.useCallback(function(e){!te&&Math.sqrt(Math.pow(e.movementX,2)+Math.pow(e.movementY,2))>30&&ne(!0)},[te]);c.useImperativeHandle(t,function(){return{getEventHandlers:function(){return{onMouseMove:ye}}}},[ye]);var Se=c.useCallback(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var t,n,i,r,o;return(0,a.qr)(this,function(a){switch(a.label){case 0:return e.altKey&&"T"===e.key.toUpperCase()?(ne(!0),null===(i=null===(t=F.current)||void 0===t?void 0:(n=t.getToolbar()).focus)||void 0===i||i.call(n),[3,3]):[3,1];case 1:return(null==ue?void 0:ue.mode)===Z.a.FreeText&&e.altKey&&e.ctrlKey&&"F"===e.key.toUpperCase()?[4,null===(o=null===(r=U.current)||void 0===r?void 0:r.getViewer())||void 0===o?void 0:o.addFreeText()]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})},[ue,U,F]),De=c.useCallback(function(){ne(function(e){return!e})},[]),Ie=c.useCallback(function(){null==H||H(),z(!0)},[H]),xe=c.useCallback(function(e){var t,n;null==R||R(e),W(!0),ne(!0),z(!1);var a=null===(t=U.current)||void 0===t?void 0:t.getViewer();if(a&&$.a.read(be.get("displayInfo",[a.getCurrentPageIndex()+1,a.scale,a.rotation])),!e.isAnnotAllowed||!e.isFormFieldAllowed){e.isAnnotAllowed||oe(!1);var i=be.get("noEditPermissionToastText"),r=null===(n=F.current)||void 0===n?void 0:n.getToastOperation();null==r||r({type:f.b.Info,text:i,shouldAutoFocus:!1,onClickClose:function(){r({type:f.b.Hidden})}})}},[R,U,F,be]),Ce=c.useCallback(function(){Y(!0),z(!1)},[]);c.useEffect(function(){var e;if(he){_e(!!_&&K);var t=null===(e=F.current)||void 0===e?void 0:e.getToastOperation();if(K)null==t||t({type:f.b.Success,text:be.get("previewToastFinishedText"),link:"",linkText:"",onClickClose:function(){t({type:f.b.Hidden})}});else if(Q){var n=setInterval(function(){null==t||t({type:f.b.Running,text:be.get("previewToastText")})},1e3);return function(){clearInterval(n)}}}},[Q,he,K,F,be,_]);var Oe=c.useCallback(function(e){null==N||N(e),de(e)},[N]),we=c.useCallback(function(e,t){var n,a,i;null==B||B(e),t||null===(i=null===(n=F.current)||void 0===n?void 0:(a=n.getToolbar()).uncheckZoomMenu)||void 0===i||i.call(a)},[B,F]),Ee=c.useCallback(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,null===(t=null===(e=U.current)||void 0===e?void 0:e.getViewer())||void 0===t?void 0:t.addFreeText()];case 1:return n.sent(),[2]}})})},[U]),Ae=c.useCallback(function(e,t){fe({mode:ve(e),inkAttributes:t?Ve(t):null==ue?void 0:ue.inkAttributes})},[null==ue?void 0:ue.inkAttributes,ve]),Le=c.useCallback(function(e){fe({mode:null==ue?void 0:ue.mode,inkAttributes:Ve(e)})},[ue]),ke=c.useCallback(function(){ne(!1)},[]);return c.createElement("div",{className:"main_72829470",style:{color:ge.palette.neutralPrimary},onMouseMove:ye,onClick:De,onKeyDown:Se},c.createElement(X.a,(0,a.W_)({},e,{ref:U,localeStrings:e.contentStrings,enableAnnotation:b,enableFormFilling:v,enablePreview:he,enableFreeText:S,enableGripperContextualMenu:I,isRootFocusable:!1,annotParams:ue,ariaHidden:i===Pe.a.Extract,onNeedPassword:Ie,onDocumentLoaded:xe,onCurrentPageChanged:Oe,onScaleChanged:we,onDocumentPreviewed:Ce,freeTextContainer:S&&Ge||void 0})),U.current&&c.createElement(ee.a,{contentViewer:U.current,docLoaded:K},K||Q?c.createElement(He,{ref:F,enableToolbar:me,enableThumbnailView:e.enableThumbnailView,enableAnnotationBar:b,enableToast:C,enableOpenMip:e.enableOpenMip,mode:i,darkMode:L,hasAnnotationPermission:re,toolbarProps:{visible:te,disableSearch:p,currentIndex:ce,defaultScale:o,onAutoHide:ke,showOpenInNewWindow:e.showOpenInNewWindow,shouldPlaceToolbarOnTop:e.shouldPlaceToolbarOnTop,dataAttributes:e.toolbarAttributes,onOpenInNewWindow:e.onOpenInNewWindow},mipDialogProps:e.mipDialogProps,inkingToolbarProps:{enableFreeText:S,localeStrings:P,defaultToolType:T,onToolChange:Ae,onInkingAttributesUpdate:Le,addNewFreeText:Ee}}):V?c.createElement(je,null):d?c.createElement(ae,null):void 0))}));Ke.displayName="PdfViewerAppMain";var We=c.lazy(function(){return n.e(26).then(n.bind(n,653)).then(function(e){return{default:e.PermissionBanner}})}),qe=c.memo(function(e){var t,n=e.mode,i=e.filename,r=e.height,o=e.shouldExitEditModeAfterSave,s=void 0===o||o,d=e.allowUnloadPageWithEdits,p=e.mainRef,m=e.contentViewerRef,D=e.onDocumentLoaded,I=e.onEditStateChanged,x=e.execSave,C=e.updateMode,O=e.isFileVersionChanged,w=e.execExtract,E=e.onExitEditMode,A=(0,a.MS)(c.useState(!1),2),L=A[0],k=A[1],M=(0,a.MS)(c.useState(!1),2),P=M[0],T=M[1],U=(0,a.MS)(c.useState(!1),2),F=U[0],H=U[1],R=(0,a.MS)(c.useState(),2),N=R[0],B=R[1],j=c.useRef(),V=(0,l.c)(),z=(0,u.c)(),G=(0,f.d)(),K=c.useRef(new b.a),q=null===(t=m.current)||void 0===t?void 0:t.getViewer(),Q=c.useRef(null),Y=c.useRef(null),X=c.useMemo(function(){return V.get("editToastText")},[V]),Z=c.useRef(null);c.useEffect(function(){var e=function(e){var t,n,a;"Escape"===e.key&&e.target instanceof Node&&(null===(t=Q.current)||void 0===t?void 0:t.contains(e.target))&&(null===(n=Y.current)||void 0===n||n.close(),null===(a=Z.current)||void 0===a||a.close())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[]);var $=c.useCallback(function(){var e=Q.current;e&&!e.contains(document.activeElement)&&e.focus()},[]);c.useEffect(function(){n===Pe.a.Extract&&($(),z.toggle(!0))},[n,z,$]),c.useEffect(function(){n===Pe.a.Edit&&$(),B(h.b.Display)},[X,n,G,$]);var ee=c.useCallback(function(e){null==D||D(e),k(!0)},[D]),te=c.useCallback(function(e){var t=e.dirty,a=e.annotTypeOfLatestEdit;t!==P&&(null==I||I({dirty:t}),T(t)),t&&n===Pe.a.View&&(null==C||C(Pe.a.Edit),G({type:f.b.Info,text:X,infoIconName:"EditSolid12",shouldAutoFocus:!1,onClickClose:function(){G({type:f.b.Hidden})}}),j.current=a)},[I,X,P,n,G,C]),ne=c.useCallback(function(){var e;null===(e=K.current)||void 0===e||e.dispatch(Pe.b.ExitEditMode),H(!1),j.current=void 0,E?E():null==C||C(Pe.a.View)},[E,C]),ae=c.useCallback(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:if(!x)throw new g.c(g.b.UploadFileDataFailed,"Empty execSave callback from host");n.label=1;case 1:return n.trys.push([1,3,,4]),[4,x(e)];case 2:return[2,n.sent()];case 3:throw t=n.sent(),new g.c(g.b.UploadFileDataFailed,(null==t?void 0:t.message)||JSON.stringify(t),null==t?void 0:t.isExpected);case 4:return[2]}})})},[x]),ie=c.useCallback(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t,n,i,r,o,c,d,l;return(0,a.qr)(this,function(u){switch(u.label){case 0:T(!1),H(!0),e=v.a.createScenario({name:y.a.DocumentSave}),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,null==q?void 0:q.getCurrentFileData()];case 2:if(t=u.sent(),!(n=null==t?void 0:t.byteLength))throw new g.c(g.b.GetPdfStreamFailed,0===n?"Empty file data":"Undefined file data");return H(!1),s&&ne(),[4,ae(t)];case 3:return i=u.sent(),e.stop({extraData:(0,a.W_)({fileSize:n},(null==i?void 0:i.extraData)||{})}),o=(r=function(e){return!!e&&e.byteLength>0})(t)?t:null==i?void 0:i.fileData,c=function(e){return new g.c(void 0,"Fail to reload document after saving, reason: ".concat(e)).toCaughtError()},r(o)?null==q||q.reloadCurrentDocument(o).catch(function(e){v.a.logError(c(e.message))}):v.a.logError(c("No available file data")),[4,null==q?void 0:q.getTelemetryData()];case 4:return void 0!==(d=u.sent())&&v.a.logEngagement({name:"InteractWithForm",actionGesture:"Form",extraData:{telemetryExtraData:d}}),[3,6];case 5:return f=u.sent()||new g.c("Unknown"),l=f instanceof g.c?f.toQosError():{isExpected:!!f.isExpected,error:f,code:f.code||f.name},e.fail(l),[3,6];case 6:return[2]}var f})})},[q,s,ae,ne]),re=c.useCallback(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,null==q?void 0:q.discardEdits()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),t="string"==typeof e?e:e.message,v.a.logError({error:{name:e.name,message:"Fail to discard, reason: ".concat(t),stack:e.stack}}),[3,3];case 3:return[2]}})})},[q]),oe=c.useCallback(function(){null==C||C(Pe.a.View)},[C]),se=c.useCallback(function(){switch(n){case Pe.a.Edit:return c.createElement(W,{ref:Y,hasEdits:P,filename:i,allowUnloadPageWithEdits:d,onSave:ie,onClose:ne,onDiscard:re,isFileVersionChanged:O});case Pe.a.Extract:return c.createElement(J,{ref:Z,viewerRef:m,onSave:w,onClose:oe});default:return}},[d,w,i,P,O,n,oe,re,ne,ie,m]),ce=c.useMemo(function(){return L&&(n===Pe.a.Edit||n===Pe.a.Extract)},[L,n]),de=c.useMemo(function(){return ce&&r?r-46:r},[r,ce]);return c.createElement("div",{className:"root_72829470",ref:Q,tabIndex:0,"aria-label":i},ce&&se(),F&&c.createElement(_.a,{styles:{itemProgress:{padding:0}}}),e.enableOpenMip&&L&&q&&c.createElement(c.Suspense,{fallback:c.createElement("div",null)},c.createElement(We,{pdfViewer:q})),c.createElement("div",{className:"mainWrapper_72829470"},c.createElement(S.a,{eventBus:K.current},c.createElement(Ke,(0,a.W_)({},e,{ref:p,height:de,defaultAnnotationToolType:N,onDocumentLoaded:ee,onEditStateChanged:te}))),F&&c.createElement("div",{className:"saveModal_72829470"})))});qe.displayName="PdfViewerAppRenderer";var Qe=c.forwardRef(function(e,t){var n=c.useRef(null),i=c.useRef(null),r=c.useRef(null);return c.useImperativeHandle(t,function(){return{getViewer:function(){var e;return(null===(e=i.current)||void 0===e?void 0:e.getViewer())||null},print:function(e,t){return(0,a.Zd)(void 0,void 0,void 0,function(){var n;return(0,a.qr)(this,function(a){return[2,null===(n=r.current)||void 0===n?void 0:n.print(e,t)]})})},onMouseMove:function(e){var t;return null===(t=n.current)||void 0===t?void 0:t.getEventHandlers().onMouseMove(e)},getThumbnailView:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.getThumbnailView()},getToastOperation:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.getToastOperation()}}}),c.createElement(qe,(0,a.W_)({},e,{mainRef:n,contentViewerRef:i,controlsRef:r}))});Qe.displayName="PdfViewerAppInner";var Ye=c.forwardRef(function(e,t){var n=function(e){return c.useMemo(function(){var t,n;if(!e)return{appStrings:void 0,contentStrings:void 0,annotBarStrings:void 0};var i={},s={},c={};try{for(var d=(0,a.OY)(Object.entries(e)),l=d.next();!l.done;l=d.next()){var u=(0,a.MS)(l.value,2),f=u[0],m=u[1];(p.includes(f)||r.a.includes(f))&&(i[f]=m),o.includes(f)&&(s[f]=m),r.a.includes(f)&&(c[f]=m)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return{appStrings:i,contentStrings:s,annotBarStrings:c}},[e])}(e.localeStrings),d=n.appStrings,m=n.contentStrings,_=n.annotBarStrings,h=(0,a.MS)(c.useState(),2),b=h[0],g=h[1],v=c.useCallback(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){var e,t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return e=g,(t=d)?[3,2]:[4,(0,l.b)()];case 1:t=n.sent(),n.label=2;case 2:return e.apply(void 0,[t]),[2]}})})},[d]);c.useEffect(function(){v()},[v]);var y=(0,s.a)(e.theme,e.darkMode);return c.createElement(i.a,{className:"root_58dd2d21",theme:(0,a.W_)((0,a.W_)({},y),{rtl:De()})},c.createElement(l.a,{strings:b},c.createElement(u.a,null,c.createElement(f.a,null,c.createElement(Qe,(0,a.W_)({},e,{contentStrings:m,annotBarStrings:_,ref:t}))))))});Ye.displayName="PdfViewerAppWithoutKey";var Je=c.forwardRef(function(e,t){return c.createElement(Ye,(0,a.W_)({key:e.url,ref:t},e))});Je.displayName="PdfViewerApp"}
,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{saveCommandKey:()=>s});var a=n("odsp.util_118"),i=n(115),r={actionProvider:n(307).a},o="saveCommand",s=new a.hK({name:"SaveCommand",factory:{dependencies:r,create:function(e){var t=e.actionProvider;return{instance:{id:o,name:i.mb,title:i._b,automationId:o,iconProps:{iconName:"Save"},evaluateAction:t.evaluateAction}}}}})}
,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("oneUpOnePlayerEnabled")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_118").hK)("oneUpPlayerHostInitResourcesKey")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("odsp.util_118"),i=new a.hK("onRenderOneUpPlayerHost"),r=new a.hK("OneUpPlayerHost")}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=!n("odsp.util_118").HW.isActivated("0A38B402-7796-4743-871F-FFEE5A9F48CF")}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>p});var a,i=n("odsp.util_118"),r=n(141),o=n(126),s=n(86),c=n(5),d=n(228),l=n(231),u=n(28);!function(e){e.Error="Error",e.WAC="WAC",e.Html="Html",e.MSPdf="MSPdf",e.Pdf="Pdf",e.OnePlayerVideo="OnePlayerVideo",e.OnePlayerAudio="OnePlayerAudio",e.Panorama="Panorama",e.Image360="Image360",e.Zip="Zip",e.ThreeD="3d",e.TextFile="TextFile",e.Photo="Photo",e.Thumbnail="Thumbnail",e.FileHandler="FileHandler",e.Copilot="Copilot",e.Other="Other",e.Unknown="Unknown"}(a||(a={}));var f=[".opus",".url",".mht",".mhtml",".xltx",".xlt"],p=new i.hK({name:"ViewerTypeHelper",factory:{dependencies:{platformDetection:s.a,pdfViewerHelper:d.b,fileHandlerHelper:l.a,pageContext:c.a},create:function(e){var t=e.platformDetection,n=e.pdfViewerHelper,i=e.fileHandlerHelper,s=e.pageContext,c=!t.isMobile;return{instance:{getValidViewerTypes:function(e){var t;if(!e||e.isPlaceholder)return a.Unknown;var d=function(e){if((0,u.ab)()&&e.extension&&-1!==f.indexOf(e.extension))return a.Other}(e);return d||(e.error?a.Error:e.folder||e.itemStatus===r.b.ConditionalAccessBlocked||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected||(0,u.V)()&&"OneNote.Notebook"===(null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.ProgId)?a.Other:e.officeBundle||e.wopiFrameUrl?a.WAC:e.htmlConversion?a.Html:n.isSupportedFileType(e)?a.MSPdf:e.video?a.OnePlayerVideo:e.audio?a.OnePlayerAudio:e.panorama?a.Panorama:c&&e.image360?a.Image360:e.model3d?a.ThreeD:e.zip?a.Zip:function(e,t){return(0,u.$)(t)&&!!e.extension&&".copilot"===e.extension}(e,s)?a.Copilot:function(e){return!!e.extension&&(0,o.b)(e.extension,e.type)}(e)?a.TextFile:e.photo?a.Photo:e.thumbnail?a.Thumbnail:i.hasFileHandler(e)?a.FileHandler:a.Other)}}}}}})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>c});var a=n("tslib_826"),i=n(4),r=(0,n(225).a)(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.XJ)(t,e),t}(i.a.withManager(r));function s(e,t){return new o({name:"OneUpLightSpeed.MeTA",extraData:(0,a.W_)({viewerName:e},t)})}function c(e,t){null==e||e.end({resultType:i.b.Success,extraData:t})}function d(e,t){null==e||e.end(t)}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>de,b:()=>oe});var a=n("tslib_826"),i=n("odsp.util_118"),r=n(130),o=[".accessToken",".callerStack",".correlationId",".driveAccessToken",".driveAccessTokenV21",".driveAccessCode",".driveAccessCodeV21",".driveUrl",".mediaBaseUrl",".officeBundleGenerate",".officeBundleGetFragment",".pdfConversionUrl",".pushChannelBaseUrl",".thumbnailUrl",".transformUrl",".videoManifestUrl"];function s(e){var t={},n=e.ListSchema;if(n)for(var a=0,i=o;a<i.length;a++){var r=i[a],s=n[r];s&&".mediaBaseUrl"===r&&(s=s.replace("https://media.cloudapp.net",window.__mediaBaseUrl||"https://northcentralus1-medias.svc.ms")),t[r]=s}return t}var c=n(439),d=n(244),l=n(213),u=n(447),f=n(455),p=n(142),m=n(242),_=n(243),h=n(136),b=n(451),g=n(128),v=n(392),y=n(178),S=n(145),D=n(452),I=n(449),x=[".docm",".dotm",".dotx",".docx",".bmp",".jpg",".jpeg",".tiff",".tif",".png",".gif",".emf",".wmf",".psd",".svg",".ai",".pdf",".pptm",".pptx",".potm",".potx",".ppsm",".ppsx",".xlsm",".xlsx",".aspx"];function C(e){return!!e&&x.indexOf(e.toLowerCase())>=0}var O=n(245),w=n(99),E=n(9),A=n(448),L=n(54),k=n(146),M=n(25),P=n(122),T=n(49),U=n(41),F=n(5),H=n(52),R=n(450),N=n(28),B=!i.HW.isActivated("b8f99452-1739-40bb-a1bb-dd8b65e27ec6","07/13/2024","Fix image preview of remote item in Gallatin"),j=[".dcm",".dcm30",".dic",".dicm",".dicom"];function V(e){var t=(0,u.a)(e),n=t.endpoint,a=t.driveId,i=t.itemId;if(n)return{endpoint:n,driveId:a,itemId:void 0===i?"root":i}}function z(e){var t,n,i,r=e.pageContext,o=e.spItemIdentity,s=e.itemFromServer,c=e.oneUpUrlDataSource,d=e.navigation,l=e.itemUrlHelper,u=e.rootItemSet;if(u)n=function(e){var t,n=e.rootItemSet;return e.oneUpUrlDataSource.getKey(((t={})[U.a.queryTypeParamKey]=n.queryType,t))}({oneUpUrlDataSource:c,rootItemSet:u});else{var f=void 0;s&&(f=s.FileRef||s.ServerRelativeUrl),o&&(t=function(e){var t,n,i=e.spItemIdentity,r=e.folderPath,o=e.newTargetListViewUrl,s=e.itemUrlHelper,c=e.supportsOnePageNavigation,d=e.itemQueryParams,l=e.searchParams,u=e.oneUpUrlDataSource,f=(0,a.l7)(e,["spItemIdentity","folderPath","newTargetListViewUrl","itemUrlHelper","supportsOnePageNavigation","itemQueryParams","searchParams","oneUpUrlDataSource"]),p=s.getUrlParts({webUrl:i.webAbsoluteUrl,listUrl:i.listFullUrl,path:r||i.rootFolder});if(i.itemId&&!r)return{key:void 0,id:void 0};var m=!0;return c&&o&&!f.listUrl&&p.normalizedListUrl&&o.indexOf(p.normalizedListUrl)>-1&&(m=!1),{key:u.getKey((0,a.W_)((0,a.W_)((0,a.W_)((t={},t[U.a.idParamKey]=p.serverRelativeItemUrl||"",t),m&&p.normalizedListUrl?(n={},n[U.a.listUrlKey]=p.normalizedListUrl,n):{}),d||{}),l||{})),id:p.serverRelativeItemUrl||""}}({spItemIdentity:o,oneUpUrlDataSource:c,folderPath:f,itemUrlHelper:l,listUrl:r.listUrl,viewParams:d.viewParams}),n=t.key,i=t.id)}return{key:n,viewParams:d.viewParams,id:i}}function G(e){var t,n=e.itemFromServer,a=e.extension,i=e.mediaServiceFastMetadata,r=e.blockDownload,o=e.microServiceDataSource,s={fileExtension:e.extension,item:n,mediaServiceMetadata:i};if(t=r&&(0,m.b)(a)?o.getPassthroughUrl(s):o.getPdfConversionUrl(s))return{url:t}}function K(e){if(e&&"{}"!==e)try{return JSON.parse(e)}catch(e){return}}function W(e){var t,n=e.siteId,a=e.webId,i=e.docId,r=e.webUrl,o=e.layoutsUrl,s=function(e){return r+"/"+o+"/getpreview.ashx?clientType=docLibGrid&guidFile="+i+"&guidSite="+n+"&guidWeb="+a+(e?"":"&resolution=Width1024")};return i&&(t={url:s(!1),width:0,height:0,getAligned:function(e,t){return{url:s(t.name===v.a.name),width:0,height:0}}}),t}function q(e){return void 0!==e?e/1e4:NaN}function Q(e){if(!e)return{};var t,n,a,r,o,s=e[".driveAccessTokenV21"],c=void 0===s?void 0:s,d=e[".driveAccessToken"],l=void 0===d?void 0:d,u=e[".driveUrl"],f=void 0===u?void 0:u,m=e[".driveUrlV21"],_=void 0===m?void 0:m,h=e[".driveAccessCode"],b=void 0===h?void 0:h,g=e[".driveAccessCodeV21"],v=void 0===g?void 0:g,S=!i.HW.isActivated("a6323fd0-da2e-4e48-a04c-b28869207ec4","07/03/2024","Add MeTA PAC tokens (driveAccessCode and driveAccessCodeV21) to sessionToken");return l&&(t={accessToken:(r=(0,y.a)(l)).access_token,proofToken:r.prooftoken,tokenUrl:f},S&&b&&(t.metaPac=b),f&&(o=V(f))&&(a=o.driveId)),c&&(n={accessToken:(r=(0,y.a)(c)).access_token,proofToken:r.prooftoken,tokenUrl:_},S&&v&&(n.metaPac=v),_&&!a&&(o=V(_))&&(a=o.driveId)),t&&(0,p.a)({authToken:t.accessToken,proofToken:t.proofToken})&&(t=void 0),n&&(0,p.a)({authToken:n.accessToken,proofToken:n.proofToken})&&(n=void 0),{driveId:a,sessionToken:t,sessionTokenV21:n}}var Y=new i.hK({name:"ProcessOneUpItem",factory:{dependencies:{pageContext:F.a,oneUpUrlDataSource:l.a,microServiceDataSource:P.a,navigation:T.a,itemUrlHelper:M.c},create:function(e){var t=e.pageContext,n=e.oneUpUrlDataSource,o=e.microServiceDataSource,s=e.navigation,c=e.itemUrlHelper;return{instance:{processOneUpItem:function(e){return e.microServiceDataSource||delete e.microServiceDataSource,function(e){var t=e.pageContext,n=e.itemFromServer,o=e.mediaTransformListSchema,s=e.microServiceDataSource,c=e.itemUrlHelper,l=e.oneUpUrlDataSource,u=e.spItemIdentity,p=e.spParentItemIdentity,m=e.navigation,v=e.listContext,y=e.currentPageContext,x=t.listBaseTemplate,M=z({pageContext:t,spItemIdentity:u,itemFromServer:n,oneUpUrlDataSource:l,navigation:m,itemUrlHelper:c}),P=M.key,T={key:P||"",id:M.id};if(p){var F=z({pageContext:t,spItemIdentity:p,itemFromServer:n,oneUpUrlDataSource:l,navigation:m,itemUrlHelper:c}).key;F&&(T.parentKey=F)}var Y=Q(o),J=Y.sessionToken,X=Y.sessionTokenV21;if(T.graph={itemId:"",driveId:"",sessionToken:J,sessionTokenV21:X},n){var Z=n[".spItemUrl"],$=Z?V(Z):void 0;if($){var ee=$.itemId,te=$.driveId;T.itemId=ee,T.graph=(0,a.W_)((0,a.W_)({},T.graph),{itemId:ee||"",driveId:te||""})}var ne=n.PermMask?(0,b.a)(n.PermMask):void 0;ne&&(T.permissions=ne),T.displayName=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=void 0===n?g.a.documentLibrary:n,i=a&&(0,r.d)(a)||a===g.a.promotedLinks||(0,r.c)(a)?t.Title:t.FileLeafRef;return a===g.a.links&&(i=t["URL.desc"]||t.URL||i),i}({itemFromServer:n,listTemplateType:x});var ae=function(e){var t=e.File_x0020_Type,n=e.FileLeafRef,a=e.FileRef,i=e.RemoteItem,r=t&&!i?"."+t:"",o=n||a&&new E.a(a).segments.slice(-1)[0]||"",s=r&&o?o.toLowerCase().lastIndexOf(r.toLowerCase()):-1;return{name:s>-1?o.substring(0,s):o,extension:r}}(n),ie=ae.name,re=ae.extension;T.name=ie,T.extension=re;var oe=Number(n.File_x0020_Size)||Number(n.FileSizeDisplay)||void 0;void 0!==oe&&(T.size=oe),T.totalSize=Number(n.SMTotalSize)||void 0;var se="Modified."in n,ce=n["Modified."];if(se&&ce){var de=new Date(ce).getTime();if(!isNaN(de)){T.dateModifiedTime=new Date(de);var le=L.a.language||window.navigator.language;T.dateModified=(0,D.c)(T.dateModifiedTime,le)}}T.contentTypeId=n.ContentTypeId;var ue=K(n.MediaServiceFastMetadata),fe=K(n.MediaServiceMetadata),pe=function(e){var t=e.itemFromServer,n=e.extension,a=e.microServiceDataSource;if(e.pageContext.isSPO){var i=a.getFbxConversionUrl({fileExtension:n,item:t}),r=(0,_.b)(n)||!1;if(i||r)return{canConvert:!0,canRenderNative:r,conversionUrl:i&&i.replace("/bxf?","/glb?")}}}({pageContext:t,itemFromServer:n,extension:re,microServiceDataSource:s});pe&&(T.model3d=pe);var me=ne&&H.a.hasPermission(ne,H.a.openItems),_e=G({itemFromServer:n,extension:re,mediaServiceFastMetadata:ue,blockDownload:t.blockDownloadsExperienceEnabled||t.viewOnlyExperienceEnabled||!me,microServiceDataSource:s});_e&&(T.pdfConversion=_e);var he=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=e.mediaServiceFastMetadata,i=e.hasPdfConversion,o=e.has3d,s=d.a.Unknown;if(t.folder)s=d.a.Folder;else if("1"===t.FSObjType||t.RemoteItem){var c=t["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],l=t["File_x0020_Type.mapapp"];s=l&&"onenote"===l.substring(0,7)||c&&-1!==c.indexOf("onenote")?d.a.OneNote:d.a.Folder}if(s===d.a.Unknown){var u=t.File_x0020_Type,f=u?".".concat(u):"";if(u&&A.a.isShortcutFileType(u))return d.a.Shortcut;if("pdf"===u||i)return d.a.Media;if(o)return d.a.Media;if("audio"===(0,S.a)(f))return d.a.Media;if(a)return d.a.Media;if((s=(0,S.c)(f))===d.a.Unknown)return void 0!==n&&(0,r.d)(n)?d.a.File:n===g.a.promotedLinks?d.a.Media:s}return s||d.a.File}({itemFromServer:n,mediaServiceFastMetadata:ue,listTemplateType:x,hasPdfConversion:!!G({itemFromServer:n,extension:re,mediaServiceFastMetadata:ue,blockDownload:!0,microServiceDataSource:s}),has3d:!!pe});if((((0,N.ub)()?C(re):(0,I.a)(re))||".ai"===re||".eps"===re||".psd"===re)&&s.getThumbnail({fileExtension:re,item:n,itemKey:P||"",mediaServiceMetadata:ue})&&(he=d.a.Media),f.b(re)?T.htmlConversion={}:f.a(re)&&(be=s.getHtmlConversionUrl({fileExtension:re,item:n,mediaServiceMetadata:ue}))&&(he=d.a.Media,T.htmlConversion={url:"".concat(be,"&inlineImages=true")}),".zip"===re||".rar"===re){var be=s.getZipMetaDataUrl({fileExtension:re,item:n,mediaServiceMetadata:ue}),ge=s.getDownloadZipContentsUrl(n);be&&ge&&(he=d.a.Media,T.zip={zipMetaDataUrl:be,downloadZipContentsUrl:ge})}var ve=ue&&ue.video,ye=".ts"===re&&void 0!==oe&&oe<1<<19&&!ve;ye&&(he=d.a.File);var Se=void 0,De={},Ie=s.getDownloadAsZipUrl(n),xe=s.getImmersiveReaderUrl({fileExtension:re,item:n}),Ce=l.getKeyParams(P),Oe=c.getUrlParts({path:n.id||n.FileRef||n.ServerRelativeUrl,listUrl:Ce[U.a.listUrlKey]}),we=Oe.fullItemUrl,Ee=we?w.a(we):void 0;Ie&&(De[h.b.downloadAsZip]=Ie),xe&&(De[h.b.immersiveReaderUrl]=xe),Z&&(De[h.b.itemUrl]=Z);var Ae=n["serverurl.progid"];(Ae=Ae?Ae.substring(1):x===g.a.links?n.URL:Ee)&&(De[h.b.original]=Ae),A.a.isShortcutItem({key:P||"",extension:re})&&(he=d.a.Shortcut,T.shortcutInfo={shortcutLinkRewritten:!0},n._ShortcutUrl&&(De[h.b.shortcutTarget]=n._ShortcutUrl),n._ShortcutUniqueId&&(Se=W({siteId:n._ShortcutSiteId,webId:n._ShortcutWebId,docId:n._ShortcutUniqueId,webUrl:t.webAbsoluteUrl,layoutsUrl:t.layoutsUrl}))),Ae&&(De[h.b.open]=Ae);var Le=n["File_x0020_Type.mapapp"];Le||(Le=n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"])&&(Le=Le.split("|").slice(-1).join()),T.appMap=Le,Se||(Se=function(e){if(e.type!==d.a.Folder){var t=e.itemFromServer;if(void 0!==e.listTemplateType&&(0,r.e)(e.listTemplateType))return{url:t.BackgroundImageLocation||"",width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===g.a.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;var a=e.pageContext,i=e.currentPageContext;if(((0,N.ub)()?C(e.extension):(0,I.a)(e.extension))&&a){var o=a.siteId,s=a.webId,c=a.webAbsoluteUrl,l=a.layoutsUrl;return W({siteId:B&&(null==i?void 0:i.siteId)||o,webId:B&&(null==i?void 0:i.webId)||s,docId:t.UniqueId,webUrl:c,layoutsUrl:l})}}}({itemFromServer:n,listTemplateType:x,extension:re,key:P||"",type:he,mediaServiceFastMetadata:ue,microServiceDataSource:s,pageContext:t,currentPageContext:y})),T.openUrl=Ae,T.downloadUrl=n[".downloadUrl"]||void 0,T.downloadUrlNoAuth=n[".downloadUrlNoAuth"]||void 0,T.itemGeneratedTimeStamp=Date.now();var ke=n["IconOverlay.mapoly"];if(ke&&(T.overlayUrl="/"+t.layoutsUrl+"/images/"+ke),Se&&(T.thumbnail=Se),he===d.a.Folder){T.childCount=function(e){var t=e.FolderChildCount,n=e.ItemChildCount,a=e.RemoteItem;if(a)return JSON.parse(a).FolderChildCount;var i=n?parseInt(n,10):NaN,r=t?parseInt(t,10):NaN;return isNaN(i)&&isNaN(r)?void 0:isNaN(i)?r:isNaN(r)?i:i+r}(n);var Me=Number(n.SMTotalFileCount);T.folder={totalCount:Me>0?Me:T.childCount,childCount:T.childCount}}var Pe=n.ServerRedirectedEmbedUrl;Pe&&(c.getUrlParts({path:Pe}).isCrossDomain||(T.previewIFrameUrl=Pe)),T.type=he;var Te=n.ID,Ue=n.UniqueId,Fe={};for(var He in Fe.uniqueId=(0,i.wP)(Ue),Fe.ID=Te,n)n.hasOwnProperty(He)&&(Fe[He]=n[He]);T.properties=Fe;var Re="ms-excel"===Le,Ne="ms-powerpoint"===Le,Be="ms-visio"===Le,je="ms-word"===Le,Ve=!0;if((0,N.gb)()&&re){var ze=k.b[re.replace(/^\./,"")];Ve=!!ze&&(ze===k.f||ze===k.c||ze===k.d||ze===k.e)}if(Ae&&(je||Re||Ne||Be)&&Ve){var Ge=function(e){var t=e.isWord,n=e.extension,a=e.isPowerPoint,i=e.itemFromServer,r=e.microServiceDataSource,o=e.mediaServiceFastMetadata;if(!e.itemUrlParts.isCrossDomain){var s,c,d,l=t||a,u=(t||a?r.getOfficeBundleGenerateUrl({fileExtension:n,item:i,mediaServiceMetadata:o}):"")||"",f=r.getOfficeBundleGetFragmentUrl({fileExtension:n,item:i,mediaServiceMetadata:o})||"",p=!1,m="",_=i[".ctag"],h=o&&o.officeBundle;return h&&(s=h.ctag,d=h.version,p=h.fatalError||!1,h.generationTime&&(c=new Date(h.generationTime)),m=h.errorInfo||""),{officeBundleGenerateUrl:u,officeBundleGetFragmentUrl:f,bundleCTag:s||"",bundleVersion:d||"",hasBundleGenerationFailed:p,bundleErrorInfo:m,generationTime:c,cTag:_||"",enableDefaultClick:l}}}({isWord:je,extension:re,itemUrlParts:Oe,isPowerPoint:Ne,itemFromServer:n,microServiceDataSource:s,mediaServiceFastMetadata:ue});if(Ge&&!Be&&(T.officeBundle=Ge),Ge&&(je||Ne)){var Ke=s.getPdfConversionUrl({fileExtension:re,item:n,mediaServiceMetadata:ue},!0);Ke&&(De[h.b.viewInBrowser]=Ke)}T.wopiFrameUrl=Ae}var We=s.getVideoUrl({fileExtension:re,item:n,mediaServiceMetadata:ue});We&&(De[h.b.video]=We);var qe=s.getMediaBaseUrl({fileExtension:re,item:n,mediaServiceMetadata:ue});qe&&(De[h.b.mediaBaseUrl]=qe);var Qe=s.getThumbnailSpriteBaseUrl({fileExtension:re,item:n});Qe&&(De[h.b.thumbnailSpriteBaseUrl]=Qe),T.urls=De;var Ye=void 0,Je=j.indexOf(re)>=0,Xe=void 0,Ze=void 0,$e=void 0,et=void 0,tt=void 0;if(he===d.a.Folder)Ye=!!n.ProgId&&"sharepoint.documentset"===n.ProgId.toLowerCase(),T.isDocSet=Ye;else if(he!==d.a.Media&&!ue||void 0!==x&&(0,r.e)(x))he===d.a.File&&v&&void 0!==v.isDocLib&&!v.isDocLib&&(tt={});else{var nt=S.a(re),at=ue&&ue.photo||(Je||"photo"===nt?{}:void 0),it=ve||("video"===nt?{}:void 0),rt=ue&&ue.audio||("audio"===nt?{}:void 0);at&&(Xe={originalUrl:"photo"===nt?Ee:void 0,width:at.width||0,height:at.height||0},$&&$.itemId&&(Ze=function(e){var t,n=e.itemFromServer,a=e.mediaServiceFastMetadata,i=e.photoMetadata,r=e.fullMediaServiceMetadata,o=a&&a.panorama,s=!1;if(o&&"equirectangular"===o.projectionType?(t={projectionType:o.projectionType},s=!0):n.FileLeafRef&&-1!==n.FileLeafRef.indexOf(".360")?t={projectionType:"equirectangular"}:void 0!==i.width&&i.width>0&&void 0!==i.height&&i.height>0&&i.width/i.height==2&&(s=!0),s&&r){var c=r.panorama;if(c)t={projectionType:o&&o.projectionType||void 0,croppedAreaImageHeightPixels:c.croppedAreaImageHeightPixels||void 0,croppedAreaImageWidthPixels:c.croppedAreaImageWidthPixels||void 0,croppedAreaLeftPixels:c.croppedAreaLeftPixels||void 0,croppedAreaTopPixels:c.croppedAreaTopPixels||void 0,fullPanoHeightPixels:c.fullPanoHeightPixels||void 0,fullPanoWidthPixels:c.fullPanoWidthPixels||void 0,initialHorizontalFOVDegrees:c.initialHorizontalFOVDegrees||void 0,initialVerticalFOVDegrees:c.initialVerticalFOVDegrees||void 0,initialViewHeadingDegrees:c.initialViewHeadingDegrees||void 0,initialViewPitchDegrees:c.initialViewPitchDegrees||void 0,initialViewRollDegrees:c.initialViewRollDegrees||void 0,poseHeadingDegrees:c.poseHeadingDegrees||void 0,posePitchDegrees:c.posePitchDegrees||void 0,poseRollDegrees:c.poseRollDegrees||void 0};else{var d=r.photo;if(d&&d.cameraModel){var l=d.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(l)>=0&&(t={projectionType:"equirectangular"})}}}return t}({itemFromServer:n,mediaServiceFastMetadata:ue,photoMetadata:at,fullMediaServiceMetadata:fe})));var ot={mediaEdits:!i.HW.isActivated("5ec031b1-e270-4bdd-8c72-638a99a62d60","10/23/2023","Get edits information from RLDAS infromation for Soft trim")&&n.Edits?JSON.parse(n.Edits):void 0,previewThumbnailsQualitySets:!i.HW.isActivated("96f75f66-17fb-4071-9322-86e0db732994","07/04/2024","Get preview thumbnails information from RLDAS infromation for Seek bar thumbnails.")&&n.PreviewThumbnailsQualitySets?JSON.parse(n.PreviewThumbnailsQualitySets):void 0};T.media=ot;var st=ue&&ue.media;if(it){var ct=i.HW.isActivated("f0fc3265-1fce-4d4a-b67a-3b3dfa291a6f","09/27/2023","Get PremiumProcessingStatus from RLDAS for Premium Video in 1P 1.0")?void 0:it.premiumProcessingStatus;$e={fourCC:it.fourCC||(".mp4"===re.toLowerCase()?"H264":void 0),bitrate:it.encodingBitrate,width:it.frameWidth||0,height:it.frameHeight||0,duration:q(st&&st.duration),audioFormat:rt&&rt.format,manifestMetadata:it.manifestMetadata,altManifestMetadata:it.altManifestMetadata,premiumProcessingStatus:ct}}rt&&(et={duration:q(st&&st.duration)})}T.photo=Xe,T.image360=Ze,T.video=$e,T.audio=et;var dt,lt=!t||"21"===t.webTemplate&&700===t.listBaseTemplate;dt=Number(n.PrincipalCount)>0?O.a.Shared:void 0===n.PrincipalCount?lt?void 0:O.a.Unknown:O.a.Private,T.sharingType=dt;var ut=S.b({extension:re,isDocSet:Ye,listItem:tt,sharingType:dt,type:he,textEditorMimeType:ye?"text/typescript":void 0,panorama:Ze,isMountPoint:!!n.RemoteItem});T.iconName=ut,T.isPlaceholder=!T.displayName&&!T.permissions;var ft=function(e){return{isMalwareDetected:(0,R.a)(e),isNew:(0,R.b)(e)}}(n);ft&&(T.lifeCycleStatus=ft)}return T}((0,a.W_)({pageContext:t,oneUpUrlDataSource:n,microServiceDataSource:o,navigation:s,itemUrlHelper:c},e))},processOneUpListRootItem:function(e){return function(e){var t=e.pageContext,n=e.oneUpListInfo,a=e.itemUrlHelper,i=e.oneUpUrlDataSource,r=z({pageContext:t,spItemIdentity:e.spItemIdentity,oneUpUrlDataSource:i,navigation:e.navigation,itemUrlHelper:a}),o={key:r.key||"",id:r.id},s=n.mediaTransform,c=n.list,l=n.permissions,u=Q(s),f=u.sessionToken,p=u.sessionTokenV21,m=u.driveId;return o.itemId=o.itemId||"root",o.graph={itemId:"root",driveId:m||"",sessionToken:f,sessionTokenV21:p},o.name=o.name||c.title,o.displayName=o.displayName||c.title,o.type=d.a.Folder,o.isRootFolder=!0,o.folder={},o.list=c,o.permissions=l,o}((0,a.W_)({pageContext:t,oneUpUrlDataSource:n,microServiceDataSource:o,navigation:s,itemUrlHelper:c},e))}}}}}}),J=n(70),X=n(4),Z=n(443),$=n(140),ee=n(53);const te=function(){function e(){this._pageContextMap=new Map}return e.prototype.add=function(e,t){this._pageContextMap.set(JSON.stringify(e),t)},e.prototype.get=function(e){return this._pageContextMap.get(JSON.stringify(e))},e}();var ne=n(698),ae=n(438),ie=n(697),re=!i.HW.isActivated("cc69c4e8-4b22-45b5-9f19-caec58f399d7","04/30/2024","if url is not right, log url for ppe ");function oe(e){var t;try{var r=(0,ae.a)(e),o=r.idViewParam,c=r.parentViewParam,d=r.parentViewViewParam,l=r.listUrlViewParam,f=r.viewViewParam,p=r.webAbsoluteUrl,m=r.fullListUrl,_=r.serverRelativeFocusItemUrl,h=r.serverRelativeParentUrl,g=r.listContext,v=r.pageContext,y=new X.a({name:$.h}),S=o&&_&&(c||l||d),D=(c||d)&&(o||l||f),I=!!re&&"spdf"===(null===(t=v.cloudType)||void 0===t?void 0:t.toLowerCase());if((0,N.T)()?D:S)if(p&&m){var x=e.consume(ie.a),C=o?_:void 0,O=new X.a({name:$.l});x.getCurrentItem().then(function(t){if((0,N.Y)()&&t&&t.BasePermissions&&!1===t.BasePermissions.OpenItems&&e.consume(ee.e).updateIsNoAccessScenarioState("fastOneUpAdapter",!0),t&&t.ListData&&t.ListData.Row&&t.ListData.Row.length>0&&t.ListSchema){e.consume(P.a).setBaseInfo({data:t.ListSchema,allowCookies:!1});var r=t.PageContextInfo?JSON.parse(t.PageContextInfo):void 0;if((0,N.T)()&&!C&&m){var o={focusItem:D=ce({spGetFocusItemResponse:t,webAbsoluteUrl:p,listFullUrl:m,listContext:g,parentFolderPath:h,resourceScope:e}),parentItem:D,focusItemSet:[D],list:D,currentIndex:0};(l=e.consume(J.b)).update(o,"fastOneUpRLDS"),y.end({resultType:X.b.Success})}else if(v){var c=(0,Z.a)({response:t,id:_,listContext:g,qosEvent:O});if(c.resultType===X.b.Success)try{var d=se({spGetItemResponse:t,webAbsoluteUrl:p,listFullUrl:m,listContext:g,parentFolderPath:h,resourceScope:e,currentPageContext:r});if(d){var l=e.consume(J.b),f=t.ListData&&t.ListData.Row&&t.ListData.Row[0];f&&(function(e,t){return(0,a.Zd)(this,void 0,void 0,function(){var i,r,o=this;return(0,a.qr)(this,function(s){return(0,N.Z)(N.P)&&(i=new X.a({name:$.k}),r=function(){return(0,a.Zd)(o,void 0,void 0,function(){return(0,a.qr)(this,function(a){switch(a.label){case 0:return[4,n.e(16).then(n.bind(n,638)).then(function(n){var a=n.favoritesDataManagerKey,r=e.consume(a);return r.populateFavorites().then(function(n){var a=null==t?void 0:t.UniqueId;if(a&&-1!==a.indexOf("{")&&(a=a.replace("{","").replace("}","").toLowerCase()),i.end({resultType:X.b.Success}),n&&a){var o=r.isFavorited(a);return e.consume(ee.e).setIsFocusItemFavorited("fastoneUpAdapater",o),o}}).catch(function(e){i.end({resultType:X.b.Failure,error:e.message,extraData:{rawError:e}})})}).catch(function(e){i.end({resultType:X.b.Failure,error:e.message,extraData:{rawError:e}})})];case 1:return[2,a.sent()]}})})},r().catch(function(e){i.end({resultType:X.b.Failure,error:e.message,extraData:{rawError:e}})})),[2]})})}(e,f).catch(function(e){}),function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t;return(0,a.qr)(this,function(n){switch(n.label){case 0:return[4,e.consumeAsync(ne.a)];case 1:return[4,n.sent().hasValidLicenseCached()];case 2:return t=n.sent(),e.consume(ee.e).updateIsUniversalPrintLicenseValidState("fastOneUpAdapter",t),[2]}})})}(e).catch(function(e){}));var S=function(e){var t,n,i=e.resourceScope,r=e.focusItemResponse,o=(0,ae.a)(i),c=o.webAbsoluteUrl,d=o.fullListUrl,l=o.isRootFolder,f=o.listContext,p=o.serverRelativeParentUrl,m={key:"",isPlaceholder:!0},_=i.consume(Y);if(c&&d)if(l&&r){var h={listFullUrl:d,rootFolder:"",webAbsoluteUrl:c},g=s(r),v=_.processOneUpItem({itemFromServer:void 0,spItemIdentity:h,listContext:f,mediaTransformListSchema:g}),y=r.ListData,S=(y||{}).FolderPermissions,D=void 0;S&&(D=(0,b.a)(S));var I=void 0,x="root",C=y&&y.Row&&y.Row[0];C&&C[".spItemUrl"]&&(I=(0,u.a)(C[".spItemUrl"]).driveId),(m=(0,a.W_)((0,a.W_)((0,a.W_)((0,a.W_)((0,a.W_)({},v),{itemId:x}),I?{graph:{itemId:x,driveId:I,sessionToken:null===(t=v.graph)||void 0===t?void 0:t.sessionToken,sessionTokenV21:null===(n=v.graph)||void 0===n?void 0:n.sessionTokenV21}}:{}),{folder:{}}),D?{permissions:D}:{})).isPlaceholder=!1}else g=s(r),v=_.processOneUpItem({itemFromServer:void 0,spItemIdentity:{itemId:"",listFullUrl:d,webAbsoluteUrl:c,rootFolder:p},listContext:f,mediaTransformListSchema:g}),m=(0,a.W_)((0,a.W_)({},v),{isPlaceholder:!0});return m}({resourceScope:e,focusItemResponse:t}),D=ce({spGetFocusItemResponse:t,webAbsoluteUrl:p,listFullUrl:m,listContext:g,parentFolderPath:h,resourceScope:e}),I=l.pageContexts;if(r){var x={webAbsoluteUrl:r.webAbsoluteUrl,listUrl:r.listUrl};I?I.add(x,r):(I=new te).add(x,r)}o={focusItem:d,focusItemSet:[d],parentItem:S,list:D,currentIndex:0,pageContexts:I},l.update(o,"fastOneUpRLDS"),y.end({resultType:X.b.Success})}else y.end({resultType:X.b.Failure,error:"missing focusItem"}),le(e,new i.EI({code:"FastOneUp-NoFocusItem"}))}catch(t){y.end({resultType:X.b.Failure,error:t.message}),le(e,new i.EI({code:"FastOneUp-getOneUpItemException",innerError:t}))}else y.end(c),O.end(c),le(e,new i.EI({code:c.resultCode,extraData:c.extraData}))}else{var w="noPageContext";y.end({resultType:X.b.Failure,error:w}),O.end({resultType:X.b.Failure,error:w}),le(e,new i.EI({code:"FastOneUp-noPageContext"}))}}else w="no Row Data from RLDS",y.end({resultType:X.b.Failure,error:w}),O.end({resultType:X.b.Failure,error:w}),le(e,new i.EI({code:"FastOneUp-NoRowData"}))}).catch(function(t){y.end({resultType:X.b.Failure,error:t.message}),O.end({resultType:X.b.Failure,error:t.message}),le(e,new i.EI({code:"FastOneUp-getSingleItemException",innerError:t}))})}else p?m||(y.end({resultType:X.b.Failure,error:"no listFullUrl"}),le(e,new i.EI({code:"FastOneUp-noListFullUrl"}))):(y.end({resultType:X.b.Failure,error:"no webAbsoluteUrl"}),le(e,new i.EI({code:"FastOneUp-noWebAbsoluteUrl"})));else y.end({resultType:X.b.Failure,error:"no id, parent, parentview or listurl"}),le(e,c||d?new i.EI({code:"FastOneUp-noIdOrListurl",extraData:{url:I?window.location.href:void 0}}):new i.EI({code:"FastOneUp-noParent",extraData:{url:I?window.location.href:void 0}}))}catch(t){le(e,new i.EI({code:"FastOneUp-useAdapterException",innerError:t}))}}function se(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,a=e.listContext,i=e.parentFolderPath,r=e.resourceScope,o=e.spGetItemResponse,c=e.currentPageContext,d=o.ListData&&o.ListData.Row&&o.ListData.Row[0];if(d){var l={itemId:d.ID,listFullUrl:n,rootFolder:"",webAbsoluteUrl:t},u=i?{itemId:"",listFullUrl:n,rootFolder:i,webAbsoluteUrl:t}:void 0,f=r.consume(Y),p=s(o);return f.processOneUpItem({itemFromServer:d,spItemIdentity:l,spParentItemIdentity:u,listContext:a,mediaTransformListSchema:p,currentPageContext:c})}}function ce(e){var t,n,a,o,c,d,l,u,f,p,m,_,h,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H=e.webAbsoluteUrl,R=e.listFullUrl,N=e.listContext,B=e.resourceScope,j=e.spGetFocusItemResponse,V=j.ListData&&j.ListData.Row&&j.ListData.Row[0],z=B.consume(Y),G=j&&s(j),K=V&&V.PermMask?(0,b.a)(V.PermMask):void 0;if(j&&K){var W={list:(t=j,n=t.AllowGridMode,a=t.DisableGridEditing,o=t.ListTemplateType,c=t.BasePermissions,d=void 0===c?{}:c,l=d.ManageLists,u=void 0===l?void 0:l,f=d.ManagePersonalViews,p=void 0===f?void 0:f,m=d.OpenItems,_=void 0===m?void 0:m,h=d.UseClientIntegration,g=void 0===h?void 0:h,v=t.ListSchema,y=(void 0===v?{}:v).DefaultItemOpen,S=void 0===y?void 0:y,D=t.ExcludeFromOfflineClient,I=t.WebExcludeFromOfflineClient,x=t.ListData,C=t.listBaseType,O=t.Flags2,w=t.MachineLearningCaptureEnabled,E=t.MachineLearningExperienceEnabled,A=t.AIBuilderEnabled,L=t.AIBuilderDefaultPowerAppsEnvironment,k=t.Color,M=t.Icon,P=t.ListUrl,T=t.listUrlDir,U=P||T&&decodeURIComponent(T),F="string"==typeof S?"0"===S:void 0,{id:(0,i.wP)(t.listName),title:t.ListTitle,flags2:O,machineLearningCaptureEnabled:w,machineLearningExperienceEnabled:E,aiBuilderEnabled:A,aiBuilderDefaultPowerAppsEnvironment:L,allowGridMode:"boolean"!=typeof n||n,allowCreateFolder:t.AllowCreateFolder,disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof a&&a,enableMinorVersions:t.EnableMinorVersions,enableVersions:t.verEnabled,templateType:"string"==typeof o?Number(o):void 0,isDocumentLibrary:(0,r.b)(String(C)),isPromotedLinks:"string"==typeof o?(0,r.e)(o):void 0,isForceCheckout:t.isForceCheckout,isModerated:t.isModerated,enableRequestSignOff:t.EnableRequestSignOff,newWOPIDocumentEnabled:t.NewWOPIDocumentEnabled,newWOPIDocumentTypes:t.NewWOPIDocumentTypes,permissions:{manageLists:u,managePersonalViews:p,openItems:_,useClientIntegration:g},openInClient:F,excludeFromOfflineClient:"boolean"==typeof D||"boolean"==typeof I?D||I:void 0,contentTypesEnabled:t.ContentTypesEnabled,metadataNavFeatureEnabled:t.metadataNavFeatureEnabled,canUserCreateMicrosoftForm:t.canUserCreateMicrosoftForm,itemCount:t.ListSchema&&t.ListSchema.ItemCount,rowLimit:x&&x.RowLimit,canShareLinkForNewDocument:t.CanShareLinkForNewDocument,enableAttachments:"true"===t.EnableAttachments,createdFromExcel:t.CreatedFromExcel,createdFromExisting:t.CreatedFromExisting,icon:"string"==typeof M?Number(M):void 0,color:"string"==typeof k?Number(k):void 0,lastItemModifiedTime:t.lastItemModifiedTime,tick:t.tick,modernListTemplateTypeId:t.ModernListTemplateTypeId,readSecurity:t.ListSchema&&t.ListSchema.ReadSecurity,listUrlDir:U,hasPendingBusinessAppMigration:t.hasPendingBusinessAppMigration,modernTemplatesInfo:void 0!==t.IsModernTemplateLinked?{containsTemplates:t.IsModernTemplateLinked,containsListExclusiveTemplates:t.HasListExclusiveModernTemplates||!1}:void 0}),permissions:K,mediaTransform:G},q={itemId:"",listFullUrl:R,rootFolder:"",webAbsoluteUrl:H};return z.processOneUpListRootItem({spItemIdentity:q,listContext:N,oneUpListInfo:W})}}function de(e){var t=new X.a({name:$.j}),n=e.consume(ee.e);try{var i=e.consume(J.b),r=i.getOneUpProperties();if(r&&(!r.parentItem||r.parentItem.isPlaceholder)){var o=(0,ae.a)(e),s=o.webAbsoluteUrl,d=o.fullListUrl,l=o.serverRelativeParentUrl,u=o.isRootFolder,f=o.listContext,p=o.pageContext;if(l&&s&&d&&!u){var m={pageContext:p,id:l,webAbsoluteUrl:s,listFullUrl:d,listContext:f};new c.a(m).getSingleItem(!0).then(function(o){if(o&&o.ListData&&o.ListData.Row&&o.ListData.Row.length>0&&o.ListSchema){if(e.consume(P.a).setBaseInfo({data:o.ListSchema,allowCookies:!1}),p&&(0,Z.a)({response:o,id:l||"",listContext:f,qosEvent:t}))try{var c=se({spGetItemResponse:o,webAbsoluteUrl:s,listFullUrl:d,listContext:f,parentFolderPath:void 0,resourceScope:e});c&&(i.update((0,a.W_)((0,a.W_)({},r),{parentItem:c}),"fastOneUpRLDS"),n.updateParentPermissionValidity("ensureParentItem",!0))}catch(e){var u=e instanceof Error?e:new Error(e);t.end({resultType:X.b.Failure,error:u.message}),n.updateParentPermissionValidity("ensureParentItem",!1)}}else t.end({resultType:X.b.Failure,error:"no Row Data from RLDS"}),n.updateParentPermissionValidity("ensureParentItem",!1)}).catch(function(e){t.end({resultType:X.b.Failure,error:e.message}),n.updateParentPermissionValidity("ensureParentItem",!1)})}}}catch(e){var _=e instanceof Error?e:new Error(e);t.end({resultType:X.b.Failure,error:_.message}),n.updateParentPermissionValidity("ensureParentItem",!1)}}function le(e,t,n){var a=e.consume(ee.e);(0,N.Y)()&&a.currentAppState.isNoAccessScenario?a.updateErrorState("fastOneUpAdapterException",{errorType:$.d.rldsApiErrorNoAccess,error:t,item:void 0,extraData:n}):a.updateErrorState("fastOneUpAdapterException",{errorType:$.d.rldsApiError,error:t,item:void 0,extraData:n})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l});var a=n(25),i=n(41),r=n(49),o=n(5),s=n(9),c=n(28),d=n(427);function l(e){var t,n,l,u,f,p,m=e.consume(r.a),_=e.consume(o.a),h=m.viewParams,b=h[i.b.idParamKey],g=h[i.b.parentIdParamKey],v=h[i.b.parentQueryTypeParamKey],y=h[i.b.queryTypeParamKey],S=h[i.b.listUrlKey];if(!d.a&&(0,c.Z)(c.p)&&window.g_oneUpPathAndQueryString){var D=window.g_oneUpPathAndQueryString,I=new URL(D);if(I.searchParams&&I.searchParams.get("ga")){window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",D);var x=null===(t=I.searchParams)||void 0===t?void 0:t.get("id");x&&(b=x),(x=null===(n=I.searchParams)||void 0===n?void 0:n.get("parent"))&&(g=x),(x=null===(l=I.searchParams)||void 0===l?void 0:l.get("parentview"))&&(v=x),(x=null===(u=I.searchParams)||void 0===u?void 0:u.get("view"))&&(y=x),(x=null===(f=I.searchParams)||void 0===f?void 0:f.get("listurl"))&&(S=x)}}var C=g,O=e.consume(a.c),w=O.getUrlParts({path:b,listUrl:S}),E=w.fullItemUrl?new s.a(w.fullItemUrl):void 0;C?p=O.getUrlParts({path:p,listUrl:S}).fullItemUrl:(p=E?"".concat(E.authority).concat(E.segments.slice(0,-1).join("/")):void 0,C=O.getUrlParts({path:p,listUrl:S}).serverRelativeItemUrl);var A=O.getUrlParts({path:C,listUrl:S}),L=w.fullWebUrl,k=w.fullListUrl,M={listUrl:w.serverRelativeListUrl,needSchema:!0,urlParts:w},P=w.fullItemUrl,T=!(C=A.serverRelativeItemUrl!==A.serverRelativeListUrl&&A.fullItemUrl!==L&&"/"!==A.serverRelativeListUrl&&A.serverRelativeItemUrl||"")||!!C&&k===A.fullItemUrl;return{idViewParam:b,parentViewParam:g,parentViewViewParam:v,listUrlViewParam:S,viewViewParam:y,webAbsoluteUrl:L,fullListUrl:k,serverRelativeListUrl:w.serverRelativeListUrl,fullFocusItemUrl:P,serverRelativeFocusItemUrl:w.serverRelativeItemUrl,fullParentUrl:p,serverRelativeParentUrl:C,isRootFolder:T,listContext:M,pageContext:_}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a,i=n("tslib_826"),r=n(102),o=n(4),s=n(440),c=n(241),d=n(443),l=n(140);!function(e){e.preload="preload",e.callRLDS="callRLDS"}(a||(a={}));var u=function(e){function t(t){var n=e.call(this,{dataSourceName:"OneUpRLDS"},{pageContext:t.pageContext})||this;return n._id=t.id,n._retriever=new s.a({pageContext:t.pageContext}),n._listContext=t.listContext,n._extraLoggingData=t.extraLoggingData,n}return(0,i.XJ)(t,e),t.prototype.getSingleItem=function(e){void 0===e&&(e=!1);var t=new o.a({name:l.m,extraData:(0,i.W_)({},this._extraLoggingData)});if(!this._listContext)throw new Error("no listContext");if(!e&&window.g_listData){if(this._id){if((0,d.a)({response:window.g_listData,id:this._id,listContext:this._listContext,qosEvent:t,extraData:{isRace:!1}}).resultType===o.b.Success)return Promise.resolve(window.g_listData);var n=new o.a({name:l.f,extraData:(0,i.W_)({},this._extraLoggingData)});return this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:n,qosName:l.f})}throw new Error("noItemId")}return this._racePrefetchAndRLDSAPI(t).then(function(e){return e.response})},t.prototype._racePrefetchAndRLDSAPI=function(e){var t=this,n=new Promise(function(e,n){window.DeferredListDataComplete=function(){if(!t._id||!window.g_listData)throw new Error("no g_listData");if((0,d.a)({response:window.g_listData,id:t._id,listContext:t._listContext}).resultType!==o.b.Success)throw new Error("incorrect g_listData");e({response:window.g_listData,type:a.preload})}}),r=new o.a({name:l.n,extraData:(0,i.W_)({},this._extraLoggingData)}),s=this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:r,qosName:l.n}).then(function(e){return{response:e,type:a.callRLDS}});return Promise.race([n,s]).then(function(t){return t.type===a.preload?e.end({resultType:o.b.Success,extraData:{isRace:!0}}):t.type===a.callRLDS&&e.end({resultType:o.b.Failure,extraData:{isRace:!0,reason:"callRLDAS wins"}}),t})},t.prototype._getContext=function(){return this._id?{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{disableAutoHyperlink:!1,isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needClientSideComponentManifest:!1,needUpdatePageContext:!0,needsContentTypeOrder:!0,needsContentTypes:!1,needsForms:!1,needsGridInitInfo:!1,needsListAvailableContentTypes:!0,needsMountPoint:!0,needsParentInfo:!0,needsQuickLaunch:!1,needsSchema:!0,needsSpotlight:!0,needsViewMetadata:!0,renderCustomActions:!0,renderSpfxCustomActions:!1,preAuthorizedDownloadUrl:!0,requireDownloadUrlNoAuth:!0,viewXml:c.b({sortField:void 0,itemIds:void 0,itemRefs:[this._id],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:!0,pageSize:1})}}:{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needsSchema:!0,needUpdatePageContext:!0,needsMountPoint:!0,requireFolderColoringFields:!0,viewXml:c.b({itemIds:void 0,itemRefs:void 0,pageSize:0,recurseInFolders:!0,fieldNames:["File_x0020_Type","FileRef","FileLeafRef","Editor","Author","PrincipalCount","Title"]})}}},t}(r.b)}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_826"),i=n(4),r=n(28);function o(e){var t,n,o,s,c=e.response,d=e.id,l=e.listContext,u=e.qosEvent,f=e.extraData;if(c&&c.ListData&&c.ListData.Row){var p=c.ListData.Row;if(1===p.length){var m=p[0];s=((0,r.U)()?(null===(t=m.FileRef)||void 0===t?void 0:t.toLowerCase())===d.toLowerCase()&&(null===(n=c.ListUrl)||void 0===n?void 0:n.toLowerCase())===(null===(o=null==l?void 0:l.listUrl)||void 0===o?void 0:o.toLowerCase()):m.FileRef===d&&c.ListUrl===(null==l?void 0:l.listUrl))?{resultType:i.b.Success}:{resultType:i.b.Failure,resultCode:"idFileRefMismatch",extraData:(0,a.W_)((0,a.W_)({},f),{serverFileRef:m.FileRef,fileId:d,serverlistUrl:c.ListUrl,fileListUrl:null==l?void 0:l.listUrl})}}else s={resultType:i.b.Failure,resultCode:"wrongRowDataLength",extraData:(0,a.W_)((0,a.W_)({},f),{rowDataLength:p.length})}}else s={resultType:i.b.Failure,resultCode:"noRowData",extraData:(0,a.W_)({},f)};return null==u||u.end(s),s}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t)=>{"use strict";var n=60103,a=60106,i=60107,r=60108,o=60114,s=60109,c=60110,d=60112,l=60113,u=60120,f=60115,p=60116;if("function"==typeof Symbol&&Symbol.for){var m=Symbol.for;n=m("react.element"),a=m("react.portal"),i=m("react.fragment"),r=m("react.strict_mode"),o=m("react.profiler"),s=m("react.provider"),c=m("react.context"),d=m("react.forward_ref"),l=m("react.suspense"),u=m("react.suspense_list"),f=m("react.memo"),p=m("react.lazy"),m("react.block"),m("react.server.block"),m("react.fundamental"),m("react.debug_trace_mode"),m("react.legacy_hidden")}function _(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case o:case r:case l:case u:return e;default:switch(e=e&&e.$$typeof){case c:case d:case p:case f:case s:return e;default:return t}}case a:return t}}}t.a=function(e){return _(e)===c},t.b=function(e){return _(e)===d}}
,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>V,b:()=>G,c:()=>N,d:()=>j,e:()=>z,f:()=>R,g:()=>B});var a=n(496),i=n(298);function r(e){return c(e)?(e.nodeName||"").toLowerCase():"#document"}function o(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function s(e){var t;return null==(t=(c(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function c(e){return e instanceof Node||e instanceof o(e).Node}function d(e){return e instanceof Element||e instanceof o(e).Element}function l(e){return e instanceof HTMLElement||e instanceof o(e).HTMLElement}function u(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof o(e).ShadowRoot)}function f(e){const{overflow:t,overflowX:n,overflowY:a,display:i}=g(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+n)&&!["inline","contents"].includes(i)}function p(e){return["table","td","th"].includes(r(e))}function m(e){const t=h(),n=g(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(e=>(n.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(n.contain||"").includes(e))}function _(e){let t=y(e);for(;l(t)&&!b(t);){if(m(t))return t;t=y(t)}return null}function h(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function b(e){return["html","body","#document"].includes(r(e))}function g(e){return o(e).getComputedStyle(e)}function v(e){return d(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function y(e){if("html"===r(e))return e;const t=e.assignedSlot||e.parentNode||u(e)&&e.host||s(e);return u(t)?t.host:t}function S(e){const t=y(e);return b(t)?e.ownerDocument?e.ownerDocument.body:e.body:l(t)&&f(t)?t:S(t)}function D(e,t,n){var a;void 0===t&&(t=[]),void 0===n&&(n=!0);const i=S(e),r=i===(null==(a=e.ownerDocument)?void 0:a.body),s=o(i);return r?t.concat(s,s.visualViewport||[],f(i)?i:[],s.frameElement&&n?D(s.frameElement):[]):t.concat(i,D(i,[],n))}function I(e){const t=g(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=l(e),o=r?e.offsetWidth:n,s=r?e.offsetHeight:i,c=(0,a.r)(n)!==o||(0,a.r)(i)!==s;return c&&(n=o,i=s),{width:n,height:i,$:c}}function x(e){return d(e)?e:e.contextElement}function C(e){const t=x(e);if(!l(t))return(0,a.b)(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:o}=I(t);let s=(o?(0,a.r)(n.width):n.width)/i,c=(o?(0,a.r)(n.height):n.height)/r;return s&&Number.isFinite(s)||(s=1),c&&Number.isFinite(c)||(c=1),{x:s,y:c}}const O=(0,a.b)(0);function w(e){const t=o(e);return h()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:O}function E(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),s=x(e);let c=(0,a.b)(1);t&&(i?d(i)&&(c=C(i)):c=C(e));const l=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==o(e))&&t}(s,n,i)?w(s):(0,a.b)(0);let u=(r.left+l.x)/c.x,f=(r.top+l.y)/c.y,p=r.width/c.x,m=r.height/c.y;if(s){const e=o(s),t=i&&d(i)?o(i):i;let n=e.frameElement;for(;n&&i&&t!==e;){const e=C(n),t=n.getBoundingClientRect(),a=g(n),i=t.left+(n.clientLeft+parseFloat(a.paddingLeft))*e.x,r=t.top+(n.clientTop+parseFloat(a.paddingTop))*e.y;u*=e.x,f*=e.y,p*=e.x,m*=e.y,u+=i,f+=r,n=o(n).frameElement}}return(0,a.q)({width:p,height:m,x:u,y:f})}const A=[":popover-open",":modal"];function L(e){let t=!1,n=0,a=0;if(A.forEach(n=>{!function(n){try{t=t||e.matches(n)}catch(e){}}(n)}),t){const t=_(e);if(t){const e=t.getBoundingClientRect();n=e.x,a=e.y}}return[t,n,a]}function k(e){return E(s(e)).left+v(e).scrollLeft}function M(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=o(e),a=s(e),i=n.visualViewport;let r=a.clientWidth,c=a.clientHeight,d=0,l=0;if(i){r=i.width,c=i.height;const e=h();(!e||e&&"fixed"===t)&&(d=i.offsetLeft,l=i.offsetTop)}return{width:r,height:c,x:d,y:l}}(e,n);else if("document"===t)i=function(e){const t=s(e),n=v(e),i=e.ownerDocument.body,r=(0,a.o)(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),o=(0,a.o)(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let c=-n.scrollLeft+k(e);const d=-n.scrollTop;return"rtl"===g(i).direction&&(c+=(0,a.o)(t.clientWidth,i.clientWidth)-r),{width:r,height:o,x:c,y:d}}(s(e));else if(d(t))i=function(e,t){const n=E(e,!0,"fixed"===t),i=n.top+e.clientTop,r=n.left+e.clientLeft,o=l(e)?C(e):(0,a.b)(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:r*o.x,y:i*o.y}}(t,n);else{const n=w(e);i={...t,x:t.x-n.x,y:t.y-n.y}}return(0,a.q)(i)}function P(e,t){const n=y(e);return!(n===t||!d(n)||b(n))&&("fixed"===g(n).position||P(n,t))}function T(e,t,n,i){const o=l(t),c=s(t),d="fixed"===n,u=E(e,!0,d,t);let p={scrollLeft:0,scrollTop:0};const m=(0,a.b)(0);if(o||!o&&!d)if(("body"!==r(t)||f(c))&&(p=v(t)),o){const e=E(t,!0,d,t);m.x=e.x+t.clientLeft,m.y=e.y+t.clientTop}else c&&(m.x=k(c));let _=u.left+p.scrollLeft-m.x,h=u.top+p.scrollTop-m.y;const[b,g,y]=L(i);return b&&(_+=g,h+=y,o&&(_+=t.clientLeft,h+=t.clientTop)),{x:_,y:h,width:u.width,height:u.height}}function U(e,t){return l(e)&&"fixed"!==g(e).position?t?t(e):e.offsetParent:null}function F(e,t){const n=o(e);if(!l(e))return n;let a=U(e,t);for(;a&&p(a)&&"static"===g(a).position;)a=U(a,t);return a&&("html"===r(a)||"body"===r(a)&&"static"===g(a).position&&!m(a))?n:a||_(e)||n}const H={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:o}=e;const c=s(i),[d]=t?L(t.floating):[!1];if(i===c||d)return n;let u={scrollLeft:0,scrollTop:0},p=(0,a.b)(1);const m=(0,a.b)(0),_=l(i);if((_||!_&&"fixed"!==o)&&(("body"!==r(i)||f(c))&&(u=v(i)),l(i))){const e=E(i);p=C(i),m.x=e.x+i.clientLeft,m.y=e.y+i.clientTop}return{width:n.width*p.x,height:n.height*p.y,x:n.x*p.x-u.scrollLeft*p.x+m.x,y:n.y*p.y-u.scrollTop*p.y+m.y}},getDocumentElement:s,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:o}=e;const s="clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let a=D(e,[],!1).filter(e=>d(e)&&"body"!==r(e)),i=null;const o="fixed"===g(e).position;let s=o?y(e):e;for(;d(s)&&!b(s);){const t=g(s),n=m(s);n||"fixed"!==t.position||(i=null),(o?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||f(s)&&!n&&P(e,s))?a=a.filter(e=>e!==s):i=t,s=y(s)}return t.set(e,a),a}(t,this._c):[].concat(n),c=[...s,i],l=c[0],u=c.reduce((e,n)=>{const i=M(t,n,o);return e.top=(0,a.o)(i.top,e.top),e.right=(0,a.p)(i.right,e.right),e.bottom=(0,a.p)(i.bottom,e.bottom),e.left=(0,a.o)(i.left,e.left),e},M(t,l,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}},getOffsetParent:F,getElementRects:async function(e){const t=this.getOffsetParent||F,n=this.getDimensions;return{reference:T(e.reference,await t(e.floating),e.strategy,e.floating),floating:{x:0,y:0,...await n(e.floating)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=I(e);return{width:t,height:n}},getScale:C,isElement:d,isRTL:function(e){return"rtl"===g(e).direction}},R=i.h,N=i.d,B=i.i,j=i.e,V=i.a,z=i.f,G=(e,t,n)=>{const a=new Map,r={platform:H,...n},o={...r.platform,_c:a};return(0,i.b)(e,t,{...r,platform:o})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>s,c:()=>u,d:()=>b,e:()=>g,f:()=>p,g:()=>_,h:()=>v,i:()=>S,j:()=>m,k:()=>D,l:()=>I,m:()=>h,n:()=>f,o:()=>r,p:()=>i,q:()=>x,r:()=>o,s:()=>a});const a=["top","right","bottom","left"],i=Math.min,r=Math.max,o=Math.round,s=(Math.floor,e=>({x:e,y:e})),c={left:"right",right:"left",bottom:"top",top:"bottom"},d={start:"end",end:"start"};function l(e,t,n){return r(e,i(t,n))}function u(e,t){return"function"==typeof e?e(t):e}function f(e){return e.split("-")[0]}function p(e){return e.split("-")[1]}function m(e){return"x"===e?"y":"x"}function _(e){return"y"===e?"height":"width"}function h(e){return["top","bottom"].includes(f(e))?"y":"x"}function b(e){return m(h(e))}function g(e,t,n){void 0===n&&(n=!1);const a=p(e),i=b(e),r=_(i);let o="x"===i?a===(n?"end":"start")?"right":"left":"start"===a?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=D(o)),[o,D(o)]}function v(e){const t=D(e);return[y(e),t,y(t)]}function y(e){return e.replace(/start|end/g,e=>d[e])}function S(e,t,n,a){const i=p(e);let r=function(e,t,n){const a=["left","right"],i=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:a:t?a:i;case"left":case"right":return t?r:o;default:return[]}}(f(e),"start"===n,a);return i&&(r=r.map(e=>e+"-"+i),t&&(r=r.concat(r.map(y)))),r}function D(e){return e.replace(/left|right|bottom|top/g,e=>c[e])}function I(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function x(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>o});var a=n("react-lib"),i=n(70),r=n(85);function o(e,t){var n=(0,r.c)(),o=[];(0,a.useEffect)(function(){return function(){var a=n.consume(i.b);for(var r in e)if(e.hasOwnProperty(r)){var s=r,c=e[s];c&&o.push(a.subscribe(s,c,t))}}(),function(){for(var e;e=o.pop();)e()}},[])}function s(e){var t=(0,a.useState)(),n=t[0],r=t[1];return o({updateOneUpStatus:function(t){if("update"in t.detail&&t.detail.update&&"publisher"in t.detail){var n=t.detail.update,a=e?e(n):n;r(a)}}},i.a.oneUpItemCacheUpdate),n}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>f,c:()=>d,d:()=>p,e:()=>a,f:()=>l,g:()=>m,h:()=>_});var a,i=n("tslib_826"),r=n("react-lib"),o=n(38),s=n(85),c=n(239),d="CollabOneUp",l="Viewer",u="Command",f="Component";!function(e){e.success="Success",e.unexpectedFailure="UnexpectedFailure",e.expectedFailure="ExpectedFailure"}(a||(a={}));var p=r.createContext({});function m(e,t){var n=0===e.indexOf(d)?e:"".concat(d,".").concat(e),a=null==t?void 0:t.engagementContext;t&&t.engagementContext&&(t.engagementContext=void 0);var r={name:n,extraData:(0,i.W_)((0,i.W_)({},t),a)};o.a.logData(r)}function _(){return(0,s.c)().consume(c.a)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>j});var a=n(115),i=n("odsp.util_118"),r=n("tslib_826"),o=n(28),s=n(226),c=n(4),d=n(64),l=n(5),u=n(40),f=new i.hK({name:"isCopilotEnabledOnSite",factory:{dependencies:{pageContext:l.a},create:function(e){var t=e.pageContext;return{instance:function(){var e=!0;return i.HW.isActivated("44d3c708-0bb8-444d-8457-4b05f3853ba7","11/20/2023","enables the msit site disallow list logic")||((0,u.a)({ODB:61346})?e=!0:(e=0===(0,d.c)(90214,t))||new c.a({name:"CopilotDisabledOnSite_OD_90214"}).end({resultType:c.b.Success})),(0,s.a)().availability.isSiteAllowed=e,e}}}}}),p=n(38),m="UserLicensedForCopilot",_="UserNotLicensedForCopilot",h=new i.hK({name:"isUserCopilotLicensed",factory:{dependencies:{pageContext:l.a},create:function(e){var t=e.pageContext,n=!1,a=(0,s.a)();return window.sessionStorage.getItem("_isRunningTABTest")?(a.availability.isLicenseCheckBypassed=!0,n=!0):(n=!!t.canUserUseSPCopilot,new c.a({name:n?m:_}).end({resultType:c.b.Success}),p.a.logData({name:n?m:_})),a.availability.isLicensed=n,a.availability.siteSubscriptionId=t.siteSubscriptionId,{instance:n}}}}),b=new i.hK({name:"ECSDataSource.key",loader:new i.vh(function(){return n.e(10).then(n.bind(n,645)).then(function(e){return e.ecsDataSourceKey})})}),g={ODB:61598};function v(){var e=!i.HW.isActivated("1732ACBA-F0C5-4DEA-9B0D-B533DA1E48A6")&&i.Tb.isFeatureEnabled(g);return(0,s.a)().availability.enableCopilotMochaSegmentation=e,e}function y(e){return"mocha_".concat(e)}var S=!1,D={pageContext:l.a,getECSDataSource:b.async.lazy},I=new i.hK({name:"isMochaBypassEnabled",factory:{dependencies:D,create:function(e){var t=e.pageContext,n=e.getECSDataSource,a=!1;if(v()){var i=t.aadUserId||"";a=function(e){var t,n=(0,s.a)(),a="true"===(null===(t=window.localStorage)||void 0===t?void 0:t.getItem(y(e)));return n.availability.aadUserId=e,n.availability.isUserInMochaSegmentation=a,a}(i),function(e,t){v()&&!S&&e&&(S=!0,t().then(function(e){return e.getECSSMochaSegmentation()}).then(function(t){var n,a=y(e);null===(n=window.localStorage)||void 0===n||n.setItem(a,t.toString())}))}(i,n)}return{instance:function(){return a}}}}}),x=n(20),C=n(342),O=!1,w=n(70),E=new i.hK({name:"showCopilotPaneAsync.key",loader:new i.vh(function(){return Promise.all([n.e("ondemand.resx"),n.e(5)]).then(n.bind(n,646)).then(function(e){return e.showCopilotPaneKey})})}),A=n(53),L=n(504),k=n(505),M=!i.HW.isActivated("362E5C67-02CF-4C98-AE96-22103CD0A622"),P={resources:i.Ci,oneUpStateStore:A.e,getExecutor:E.async.lazy,oneUpStore:w.b,pageContext:l.a},T=new i.hK({name:"onClickCopilotPaneAction",factory:{dependencies:P,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=t.resources,a=t.pageContext,s=(0,o.Z)(o.f);!s&&M&&(s=n.consume(I)());var c=s&&n.consume(h)&&n.consume(f)(),d=!!e.item.extension&&function(e,t){var n=t;try{var a=(0,L.b)(L.a),i=(0,k.a)(a);if(i){var r=e.replace(".","");n=n&&!!i.map.get(r)}else n=!1}catch(e){n=!1}return n}(e.item.extension,c);return!O&&c&&(O=!0,C.a.logData({name:"ChatODSP.EntryPointRendered"})),{isAvailable:d,id:"openCopilotPaneAction",onExecute:function(){return(0,r.Zd)(void 0,void 0,void 0,function(){var n,s,c,d,l,u,f,p,m,_,h;return(0,r.qr)(this,function(r){switch(r.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==A.d.copilotPane?[3,1]:(t.oneUpStateStore.updateRightPaneState("closeCopilotPane",{type:A.d.none}),[3,4]);case 1:return n=void 0,(0,o.N)()&&(s=t.oneUpStore.getOneUpProperties(),c=new x.b({context:a}),d=(0,i.k1)(e.item.key),l=d.id,u=d.listurl,f=c.getUrlParts({listUrl:u,path:l}),p=f.fullWebUrl,m={webAbsoluteUrl:p,listUrl:f.serverRelativeListUrl},n=null===(h=null==s?void 0:s.pageContexts)||void 0===h?void 0:h.get(m)),_={currentPageContext:n,loadConversationHistory:!!(window.event&&window.event instanceof MouseEvent&&window.event.shiftKey)},[4,t.getExecutor()];case 2:return[4,r.sent().showCopilotPane(_)];case 3:r.sent(),r.label=4;case 4:return[2]}})})}}})}};var t}}}),U=n(164),F={actionProvider:T},H="CopilotPaneCommand",R=window.require,N=R.toUrl?R.toUrl("odsp-media/images/copilot/svg/ic_fluent_copilot_16_color.svg"):void 0,B=(0,U.a)(),j=new i.hK({name:"CopilotCommand",factory:{dependencies:F,create:function(e){var t=e.actionProvider;return{instance:{id:H,title:a.f,automationId:H,iconProps:{imageProps:{src:N}},evaluateAction:t.evaluateAction,buttonStyles:B}}}}})}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var a=n("react-lib"),i=n(510),r=n("fui.util_554"),o=n("odsp.util_118"),s=n(511);function c(e){var t=e.allowInfectedFileDownload?i.c:i.f,n=(0,r.n6)();return a.createElement(s.a,null,o.ni(t,a.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank",rel:"noreferrer"},a.createElement("span",{style:{color:n.palette.themePrimary}},i.e))))}}
,,,(e,t,n)=>{"use strict";function a(e){return!!(null==e?void 0:e.match(/https?:\/\/[^\/]+\/transform\/.*/))}function i(e){var t=e.headers;return{correlationId:t.get("X-Correlationid")||void 0,failureReason:t.get("X-Onedrive-Thumbnailfailurereason")||void 0}}n.d(t,{a:()=>a,b:()=>i})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>d,c:()=>s});var a=n(34),i=n(6),r=n(26);function o(e,t,n){return i.c.all([c(e),c(e,n)]).then(function(e){var n=e[0],a=e[1],i=a.length>n.length;return{text:i?n:a,mimeType:t,isSafeText:i||l(a)}},function(e){return e.filter(function(e){return!i.c.isCanceled(e)})[0]||e[0]})}function s(e,t){return c(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})}function c(e,t){var n=new a.b,i=new FileReader;return i.onload=function(){n.complete(i.result||"")},i.onerror=function(e){var t=i.error;t&&t.message&&console.log(t.message)},i.readAsText(e,t),n.getPromise()}function d(e,t){return-1===t.search(/^http/)||t.lastIndexOf(":")===t.indexOf(":")&&t.indexOf("/content?format=")<0||t.indexOf(":/content?")>=0?t:"".concat(t.indexOf("/content?format=")>=0?"".concat(t):"".concat(t,":/content?")).concat((0,r.a)(e))}function l(e){for(var t=0;t<e.length;t++)if(!((n=e.charCodeAt(t))<127||u[n]))return!1;var n;return!0}var u={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_118"),i=new a.hK({name:"SaveActionExecutor.key",loader:new a.vh(function(){return n.e(50).then(n.bind(n,650)).then(function(e){return e.saveActionExecutorKey})})})}
,,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>d});var i=new Uint8Array(16);function r(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}for(var o=n(521),s=[],c=0;c<256;++c)s.push((c+256).toString(16).substr(1));const d=function(e,t,n){var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!(0,o.a)(n))throw TypeError("Stringified UUID is invalid");return n}(a)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,i=function(e){return"string"==typeof e&&a.test(e)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("odsp.util_118"),i={Modified:"modified",ExitEdit:"exitEdit"},r=new a.hK({name:"PdfEmbedHelper.key",loader:new a.vh(function(){return n.e(45).then(n.bind(n,652)).then(function(e){return e.resourceKey})})})}
,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n(83),i=n(317),r=function(e){var t=new a.a(e.origin.x,e.origin.y);return{image:e.image,origin:t.scale(1/(0,i.a)()),triggerType:e.triggerType}},o=function(e,t,n,i,r){return new a.b(e,t,n-e,i-t).scale(r||1)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_826");const i=()=>(0,a.Zd)(void 0,void 0,void 0,function*(){return Promise.all([n.e("odsp.react.lib"),n.e(24)]).then(n.bind(n,660))})}
,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=["ToolButtonPenLabel","ToolButtonPenDescription","ToolButtonPenOrHighlitActiveAriaSuffix","ToolButtonFreeTextActiveAriaSuffix","ToolButtonFreeTextLabel","ToolButtonFreeTextTooltip","ToolButtonHighlighterLabel","ToolButtonHighlighterDescription","ToolButtonEraserTooltip","ToolButtonEraserLabel","ToolButtonEraserDescription","ToolButtonDisplayTooltip","ToolButtonDisplayLabel","ToolButtonSelectedText","ToolButtonDisplayDescription","ToolbarThickness","ToolbarButtonFormatString","ToolbarStylePickerTriggerNotice","inkToolbarLabel","PenThicknessSliderLabel","HighlighterThicknessSliderLabel","ColorPickerColorDarkYellow","ColorPickerColorLightOrange","ColorPickerColorOrange","ColorPickerColorRed","ColorPickerColorDarkPurple","ColorPickerColorPurple","ColorPickerColorMagenta","ColorPickerColorDarkRed","ColorPickerColorLightBlue","ColorPickerColorBlue","ColorPickerColorDarkBlue","ColorPickerColorLightGreen","ColorPickerColorGreen","ColorPickerColorLightGrey","ColorPickerColorGrey","ColorPickerColorBlack","ColorPickerTable"]}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>f,c:()=>m,d:()=>p});var a=n("tslib_826"),i=n("react-lib"),r=n.n(i),o=n(557),s=n(179),c=n(308),d=n(60),l=n(322),u=function(){return r().useContext(o.a)},f=function(){return r().useContext(o.b)},p=function(e){var t=r().useCallback(function(t,n){var a,i=null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.getToastOperation();null==i||i({type:s.b.Running,text:t,percentComplete:n/100})},[e]),n=r().useCallback(function(t,n){var a,i=null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.getToastOperation();null==i||i({type:s.b.Success,text:t,link:n,linkText:"Open",onClickClose:function(){null==i||i({type:s.b.Hidden})}})},[e]),i=r().useCallback(function(t){var n,a=null===(n=null==e?void 0:e.current)||void 0===n?void 0:n.getToastOperation();null==a||a({type:s.b.Error,text:t,onClickClose:function(){null==a||a({type:s.b.Hidden})}})},[e]);return r().useCallback(function(e){return(0,a.Zd)(void 0,void 0,void 0,function(){var r,o,s,l,u,f,p,m,_,h;return(0,a.qr)(this,function(a){switch(a.label){case 0:r=0,o=0,s=new c.d({name:e.scenarioName}),a.label=1;case 1:return a.trys.push([1,3,4,5]),r=window.setInterval(function(){if(100-o>10)return o+=10,void t(e.runningText,o);o=Math.floor((100-o)/4)+o,t(e.runningText,o)},200),null===(f=e.telemetryHandler)||void 0===f||f.logQosStart(s),null===(p=e.before)||void 0===p||p.call(e),[4,e.runner()];case 2:return l=a.sent(),clearInterval(r),n(e.successText,l),null===(m=e.telemetryHandler)||void 0===m||m.logQosEnd(new c.c(s.payload.id,e.scenarioName,d.b.Succeed,{})),[3,5];case 3:return u=a.sent(),clearInterval(r),i(e.failedText),null===(_=e.telemetryHandler)||void 0===_||_.logQosEnd(new c.c(s.payload.id,e.scenarioName,d.b.Fail,{isExpected:!1,error:u})),[3,5];case 4:return null===(h=e.after)||void 0===h||h.call(e),[7];case 5:return[2]}})})},[t,n,i])},m=function(e){return r().useCallback(function(t,n){return(0,a.Zd)(void 0,void 0,void 0,function(){var i,r,o,s,c,d,u,f;return(0,a.qr)(this,function(a){switch(a.label){case 0:if(!e)throw new l.a("Manipulator is not ready in PDF engine");a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n()];case 2:return i=a.sent(),[3,4];case 3:throw r=a.sent(),new l.a("Manipulator runtime error: ".concat(r.message));case 4:if(!i)throw new l.a("Manipulator is not ready in PDF engine");if(o=i[0],s=i[1],0!==o)throw new l.a("Fail to manipulate PDF from PDF Parser, code=".concat(o));return c=t.newFileName,d=t.items,u=new Blob([s],{type:"application/pdf"}),f=new File([u],"".concat(c,".pdf"),{type:"application/pdf"}),[2,e(f,d[0])]}})})},[e])}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("react-lib"),i=(0,a.createContext)(function(){throw new Error("closeFilePickerCtx call out of context scope")}),r=(0,a.createContext)(function(){throw new Error("confirmFilePickerCtx call out of context scope")})}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>i});var a=n(146);function i(e){var t=e&&e.replace(/^\./,"");return!(!t||!a.b[t])}function r(e){return!(!e||!e.extension||i(e.extension))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var a=n("tslib_826"),i=n("react-lib"),r=n("odsp.util_118"),o=n(133),s="presenceCommand";function c(e){return{id:s,isAvailable:!0,isDisabled:!0}}var d=new r.hK({name:"PresenceCommand",factory:{dependencies:{},create:function(){var e=(0,o.a)(function(){return(0,a.Zd)(void 0,void 0,void 0,function(){return(0,a.qr)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,684))];case 1:return[2,e.sent().PresenceHeaderAsyncDeferred]}})})});return{instance:{id:s,automationId:s,onRender:function(t){return i.createElement(e,null)},evaluateAction:c}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>v});var a=n(115),i=n("odsp.util_118"),r=n(332),o={actionProvider:r.c},s="shareCommand",c=new i.hK({name:"ShareCommand",factory:{dependencies:o,create:function(e){var t=e.actionProvider;return{instance:{id:s,name:a.gb,title:a.vb,automationId:s,iconProps:{iconName:"Share"},evaluateAction:t.evaluateAction}}}}}),d={actionProvider:r.a},l="copyLinkCommand",u=new i.hK({name:"CopyCommand",factory:{dependencies:d,create:function(e){var t=e.actionProvider;return{instance:{id:l,name:a.g,title:a.g,automationId:l,iconProps:{iconName:"Link"},evaluateAction:t.evaluateAction}}}}}),f={actionProvider:r.b},p="manageAccessCommand",m=new i.hK({name:"ManageAccessCommand",factory:{dependencies:f,create:function(e){var t=e.actionProvider;return{instance:{id:p,name:a.T,title:a.T,automationId:p,iconProps:{iconName:"Contact"},evaluateAction:t.evaluateAction}}}}}),_=n(164),h={shareCommand:c,copyCommand:u,manageAccessCommand:m},b="shareCommandGroup",g=function(e){return{isAvailable:!0}},v=new i.hK({name:"ShareGroupCommand",factory:{dependencies:h,create:function(e){var t=e.shareCommand,n=e.copyCommand,i=e.manageAccessCommand;return{instance:{id:b,name:a.gb,automationId:b,subCommands:[t,n,i],evaluateAction:g,buttonStyles:(0,_.a)(),iconProps:{iconName:"Share"}}}}}})}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s});var a=n(69),i=n(5),r=n(91),o=n(193),s=(0,n("odsp.util_118").yE)("DataRequestor",a.b,{pageContext:i.a,offlineDetection:r.a,noRedirect:o.a});const c=a.b}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a=n(49),i=n(43),r=n(20),o=n("odsp.util_118"),s=n(439),c=n(239),d=n(438),l={resourceScope:o.Ci,navigation:a.a,engagementContext:c.a},u=new o.hK({name:"ListItemRetrieverHelper",factory:{dependencies:l,create:function(e){var t=e.resourceScope,n=e.navigation,a=e.engagementContext,o=(0,d.a)(t),c=o.idViewParam,l=o.webAbsoluteUrl,u=o.fullListUrl,f=o.serverRelativeFocusItemUrl,p=o.listContext,m=o.pageContext,_=new i.a({},{pageContext:m});return{instance:{getCurrentItem:function(e){var t=_.getItemUrlParts(window.location.href),i=t.isCrossList,o=t.isCrossDomain,d=t.geoRelation,h=l&&u?{pageContext:m,id:c?f:void 0,webAbsoluteUrl:l,listFullUrl:u,listContext:p,extraLoggingData:{isCrossList:i,isCrossDomain:o,isCrossGeo:d!==r.a.sameGeo,correlationId:m.CorrelationId,engagementContext:a,isShareLinkRedeeming:void 0!==n.viewParams.ga}}:void 0;return h?new s.a(h).getSingleItem(e):Promise.resolve(void 0)}}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_118"),i=new a.hK({name:"UniversalPrintDataSourceAsync.key",loader:new a.vh(function(){return n.e(60).then(n.bind(n,639)).then(function(e){return e.universalPrintDataSourceKey})})})}
,,(e,t,n)=>{"use strict";function a(){return window.location!==window.parent.location}function i(){var e=window;return e.parent===e&&!e.opener&&void 0!==e.external&&("messageToHost"in e.external||"notify"in e.external)}n.d(t,{a:()=>a,b:()=>i})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a=n("tslib_826"),i=n("fui.util_554"),r={bodyBackground:"#faf9f8",menuBackground:"#ffffff",menuDivider:"#c8c6c4",menuItemBackgroundHovered:"#f3f2f1",menuIcon:"#605e5c",menuItemText:"#323130",inputBackground:"#ffffff",inputBorder:"#bebbb8",inputText:"#323130",inputPlaceholderText:"#605e5c",cardStandoutBackground:"#ebf3fc",cardShadowHovered:"#b4d6fa",listText:"#242424",disabledBorder:"#707070",messageLink:"#115ea3",messageLinkHovered:"#0f548c"},o={neutralLight:"#edebe9",neutralLighterAlt:"#faf9f8",neutralPrimary:"#323130",neutralTertiary:"#616161",white:"#ffffff"},s={bodyBackground:"#201f1e",menuBackground:"#484644",menuDivider:"#BEBBB8",menuItemBackgroundHovered:"#3B3A39",menuItemBackgroundPressed:"#3B3A39",menuIcon:"#FFFFFF",menuItemText:"#F3F2F1",menuItemTextHovered:"#F3F2F1",inputBackground:"#292929",inputBorder:"#bebbb8",inputText:"#F3F2F1",inputPlaceholderText:"#999999",primaryButtonBackgroundDisabled:"#252423",primaryButtonBackgroundPressed:"#043862",primaryButtonText:"#FFFFFF",primaryButtonTextHovered:"#FFFFFF",primaryButtonTextPressed:"#FFFFFF",disabledText:"#A19F9D",bodySubtext:"#F3F2F1",buttonBackgroundPressed:"#292827",cardStandoutBackground:"#082338",cardShadowHovered:"#0e4775",listText:"#ffffff",disabledBorder:"#999999",messageLink:"#479ef5",messageLinkHovered:"#62abf5"},c={neutralDark:"#f3f2f1",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",neutralPrimary:"#f3f2f1",neutralTertiary:"#adadad",themeDark:"#faf9f8",white:"#1b1a19"},d=(0,i.aE)({palette:o,semanticColors:r}),l=(0,i.aE)({palette:c,semanticColors:s,isInverted:!0}),u=function(e,t){if(void 0===t&&(t=!1),!e)return t?l:d;var n=e.palette,u=e.semanticColors,f=(0,a.l7)(e,["palette","semanticColors"]),p=(0,a.W_)({palette:t?(0,a.W_)((0,a.W_)({},c),n):(0,a.W_)((0,a.W_)({},o),n),semanticColors:t?(0,a.W_)((0,a.W_)({},s),u):(0,a.W_)((0,a.W_)({},r),u),isInverted:(null==e?void 0:e.isInverted)||t},f);return(0,i.aE)(p)}}
],t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e;var a=document.currentScript,i=window,r=i.require;function o(e){var t=e&&e.indexOf("/",e.indexOf("://")+3)+1;return t?e.slice(0,t):e}var s,c,d,l,u,f=o(a&&a.src||r&&r.toUrl("")),p=o(i.__backupBaseUrl),m=r&&r.s.contexts._,_=i.__odspSriHashes;n.amdO={},s=[],n.O=(e,t,a,i)=>{if(!t){var r=1/0;for(l=0;l<s.length;l++){for(var[t,a,i]=s[l],o=!0,c=0;c<t.length;c++)(!1&i||r>=i)&&Object.keys(n.O).every(e=>n.O[e](t[c]))?t.splice(c--,1):(o=!1,i<r&&(r=i));if(o){s.splice(l--,1);var d=a();void 0!==d&&(e=d)}}return e}i=i||0;for(var l=s.length;l>0&&s[l-1][2]>i;l--)s[l]=s[l-1];s[l]=[t,a,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},d=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var a=Object.create(null);n.r(a);var i={};c=c||[null,d({}),d([]),d(d)];for(var r=2&t&&e;"object"==typeof r&&!~c.indexOf(r);r=d(r))Object.getOwnPropertyNames(r).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,n.d(a,i),a},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,a)=>(n.f[a](e,t),t),[])),n.u=e=>"odsp.1ds.lib"===e?"odsp.1ds.lib.js":({"ondemand.resx":1,"odsp.1ds.lib":1}[e]?self.__odsp_culture+"/":"")+e+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l={},u="__webpack_result__:",n.l=(e,t,a,r)=>{if(l[e])l[e].push(t);else{var o,s;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var f=c[d];if(f.getAttribute("src")==e||f.getAttribute("data-webpack")==u+a){o=f;break}}if(!o){s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",u+a),o.setAttribute("fetchpriority","high"),o.src=e,0!==o.src.indexOf(window.location.origin+"/")&&(o.crossOrigin="anonymous");var p=function(e){return _&&(_[i.__odsp_culture+"/"+e]||_[e])}(r);p&&(o.integrity=p)}l[e]=[t];var m=(t,n)=>{o.onerror=o.onload=null,clearTimeout(h);var a=l[e];if(delete l[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(n)),t)return t(n)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),s&&document.head.appendChild(o)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var i=a.length-1;i>-1&&!e;)e=a[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{n.b=document.baseURI||self.location.href;var e={oneuplightspeedwebpack:0};n.f.j=(t,a)=>{var r=t.toString(),o=m&&m.config.paths[r]&&m.nameToUrl(r)||n.p+n.u(t);function s(t){var a=n.o(e,t)?e[t]:void 0;if(0!==a){if(a)return a;var i=new Promise((n,i)=>a=e[t]=[n,i]);a[2]=i,a[3]=o;var r=new Error;return n.l(o,i=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;r.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",r.name="ChunkLoadError",r.type=o,r.request=s,r.chunkId=t,a[1](r)}},"chunk-"+t,t),a}}var c=s(t);c&&a.push(c[2].catch(function(e){var n=i.__integrityViolationCallBack;n&&n(e.request);var a=c[3],r=p&&a.replace(f,p);if(r&&r!==a){o=r;var d=s(t);return d&&d[2]}return Promise.reject(e)}))},n.O.j=t=>0===e[t];var t=(t,a)=>{var i,r,[o,s,c]=a,d=0;if(o.some(t=>0!==e[t])){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var l=c(n)}for(t&&t(a);d<o.length;d++)r=o[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},a=self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var h=n.O(void 0,["odsp.react.lib","odsp.util","tslib","fui.util","fui.core","initial.resx","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"],()=>n(386));h=n.O(h),__webpack_result__=h})(),define("oneuplightspeedwebpack",[],{});